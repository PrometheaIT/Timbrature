import{a as P,b as Y,c as _x,d as Ar,e as yx,f as bx,g as Rr,h as b,j as Kv,k as Yv,n as wx,o as Zv}from"./chunk-7F6XFQYV.js";var kr={};yx(kr,{__addDisposableResource:()=>k_,__assign:()=>Sc,__asyncDelegator:()=>T_,__asyncGenerator:()=>Ic,__asyncValues:()=>Tc,__await:()=>ti,__awaiter:()=>z,__classPrivateFieldGet:()=>O_,__classPrivateFieldIn:()=>P_,__classPrivateFieldSet:()=>N_,__createBinding:()=>Dc,__decorate:()=>g_,__disposeResources:()=>F_,__esDecorate:()=>__,__exportStar:()=>S_,__extends:()=>m_,__generator:()=>C_,__importDefault:()=>R_,__importStar:()=>A_,__makeTemplateObject:()=>M_,__metadata:()=>E_,__param:()=>v_,__propKey:()=>b_,__read:()=>Up,__rest:()=>xi,__rewriteRelativeImportExtension:()=>L_,__runInitializers:()=>y_,__setFunctionName:()=>w_,__spread:()=>x_,__spreadArray:()=>I_,__spreadArrays:()=>D_,__values:()=>xc,default:()=>Fx});function m_(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");Vp(n,t);function e(){this.constructor=n}n.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function xi(n,t){var e={};for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&t.indexOf(i)<0&&(e[i]=n[i]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(n);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(n,i[r])&&(e[i[r]]=n[i[r]]);return e}function g_(n,t,e,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(n,t,e,i);else for(var a=n.length-1;a>=0;a--)(s=n[a])&&(o=(r<3?s(o):r>3?s(t,e,o):s(t,e))||o);return r>3&&o&&Object.defineProperty(t,e,o),o}function v_(n,t){return function(e,i){t(e,i,n)}}function __(n,t,e,i,r,o){function s(M){if(M!==void 0&&typeof M!="function")throw new TypeError("Function expected");return M}for(var a=i.kind,c=a==="getter"?"get":a==="setter"?"set":"value",f=!t&&n?i.static?n:n.prototype:null,h=t||(f?Object.getOwnPropertyDescriptor(f,i.name):{}),m,y=!1,g=e.length-1;g>=0;g--){var w={};for(var T in i)w[T]=T==="access"?{}:i[T];for(var T in i.access)w.access[T]=i.access[T];w.addInitializer=function(M){if(y)throw new TypeError("Cannot add initializers after decoration has completed");o.push(s(M||null))};var x=(0,e[g])(a==="accessor"?{get:h.get,set:h.set}:h[c],w);if(a==="accessor"){if(x===void 0)continue;if(x===null||typeof x!="object")throw new TypeError("Object expected");(m=s(x.get))&&(h.get=m),(m=s(x.set))&&(h.set=m),(m=s(x.init))&&r.unshift(m)}else(m=s(x))&&(a==="field"?r.unshift(m):h[c]=m)}f&&Object.defineProperty(f,i.name,h),y=!0}function y_(n,t,e){for(var i=arguments.length>2,r=0;r<t.length;r++)e=i?t[r].call(n,e):t[r].call(n);return i?e:void 0}function b_(n){return typeof n=="symbol"?n:"".concat(n)}function w_(n,t,e){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(n,"name",{configurable:!0,value:e?"".concat(e," ",t):t})}function E_(n,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,t)}function z(n,t,e,i){function r(o){return o instanceof e?o:new e(function(s){s(o)})}return new(e||(e=Promise))(function(o,s){function a(h){try{f(i.next(h))}catch(m){s(m)}}function c(h){try{f(i.throw(h))}catch(m){s(m)}}function f(h){h.done?o(h.value):r(h.value).then(a,c)}f((i=i.apply(n,t||[])).next())})}function C_(n,t){var e={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,r,o,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=a(0),s.throw=a(1),s.return=a(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function a(f){return function(h){return c([f,h])}}function c(f){if(i)throw new TypeError("Generator is already executing.");for(;s&&(s=0,f[0]&&(e=0)),e;)try{if(i=1,r&&(o=f[0]&2?r.return:f[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,f[1])).done)return o;switch(r=0,o&&(f=[f[0]&2,o.value]),f[0]){case 0:case 1:o=f;break;case 4:return e.label++,{value:f[1],done:!1};case 5:e.label++,r=f[1],f=[0];continue;case 7:f=e.ops.pop(),e.trys.pop();continue;default:if(o=e.trys,!(o=o.length>0&&o[o.length-1])&&(f[0]===6||f[0]===2)){e=0;continue}if(f[0]===3&&(!o||f[1]>o[0]&&f[1]<o[3])){e.label=f[1];break}if(f[0]===6&&e.label<o[1]){e.label=o[1],o=f;break}if(o&&e.label<o[2]){e.label=o[2],e.ops.push(f);break}o[2]&&e.ops.pop(),e.trys.pop();continue}f=t.call(n,e)}catch(h){f=[6,h],r=0}finally{i=o=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function S_(n,t){for(var e in n)e!=="default"&&!Object.prototype.hasOwnProperty.call(t,e)&&Dc(t,n,e)}function xc(n){var t=typeof Symbol=="function"&&Symbol.iterator,e=t&&n[t],i=0;if(e)return e.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Up(n,t){var e=typeof Symbol=="function"&&n[Symbol.iterator];if(!e)return n;var i=e.call(n),r,o=[],s;try{for(;(t===void 0||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(a){s={error:a}}finally{try{r&&!r.done&&(e=i.return)&&e.call(i)}finally{if(s)throw s.error}}return o}function x_(){for(var n=[],t=0;t<arguments.length;t++)n=n.concat(Up(arguments[t]));return n}function D_(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;for(var i=Array(n),r=0,t=0;t<e;t++)for(var o=arguments[t],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}function I_(n,t,e){if(e||arguments.length===2)for(var i=0,r=t.length,o;i<r;i++)(o||!(i in t))&&(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return n.concat(o||Array.prototype.slice.call(t))}function ti(n){return this instanceof ti?(this.v=n,this):new ti(n)}function Ic(n,t,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=e.apply(n,t||[]),r,o=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",s),r[Symbol.asyncIterator]=function(){return this},r;function s(g){return function(w){return Promise.resolve(w).then(g,m)}}function a(g,w){i[g]&&(r[g]=function(T){return new Promise(function(x,M){o.push([g,T,x,M])>1||c(g,T)})},w&&(r[g]=w(r[g])))}function c(g,w){try{f(i[g](w))}catch(T){y(o[0][3],T)}}function f(g){g.value instanceof ti?Promise.resolve(g.value.v).then(h,m):y(o[0][2],g)}function h(g){c("next",g)}function m(g){c("throw",g)}function y(g,w){g(w),o.shift(),o.length&&c(o[0][0],o[0][1])}}function T_(n){var t,e;return t={},i("next"),i("throw",function(r){throw r}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(r,o){t[r]=n[r]?function(s){return(e=!e)?{value:ti(n[r](s)),done:!1}:o?o(s):s}:o}}function Tc(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=n[Symbol.asyncIterator],e;return t?t.call(n):(n=typeof xc=="function"?xc(n):n[Symbol.iterator](),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(o){e[o]=n[o]&&function(s){return new Promise(function(a,c){s=n[o](s),r(a,c,s.done,s.value)})}}function r(o,s,a,c){Promise.resolve(c).then(function(f){o({value:f,done:a})},s)}}function M_(n,t){return Object.defineProperty?Object.defineProperty(n,"raw",{value:t}):n.raw=t,n}function A_(n){if(n&&n.__esModule)return n;var t={};if(n!=null)for(var e=zp(n),i=0;i<e.length;i++)e[i]!=="default"&&Dc(t,n,e[i]);return Px(t,n),t}function R_(n){return n&&n.__esModule?n:{default:n}}function O_(n,t,e,i){if(e==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?n!==t||!i:!t.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e==="m"?i:e==="a"?i.call(n):i?i.value:t.get(n)}function N_(n,t,e,i,r){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?n!==t||!r:!t.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?r.call(n,e):r?r.value=e:t.set(n,e),e}function P_(n,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof n=="function"?t===n:n.has(t)}function k_(n,t,e){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var i,r;if(e){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");i=t[Symbol.asyncDispose]}if(i===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");i=t[Symbol.dispose],e&&(r=i)}if(typeof i!="function")throw new TypeError("Object not disposable.");r&&(i=function(){try{r.call(this)}catch(o){return Promise.reject(o)}}),n.stack.push({value:t,dispose:i,async:e})}else e&&n.stack.push({async:!0});return t}function F_(n){function t(o){n.error=n.hasError?new kx(o,n.error,"An error was suppressed during disposal."):o,n.hasError=!0}var e,i=0;function r(){for(;e=n.stack.pop();)try{if(!e.async&&i===1)return i=0,n.stack.push(e),Promise.resolve().then(r);if(e.dispose){var o=e.dispose.call(e.value);if(e.async)return i|=2,Promise.resolve(o).then(r,function(s){return t(s),r()})}else i|=1}catch(s){t(s)}if(i===1)return n.hasError?Promise.reject(n.error):Promise.resolve();if(n.hasError)throw n.error}return r()}function L_(n,t){return typeof n=="string"&&/^\.\.?\//.test(n)?n.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(e,i,r,o,s){return i?t?".jsx":".js":r&&(!o||!s)?e:r+o+"."+s.toLowerCase()+"js"}):n}var Vp,Sc,Dc,Px,zp,kx,Fx,ke=_x(()=>{"use strict";Vp=function(n,t){return Vp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])},Vp(n,t)};Sc=function(){return Sc=Object.assign||function(t){for(var e,i=1,r=arguments.length;i<r;i++){e=arguments[i];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t},Sc.apply(this,arguments)};Dc=Object.create?function(n,t,e,i){i===void 0&&(i=e);var r=Object.getOwnPropertyDescriptor(t,e);(!r||("get"in r?!t.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return t[e]}}),Object.defineProperty(n,i,r)}:function(n,t,e,i){i===void 0&&(i=e),n[i]=t[e]};Px=Object.create?function(n,t){Object.defineProperty(n,"default",{enumerable:!0,value:t})}:function(n,t){n.default=t},zp=function(n){return zp=Object.getOwnPropertyNames||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[e.length]=i);return e},zp(n)};kx=typeof SuppressedError=="function"?SuppressedError:function(n,t,e){var i=new Error(e);return i.name="SuppressedError",i.error=n,i.suppressed=t,i};Fx={__extends:m_,__assign:Sc,__rest:xi,__decorate:g_,__param:v_,__esDecorate:__,__runInitializers:y_,__propKey:b_,__setFunctionName:w_,__metadata:E_,__awaiter:z,__generator:C_,__createBinding:Dc,__exportStar:S_,__values:xc,__read:Up,__spread:x_,__spreadArrays:D_,__spreadArray:I_,__await:ti,__asyncGenerator:Ic,__asyncDelegator:T_,__asyncValues:Tc,__makeTemplateObject:M_,__importStar:A_,__importDefault:R_,__classPrivateFieldGet:O_,__classPrivateFieldSet:N_,__classPrivateFieldIn:P_,__addDisposableResource:k_,__disposeResources:F_,__rewriteRelativeImportExtension:L_}});var uv=Ar(cv=>{"use strict";Object.defineProperty(cv,"__esModule",{value:!0});var lv=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};cv.default=lv});var pv=Ar(fv=>{"use strict";Object.defineProperty(fv,"__esModule",{value:!0});var Q1=(ke(),Rr(kr)),OP=Q1.__importDefault((Zv(),Rr(wx))),NP=Q1.__importDefault(uv()),dv=class{constructor(t){var e,i;this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=new Headers(t.headers),this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=(e=t.shouldThrowOnError)!==null&&e!==void 0?e:!1,this.signal=t.signal,this.isMaybeSingle=(i=t.isMaybeSingle)!==null&&i!==void 0?i:!1,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=OP.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,e){return this.headers=new Headers(this.headers),this.headers.set(t,e),this}then(t,e){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");let i=this.fetch,r=i(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(o=>b(this,null,function*(){var s,a,c,f;let h=null,m=null,y=null,g=o.status,w=o.statusText;if(o.ok){if(this.method!=="HEAD"){let X=yield o.text();X===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((s=this.headers.get("Accept"))===null||s===void 0)&&s.includes("application/vnd.pgrst.plan+text"))?m=X:m=JSON.parse(X))}let x=(a=this.headers.get("Prefer"))===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),M=(c=o.headers.get("content-range"))===null||c===void 0?void 0:c.split("/");x&&M&&M.length>1&&(y=parseInt(M[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(m)&&(m.length>1?(h={code:"PGRST116",details:`Results contain ${m.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},m=null,y=null,g=406,w="Not Acceptable"):m.length===1?m=m[0]:m=null)}else{let x=yield o.text();try{h=JSON.parse(x),Array.isArray(h)&&o.status===404&&(m=[],h=null,g=200,w="OK")}catch{o.status===404&&x===""?(g=204,w="No Content"):h={message:x}}if(h&&this.isMaybeSingle&&(!((f=h?.details)===null||f===void 0)&&f.includes("0 rows"))&&(h=null,g=200,w="OK"),h&&this.shouldThrowOnError)throw new NP.default(h)}return{error:h,data:m,count:y,status:g,statusText:w}}));return this.shouldThrowOnError||(r=r.catch(o=>{var s,a,c;return{error:{message:`${(s=o?.name)!==null&&s!==void 0?s:"FetchError"}: ${o?.message}`,details:`${(a=o?.stack)!==null&&a!==void 0?a:""}`,hint:"",code:`${(c=o?.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),r.then(t,e)}returns(){return this}overrideTypes(){return this}};fv.default=dv});var gv=Ar(mv=>{"use strict";Object.defineProperty(mv,"__esModule",{value:!0});var PP=(ke(),Rr(kr)),kP=PP.__importDefault(pv()),hv=class extends kP.default{select(t){let e=!1,i=(t??"*").split("").map(r=>/\s/.test(r)&&!e?"":(r==='"'&&(e=!e),r)).join("");return this.url.searchParams.set("select",i),this.headers.append("Prefer","return=representation"),this}order(t,{ascending:e=!0,nullsFirst:i,foreignTable:r,referencedTable:o=r}={}){let s=o?`${o}.order`:"order",a=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${a?`${a},`:""}${t}.${e?"asc":"desc"}${i===void 0?"":i?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:e,referencedTable:i=e}={}){let r=typeof i>"u"?"limit":`${i}.limit`;return this.url.searchParams.set(r,`${t}`),this}range(t,e,{foreignTable:i,referencedTable:r=i}={}){let o=typeof r>"u"?"offset":`${r}.offset`,s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(o,`${t}`),this.url.searchParams.set(s,`${e-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:t=!1,verbose:e=!1,settings:i=!1,buffers:r=!1,wal:o=!1,format:s="text"}={}){var a;let c=[t?"analyze":null,e?"verbose":null,i?"settings":null,r?"buffers":null,o?"wal":null].filter(Boolean).join("|"),f=(a=this.headers.get("Accept"))!==null&&a!==void 0?a:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${s}; for="${f}"; options=${c};`),s==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(t){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${t}`),this}};mv.default=hv});var wf=Ar(_v=>{"use strict";Object.defineProperty(_v,"__esModule",{value:!0});var FP=(ke(),Rr(kr)),LP=FP.__importDefault(gv()),jP=new RegExp("[,()]"),vv=class extends LP.default{eq(t,e){return this.url.searchParams.append(t,`eq.${e}`),this}neq(t,e){return this.url.searchParams.append(t,`neq.${e}`),this}gt(t,e){return this.url.searchParams.append(t,`gt.${e}`),this}gte(t,e){return this.url.searchParams.append(t,`gte.${e}`),this}lt(t,e){return this.url.searchParams.append(t,`lt.${e}`),this}lte(t,e){return this.url.searchParams.append(t,`lte.${e}`),this}like(t,e){return this.url.searchParams.append(t,`like.${e}`),this}likeAllOf(t,e){return this.url.searchParams.append(t,`like(all).{${e.join(",")}}`),this}likeAnyOf(t,e){return this.url.searchParams.append(t,`like(any).{${e.join(",")}}`),this}ilike(t,e){return this.url.searchParams.append(t,`ilike.${e}`),this}ilikeAllOf(t,e){return this.url.searchParams.append(t,`ilike(all).{${e.join(",")}}`),this}ilikeAnyOf(t,e){return this.url.searchParams.append(t,`ilike(any).{${e.join(",")}}`),this}is(t,e){return this.url.searchParams.append(t,`is.${e}`),this}in(t,e){let i=Array.from(new Set(e)).map(r=>typeof r=="string"&&jP.test(r)?`"${r}"`:`${r}`).join(",");return this.url.searchParams.append(t,`in.(${i})`),this}contains(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cs.{${e.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(e)}`),this}containedBy(t,e){return typeof e=="string"?this.url.searchParams.append(t,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(t,`cd.{${e.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(e)}`),this}rangeGt(t,e){return this.url.searchParams.append(t,`sr.${e}`),this}rangeGte(t,e){return this.url.searchParams.append(t,`nxl.${e}`),this}rangeLt(t,e){return this.url.searchParams.append(t,`sl.${e}`),this}rangeLte(t,e){return this.url.searchParams.append(t,`nxr.${e}`),this}rangeAdjacent(t,e){return this.url.searchParams.append(t,`adj.${e}`),this}overlaps(t,e){return typeof e=="string"?this.url.searchParams.append(t,`ov.${e}`):this.url.searchParams.append(t,`ov.{${e.join(",")}}`),this}textSearch(t,e,{config:i,type:r}={}){let o="";r==="plain"?o="pl":r==="phrase"?o="ph":r==="websearch"&&(o="w");let s=i===void 0?"":`(${i})`;return this.url.searchParams.append(t,`${o}fts${s}.${e}`),this}match(t){return Object.entries(t).forEach(([e,i])=>{this.url.searchParams.append(e,`eq.${i}`)}),this}not(t,e,i){return this.url.searchParams.append(t,`not.${e}.${i}`),this}or(t,{foreignTable:e,referencedTable:i=e}={}){let r=i?`${i}.or`:"or";return this.url.searchParams.append(r,`(${t})`),this}filter(t,e,i){return this.url.searchParams.append(t,`${e}.${i}`),this}};_v.default=vv});var wv=Ar(bv=>{"use strict";Object.defineProperty(bv,"__esModule",{value:!0});var VP=(ke(),Rr(kr)),Ul=VP.__importDefault(wf()),yv=class{constructor(t,{headers:e={},schema:i,fetch:r}){this.url=t,this.headers=new Headers(e),this.schema=i,this.fetch=r}select(t,e){let{head:i=!1,count:r}=e??{},o=i?"HEAD":"GET",s=!1,a=(t??"*").split("").map(c=>/\s/.test(c)&&!s?"":(c==='"'&&(s=!s),c)).join("");return this.url.searchParams.set("select",a),r&&this.headers.append("Prefer",`count=${r}`),new Ul.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(t,{count:e,defaultToNull:i=!0}={}){var r;let o="POST";if(e&&this.headers.append("Prefer",`count=${e}`),i||this.headers.append("Prefer","missing=default"),Array.isArray(t)){let s=t.reduce((a,c)=>a.concat(Object.keys(c)),[]);if(s.length>0){let a=[...new Set(s)].map(c=>`"${c}"`);this.url.searchParams.set("columns",a.join(","))}}return new Ul.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(r=this.fetch)!==null&&r!==void 0?r:fetch})}upsert(t,{onConflict:e,ignoreDuplicates:i=!1,count:r,defaultToNull:o=!0}={}){var s;let a="POST";if(this.headers.append("Prefer",`resolution=${i?"ignore":"merge"}-duplicates`),e!==void 0&&this.url.searchParams.set("on_conflict",e),r&&this.headers.append("Prefer",`count=${r}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(t)){let c=t.reduce((f,h)=>f.concat(Object.keys(h)),[]);if(c.length>0){let f=[...new Set(c)].map(h=>`"${h}"`);this.url.searchParams.set("columns",f.join(","))}}return new Ul.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}update(t,{count:e}={}){var i;let r="PATCH";return e&&this.headers.append("Prefer",`count=${e}`),new Ul.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}delete({count:t}={}){var e;let i="DELETE";return t&&this.headers.append("Prefer",`count=${t}`),new Ul.default({method:i,url:this.url,headers:this.headers,schema:this.schema,fetch:(e=this.fetch)!==null&&e!==void 0?e:fetch})}};bv.default=yv});var eS=Ar(Cv=>{"use strict";Object.defineProperty(Cv,"__esModule",{value:!0});var X1=(ke(),Rr(kr)),zP=X1.__importDefault(wv()),UP=X1.__importDefault(wf()),Ev=class n{constructor(t,{headers:e={},schema:i,fetch:r}={}){this.url=t,this.headers=new Headers(e),this.schemaName=i,this.fetch=r}from(t){let e=new URL(`${this.url}/${t}`);return new zP.default(e,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new n(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,e={},{head:i=!1,get:r=!1,count:o}={}){var s;let a,c=new URL(`${this.url}/rpc/${t}`),f;i||r?(a=i?"HEAD":"GET",Object.entries(e).filter(([m,y])=>y!==void 0).map(([m,y])=>[m,Array.isArray(y)?`{${y.join(",")}}`:`${y}`]).forEach(([m,y])=>{c.searchParams.append(m,y)})):(a="POST",f=e);let h=new Headers(this.headers);return o&&h.set("Prefer",`count=${o}`),new UP.default({method:a,url:c,headers:h,schema:this.schemaName,body:f,fetch:(s=this.fetch)!==null&&s!==void 0?s:fetch})}};Cv.default=Ev});var aS=Ar(Xt=>{"use strict";Object.defineProperty(Xt,"__esModule",{value:!0});Xt.PostgrestError=Xt.PostgrestBuilder=Xt.PostgrestTransformBuilder=Xt.PostgrestFilterBuilder=Xt.PostgrestQueryBuilder=Xt.PostgrestClient=void 0;var Ls=(ke(),Rr(kr)),tS=Ls.__importDefault(eS());Xt.PostgrestClient=tS.default;var nS=Ls.__importDefault(wv());Xt.PostgrestQueryBuilder=nS.default;var iS=Ls.__importDefault(wf());Xt.PostgrestFilterBuilder=iS.default;var rS=Ls.__importDefault(gv());Xt.PostgrestTransformBuilder=rS.default;var oS=Ls.__importDefault(pv());Xt.PostgrestBuilder=oS.default;var sS=Ls.__importDefault(uv());Xt.PostgrestError=sS.default;Xt.default={PostgrestClient:tS.default,PostgrestQueryBuilder:nS.default,PostgrestFilterBuilder:iS.default,PostgrestTransformBuilder:rS.default,PostgrestBuilder:oS.default,PostgrestError:sS.default}});var wp;function rc(){return wp}function ei(n){let t=wp;return wp=n,t}var Jv=Symbol("NotFound");function Ro(n){return n===Jv||n?.name==="\u0275NotFound"}var Ot=null,oc=!1,Ep=1,Ex=null,Nt=Symbol("SIGNAL");function oe(n){let t=Ot;return Ot=n,t}function cc(){return Ot}var Oo={version:0,lastCleanEpoch:0,dirty:!1,producers:void 0,producersTail:void 0,consumers:void 0,consumersTail:void 0,recomputing:!1,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,kind:"unknown",producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{}};function No(n){if(oc)throw new Error("");if(Ot===null)return;Ot.consumerOnSignalRead(n);let t=Ot.producersTail;if(t!==void 0&&t.producer===n)return;let e,i=Ot.recomputing;if(i&&(e=t!==void 0?t.nextProducer:Ot.producers,e!==void 0&&e.producer===n)){Ot.producersTail=e,e.lastReadVersion=n.version;return}let r=n.consumersTail;if(r!==void 0&&r.consumer===Ot&&(!i||Sx(r,Ot)))return;let o=ko(Ot),s={producer:n,consumer:Ot,nextProducer:e,prevConsumer:r,lastReadVersion:n.version,nextConsumer:void 0};Ot.producersTail=s,t!==void 0?t.nextProducer=s:Ot.producers=s,o&&t_(n,s)}function Qv(){Ep++}function uc(n){if(!(ko(n)&&!n.dirty)&&!(!n.dirty&&n.lastCleanEpoch===Ep)){if(!n.producerMustRecompute(n)&&!na(n)){lc(n);return}n.producerRecomputeValue(n),lc(n)}}function Cp(n){if(n.consumers===void 0)return;let t=oc;oc=!0;try{for(let e=n.consumers;e!==void 0;e=e.nextConsumer){let i=e.consumer;i.dirty||Cx(i)}}finally{oc=t}}function Sp(){return Ot?.consumerAllowSignalWrites!==!1}function Cx(n){n.dirty=!0,Cp(n),n.consumerMarkedDirty?.(n)}function lc(n){n.dirty=!1,n.lastCleanEpoch=Ep}function Po(n){return n&&Xv(n),oe(n)}function Xv(n){n.producersTail=void 0,n.recomputing=!0}function ta(n,t){oe(t),n&&e_(n)}function e_(n){n.recomputing=!1;let t=n.producersTail,e=t!==void 0?t.nextProducer:n.producers;if(e!==void 0){if(ko(n))do e=xp(e);while(e!==void 0);t!==void 0?t.nextProducer=void 0:n.producers=void 0}}function na(n){for(let t=n.producers;t!==void 0;t=t.nextProducer){let e=t.producer,i=t.lastReadVersion;if(i!==e.version||(uc(e),i!==e.version))return!0}return!1}function ia(n){if(ko(n)){let t=n.producers;for(;t!==void 0;)t=xp(t)}n.producers=void 0,n.producersTail=void 0,n.consumers=void 0,n.consumersTail=void 0}function t_(n,t){let e=n.consumersTail,i=ko(n);if(e!==void 0?(t.nextConsumer=e.nextConsumer,e.nextConsumer=t):(t.nextConsumer=void 0,n.consumers=t),t.prevConsumer=e,n.consumersTail=t,!i)for(let r=n.producers;r!==void 0;r=r.nextProducer)t_(r.producer,r)}function xp(n){let t=n.producer,e=n.nextProducer,i=n.nextConsumer,r=n.prevConsumer;if(n.nextConsumer=void 0,n.prevConsumer=void 0,i!==void 0?i.prevConsumer=r:t.consumersTail=r,r!==void 0)r.nextConsumer=i;else if(t.consumers=i,!ko(t)){let o=t.producers;for(;o!==void 0;)o=xp(o)}return e}function ko(n){return n.consumerIsAlwaysLive||n.consumers!==void 0}function dc(n){Ex?.(n)}function Sx(n,t){let e=t.producersTail;if(e!==void 0){let i=t.producers;do{if(i===n)return!0;if(i===e)break;i=i.nextProducer}while(i!==void 0)}return!1}function fc(n,t){return Object.is(n,t)}function pc(n,t){let e=Object.create(xx);e.computation=n,t!==void 0&&(e.equal=t);let i=()=>{if(uc(e),No(e),e.value===ea)throw e.error;return e.value};return i[Nt]=e,dc(e),i}var sc=Symbol("UNSET"),ac=Symbol("COMPUTING"),ea=Symbol("ERRORED"),xx=Y(P({},Oo),{value:sc,dirty:!0,error:null,equal:fc,kind:"computed",producerMustRecompute(n){return n.value===sc||n.value===ac},producerRecomputeValue(n){if(n.value===ac)throw new Error("");let t=n.value;n.value=ac;let e=Po(n),i,r=!1;try{i=n.computation(),oe(null),r=t!==sc&&t!==ea&&i!==ea&&n.equal(t,i)}catch(o){i=ea,n.error=o}finally{ta(n,e)}if(r){n.value=t;return}n.value=i,n.version++}});function Dx(){throw new Error}var n_=Dx;function i_(n){n_(n)}function Dp(n){n_=n}var Ix=null;function Ip(n,t){let e=Object.create(hc);e.value=n,t!==void 0&&(e.equal=t);let i=()=>r_(e);return i[Nt]=e,dc(e),[i,s=>Fo(e,s),s=>Tp(e,s)]}function r_(n){return No(n),n.value}function Fo(n,t){Sp()||i_(n),n.equal(n.value,t)||(n.value=t,Tx(n))}function Tp(n,t){Sp()||i_(n),Fo(n,t(n.value))}var hc=Y(P({},Oo),{equal:fc,value:void 0,kind:"signal"});function Tx(n){n.version++,Qv(),Cp(n),Ix?.(n)}function ae(n){return typeof n=="function"}function Lo(n){let e=n(i=>{Error.call(i),i.stack=new Error().stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}var mc=Lo(n=>function(e){n(this),this.message=e?`${e.length} errors occurred during unsubscription:
${e.map((i,r)=>`${r+1}) ${i.toString()}`).join(`
  `)}`:"",this.name="UnsubscriptionError",this.errors=e});function Or(n,t){if(n){let e=n.indexOf(t);0<=e&&n.splice(e,1)}}var He=class n{constructor(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let t;if(!this.closed){this.closed=!0;let{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(let o of e)o.remove(this);else e.remove(this);let{initialTeardown:i}=this;if(ae(i))try{i()}catch(o){t=o instanceof mc?o.errors:[o]}let{_finalizers:r}=this;if(r){this._finalizers=null;for(let o of r)try{o_(o)}catch(s){t=t??[],s instanceof mc?t=[...t,...s.errors]:t.push(s)}}if(t)throw new mc(t)}}add(t){var e;if(t&&t!==this)if(this.closed)o_(t);else{if(t instanceof n){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=(e=this._finalizers)!==null&&e!==void 0?e:[]).push(t)}}_hasParent(t){let{_parentage:e}=this;return e===t||Array.isArray(e)&&e.includes(t)}_addParent(t){let{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(t),e):e?[e,t]:t}_removeParent(t){let{_parentage:e}=this;e===t?this._parentage=null:Array.isArray(e)&&Or(e,t)}remove(t){let{_finalizers:e}=this;e&&Or(e,t),t instanceof n&&t._removeParent(this)}};He.EMPTY=(()=>{let n=new He;return n.closed=!0,n})();var Mp=He.EMPTY;function gc(n){return n instanceof He||n&&"closed"in n&&ae(n.remove)&&ae(n.add)&&ae(n.unsubscribe)}function o_(n){ae(n)?n():n.unsubscribe()}var jn={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1};var jo={setTimeout(n,t,...e){let{delegate:i}=jo;return i?.setTimeout?i.setTimeout(n,t,...e):setTimeout(n,t,...e)},clearTimeout(n){let{delegate:t}=jo;return(t?.clearTimeout||clearTimeout)(n)},delegate:void 0};function vc(n){jo.setTimeout(()=>{let{onUnhandledError:t}=jn;if(t)t(n);else throw n})}function ra(){}var s_=Ap("C",void 0,void 0);function a_(n){return Ap("E",void 0,n)}function l_(n){return Ap("N",n,void 0)}function Ap(n,t,e){return{kind:n,value:t,error:e}}var Nr=null;function Vo(n){if(jn.useDeprecatedSynchronousErrorHandling){let t=!Nr;if(t&&(Nr={errorThrown:!1,error:null}),n(),t){let{errorThrown:e,error:i}=Nr;if(Nr=null,e)throw i}}else n()}function c_(n){jn.useDeprecatedSynchronousErrorHandling&&Nr&&(Nr.errorThrown=!0,Nr.error=n)}var Pr=class extends He{constructor(t){super(),this.isStopped=!1,t?(this.destination=t,gc(t)&&t.add(this)):this.destination=Rx}static create(t,e,i){return new Qi(t,e,i)}next(t){this.isStopped?Op(l_(t),this):this._next(t)}error(t){this.isStopped?Op(a_(t),this):(this.isStopped=!0,this._error(t))}complete(){this.isStopped?Op(s_,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(t){this.destination.next(t)}_error(t){try{this.destination.error(t)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}},Mx=Function.prototype.bind;function Rp(n,t){return Mx.call(n,t)}var Np=class{constructor(t){this.partialObserver=t}next(t){let{partialObserver:e}=this;if(e.next)try{e.next(t)}catch(i){_c(i)}}error(t){let{partialObserver:e}=this;if(e.error)try{e.error(t)}catch(i){_c(i)}else _c(t)}complete(){let{partialObserver:t}=this;if(t.complete)try{t.complete()}catch(e){_c(e)}}},Qi=class extends Pr{constructor(t,e,i){super();let r;if(ae(t)||!t)r={next:t??void 0,error:e??void 0,complete:i??void 0};else{let o;this&&jn.useDeprecatedNextContext?(o=Object.create(t),o.unsubscribe=()=>this.unsubscribe(),r={next:t.next&&Rp(t.next,o),error:t.error&&Rp(t.error,o),complete:t.complete&&Rp(t.complete,o)}):r=t}this.destination=new Np(r)}};function _c(n){jn.useDeprecatedSynchronousErrorHandling?c_(n):vc(n)}function Ax(n){throw n}function Op(n,t){let{onStoppedNotification:e}=jn;e&&jo.setTimeout(()=>e(n,t))}var Rx={closed:!0,next:ra,error:Ax,complete:ra};var zo=typeof Symbol=="function"&&Symbol.observable||"@@observable";function Ht(n){return n}function Pp(...n){return kp(n)}function kp(n){return n.length===0?Ht:n.length===1?n[0]:function(e){return n.reduce((i,r)=>r(i),e)}}var me=(()=>{class n{constructor(e){e&&(this._subscribe=e)}lift(e){let i=new n;return i.source=this,i.operator=e,i}subscribe(e,i,r){let o=Nx(e)?e:new Qi(e,i,r);return Vo(()=>{let{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return i=u_(i),new i((r,o)=>{let s=new Qi({next:a=>{try{e(a)}catch(c){o(c),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(e){var i;return(i=this.source)===null||i===void 0?void 0:i.subscribe(e)}[zo](){return this}pipe(...e){return kp(e)(this)}toPromise(e){return e=u_(e),new e((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return n.create=t=>new n(t),n})();function u_(n){var t;return(t=n??jn.Promise)!==null&&t!==void 0?t:Promise}function Ox(n){return n&&ae(n.next)&&ae(n.error)&&ae(n.complete)}function Nx(n){return n&&n instanceof Pr||Ox(n)&&gc(n)}function Fp(n){return ae(n?.lift)}function pe(n){return t=>{if(Fp(t))return t.lift(function(e){try{return n(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function ue(n,t,e,i,r){return new Lp(n,t,e,i,r)}var Lp=class extends Pr{constructor(t,e,i,r,o,s){super(t),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=e?function(a){try{e(a)}catch(c){t.error(c)}}:super._next,this._error=r?function(a){try{r(a)}catch(c){t.error(c)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){t.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){let{closed:e}=this;super.unsubscribe(),!e&&((t=this.onFinalize)===null||t===void 0||t.call(this))}}};function Uo(){return pe((n,t)=>{let e=null;n._refCount++;let i=ue(t,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount){e=null;return}let r=n._connection,o=e;e=null,r&&(!o||r===o)&&r.unsubscribe(),t.unsubscribe()});n.subscribe(i),i.closed||(e=n.connect())})}var Bo=class extends me{constructor(t,e){super(),this.source=t,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,Fp(t)&&(this.lift=t.lift)}_subscribe(t){return this.getSubject().subscribe(t)}getSubject(){let t=this._subject;return(!t||t.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;let{_connection:t}=this;this._subject=this._connection=null,t?.unsubscribe()}connect(){let t=this._connection;if(!t){t=this._connection=new He;let e=this.getSubject();t.add(this.source.subscribe(ue(e,void 0,()=>{this._teardown(),e.complete()},i=>{this._teardown(),e.error(i)},()=>this._teardown()))),t.closed&&(this._connection=null,t=He.EMPTY)}return t}refCount(){return Uo()(this)}};var d_=Lo(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Le=(()=>{class n extends me{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){let i=new yc(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new d_}next(e){Vo(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(let i of this.currentObservers)i.next(e)}})}error(e){Vo(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;let{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){Vo(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;let{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return((e=this.observers)===null||e===void 0?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){let{hasError:i,isStopped:r,observers:o}=this;return i||r?Mp:(this.currentObservers=null,o.push(e),new He(()=>{this.currentObservers=null,Or(o,e)}))}_checkFinalizedStatuses(e){let{hasError:i,thrownError:r,isStopped:o}=this;i?e.error(r):o&&e.complete()}asObservable(){let e=new me;return e.source=this,e}}return n.create=(t,e)=>new yc(t,e),n})(),yc=class extends Le{constructor(t,e){super(),this.destination=t,this.source=e}next(t){var e,i;(i=(e=this.destination)===null||e===void 0?void 0:e.next)===null||i===void 0||i.call(e,t)}error(t){var e,i;(i=(e=this.destination)===null||e===void 0?void 0:e.error)===null||i===void 0||i.call(e,t)}complete(){var t,e;(e=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||e===void 0||e.call(t)}_subscribe(t){var e,i;return(i=(e=this.source)===null||e===void 0?void 0:e.subscribe(t))!==null&&i!==void 0?i:Mp}};var Ke=class extends Le{constructor(t){super(),this._value=t}get value(){return this.getValue()}_subscribe(t){let e=super._subscribe(t);return!e.closed&&t.next(this._value),e}getValue(){let{hasError:t,thrownError:e,_value:i}=this;if(t)throw e;return this._throwIfClosed(),i}next(t){super.next(this._value=t)}};var jp={now(){return(jp.delegate||Date).now()},delegate:void 0};var bc=class extends He{constructor(t,e){super()}schedule(t,e=0){return this}};var oa={setInterval(n,t,...e){let{delegate:i}=oa;return i?.setInterval?i.setInterval(n,t,...e):setInterval(n,t,...e)},clearInterval(n){let{delegate:t}=oa;return(t?.clearInterval||clearInterval)(n)},delegate:void 0};var wc=class extends bc{constructor(t,e){super(t,e),this.scheduler=t,this.work=e,this.pending=!1}schedule(t,e=0){var i;if(this.closed)return this;this.state=t;let r=this.id,o=this.scheduler;return r!=null&&(this.id=this.recycleAsyncId(o,r,e)),this.pending=!0,this.delay=e,this.id=(i=this.id)!==null&&i!==void 0?i:this.requestAsyncId(o,this.id,e),this}requestAsyncId(t,e,i=0){return oa.setInterval(t.flush.bind(t,this),i)}recycleAsyncId(t,e,i=0){if(i!=null&&this.delay===i&&this.pending===!1)return e;e!=null&&oa.clearInterval(e)}execute(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;let i=this._execute(t,e);if(i)return i;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(t,e){let i=!1,r;try{this.work(t)}catch(o){i=!0,r=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){let{id:t,scheduler:e}=this,{actions:i}=e;this.work=this.state=this.scheduler=null,this.pending=!1,Or(i,this),t!=null&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null,super.unsubscribe()}}};var $o=class n{constructor(t,e=n.now){this.schedulerActionCtor=t,this.now=e}schedule(t,e=0,i){return new this.schedulerActionCtor(this,t).schedule(i,e)}};$o.now=jp.now;var Ec=class extends $o{constructor(t,e=$o.now){super(t,e),this.actions=[],this._active=!1}flush(t){let{actions:e}=this;if(this._active){e.push(t);return}let i;this._active=!0;do if(i=t.execute(t.state,t.delay))break;while(t=e.shift());if(this._active=!1,i){for(;t=e.shift();)t.unsubscribe();throw i}}};var f_=new Ec(wc);var Dt=new me(n=>n.complete());function p_(n){return n&&ae(n.schedule)}function h_(n){return n[n.length-1]}function Cc(n){return ae(h_(n))?n.pop():void 0}function Xi(n){return p_(h_(n))?n.pop():void 0}ke();var Mc=n=>n&&typeof n.length=="number"&&typeof n!="function";function Ac(n){return ae(n?.then)}function Rc(n){return ae(n[zo])}function Oc(n){return Symbol.asyncIterator&&ae(n?.[Symbol.asyncIterator])}function Nc(n){return new TypeError(`You provided ${n!==null&&typeof n=="object"?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}function Lx(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Pc=Lx();function kc(n){return ae(n?.[Pc])}ke();function Fc(n){return Ic(this,arguments,function*(){let e=n.getReader();try{for(;;){let{value:i,done:r}=yield ti(e.read());if(r)return yield ti(void 0);yield yield ti(i)}}finally{e.releaseLock()}})}function Lc(n){return ae(n?.getReader)}function et(n){if(n instanceof me)return n;if(n!=null){if(Rc(n))return jx(n);if(Mc(n))return Vx(n);if(Ac(n))return zx(n);if(Oc(n))return j_(n);if(kc(n))return Ux(n);if(Lc(n))return Bx(n)}throw Nc(n)}function jx(n){return new me(t=>{let e=n[zo]();if(ae(e.subscribe))return e.subscribe(t);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function Vx(n){return new me(t=>{for(let e=0;e<n.length&&!t.closed;e++)t.next(n[e]);t.complete()})}function zx(n){return new me(t=>{n.then(e=>{t.closed||(t.next(e),t.complete())},e=>t.error(e)).then(null,vc)})}function Ux(n){return new me(t=>{for(let e of n)if(t.next(e),t.closed)return;t.complete()})}function j_(n){return new me(t=>{$x(n,t).catch(e=>t.error(e))})}function Bx(n){return j_(Fc(n))}function $x(n,t){var e,i,r,o;return z(this,void 0,void 0,function*(){try{for(e=Tc(n);i=yield e.next(),!i.done;){let s=i.value;if(t.next(s),t.closed)return}}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=e.return)&&(yield o.call(e))}finally{if(r)throw r.error}}t.complete()})}function tn(n,t,e,i=0,r=!1){let o=t.schedule(function(){e(),r?n.add(this.schedule(null,i)):this.unsubscribe()},i);if(n.add(o),!r)return o}function jc(n,t=0){return pe((e,i)=>{e.subscribe(ue(i,r=>tn(i,n,()=>i.next(r),t),()=>tn(i,n,()=>i.complete(),t),r=>tn(i,n,()=>i.error(r),t)))})}function Vc(n,t=0){return pe((e,i)=>{i.add(n.schedule(()=>e.subscribe(i),t))})}function V_(n,t){return et(n).pipe(Vc(t),jc(t))}function z_(n,t){return et(n).pipe(Vc(t),jc(t))}function U_(n,t){return new me(e=>{let i=0;return t.schedule(function(){i===n.length?e.complete():(e.next(n[i++]),e.closed||this.schedule())})})}function B_(n,t){return new me(e=>{let i;return tn(e,t,()=>{i=n[Pc](),tn(e,t,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){e.error(s);return}o?e.complete():e.next(r)},0,!0)}),()=>ae(i?.return)&&i.return()})}function zc(n,t){if(!n)throw new Error("Iterable cannot be null");return new me(e=>{tn(e,t,()=>{let i=n[Symbol.asyncIterator]();tn(e,t,()=>{i.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}function $_(n,t){return zc(Fc(n),t)}function H_(n,t){if(n!=null){if(Rc(n))return V_(n,t);if(Mc(n))return U_(n,t);if(Ac(n))return z_(n,t);if(Oc(n))return zc(n,t);if(kc(n))return B_(n,t);if(Lc(n))return $_(n,t)}throw Nc(n)}function B(n,t){return t?H_(n,t):et(n)}function H(...n){let t=Xi(n);return B(n,t)}function Ho(n,t){let e=ae(n)?n:()=>n,i=r=>r.error(e());return new me(t?r=>t.schedule(i,0,r):i)}function Bp(n){return!!n&&(n instanceof me||ae(n.lift)&&ae(n.subscribe))}var ln=Lo(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function $p(n,t){let e=typeof t=="object";return new Promise((i,r)=>{let o=!1,s;n.subscribe({next:a=>{s=a,o=!0},error:r,complete:()=>{o?i(s):e?i(t.defaultValue):r(new ln)}})})}function er(n,t){let e=typeof t=="object";return new Promise((i,r)=>{let o=new Qi({next:s=>{i(s),o.unsubscribe()},error:r,complete:()=>{e?i(t.defaultValue):r(new ln)}});n.subscribe(o)})}function le(n,t){return pe((e,i)=>{let r=0;e.subscribe(ue(i,o=>{i.next(n.call(t,o,r++))}))})}var{isArray:Hx}=Array;function Wx(n,t){return Hx(t)?n(...t):n(t)}function Uc(n){return le(t=>Wx(n,t))}var{isArray:Gx}=Array,{getPrototypeOf:qx,prototype:Kx,keys:Yx}=Object;function Bc(n){if(n.length===1){let t=n[0];if(Gx(t))return{args:t,keys:null};if(Zx(t)){let e=Yx(t);return{args:e.map(i=>t[i]),keys:e}}}return{args:n,keys:null}}function Zx(n){return n&&typeof n=="object"&&qx(n)===Kx}function $c(n,t){return n.reduce((e,i,r)=>(e[i]=t[r],e),{})}function sa(...n){let t=Xi(n),e=Cc(n),{args:i,keys:r}=Bc(n);if(i.length===0)return B([],t);let o=new me(Jx(i,t,r?s=>$c(r,s):Ht));return e?o.pipe(Uc(e)):o}function Jx(n,t,e=Ht){return i=>{W_(t,()=>{let{length:r}=n,o=new Array(r),s=r,a=r;for(let c=0;c<r;c++)W_(t,()=>{let f=B(n[c],t),h=!1;f.subscribe(ue(i,m=>{o[c]=m,h||(h=!0,a--),a||i.next(e(o.slice()))},()=>{--s||i.complete()}))},i)},i)}}function W_(n,t,e){n?tn(e,n,t):t()}function G_(n,t,e,i,r,o,s,a){let c=[],f=0,h=0,m=!1,y=()=>{m&&!c.length&&!f&&t.complete()},g=T=>f<i?w(T):c.push(T),w=T=>{o&&t.next(T),f++;let x=!1;et(e(T,h++)).subscribe(ue(t,M=>{r?.(M),o?g(M):t.next(M)},()=>{x=!0},void 0,()=>{if(x)try{for(f--;c.length&&f<i;){let M=c.shift();s?tn(t,s,()=>w(M)):w(M)}y()}catch(M){t.error(M)}}))};return n.subscribe(ue(t,g,()=>{m=!0,y()})),()=>{a?.()}}function Ye(n,t,e=1/0){return ae(t)?Ye((i,r)=>le((o,s)=>t(i,o,r,s))(et(n(i,r))),e):(typeof t=="number"&&(e=t),pe((i,r)=>G_(i,r,n,e)))}function tr(n=1/0){return Ye(Ht,n)}function q_(){return tr(1)}function Wo(...n){return q_()(B(n,Xi(n)))}function aa(n){return new me(t=>{et(n()).subscribe(t)})}function Hp(...n){let t=Cc(n),{args:e,keys:i}=Bc(n),r=new me(o=>{let{length:s}=e;if(!s){o.complete();return}let a=new Array(s),c=s,f=s;for(let h=0;h<s;h++){let m=!1;et(e[h]).subscribe(ue(o,y=>{m||(m=!0,f--),a[h]=y},()=>c--,void 0,()=>{(!c||!m)&&(f||o.next(i?$c(i,a):a),o.complete())}))}});return t?r.pipe(Uc(t)):r}function rt(n,t){return pe((e,i)=>{let r=0;e.subscribe(ue(i,o=>n.call(t,o,r++)&&i.next(o)))})}function Di(n){return pe((t,e)=>{let i=null,r=!1,o;i=t.subscribe(ue(e,void 0,void 0,s=>{o=et(n(s,Di(n)(t))),i?(i.unsubscribe(),i=null,o.subscribe(e)):r=!0})),r&&(i.unsubscribe(),i=null,o.subscribe(e))})}function K_(n,t,e,i,r){return(o,s)=>{let a=e,c=t,f=0;o.subscribe(ue(s,h=>{let m=f++;c=a?n(c,h,m):(a=!0,h),i&&s.next(c)},r&&(()=>{a&&s.next(c),s.complete()})))}}function ni(n,t){return ae(t)?Ye(n,t,1):Ye(n,1)}function Wp(n,t=f_){return pe((e,i)=>{let r=null,o=null,s=null,a=()=>{if(r){r.unsubscribe(),r=null;let f=o;o=null,i.next(f)}};function c(){let f=s+n,h=t.now();if(h<f){r=this.schedule(void 0,f-h),i.add(r);return}a()}e.subscribe(ue(i,f=>{o=f,s=t.now(),r||(r=t.schedule(c,n),i.add(r))},()=>{a(),i.complete()},void 0,()=>{o=r=null}))})}function nr(n){return pe((t,e)=>{let i=!1;t.subscribe(ue(e,r=>{i=!0,e.next(r)},()=>{i||e.next(n),e.complete()}))})}function Pt(n){return n<=0?()=>Dt:pe((t,e)=>{let i=0;t.subscribe(ue(e,r=>{++i<=n&&(e.next(r),n<=i&&e.complete())}))})}function Gp(n,t=Ht){return n=n??Qx,pe((e,i)=>{let r,o=!0;e.subscribe(ue(i,s=>{let a=t(s);(o||!n(r,a))&&(o=!1,r=a,i.next(s))}))})}function Qx(n,t){return n===t}function Hc(n=Xx){return pe((t,e)=>{let i=!1;t.subscribe(ue(e,r=>{i=!0,e.next(r)},()=>i?e.complete():e.error(n())))})}function Xx(){return new ln}function Fr(n){return pe((t,e)=>{try{t.subscribe(e)}finally{e.add(n)}})}function Ii(n,t){let e=arguments.length>=2;return i=>i.pipe(n?rt((r,o)=>n(r,o,i)):Ht,Pt(1),e?nr(t):Hc(()=>new ln))}function Go(n){return n<=0?()=>Dt:pe((t,e)=>{let i=[];t.subscribe(ue(e,r=>{i.push(r),n<i.length&&i.shift()},()=>{for(let r of i)e.next(r);e.complete()},void 0,()=>{i=null}))})}function qp(n,t){let e=arguments.length>=2;return i=>i.pipe(n?rt((r,o)=>n(r,o,i)):Ht,Go(1),e?nr(t):Hc(()=>new ln))}function Kp(n,t){return pe(K_(n,t,arguments.length>=2,!0))}function Yp(...n){let t=Xi(n);return pe((e,i)=>{(t?Wo(n,e,t):Wo(n,e)).subscribe(i)})}function je(n,t){return pe((e,i)=>{let r=null,o=0,s=!1,a=()=>s&&!r&&i.complete();e.subscribe(ue(i,c=>{r?.unsubscribe();let f=0,h=o++;et(n(c,h)).subscribe(r=ue(i,m=>i.next(t?t(c,m,h,f++):m),()=>{r=null,a()}))},()=>{s=!0,a()}))})}function Vn(n){return pe((t,e)=>{et(n).subscribe(ue(e,()=>e.complete(),ra)),!e.closed&&t.subscribe(e)})}function ft(n,t,e){let i=ae(n)||t||e?{next:n,error:t,complete:e}:n;return i?pe((r,o)=>{var s;(s=i.subscribe)===null||s===void 0||s.call(i);let a=!0;r.subscribe(ue(o,c=>{var f;(f=i.next)===null||f===void 0||f.call(i,c),o.next(c)},()=>{var c;a=!1,(c=i.complete)===null||c===void 0||c.call(i),o.complete()},c=>{var f;a=!1,(f=i.error)===null||f===void 0||f.call(i,c),o.error(c)},()=>{var c,f;a&&((c=i.unsubscribe)===null||c===void 0||c.call(i)),(f=i.finalize)===null||f===void 0||f.call(i)}))}):Ht}function Y_(n){let t=oe(null);try{return n()}finally{oe(t)}}var Kc="https://angular.dev/best-practices/security#preventing-cross-site-scripting-xss",F=class extends Error{code;constructor(t,e){super(Ri(t,e)),this.code=t}};function eD(n){return`NG0${Math.abs(n)}`}function Ri(n,t){return`${eD(n)}${t?": "+t:""}`}var Oi=globalThis;function xe(n){for(let t in n)if(n[t]===xe)return t;throw Error("")}function Q_(n,t){for(let e in t)t.hasOwnProperty(e)&&!n.hasOwnProperty(e)&&(n[e]=t[e])}function Mi(n){if(typeof n=="string")return n;if(Array.isArray(n))return`[${n.map(Mi).join(", ")}]`;if(n==null)return""+n;let t=n.overriddenName||n.name;if(t)return`${t}`;let e=n.toString();if(e==null)return""+e;let i=e.indexOf(`
`);return i>=0?e.slice(0,i):e}function Yc(n,t){return n?t?`${n} ${t}`:n:t||""}var tD=xe({__forward_ref__:xe});function st(n){return n.__forward_ref__=st,n.toString=function(){return Mi(this())},n}function It(n){return ah(n)?n():n}function ah(n){return typeof n=="function"&&n.hasOwnProperty(tD)&&n.__forward_ref__===st}function k(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function cn(n){return{providers:n.providers||[],imports:n.imports||[]}}function da(n){return nD(n,Zc)}function lh(n){return da(n)!==null}function nD(n,t){return n.hasOwnProperty(t)&&n[t]||null}function iD(n){let t=n?.[Zc]??null;return t||null}function Jp(n){return n&&n.hasOwnProperty(Gc)?n[Gc]:null}var Zc=xe({\u0275prov:xe}),Gc=xe({\u0275inj:xe}),U=class{_desc;ngMetadataName="InjectionToken";\u0275prov;constructor(t,e){this._desc=t,this.\u0275prov=void 0,typeof e=="number"?this.__NG_ELEMENT_ID__=e:e!==void 0&&(this.\u0275prov=k({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}};function ch(n){return n&&!!n.\u0275providers}var uh=xe({\u0275cmp:xe}),dh=xe({\u0275dir:xe}),fh=xe({\u0275pipe:xe}),ph=xe({\u0275mod:xe}),ca=xe({\u0275fac:xe}),Ur=xe({__NG_ELEMENT_ID__:xe}),Z_=xe({__NG_ENV_ID__:xe});function Un(n){return typeof n=="string"?n:n==null?"":String(n)}function X_(n){return typeof n=="function"?n.name||n.toString():typeof n=="object"&&n!=null&&typeof n.type=="function"?n.type.name||n.type.toString():Un(n)}var ey=xe({ngErrorCode:xe}),rD=xe({ngErrorMessage:xe}),oD=xe({ngTokenPath:xe});function hh(n,t){return ty("",-200,t)}function Jc(n,t){throw new F(-201,!1)}function ty(n,t,e){let i=new F(t,n);return i[ey]=t,i[rD]=n,e&&(i[oD]=e),i}function sD(n){return n[ey]}var Qp;function ny(){return Qp}function Wt(n){let t=Qp;return Qp=n,t}function mh(n,t,e){let i=da(n);if(i&&i.providedIn=="root")return i.value===void 0?i.value=i.factory():i.value;if(e&8)return null;if(t!==void 0)return t;Jc(n,"Injector")}var aD={},Lr=aD,lD="__NG_DI_FLAG__",Xp=class{injector;constructor(t){this.injector=t}retrieve(t,e){let i=jr(e)||0;try{return this.injector.get(t,i&8?null:Lr,i)}catch(r){if(Ro(r))return r;throw r}}};function cD(n,t=0){let e=rc();if(e===void 0)throw new F(-203,!1);if(e===null)return mh(n,void 0,t);{let i=uD(t),r=e.retrieve(n,i);if(Ro(r)){if(i.optional)return null;throw r}return r}}function L(n,t=0){return(ny()||cD)(It(n),t)}function A(n,t){return L(n,jr(t))}function jr(n){return typeof n>"u"||typeof n=="number"?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function uD(n){return{optional:!!(n&8),host:!!(n&1),self:!!(n&2),skipSelf:!!(n&4)}}function eh(n){let t=[];for(let e=0;e<n.length;e++){let i=It(n[e]);if(Array.isArray(i)){if(i.length===0)throw new F(900,!1);let r,o=0;for(let s=0;s<i.length;s++){let a=i[s],c=dD(a);typeof c=="number"?c===-1?r=a.token:o|=c:r=a}t.push(L(r,o))}else t.push(L(i))}return t}function dD(n){return n[lD]}function ir(n,t){let e=n.hasOwnProperty(ca);return e?n[ca]:null}function iy(n,t,e){if(n.length!==t.length)return!1;for(let i=0;i<n.length;i++){let r=n[i],o=t[i];if(e&&(r=e(r),o=e(o)),o!==r)return!1}return!0}function ry(n){return n.flat(Number.POSITIVE_INFINITY)}function Qc(n,t){n.forEach(e=>Array.isArray(e)?Qc(e,t):t(e))}function gh(n,t,e){t>=n.length?n.push(e):n.splice(t,0,e)}function fa(n,t){return t>=n.length-1?n.pop():n.splice(t,1)[0]}function oy(n,t,e,i){let r=n.length;if(r==t)n.push(e,i);else if(r===1)n.push(i,n[0]),n[0]=e;else{for(r--,n.push(n[r-1],n[r]);r>t;){let o=r-2;n[r]=n[o],r--}n[t]=e,n[t+1]=i}}function Xc(n,t,e){let i=Ko(n,t);return i>=0?n[i|1]=e:(i=~i,oy(n,i,t,e)),i}function eu(n,t){let e=Ko(n,t);if(e>=0)return n[e|1]}function Ko(n,t){return fD(n,t,1)}function fD(n,t,e){let i=0,r=n.length>>e;for(;r!==i;){let o=i+(r-i>>1),s=n[o<<e];if(t===s)return o<<e;s>t?r=o:i=o+1}return~(r<<e)}var or={},Gt=[],Ni=new U(""),vh=new U("",-1),_h=new U(""),ua=class{get(t,e=Lr){if(e===Lr){let r=ty("",-201);throw r.name="\u0275NotFound",r}return e}};function yh(n){return n[ph]||null}function Pi(n){return n[uh]||null}function bh(n){return n[dh]||null}function sy(n){return n[fh]||null}function ii(n){return{\u0275providers:n}}function ay(n){return ii([{provide:Ni,multi:!0,useValue:n}])}function ly(...n){return{\u0275providers:wh(!0,n),\u0275fromNgModule:!0}}function wh(n,...t){let e=[],i=new Set,r,o=s=>{e.push(s)};return Qc(t,s=>{let a=s;qc(a,o,[],i)&&(r||=[],r.push(a))}),r!==void 0&&cy(r,o),e}function cy(n,t){for(let e=0;e<n.length;e++){let{ngModule:i,providers:r}=n[e];Eh(r,o=>{t(o,i)})}}function qc(n,t,e,i){if(n=It(n),!n)return!1;let r=null,o=Jp(n),s=!o&&Pi(n);if(!o&&!s){let c=n.ngModule;if(o=Jp(c),o)r=c;else return!1}else{if(s&&!s.standalone)return!1;r=n}let a=i.has(r);if(s){if(a)return!1;if(i.add(r),s.dependencies){let c=typeof s.dependencies=="function"?s.dependencies():s.dependencies;for(let f of c)qc(f,t,e,i)}}else if(o){if(o.imports!=null&&!a){i.add(r);let f;try{Qc(o.imports,h=>{qc(h,t,e,i)&&(f||=[],f.push(h))})}finally{}f!==void 0&&cy(f,t)}if(!a){let f=ir(r)||(()=>new r);t({provide:r,useFactory:f,deps:Gt},r),t({provide:_h,useValue:r,multi:!0},r),t({provide:Ni,useValue:()=>L(r),multi:!0},r)}let c=o.providers;if(c!=null&&!a){let f=n;Eh(c,h=>{t(h,f)})}}else return!1;return r!==n&&n.providers!==void 0}function Eh(n,t){for(let e of n)ch(e)&&(e=e.\u0275providers),Array.isArray(e)?Eh(e,t):t(e)}var pD=xe({provide:String,useValue:xe});function uy(n){return n!==null&&typeof n=="object"&&pD in n}function hD(n){return!!(n&&n.useExisting)}function mD(n){return!!(n&&n.useFactory)}function Vr(n){return typeof n=="function"}function dy(n){return!!n.useClass}var pa=new U(""),Wc={},J_={},Zp;function ha(){return Zp===void 0&&(Zp=new ua),Zp}var Ze=class{},zr=class extends Ze{parent;source;scopes;records=new Map;_ngOnDestroyHooks=new Set;_onDestroyHooks=[];get destroyed(){return this._destroyed}_destroyed=!1;injectorDefTypes;constructor(t,e,i,r){super(),this.parent=e,this.source=i,this.scopes=r,nh(t,s=>this.processProvider(s)),this.records.set(vh,qo(void 0,this)),r.has("environment")&&this.records.set(Ze,qo(void 0,this));let o=this.records.get(pa);o!=null&&typeof o.value=="string"&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(_h,Gt,{self:!0}))}retrieve(t,e){let i=jr(e)||0;try{return this.get(t,Lr,i)}catch(r){if(Ro(r))return r;throw r}}destroy(){la(this),this._destroyed=!0;let t=oe(null);try{for(let i of this._ngOnDestroyHooks)i.ngOnDestroy();let e=this._onDestroyHooks;this._onDestroyHooks=[];for(let i of e)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),oe(t)}}onDestroy(t){return la(this),this._onDestroyHooks.push(t),()=>this.removeOnDestroy(t)}runInContext(t){la(this);let e=ei(this),i=Wt(void 0),r;try{return t()}finally{ei(e),Wt(i)}}get(t,e=Lr,i){if(la(this),t.hasOwnProperty(Z_))return t[Z_](this);let r=jr(i),o,s=ei(this),a=Wt(void 0);try{if(!(r&4)){let f=this.records.get(t);if(f===void 0){let h=bD(t)&&da(t);h&&this.injectableDefInScope(h)?f=qo(th(t),Wc):f=null,this.records.set(t,f)}if(f!=null)return this.hydrate(t,f,r)}let c=r&2?ha():this.parent;return e=r&8&&e===Lr?null:e,c.get(t,e)}catch(c){let f=sD(c);throw f===-200||f===-201?new F(f,null):c}finally{Wt(a),ei(s)}}resolveInjectorInitializers(){let t=oe(null),e=ei(this),i=Wt(void 0),r;try{let o=this.get(Ni,Gt,{self:!0});for(let s of o)s()}finally{ei(e),Wt(i),oe(t)}}toString(){let t=[],e=this.records;for(let i of e.keys())t.push(Mi(i));return`R3Injector[${t.join(", ")}]`}processProvider(t){t=It(t);let e=Vr(t)?t:It(t&&t.provide),i=vD(t);if(!Vr(t)&&t.multi===!0){let r=this.records.get(e);r||(r=qo(void 0,Wc,!0),r.factory=()=>eh(r.multi),this.records.set(e,r)),e=t,r.multi.push(t)}this.records.set(e,i)}hydrate(t,e,i){let r=oe(null);try{if(e.value===J_)throw hh(Mi(t));return e.value===Wc&&(e.value=J_,e.value=e.factory(void 0,i)),typeof e.value=="object"&&e.value&&yD(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}finally{oe(r)}}injectableDefInScope(t){if(!t.providedIn)return!1;let e=It(t.providedIn);return typeof e=="string"?e==="any"||this.scopes.has(e):this.injectorDefTypes.has(e)}removeOnDestroy(t){let e=this._onDestroyHooks.indexOf(t);e!==-1&&this._onDestroyHooks.splice(e,1)}};function th(n){let t=da(n),e=t!==null?t.factory:ir(n);if(e!==null)return e;if(n instanceof U)throw new F(204,!1);if(n instanceof Function)return gD(n);throw new F(204,!1)}function gD(n){if(n.length>0)throw new F(204,!1);let e=iD(n);return e!==null?()=>e.factory(n):()=>new n}function vD(n){if(uy(n))return qo(void 0,n.useValue);{let t=Ch(n);return qo(t,Wc)}}function Ch(n,t,e){let i;if(Vr(n)){let r=It(n);return ir(r)||th(r)}else if(uy(n))i=()=>It(n.useValue);else if(mD(n))i=()=>n.useFactory(...eh(n.deps||[]));else if(hD(n))i=(r,o)=>L(It(n.useExisting),o!==void 0&&o&8?8:void 0);else{let r=It(n&&(n.useClass||n.provide));if(_D(n))i=()=>new r(...eh(n.deps));else return ir(r)||th(r)}return i}function la(n){if(n.destroyed)throw new F(205,!1)}function qo(n,t,e=!1){return{factory:n,value:t,multi:e?[]:void 0}}function _D(n){return!!n.deps}function yD(n){return n!==null&&typeof n=="object"&&typeof n.ngOnDestroy=="function"}function bD(n){return typeof n=="function"||typeof n=="object"&&n.ngMetadataName==="InjectionToken"}function nh(n,t){for(let e of n)Array.isArray(e)?nh(e,t):e&&ch(e)?nh(e.\u0275providers,t):t(e)}function pt(n,t){let e;n instanceof zr?(la(n),e=n):e=new Xp(n);let i,r=ei(e),o=Wt(void 0);try{return t()}finally{ei(r),Wt(o)}}function fy(){return ny()!==void 0||rc()!=null}var Bn=0,ne=1,se=2,ot=3,bn=4,wn=5,Yo=6,Zo=7,Je=8,sr=9,ri=10,Ae=11,Jo=12,Sh=13,Br=14,un=15,ar=16,$r=17,oi=18,ma=19,xh=20,Ti=21,tu=22,ga=23,dn=24,Hr=25,Wr=26,Ve=27,py=1,Dh=6,lr=7,va=8,Gr=9,tt=10;function si(n){return Array.isArray(n)&&typeof n[py]=="object"}function $n(n){return Array.isArray(n)&&n[py]===!0}function Ih(n){return(n.flags&4)!==0}function ki(n){return n.componentOffset>-1}function Qo(n){return(n.flags&1)===1}function ai(n){return!!n.template}function Xo(n){return(n[se]&512)!==0}function qr(n){return(n[se]&256)===256}var hy="svg",my="math";function En(n){for(;Array.isArray(n);)n=n[Bn];return n}function Th(n,t){return En(t[n])}function Cn(n,t){return En(t[n.index])}function _a(n,t){return n.data[t]}function ya(n,t){return n[t]}function Mh(n,t,e,i){e>=n.data.length&&(n.data[e]=null,n.blueprint[e]=null),t[e]=i}function Sn(n,t){let e=t[n];return si(e)?e:e[Bn]}function gy(n){return(n[se]&4)===4}function nu(n){return(n[se]&128)===128}function vy(n){return $n(n[ot])}function li(n,t){return t==null?null:n[t]}function Ah(n){n[$r]=0}function Rh(n){n[se]&1024||(n[se]|=1024,nu(n)&&es(n))}function _y(n,t){for(;n>0;)t=t[Br],n--;return t}function ba(n){return!!(n[se]&9216||n[dn]?.dirty)}function iu(n){n[ri].changeDetectionScheduler?.notify(8),n[se]&64&&(n[se]|=1024),ba(n)&&es(n)}function es(n){n[ri].changeDetectionScheduler?.notify(0);let t=rr(n);for(;t!==null&&!(t[se]&8192||(t[se]|=8192,!nu(t)));)t=rr(t)}function Oh(n,t){if(qr(n))throw new F(911,!1);n[Ti]===null&&(n[Ti]=[]),n[Ti].push(t)}function yy(n,t){if(n[Ti]===null)return;let e=n[Ti].indexOf(t);e!==-1&&n[Ti].splice(e,1)}function rr(n){let t=n[ot];return $n(t)?t[ot]:t}function Nh(n){return n[Zo]??=[]}function Ph(n){return n.cleanup??=[]}function by(n,t,e,i){let r=Nh(t);r.push(e),n.firstCreatePass&&Ph(n).push(i,r.length-1)}var de={lFrame:Fy(null),bindingsEnabled:!0,skipHydrationRootTNode:null};var ih=!1;function wy(){return de.lFrame.elementDepthCount}function Ey(){de.lFrame.elementDepthCount++}function Cy(){de.lFrame.elementDepthCount--}function ru(){return de.bindingsEnabled}function Sy(){return de.skipHydrationRootTNode!==null}function xy(n){return de.skipHydrationRootTNode===n}function Dy(){de.skipHydrationRootTNode=null}function ie(){return de.lFrame.lView}function ze(){return de.lFrame.tView}function D(n){return de.lFrame.contextLView=n,n[Je]}function I(n){return de.lFrame.contextLView=null,n}function ht(){let n=kh();for(;n!==null&&n.type===64;)n=n.parent;return n}function kh(){return de.lFrame.currentTNode}function Iy(){let n=de.lFrame,t=n.currentTNode;return n.isParent?t:t.parent}function ts(n,t){let e=de.lFrame;e.currentTNode=n,e.isParent=t}function Fh(){return de.lFrame.isParent}function Ty(){de.lFrame.isParent=!1}function My(){return de.lFrame.contextLView}function Lh(){return ih}function jh(n){let t=ih;return ih=n,t}function ns(){let n=de.lFrame,t=n.bindingRootIndex;return t===-1&&(t=n.bindingRootIndex=n.tView.bindingStartIndex),t}function Vh(){return de.lFrame.bindingIndex}function Ay(n){return de.lFrame.bindingIndex=n}function Fi(){return de.lFrame.bindingIndex++}function wa(n){let t=de.lFrame,e=t.bindingIndex;return t.bindingIndex=t.bindingIndex+n,e}function Ry(){return de.lFrame.inI18n}function Oy(n,t){let e=de.lFrame;e.bindingIndex=e.bindingRootIndex=n,ou(t)}function Ny(){return de.lFrame.currentDirectiveIndex}function ou(n){de.lFrame.currentDirectiveIndex=n}function Py(n){let t=de.lFrame.currentDirectiveIndex;return t===-1?null:n[t]}function zh(){return de.lFrame.currentQueryIndex}function su(n){de.lFrame.currentQueryIndex=n}function wD(n){let t=n[ne];return t.type===2?t.declTNode:t.type===1?n[wn]:null}function Uh(n,t,e){if(e&4){let r=t,o=n;for(;r=r.parent,r===null&&!(e&1);)if(r=wD(o),r===null||(o=o[Br],r.type&10))break;if(r===null)return!1;t=r,n=o}let i=de.lFrame=ky();return i.currentTNode=t,i.lView=n,!0}function au(n){let t=ky(),e=n[ne];de.lFrame=t,t.currentTNode=e.firstChild,t.lView=n,t.tView=e,t.contextLView=n,t.bindingIndex=e.bindingStartIndex,t.inI18n=!1}function ky(){let n=de.lFrame,t=n===null?null:n.child;return t===null?Fy(n):t}function Fy(n){let t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return n!==null&&(n.child=t),t}function Ly(){let n=de.lFrame;return de.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}var Bh=Ly;function lu(){let n=Ly();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function jy(n){return(de.lFrame.contextLView=_y(n,de.lFrame.contextLView))[Je]}function Hn(){return de.lFrame.selectedIndex}function cr(n){de.lFrame.selectedIndex=n}function Ea(){let n=de.lFrame;return _a(n.tView,n.selectedIndex)}function Vy(){return de.lFrame.currentNamespace}var zy=!0;function cu(){return zy}function Ca(n){zy=n}function rh(n,t=null,e=null,i){let r=$h(n,t,e,i);return r.resolveInjectorInitializers(),r}function $h(n,t=null,e=null,i,r=new Set){let o=[e||Gt,ly(n)];return i=i||(typeof n=="object"?void 0:Mi(n)),new zr(o,t||ha(),i||null,r)}var qt=class n{static THROW_IF_NOT_FOUND=Lr;static NULL=new ua;static create(t,e){if(Array.isArray(t))return rh({name:""},e,t,"");{let i=t.name??"";return rh({name:i},t.parent,t.providers,i)}}static \u0275prov=k({token:n,providedIn:"any",factory:()=>L(vh)});static __NG_ELEMENT_ID__=-1},Ue=new U(""),Wn=(()=>{class n{static __NG_ELEMENT_ID__=ED;static __NG_ENV_ID__=e=>e}return n})(),oh=class extends Wn{_lView;constructor(t){super(),this._lView=t}get destroyed(){return qr(this._lView)}onDestroy(t){let e=this._lView;return Oh(e,t),()=>yy(e,t)}};function ED(){return new oh(ie())}var zn=class{_console=console;handleError(t){this._console.error("ERROR",t)}},Kt=new U("",{providedIn:"root",factory:()=>{let n=A(Ze),t;return e=>{n.destroyed&&!t?setTimeout(()=>{throw e}):(t??=n.get(zn),t.handleError(e))}}}),Uy={provide:Ni,useValue:()=>void A(zn),multi:!0},CD=new U("",{providedIn:"root",factory:()=>{let n=A(Ue).defaultView;if(!n)return;let t=A(Kt),e=o=>{t(o.reason),o.preventDefault()},i=o=>{o.error?t(o.error):t(new Error(o.message,{cause:o})),o.preventDefault()},r=()=>{n.addEventListener("unhandledrejection",e),n.addEventListener("error",i)};typeof Zone<"u"?Zone.root.run(r):r(),A(Wn).onDestroy(()=>{n.removeEventListener("error",i),n.removeEventListener("unhandledrejection",e)})}});function Hh(){return ii([ay(()=>void A(CD))])}function Wh(n){return typeof n=="function"&&n[Nt]!==void 0}function Be(n,t){let[e,i,r]=Ip(n,t?.equal),o=e,s=o[Nt];return o.set=i,o.update=r,o.asReadonly=By.bind(o),o}function By(){let n=this[Nt];if(n.readonlyFn===void 0){let t=()=>this();t[Nt]=n,n.readonlyFn=t}return n.readonlyFn}function Gh(n){return Wh(n)&&typeof n.set=="function"}var uu=(()=>{class n{view;node;constructor(e,i){this.view=e,this.node=i}static __NG_ELEMENT_ID__=SD}return n})();function SD(){return new uu(ie(),ht())}var Ai=class{},Sa=new U("",{providedIn:"root",factory:()=>!1});var qh=new U(""),Kh=new U(""),ci=(()=>{class n{taskId=0;pendingTasks=new Set;destroyed=!1;pendingTask=new Ke(!1);get hasPendingTasks(){return this.destroyed?!1:this.pendingTask.value}get hasPendingTasksObservable(){return this.destroyed?new me(e=>{e.next(!1),e.complete()}):this.pendingTask}add(){!this.hasPendingTasks&&!this.destroyed&&this.pendingTask.next(!0);let e=this.taskId++;return this.pendingTasks.add(e),e}has(e){return this.pendingTasks.has(e)}remove(e){this.pendingTasks.delete(e),this.pendingTasks.size===0&&this.hasPendingTasks&&this.pendingTask.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks&&this.pendingTask.next(!1),this.destroyed=!0,this.pendingTask.unsubscribe()}static \u0275prov=k({token:n,providedIn:"root",factory:()=>new n})}return n})(),du=(()=>{class n{internalPendingTasks=A(ci);scheduler=A(Ai);errorHandler=A(Kt);add(){let e=this.internalPendingTasks.add();return()=>{this.internalPendingTasks.has(e)&&(this.scheduler.notify(11),this.internalPendingTasks.remove(e))}}run(e){let i=this.add();e().catch(this.errorHandler).finally(i)}static \u0275prov=k({token:n,providedIn:"root",factory:()=>new n})}return n})();function xa(...n){}var Yh=(()=>{class n{static \u0275prov=k({token:n,providedIn:"root",factory:()=>new sh})}return n})(),sh=class{dirtyEffectCount=0;queues=new Map;add(t){this.enqueue(t),this.schedule(t)}schedule(t){t.dirty&&this.dirtyEffectCount++}remove(t){let e=t.zone,i=this.queues.get(e);i.has(t)&&(i.delete(t),t.dirty&&this.dirtyEffectCount--)}enqueue(t){let e=t.zone;this.queues.has(e)||this.queues.set(e,new Set);let i=this.queues.get(e);i.has(t)||i.add(t)}flush(){for(;this.dirtyEffectCount>0;){let t=!1;for(let[e,i]of this.queues)e===null?t||=this.flushQueue(i):t||=e.run(()=>this.flushQueue(i));t||(this.dirtyEffectCount=0)}}flushQueue(t){let e=!1;for(let i of t)i.dirty&&(this.dirtyEffectCount--,e=!0,i.run());return e}};function ka(n){return{toString:n}.toString()}function OD(n){return typeof n=="function"}var yu=class{previousValue;currentValue;firstChange;constructor(t,e,i){this.previousValue=t,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}};function bb(n,t,e,i){t!==null?t.applyValueToInputSignal(t,i):n[e]=i}var fn=(()=>{let n=()=>wb;return n.ngInherit=!0,n})();function wb(n){return n.type.prototype.ngOnChanges&&(n.setInput=PD),ND}function ND(){let n=Cb(this),t=n?.current;if(t){let e=n.previous;if(e===or)n.previous=t;else for(let i in t)e[i]=t[i];n.current=null,this.ngOnChanges(t)}}function PD(n,t,e,i,r){let o=this.declaredInputs[i],s=Cb(n)||kD(n,{previous:or,current:null}),a=s.current||(s.current={}),c=s.previous,f=c[o];a[o]=new yu(f&&f.currentValue,e,c===or),bb(n,t,r,e)}var Eb="__ngSimpleChanges__";function Cb(n){return n[Eb]||null}function kD(n,t){return n[Eb]=t}var $y=[];var De=function(n,t=null,e){for(let i=0;i<$y.length;i++){let r=$y[i];r(n,t,e)}};function FD(n,t,e){let{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=t.type.prototype;if(i){let s=wb(t);(e.preOrderHooks??=[]).push(n,s),(e.preOrderCheckHooks??=[]).push(n,s)}r&&(e.preOrderHooks??=[]).push(0-n,r),o&&((e.preOrderHooks??=[]).push(n,o),(e.preOrderCheckHooks??=[]).push(n,o))}function Sb(n,t){for(let e=t.directiveStart,i=t.directiveEnd;e<i;e++){let o=n.data[e].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:c,ngAfterViewChecked:f,ngOnDestroy:h}=o;s&&(n.contentHooks??=[]).push(-e,s),a&&((n.contentHooks??=[]).push(e,a),(n.contentCheckHooks??=[]).push(e,a)),c&&(n.viewHooks??=[]).push(-e,c),f&&((n.viewHooks??=[]).push(e,f),(n.viewCheckHooks??=[]).push(e,f)),h!=null&&(n.destroyHooks??=[]).push(e,h)}}function mu(n,t,e){xb(n,t,3,e)}function gu(n,t,e,i){(n[se]&3)===e&&xb(n,t,e,i)}function Zh(n,t){let e=n[se];(e&3)===t&&(e&=16383,e+=1,n[se]=e)}function xb(n,t,e,i){let r=i!==void 0?n[$r]&65535:0,o=i??-1,s=t.length-1,a=0;for(let c=r;c<s;c++)if(typeof t[c+1]=="number"){if(a=t[c],i!=null&&a>=i)break}else t[c]<0&&(n[$r]+=65536),(a<o||o==-1)&&(LD(n,e,t,c),n[$r]=(n[$r]&4294901760)+c+2),c++}function Hy(n,t){De(4,n,t);let e=oe(null);try{t.call(n)}finally{oe(e),De(5,n,t)}}function LD(n,t,e,i){let r=e[i]<0,o=e[i+1],s=r?-e[i]:e[i],a=n[s];r?n[se]>>14<n[$r]>>16&&(n[se]&3)===t&&(n[se]+=16384,Hy(a,o)):Hy(a,o)}var rs=-1,Yr=class{factory;name;injectImpl;resolving=!1;canSeeViewProviders;multi;componentProviders;index;providerFactory;constructor(t,e,i,r){this.factory=t,this.name=r,this.canSeeViewProviders=e,this.injectImpl=i}};function jD(n){return(n.flags&8)!==0}function VD(n){return(n.flags&16)!==0}function zD(n,t,e){let i=0;for(;i<e.length;){let r=e[i];if(typeof r=="number"){if(r!==0)break;i++;let o=e[i++],s=e[i++],a=e[i++];n.setAttribute(t,s,a,o)}else{let o=r,s=e[++i];UD(o)?n.setProperty(t,o,s):n.setAttribute(t,o,s),i++}}return i}function Db(n){return n===3||n===4||n===6}function UD(n){return n.charCodeAt(0)===64}function Ta(n,t){if(!(t===null||t.length===0))if(n===null||n.length===0)n=t.slice();else{let e=-1;for(let i=0;i<t.length;i++){let r=t[i];typeof r=="number"?e=r:e===0||(e===-1||e===2?Wy(n,e,r,null,t[++i]):Wy(n,e,r,null,null))}}return n}function Wy(n,t,e,i,r){let o=0,s=n.length;if(t===-1)s=-1;else for(;o<n.length;){let a=n[o++];if(typeof a=="number"){if(a===t){s=-1;break}else if(a>t){s=o-1;break}}}for(;o<n.length;){let a=n[o];if(typeof a=="number")break;if(a===e){r!==null&&(n[o+1]=r);return}o++,r!==null&&o++}s!==-1&&(n.splice(s,0,t),o=s+1),n.splice(o++,0,e),r!==null&&n.splice(o++,0,r)}function Ib(n){return n!==rs}function bu(n){return n&32767}function BD(n){return n>>16}function wu(n,t){let e=BD(n),i=t;for(;e>0;)i=i[Br],e--;return i}var lm=!0;function Eu(n){let t=lm;return lm=n,t}var $D=256,Tb=$D-1,Mb=5,HD=0,ui={};function WD(n,t,e){let i;typeof e=="string"?i=e.charCodeAt(0)||0:e.hasOwnProperty(Ur)&&(i=e[Ur]),i==null&&(i=e[Ur]=HD++);let r=i&Tb,o=1<<r;t.data[n+(r>>Mb)]|=o}function Cu(n,t){let e=Ab(n,t);if(e!==-1)return e;let i=t[ne];i.firstCreatePass&&(n.injectorIndex=t.length,Jh(i.data,n),Jh(t,null),Jh(i.blueprint,null));let r=Vm(n,t),o=n.injectorIndex;if(Ib(r)){let s=bu(r),a=wu(r,t),c=a[ne].data;for(let f=0;f<8;f++)t[o+f]=a[s+f]|c[s+f]}return t[o+8]=r,o}function Jh(n,t){n.push(0,0,0,0,0,0,0,0,t)}function Ab(n,t){return n.injectorIndex===-1||n.parent&&n.parent.injectorIndex===n.injectorIndex||t[n.injectorIndex+8]===null?-1:n.injectorIndex}function Vm(n,t){if(n.parent&&n.parent.injectorIndex!==-1)return n.parent.injectorIndex;let e=0,i=null,r=t;for(;r!==null;){if(i=kb(r),i===null)return rs;if(e++,r=r[Br],i.injectorIndex!==-1)return i.injectorIndex|e<<16}return rs}function cm(n,t,e){WD(n,t,e)}function GD(n,t){if(t==="class")return n.classes;if(t==="style")return n.styles;let e=n.attrs;if(e){let i=e.length,r=0;for(;r<i;){let o=e[r];if(Db(o))break;if(o===0)r=r+2;else if(typeof o=="number")for(r++;r<i&&typeof e[r]=="string";)r++;else{if(o===t)return e[r+1];r=r+2}}}return null}function Rb(n,t,e){if(e&8||n!==void 0)return n;Jc(t,"NodeInjector")}function Ob(n,t,e,i){if(e&8&&i===void 0&&(i=null),(e&3)===0){let r=n[sr],o=Wt(void 0);try{return r?r.get(t,i,e&8):mh(t,i,e&8)}finally{Wt(o)}}return Rb(i,t,e)}function Nb(n,t,e,i=0,r){if(n!==null){if(t[se]&2048&&!(i&2)){let s=ZD(n,t,e,i,ui);if(s!==ui)return s}let o=Pb(n,t,e,i,ui);if(o!==ui)return o}return Ob(t,e,i,r)}function Pb(n,t,e,i,r){let o=KD(e);if(typeof o=="function"){if(!Uh(t,n,i))return i&1?Rb(r,e,i):Ob(t,e,i,r);try{let s;if(s=o(i),s==null&&!(i&8))Jc(e);else return s}finally{Bh()}}else if(typeof o=="number"){let s=null,a=Ab(n,t),c=rs,f=i&1?t[un][wn]:null;for((a===-1||i&4)&&(c=a===-1?Vm(n,t):t[a+8],c===rs||!qy(i,!1)?a=-1:(s=t[ne],a=bu(c),t=wu(c,t)));a!==-1;){let h=t[ne];if(Gy(o,a,h.data)){let m=qD(a,t,e,s,i,f);if(m!==ui)return m}c=t[a+8],c!==rs&&qy(i,t[ne].data[a+8]===f)&&Gy(o,a,t)?(s=h,a=bu(c),t=wu(c,t)):a=-1}}return r}function qD(n,t,e,i,r,o){let s=t[ne],a=s.data[n+8],c=i==null?ki(a)&&lm:i!=s&&(a.type&3)!==0,f=r&1&&o===a,h=vu(a,s,e,c,f);return h!==null?Ma(t,s,h,a,r):ui}function vu(n,t,e,i,r){let o=n.providerIndexes,s=t.data,a=o&1048575,c=n.directiveStart,f=n.directiveEnd,h=o>>20,m=i?a:a+h,y=r?a+h:f;for(let g=m;g<y;g++){let w=s[g];if(g<c&&e===w||g>=c&&w.type===e)return g}if(r){let g=s[c];if(g&&ai(g)&&g.type===e)return c}return null}function Ma(n,t,e,i,r){let o=n[e],s=t.data;if(o instanceof Yr){let a=o;if(a.resolving){let g=X_(s[e]);throw hh(g)}let c=Eu(a.canSeeViewProviders);a.resolving=!0;let f=s[e].type||s[e],h,m=a.injectImpl?Wt(a.injectImpl):null,y=Uh(n,i,0);try{o=n[e]=a.factory(void 0,r,s,n,i),t.firstCreatePass&&e>=i.directiveStart&&FD(e,s[e],t)}finally{m!==null&&Wt(m),Eu(c),a.resolving=!1,Bh()}}return o}function KD(n){if(typeof n=="string")return n.charCodeAt(0)||0;let t=n.hasOwnProperty(Ur)?n[Ur]:void 0;return typeof t=="number"?t>=0?t&Tb:YD:t}function Gy(n,t,e){let i=1<<n;return!!(e[t+(n>>Mb)]&i)}function qy(n,t){return!(n&2)&&!(n&1&&t)}var Kr=class{_tNode;_lView;constructor(t,e){this._tNode=t,this._lView=e}get(t,e,i){return Nb(this._tNode,this._lView,t,jr(i),e)}};function YD(){return new Kr(ht(),ie())}function xn(n){return ka(()=>{let t=n.prototype.constructor,e=t[ca]||um(t),i=Object.prototype,r=Object.getPrototypeOf(n.prototype).constructor;for(;r&&r!==i;){let o=r[ca]||um(r);if(o&&o!==e)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function um(n){return ah(n)?()=>{let t=um(It(n));return t&&t()}:ir(n)}function ZD(n,t,e,i,r){let o=n,s=t;for(;o!==null&&s!==null&&s[se]&2048&&!Xo(s);){let a=Pb(o,s,e,i|2,ui);if(a!==ui)return a;let c=o.parent;if(!c){let f=s[xh];if(f){let h=f.get(e,ui,i);if(h!==ui)return h}c=kb(s),s=s[Br]}o=c}return r}function kb(n){let t=n[ne],e=t.type;return e===2?t.declTNode:e===1?n[wn]:null}function Fa(n){return GD(ht(),n)}function JD(){return ls(ht(),ie())}function ls(n,t){return new mt(Cn(n,t))}var mt=(()=>{class n{nativeElement;constructor(e){this.nativeElement=e}static __NG_ELEMENT_ID__=JD}return n})();function QD(n){return n instanceof mt?n.nativeElement:n}function XD(){return this._results[Symbol.iterator]()}var Su=class{_emitDistinctChangesOnly;dirty=!0;_onDirty=void 0;_results=[];_changesDetected=!1;_changes=void 0;length=0;first=void 0;last=void 0;get changes(){return this._changes??=new Le}constructor(t=!1){this._emitDistinctChangesOnly=t}get(t){return this._results[t]}map(t){return this._results.map(t)}filter(t){return this._results.filter(t)}find(t){return this._results.find(t)}reduce(t,e){return this._results.reduce(t,e)}forEach(t){this._results.forEach(t)}some(t){return this._results.some(t)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(t,e){this.dirty=!1;let i=ry(t);(this._changesDetected=!iy(this._results,i,e))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){this._changes!==void 0&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.next(this)}onDirty(t){this._onDirty=t}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){this._changes!==void 0&&(this._changes.complete(),this._changes.unsubscribe())}[Symbol.iterator]=XD};function Fb(n){return(n.flags&128)===128}var zm=(function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n})(zm||{}),Lb=new Map,eI=0;function tI(){return eI++}function nI(n){Lb.set(n[ma],n)}function dm(n){Lb.delete(n[ma])}var Ky="__ngContext__";function os(n,t){si(t)?(n[Ky]=t[ma],nI(t)):n[Ky]=t}function jb(n){return zb(n[Jo])}function Vb(n){return zb(n[bn])}function zb(n){for(;n!==null&&!$n(n);)n=n[bn];return n}var fm;function Um(n){fm=n}function Ub(){if(fm!==void 0)return fm;if(typeof document<"u")return document;throw new F(210,!1)}var zu=new U("",{providedIn:"root",factory:()=>iI}),iI="ng",Uu=new U(""),cs=new U("",{providedIn:"platform",factory:()=>"unknown"});var Bu=new U("",{providedIn:"root",factory:()=>Ub().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});var rI="h",oI="b";var Bb="r";var $b="di";var Hb=!1,Wb=new U("",{providedIn:"root",factory:()=>Hb});var Bm=new U("");var sI=(n,t,e,i)=>{};function aI(n,t,e,i){sI(n,t,e,i)}function $m(n){return(n.flags&32)===32}var lI=()=>null;function Gb(n,t,e=!1){return lI(n,t,e)}function qb(n,t){let e=n.contentQueries;if(e!==null){let i=oe(null);try{for(let r=0;r<e.length;r+=2){let o=e[r],s=e[r+1];if(s!==-1){let a=n.data[s];su(o),a.contentQueries(2,t[s],s)}}}finally{oe(i)}}}function pm(n,t,e){su(0);let i=oe(null);try{t(n,e)}finally{oe(i)}}function Hm(n,t,e){if(Ih(t)){let i=oe(null);try{let r=t.directiveStart,o=t.directiveEnd;for(let s=r;s<o;s++){let a=n.data[s];if(a.contentQueries){let c=e[s];a.contentQueries(1,c,s)}}}finally{oe(i)}}}var Li=(function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n})(Li||{});var fu;function cI(){if(fu===void 0&&(fu=null,Oi.trustedTypes))try{fu=Oi.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return fu}function Yy(n){return cI()?.createScriptURL(n)||n}var xu=class{changingThisBreaksApplicationSecurity;constructor(t){this.changingThisBreaksApplicationSecurity=t}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Kc})`}};function us(n){return n instanceof xu?n.changingThisBreaksApplicationSecurity:n}function Wm(n,t){let e=Kb(n);if(e!=null&&e!==t){if(e==="ResourceURL"&&t==="URL")return!0;throw new Error(`Required a safe ${t}, got a ${e} (see ${Kc})`)}return e===t}function Kb(n){return n instanceof xu&&n.getTypeName()||null}var uI=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Yb(n){return n=String(n),n.match(uI)?n:"unsafe:"+n}var $u=(function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n})($u||{});function La(n){let t=Jb();return t?t.sanitize($u.URL,n)||"":Wm(n,"URL")?us(n):Yb(Un(n))}function Zb(n){let t=Jb();if(t)return Yy(t.sanitize($u.RESOURCE_URL,n)||"");if(Wm(n,"ResourceURL"))return Yy(us(n));throw new F(904,!1)}function dI(n,t){return t==="src"&&(n==="embed"||n==="frame"||n==="iframe"||n==="media"||n==="script")||t==="href"&&(n==="base"||n==="link")?Zb:La}function Gm(n,t,e){return dI(t,e)(n)}function Jb(){let n=ie();return n&&n[ri].sanitizer}var fI=/^>|^->|<!--|-->|--!>|<!-$/g,pI=/(<|>)/g,hI="\u200B$1\u200B";function mI(n){return n.replace(fI,t=>t.replace(pI,hI))}function qm(n){return n.ownerDocument.defaultView}function Km(n){return n.ownerDocument}function Qb(n){return n instanceof Function?n():n}function gI(n,t,e){let i=n.length;for(;;){let r=n.indexOf(t,e);if(r===-1)return r;if(r===0||n.charCodeAt(r-1)<=32){let o=t.length;if(r+o===i||n.charCodeAt(r+o)<=32)return r}e=r+1}}var Xb="ng-template";function vI(n,t,e,i){let r=0;if(i){for(;r<t.length&&typeof t[r]=="string";r+=2)if(t[r]==="class"&&gI(t[r+1].toLowerCase(),e,0)!==-1)return!0}else if(Ym(n))return!1;if(r=t.indexOf(1,r),r>-1){let o;for(;++r<t.length&&typeof(o=t[r])=="string";)if(o.toLowerCase()===e)return!0}return!1}function Ym(n){return n.type===4&&n.value!==Xb}function _I(n,t,e){let i=n.type===4&&!e?Xb:n.value;return t===i}function yI(n,t,e){let i=4,r=n.attrs,o=r!==null?EI(r):0,s=!1;for(let a=0;a<t.length;a++){let c=t[a];if(typeof c=="number"){if(!s&&!Gn(i)&&!Gn(c))return!1;if(s&&Gn(c))continue;s=!1,i=c|i&1;continue}if(!s)if(i&4){if(i=2|i&1,c!==""&&!_I(n,c,e)||c===""&&t.length===1){if(Gn(i))return!1;s=!0}}else if(i&8){if(r===null||!vI(n,r,c,e)){if(Gn(i))return!1;s=!0}}else{let f=t[++a],h=bI(c,r,Ym(n),e);if(h===-1){if(Gn(i))return!1;s=!0;continue}if(f!==""){let m;if(h>o?m="":m=r[h+1].toLowerCase(),i&2&&f!==m){if(Gn(i))return!1;s=!0}}}}return Gn(i)||s}function Gn(n){return(n&1)===0}function bI(n,t,e,i){if(t===null)return-1;let r=0;if(i||!e){let o=!1;for(;r<t.length;){let s=t[r];if(s===n)return r;if(s===3||s===6)o=!0;else if(s===1||s===2){let a=t[++r];for(;typeof a=="string";)a=t[++r];continue}else{if(s===4)break;if(s===0){r+=4;continue}}r+=o?1:2}return-1}else return CI(t,n)}function wI(n,t,e=!1){for(let i=0;i<t.length;i++)if(yI(n,t[i],e))return!0;return!1}function EI(n){for(let t=0;t<n.length;t++){let e=n[t];if(Db(e))return t}return n.length}function CI(n,t){let e=n.indexOf(4);if(e>-1)for(e++;e<n.length;){let i=n[e];if(typeof i=="number")return-1;if(i===t)return e;e++}return-1}function Zy(n,t){return n?":not("+t.trim()+")":t}function SI(n){let t=n[0],e=1,i=2,r="",o=!1;for(;e<n.length;){let s=n[e];if(typeof s=="string")if(i&2){let a=n[++e];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else i&8?r+="."+s:i&4&&(r+=" "+s);else r!==""&&!Gn(s)&&(t+=Zy(o,r),r=""),i=s,o=o||!Gn(i);e++}return r!==""&&(t+=Zy(o,r)),t}function xI(n){return n.map(SI).join(",")}function DI(n){let t=[],e=[],i=1,r=2;for(;i<n.length;){let o=n[i];if(typeof o=="string")r===2?o!==""&&t.push(o,n[++i]):r===8&&e.push(o);else{if(!Gn(r))break;r=o}i++}return e.length&&t.push(1,...e),t}var gt={};function II(n,t){return n.createText(t)}function TI(n,t,e){n.setValue(t,e)}function MI(n,t){return n.createComment(mI(t))}function ew(n,t,e){return n.createElement(t,e)}function Du(n,t,e,i,r){n.insertBefore(t,e,i,r)}function tw(n,t,e){n.appendChild(t,e)}function Jy(n,t,e,i,r){i!==null?Du(n,t,e,i,r):tw(n,t,e)}function nw(n,t,e,i){n.removeChild(null,t,e,i)}function AI(n,t,e){n.setAttribute(t,"style",e)}function RI(n,t,e){e===""?n.removeAttribute(t,"class"):n.setAttribute(t,"class",e)}function iw(n,t,e){let{mergedAttrs:i,classes:r,styles:o}=e;i!==null&&zD(n,t,i),r!==null&&RI(n,t,r),o!==null&&AI(n,t,o)}function Zm(n,t,e,i,r,o,s,a,c,f,h){let m=Ve+i,y=m+r,g=OI(m,y),w=typeof f=="function"?f():f;return g[ne]={type:n,blueprint:g,template:e,queries:null,viewQuery:a,declTNode:t,data:g.slice().fill(null,m),bindingStartIndex:m,expandoStartIndex:y,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:typeof o=="function"?o():o,pipeRegistry:typeof s=="function"?s():s,firstChild:null,schemas:c,consts:w,incompleteFirstPass:!1,ssrId:h}}function OI(n,t){let e=[];for(let i=0;i<t;i++)e.push(i<n?null:gt);return e}function NI(n){let t=n.tView;return t===null||t.incompleteFirstPass?n.tView=Zm(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):t}function Jm(n,t,e,i,r,o,s,a,c,f,h){let m=t.blueprint.slice();return m[Bn]=r,m[se]=i|4|128|8|64|1024,(f!==null||n&&n[se]&2048)&&(m[se]|=2048),Ah(m),m[ot]=m[Br]=n,m[Je]=e,m[ri]=s||n&&n[ri],m[Ae]=a||n&&n[Ae],m[sr]=c||n&&n[sr]||null,m[wn]=o,m[ma]=tI(),m[Yo]=h,m[xh]=f,m[un]=t.type==2?n[un]:m,m}function PI(n,t,e){let i=Cn(t,n),r=NI(e),o=n[ri].rendererFactory,s=Qm(n,Jm(n,r,null,rw(e),i,t,null,o.createRenderer(i,e),null,null,null));return n[t.index]=s}function rw(n){let t=16;return n.signals?t=4096:n.onPush&&(t=64),t}function ow(n,t,e,i){if(e===0)return-1;let r=t.length;for(let o=0;o<e;o++)t.push(i),n.blueprint.push(i),n.data.push(null);return r}function Qm(n,t){return n[Jo]?n[Sh][bn]=t:n[Jo]=t,n[Sh]=t,t}function p(n=1){sw(ze(),ie(),Hn()+n,!1)}function sw(n,t,e,i){if(!i)if((t[se]&3)===3){let o=n.preOrderCheckHooks;o!==null&&mu(t,o,e)}else{let o=n.preOrderHooks;o!==null&&gu(t,o,0,e)}cr(e)}var Hu=(function(n){return n[n.None=0]="None",n[n.SignalBased=1]="SignalBased",n[n.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",n})(Hu||{});function hm(n,t,e,i){let r=oe(null);try{let[o,s,a]=n.inputs[e],c=null;(s&Hu.SignalBased)!==0&&(c=t[o][Nt]),c!==null&&c.transformFn!==void 0?i=c.transformFn(i):a!==null&&(i=a.call(t,i)),n.setInput!==null?n.setInput(t,c,i,e,o):bb(t,c,o,i)}finally{oe(r)}}var Kn=(function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n})(Kn||{}),kI;function Xm(n,t){return kI(n,t)}var ss=new Set,Wu=(function(n){return n[n.CHANGE_DETECTION=0]="CHANGE_DETECTION",n[n.AFTER_NEXT_RENDER=1]="AFTER_NEXT_RENDER",n})(Wu||{}),eo=new U(""),Qy=new Set;function Yn(n){Qy.has(n)||(Qy.add(n),performance?.mark?.("mark_feature_usage",{detail:{feature:n}}))}var aw=!1,mm=class extends Le{__isAsync;destroyRef=void 0;pendingTasks=void 0;constructor(t=!1){super(),this.__isAsync=t,fy()&&(this.destroyRef=A(Wn,{optional:!0})??void 0,this.pendingTasks=A(ci,{optional:!0})??void 0)}emit(t){let e=oe(null);try{super.next(t)}finally{oe(e)}}subscribe(t,e,i){let r=t,o=e||(()=>null),s=i;if(t&&typeof t=="object"){let c=t;r=c.next?.bind(c),o=c.error?.bind(c),s=c.complete?.bind(c)}this.__isAsync&&(o=this.wrapInTimeout(o),r&&(r=this.wrapInTimeout(r)),s&&(s=this.wrapInTimeout(s)));let a=super.subscribe({next:r,error:o,complete:s});return t instanceof He&&t.add(a),a}wrapInTimeout(t){return e=>{let i=this.pendingTasks?.add();setTimeout(()=>{try{t(e)}finally{i!==void 0&&this.pendingTasks?.remove(i)}})}}},Re=mm;function lw(n){let t,e;function i(){n=xa;try{e!==void 0&&typeof cancelAnimationFrame=="function"&&cancelAnimationFrame(e),t!==void 0&&clearTimeout(t)}catch{}}return t=setTimeout(()=>{n(),i()}),typeof requestAnimationFrame=="function"&&(e=requestAnimationFrame(()=>{n(),i()})),()=>i()}function Xy(n){return queueMicrotask(()=>n()),()=>{n=xa}}var eg="isAngularZone",Iu=eg+"_ID",FI=0,We=class n{hasPendingMacrotasks=!1;hasPendingMicrotasks=!1;isStable=!0;onUnstable=new Re(!1);onMicrotaskEmpty=new Re(!1);onStable=new Re(!1);onError=new Re(!1);constructor(t){let{enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:r=!1,scheduleInRootZone:o=aw}=t;if(typeof Zone>"u")throw new F(908,!1);Zone.assertZonePatched();let s=this;s._nesting=0,s._outer=s._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(s._inner=s._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(s._inner=s._inner.fork(Zone.longStackTraceZoneSpec)),s.shouldCoalesceEventChangeDetection=!r&&i,s.shouldCoalesceRunChangeDetection=r,s.callbackScheduled=!1,s.scheduleInRootZone=o,VI(s)}static isInAngularZone(){return typeof Zone<"u"&&Zone.current.get(eg)===!0}static assertInAngularZone(){if(!n.isInAngularZone())throw new F(909,!1)}static assertNotInAngularZone(){if(n.isInAngularZone())throw new F(909,!1)}run(t,e,i){return this._inner.run(t,e,i)}runTask(t,e,i,r){let o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,t,LI,xa,xa);try{return o.runTask(s,e,i)}finally{o.cancelTask(s)}}runGuarded(t,e,i){return this._inner.runGuarded(t,e,i)}runOutsideAngular(t){return this._outer.run(t)}},LI={};function tg(n){if(n._nesting==0&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function jI(n){if(n.isCheckStableRunning||n.callbackScheduled)return;n.callbackScheduled=!0;function t(){lw(()=>{n.callbackScheduled=!1,gm(n),n.isCheckStableRunning=!0,tg(n),n.isCheckStableRunning=!1})}n.scheduleInRootZone?Zone.root.run(()=>{t()}):n._outer.run(()=>{t()}),gm(n)}function VI(n){let t=()=>{jI(n)},e=FI++;n._inner=n._inner.fork({name:"angular",properties:{[eg]:!0,[Iu]:e,[Iu+e]:!0},onInvokeTask:(i,r,o,s,a,c)=>{if(zI(c))return i.invokeTask(o,s,a,c);try{return eb(n),i.invokeTask(o,s,a,c)}finally{(n.shouldCoalesceEventChangeDetection&&s.type==="eventTask"||n.shouldCoalesceRunChangeDetection)&&t(),tb(n)}},onInvoke:(i,r,o,s,a,c,f)=>{try{return eb(n),i.invoke(o,s,a,c,f)}finally{n.shouldCoalesceRunChangeDetection&&!n.callbackScheduled&&!UI(c)&&t(),tb(n)}},onHasTask:(i,r,o,s)=>{i.hasTask(o,s),r===o&&(s.change=="microTask"?(n._hasPendingMicrotasks=s.microTask,gm(n),tg(n)):s.change=="macroTask"&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(i,r,o,s)=>(i.handleError(o,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}function gm(n){n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&n.callbackScheduled===!0?n.hasPendingMicrotasks=!0:n.hasPendingMicrotasks=!1}function eb(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function tb(n){n._nesting--,tg(n)}var Tu=class{hasPendingMicrotasks=!1;hasPendingMacrotasks=!1;isStable=!0;onUnstable=new Re;onMicrotaskEmpty=new Re;onStable=new Re;onError=new Re;run(t,e,i){return t.apply(e,i)}runGuarded(t,e,i){return t.apply(e,i)}runOutsideAngular(t){return t()}runTask(t,e,i,r){return t.apply(e,i)}};function zI(n){return cw(n,"__ignore_ng_zone__")}function UI(n){return cw(n,"__scheduler_tick__")}function cw(n,t){return!Array.isArray(n)||n.length!==1?!1:n[0]?.data?.[t]===!0}var ng=(()=>{class n{impl=null;execute(){this.impl?.execute()}static \u0275prov=k({token:n,providedIn:"root",factory:()=>new n})}return n})(),uw=[0,1,2,3],dw=(()=>{class n{ngZone=A(We);scheduler=A(Ai);errorHandler=A(zn,{optional:!0});sequences=new Set;deferredRegistrations=new Set;executing=!1;constructor(){A(eo,{optional:!0})}execute(){let e=this.sequences.size>0;e&&De(16),this.executing=!0;for(let i of uw)for(let r of this.sequences)if(!(r.erroredOrDestroyed||!r.hooks[i]))try{r.pipelinedValue=this.ngZone.runOutsideAngular(()=>this.maybeTrace(()=>{let o=r.hooks[i];return o(r.pipelinedValue)},r.snapshot))}catch(o){r.erroredOrDestroyed=!0,this.errorHandler?.handleError(o)}this.executing=!1;for(let i of this.sequences)i.afterRun(),i.once&&(this.sequences.delete(i),i.destroy());for(let i of this.deferredRegistrations)this.sequences.add(i);this.deferredRegistrations.size>0&&this.scheduler.notify(7),this.deferredRegistrations.clear(),e&&De(17)}register(e){let{view:i}=e;i!==void 0?((i[Hr]??=[]).push(e),es(i),i[se]|=8192):this.executing?this.deferredRegistrations.add(e):this.addSequence(e)}addSequence(e){this.sequences.add(e),this.scheduler.notify(7)}unregister(e){this.executing&&this.sequences.has(e)?(e.erroredOrDestroyed=!0,e.pipelinedValue=void 0,e.once=!0):(this.sequences.delete(e),this.deferredRegistrations.delete(e))}maybeTrace(e,i){return i?i.run(Wu.AFTER_NEXT_RENDER,e):e()}static \u0275prov=k({token:n,providedIn:"root",factory:()=>new n})}return n})(),Mu=class{impl;hooks;view;once;snapshot;erroredOrDestroyed=!1;pipelinedValue=void 0;unregisterOnDestroy;constructor(t,e,i,r,o,s=null){this.impl=t,this.hooks=e,this.view=i,this.once=r,this.snapshot=s,this.unregisterOnDestroy=o?.onDestroy(()=>this.destroy())}afterRun(){this.erroredOrDestroyed=!1,this.pipelinedValue=void 0,this.snapshot?.dispose(),this.snapshot=null}destroy(){this.impl.unregister(this),this.unregisterOnDestroy?.();let t=this.view?.[Hr];t&&(this.view[Hr]=t.filter(e=>e!==this))}};function ja(n,t){let e=t?.injector??A(qt);return Yn("NgAfterNextRender"),$I(n,e,t,!0)}function BI(n){return n instanceof Function?[void 0,void 0,n,void 0]:[n.earlyRead,n.write,n.mixedReadWrite,n.read]}function $I(n,t,e,i){let r=t.get(ng);r.impl??=t.get(dw);let o=t.get(eo,null,{optional:!0}),s=e?.manualCleanup!==!0?t.get(Wn):null,a=t.get(uu,null,{optional:!0}),c=new Mu(r.impl,BI(n),a?.view,i,s,o?.snapshot(null));return r.impl.register(c),c}var HI=new U("",{providedIn:"root",factory:()=>({queue:new Set,isScheduled:!1,scheduler:null})});function fw(n,t){let e=n.get(HI);if(Array.isArray(t))for(let i of t)e.queue.add(i);else e.queue.add(t);e.scheduler&&e.scheduler(n)}function WI(n,t){for(let[e,i]of t)fw(n,i.animateFns)}function nb(n,t,e,i){let r=n?.[Wr]?.enter;t!==null&&r&&r.has(e.index)&&WI(i,r)}function is(n,t,e,i,r,o,s,a){if(r!=null){let c,f=!1;$n(r)?c=r:si(r)&&(f=!0,r=r[Bn]);let h=En(r);n===0&&i!==null?(nb(a,i,o,e),s==null?tw(t,i,h):Du(t,i,h,s||null,!0)):n===1&&i!==null?(nb(a,i,o,e),Du(t,i,h,s||null,!0)):n===2?ib(a,o,e,m=>{nw(t,h,f,m)}):n===3&&ib(a,o,e,()=>{t.destroyNode(h)}),c!=null&&rT(t,n,e,c,o,i,s)}}function GI(n,t){pw(n,t),t[Bn]=null,t[wn]=null}function qI(n,t,e,i,r,o){i[Bn]=r,i[wn]=t,qu(n,i,e,1,r,o)}function pw(n,t){t[ri].changeDetectionScheduler?.notify(9),qu(n,t,t[Ae],2,null,null)}function KI(n){let t=n[Jo];if(!t)return Qh(n[ne],n);for(;t;){let e=null;if(si(t))e=t[Jo];else{let i=t[tt];i&&(e=i)}if(!e){for(;t&&!t[bn]&&t!==n;)si(t)&&Qh(t[ne],t),t=t[ot];t===null&&(t=n),si(t)&&Qh(t[ne],t),e=t&&t[bn]}t=e}}function ig(n,t){let e=n[Gr],i=e.indexOf(t);e.splice(i,1)}function Gu(n,t){if(qr(t))return;let e=t[Ae];e.destroyNode&&qu(n,t,e,3,null,null),KI(t)}function Qh(n,t){if(qr(t))return;let e=oe(null);try{t[se]&=-129,t[se]|=256,t[dn]&&ia(t[dn]),JI(n,t),ZI(n,t),t[ne].type===1&&t[Ae].destroy();let i=t[ar];if(i!==null&&$n(t[ot])){i!==t[ot]&&ig(i,t);let r=t[oi];r!==null&&r.detachView(n)}dm(t)}finally{oe(e)}}function ib(n,t,e,i){let r=n?.[Wr];if(r==null||r.leave==null||!r.leave.has(t.index))return i(!1);if(r.skipLeaveAnimations)return r.skipLeaveAnimations=!1,i(!1);n&&ss.add(n),fw(e,()=>{if(r.leave&&r.leave.has(t.index)){let s=r.leave.get(t.index),a=[];if(s)for(let c=0;c<s.animateFns.length;c++){let f=s.animateFns[c],{promise:h}=f();a.push(h)}r.running=Promise.allSettled(a),YI(n,i)}else n&&ss.delete(n),i(!1)})}function YI(n,t){let e=n[Wr]?.running;if(e){e.then(()=>{n[Wr].running=void 0,ss.delete(n),t(!0)});return}t(!1)}function ZI(n,t){let e=n.cleanup,i=t[Zo];if(e!==null)for(let s=0;s<e.length-1;s+=2)if(typeof e[s]=="string"){let a=e[s+3];a>=0?i[a]():i[-a].unsubscribe(),s+=2}else{let a=i[e[s+1]];e[s].call(a)}i!==null&&(t[Zo]=null);let r=t[Ti];if(r!==null){t[Ti]=null;for(let s=0;s<r.length;s++){let a=r[s];a()}}let o=t[ga];if(o!==null){t[ga]=null;for(let s of o)s.destroy()}}function JI(n,t){let e;if(n!=null&&(e=n.destroyHooks)!=null)for(let i=0;i<e.length;i+=2){let r=t[e[i]];if(!(r instanceof Yr)){let o=e[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){let a=r[o[s]],c=o[s+1];De(4,a,c);try{c.call(a)}finally{De(5,a,c)}}else{De(4,r,o);try{o.call(r)}finally{De(5,r,o)}}}}}function QI(n,t,e){return XI(n,t.parent,e)}function XI(n,t,e){let i=t;for(;i!==null&&i.type&168;)t=i,i=t.parent;if(i===null)return e[Bn];if(ki(i)){let{encapsulation:r}=n.data[i.directiveStart+i.componentOffset];if(r===Li.None||r===Li.Emulated)return null}return Cn(i,e)}function eT(n,t,e){return nT(n,t,e)}function tT(n,t,e){return n.type&40?Cn(n,e):null}var nT=tT,rb;function rg(n,t,e,i){let r=QI(n,i,t),o=t[Ae],s=i.parent||t[wn],a=eT(s,i,t);if(r!=null)if(Array.isArray(e))for(let c=0;c<e.length;c++)Jy(o,r,e[c],a,!1);else Jy(o,r,e,a,!1);rb!==void 0&&rb(o,i,t,e,r)}function Da(n,t){if(t!==null){let e=t.type;if(e&3)return Cn(t,n);if(e&4)return vm(-1,n[t.index]);if(e&8){let i=t.child;if(i!==null)return Da(n,i);{let r=n[t.index];return $n(r)?vm(-1,r):En(r)}}else{if(e&128)return Da(n,t.next);if(e&32)return Xm(t,n)()||En(n[t.index]);{let i=hw(n,t);if(i!==null){if(Array.isArray(i))return i[0];let r=rr(n[un]);return Da(r,i)}else return Da(n,t.next)}}}return null}function hw(n,t){if(t!==null){let i=n[un][wn],r=t.projection;return i.projection[r]}return null}function vm(n,t){let e=tt+n+1;if(e<t.length){let i=t[e],r=i[ne].firstChild;if(r!==null)return Da(i,r)}return t[lr]}function og(n,t,e,i,r,o,s){for(;e!=null;){let a=i[sr];if(e.type===128){e=e.next;continue}let c=i[e.index],f=e.type;if(s&&t===0&&(c&&os(En(c),i),e.flags|=2),!$m(e))if(f&8)og(n,t,e.child,i,r,o,!1),is(t,n,a,r,c,e,o,i);else if(f&32){let h=Xm(e,i),m;for(;m=h();)is(t,n,a,r,m,e,o,i);is(t,n,a,r,c,e,o,i)}else f&16?iT(n,t,i,e,r,o):is(t,n,a,r,c,e,o,i);e=s?e.projectionNext:e.next}}function qu(n,t,e,i,r,o){og(e,i,n.firstChild,t,r,o,!1)}function iT(n,t,e,i,r,o){let s=e[un],c=s[wn].projection[i.projection];if(Array.isArray(c))for(let f=0;f<c.length;f++){let h=c[f];is(t,n,e[sr],r,h,i,o,e)}else{let f=c,h=s[ot];Fb(i)&&(f.flags|=128),og(n,t,f,h,r,o,!0)}}function rT(n,t,e,i,r,o,s){let a=i[lr],c=En(i);a!==c&&is(t,n,e,o,a,r,s);for(let f=tt;f<i.length;f++){let h=i[f];qu(h[ne],h,n,t,o,a)}}function oT(n,t,e,i,r){if(t)r?n.addClass(e,i):n.removeClass(e,i);else{let o=i.indexOf("-")===-1?void 0:Kn.DashCase;r==null?n.removeStyle(e,i,o):(typeof r=="string"&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=Kn.Important),n.setStyle(e,i,r,o))}}function mw(n,t,e,i,r){let o=Hn(),s=i&2;try{cr(-1),s&&t.length>Ve&&sw(n,t,Ve,!1),De(s?2:0,r,e),e(i,r)}finally{cr(o),De(s?3:1,r,e)}}function Ku(n,t,e){dT(n,t,e),(e.flags&64)===64&&fT(n,t,e)}function Yu(n,t,e=Cn){let i=t.localNames;if(i!==null){let r=t.index+1;for(let o=0;o<i.length;o+=2){let s=i[o+1],a=s===-1?e(t,n):n[s];n[r++]=a}}}function sT(n,t,e,i){let o=i.get(Wb,Hb)||e===Li.ShadowDom,s=n.selectRootElement(t,o);return aT(s),s}function aT(n){lT(n)}var lT=()=>null;function cT(n){return n==="class"?"className":n==="for"?"htmlFor":n==="formaction"?"formAction":n==="innerHtml"?"innerHTML":n==="readonly"?"readOnly":n==="tabindex"?"tabIndex":n}function gw(n,t,e,i,r,o){let s=t[ne];if(Zu(n,s,t,e,i)){ki(n)&&vw(t,n.index);return}n.type&3&&(e=cT(e)),uT(n,t,e,i,r,o)}function uT(n,t,e,i,r,o){if(n.type&3){let s=Cn(n,t);i=o!=null?o(i,n.value||"",e):i,r.setProperty(s,e,i)}else n.type&12}function vw(n,t){let e=Sn(t,n);e[se]&16||(e[se]|=64)}function dT(n,t,e){let i=e.directiveStart,r=e.directiveEnd;ki(e)&&PI(t,e,n.data[i+e.componentOffset]),n.firstCreatePass||Cu(e,t);let o=e.initialInputs;for(let s=i;s<r;s++){let a=n.data[s],c=Ma(t,n,s,e);if(os(c,t),o!==null&&mT(t,s-i,c,a,e,o),ai(a)){let f=Sn(e.index,t);f[Je]=Ma(t,n,s,e)}}}function fT(n,t,e){let i=e.directiveStart,r=e.directiveEnd,o=e.index,s=Ny();try{cr(o);for(let a=i;a<r;a++){let c=n.data[a],f=t[a];ou(a),(c.hostBindings!==null||c.hostVars!==0||c.hostAttrs!==null)&&pT(c,f)}}finally{cr(-1),ou(s)}}function pT(n,t){n.hostBindings!==null&&n.hostBindings(1,t)}function sg(n,t){let e=n.directiveRegistry,i=null;if(e)for(let r=0;r<e.length;r++){let o=e[r];wI(t,o.selectors,!1)&&(i??=[],ai(o)?i.unshift(o):i.push(o))}return i}function hT(n,t,e,i,r,o){let s=Cn(n,t);_w(t[Ae],s,o,n.value,e,i,r)}function _w(n,t,e,i,r,o,s){if(o==null)n.removeAttribute(t,r,e);else{let a=s==null?Un(o):s(o,i||"",r);n.setAttribute(t,r,a,e)}}function mT(n,t,e,i,r,o){let s=o[t];if(s!==null)for(let a=0;a<s.length;a+=2){let c=s[a],f=s[a+1];hm(i,e,c,f)}}function yw(n,t,e,i,r){let o=Ve+e,s=t[ne],a=r(s,t,n,i,e);t[o]=a,ts(n,!0);let c=n.type===2;return c?(iw(t[Ae],a,n),(wy()===0||Qo(n))&&os(a,t),Ey()):os(a,t),cu()&&(!c||!$m(n))&&rg(s,t,a,n),n}function bw(n){let t=n;return Fh()?Ty():(t=t.parent,ts(t,!1)),t}function gT(n,t){let e=n[sr];if(!e)return;let i;try{i=e.get(Kt,null)}catch{i=null}i?.(t)}function Zu(n,t,e,i,r){let o=n.inputs?.[i],s=n.hostDirectiveInputs?.[i],a=!1;if(s)for(let c=0;c<s.length;c+=2){let f=s[c],h=s[c+1],m=t.data[f];hm(m,e[f],h,r),a=!0}if(o)for(let c of o){let f=e[c],h=t.data[c];hm(h,f,i,r),a=!0}return a}function vT(n,t){let e=Sn(t,n),i=e[ne];_T(i,e);let r=e[Bn];r!==null&&e[Yo]===null&&(e[Yo]=Gb(r,e[sr])),De(18),ag(i,e,e[Je]),De(19,e[Je])}function _T(n,t){for(let e=t.length;e<n.blueprint.length;e++)t.push(n.blueprint[e])}function ag(n,t,e){au(t);try{let i=n.viewQuery;i!==null&&pm(1,i,e);let r=n.template;r!==null&&mw(n,t,r,1,e),n.firstCreatePass&&(n.firstCreatePass=!1),t[oi]?.finishViewCreation(n),n.staticContentQueries&&qb(n,t),n.staticViewQueries&&pm(2,n.viewQuery,e);let o=n.components;o!==null&&yT(t,o)}catch(i){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),i}finally{t[se]&=-5,lu()}}function yT(n,t){for(let e=0;e<t.length;e++)vT(n,t[e])}function Ju(n,t,e,i){let r=oe(null);try{let o=t.tView,a=n[se]&4096?4096:16,c=Jm(n,o,e,a,null,t,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null),f=n[t.index];c[ar]=f;let h=n[oi];return h!==null&&(c[oi]=h.createEmbeddedView(o)),ag(o,c,e),c}finally{oe(r)}}function Aa(n,t){return!t||t.firstChild===null||Fb(n)}function Ra(n,t,e,i,r=!1){for(;e!==null;){if(e.type===128){e=r?e.projectionNext:e.next;continue}let o=t[e.index];o!==null&&i.push(En(o)),$n(o)&&ww(o,i);let s=e.type;if(s&8)Ra(n,t,e.child,i);else if(s&32){let a=Xm(e,t),c;for(;c=a();)i.push(c)}else if(s&16){let a=hw(t,e);if(Array.isArray(a))i.push(...a);else{let c=rr(t[un]);Ra(c[ne],c,a,i,!0)}}e=r?e.projectionNext:e.next}return i}function ww(n,t){for(let e=tt;e<n.length;e++){let i=n[e],r=i[ne].firstChild;r!==null&&Ra(i[ne],i,r,t)}n[lr]!==n[Bn]&&t.push(n[lr])}function Ew(n){if(n[Hr]!==null){for(let t of n[Hr])t.impl.addSequence(t);n[Hr].length=0}}var Cw=[];function bT(n){return n[dn]??wT(n)}function wT(n){let t=Cw.pop()??Object.create(CT);return t.lView=n,t}function ET(n){n.lView[dn]!==n&&(n.lView=null,Cw.push(n))}var CT=Y(P({},Oo),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{es(n.lView)},consumerOnSignalRead(){this.lView[dn]=this}});function ST(n){let t=n[dn]??Object.create(xT);return t.lView=n,t}var xT=Y(P({},Oo),{consumerIsAlwaysLive:!0,kind:"template",consumerMarkedDirty:n=>{let t=rr(n.lView);for(;t&&!Sw(t[ne]);)t=rr(t);t&&Rh(t)},consumerOnSignalRead(){this.lView[dn]=this}});function Sw(n){return n.type!==2}function xw(n){if(n[ga]===null)return;let t=!0;for(;t;){let e=!1;for(let i of n[ga])i.dirty&&(e=!0,i.zone===null||Zone.current===i.zone?i.run():i.zone.run(()=>i.run()));t=e&&!!(n[se]&8192)}}var DT=100;function Dw(n,t=0){let i=n[ri].rendererFactory,r=!1;r||i.begin?.();try{IT(n,t)}finally{r||i.end?.()}}function IT(n,t){let e=Lh();try{jh(!0),_m(n,t);let i=0;for(;ba(n);){if(i===DT)throw new F(103,!1);i++,_m(n,1)}}finally{jh(e)}}function TT(n,t,e,i){if(qr(t))return;let r=t[se],o=!1,s=!1;au(t);let a=!0,c=null,f=null;o||(Sw(n)?(f=bT(t),c=Po(f)):cc()===null?(a=!1,f=ST(t),c=Po(f)):t[dn]&&(ia(t[dn]),t[dn]=null));try{Ah(t),Ay(n.bindingStartIndex),e!==null&&mw(n,t,e,2,i);let h=(r&3)===3;if(!o)if(h){let g=n.preOrderCheckHooks;g!==null&&mu(t,g,null)}else{let g=n.preOrderHooks;g!==null&&gu(t,g,0,null),Zh(t,0)}if(s||MT(t),xw(t),Iw(t,0),n.contentQueries!==null&&qb(n,t),!o)if(h){let g=n.contentCheckHooks;g!==null&&mu(t,g)}else{let g=n.contentHooks;g!==null&&gu(t,g,1),Zh(t,1)}RT(n,t);let m=n.components;m!==null&&Mw(t,m,0);let y=n.viewQuery;if(y!==null&&pm(2,y,i),!o)if(h){let g=n.viewCheckHooks;g!==null&&mu(t,g)}else{let g=n.viewHooks;g!==null&&gu(t,g,2),Zh(t,2)}if(n.firstUpdatePass===!0&&(n.firstUpdatePass=!1),t[tu]){for(let g of t[tu])g();t[tu]=null}o||(Ew(t),t[se]&=-73)}catch(h){throw o||es(t),h}finally{f!==null&&(ta(f,c),a&&ET(f)),lu()}}function Iw(n,t){for(let e=jb(n);e!==null;e=Vb(e))for(let i=tt;i<e.length;i++){let r=e[i];Tw(r,t)}}function MT(n){for(let t=jb(n);t!==null;t=Vb(t)){if(!(t[se]&2))continue;let e=t[Gr];for(let i=0;i<e.length;i++){let r=e[i];Rh(r)}}}function AT(n,t,e){De(18);let i=Sn(t,n);Tw(i,e),De(19,i[Je])}function Tw(n,t){nu(n)&&_m(n,t)}function _m(n,t){let i=n[ne],r=n[se],o=n[dn],s=!!(t===0&&r&16);if(s||=!!(r&64&&t===0),s||=!!(r&1024),s||=!!(o?.dirty&&na(o)),s||=!1,o&&(o.dirty=!1),n[se]&=-9217,s)TT(i,n,i.template,n[Je]);else if(r&8192){let a=oe(null);try{xw(n),Iw(n,1);let c=i.components;c!==null&&Mw(n,c,1),Ew(n)}finally{oe(a)}}}function Mw(n,t,e){for(let i=0;i<t.length;i++)AT(n,t[i],e)}function RT(n,t){let e=n.hostBindingOpCodes;if(e!==null)try{for(let i=0;i<e.length;i++){let r=e[i];if(r<0)cr(~r);else{let o=r,s=e[++i],a=e[++i];Oy(s,o);let c=t[o];De(24,c),a(2,c),De(25,c)}}}finally{cr(-1)}}function lg(n,t){let e=Lh()?64:1088;for(n[ri].changeDetectionScheduler?.notify(t);n;){n[se]|=e;let i=rr(n);if(Xo(n)&&!i)return n;n=i}return null}function Aw(n,t,e,i){return[n,!0,0,t,null,i,null,e,null,null]}function Rw(n,t){let e=tt+t;if(e<n.length)return n[e]}function Qu(n,t,e,i=!0){let r=t[ne];if(OT(r,t,n,e),i){let s=vm(e,n),a=t[Ae],c=a.parentNode(n[lr]);c!==null&&qI(r,n[wn],a,t,c,s)}let o=t[Yo];o!==null&&o.firstChild!==null&&(o.firstChild=null)}function Ow(n,t){let e=Oa(n,t);return e!==void 0&&Gu(e[ne],e),e}function Oa(n,t){if(n.length<=tt)return;let e=tt+t,i=n[e];if(i){let r=i[ar];r!==null&&r!==n&&ig(r,i),t>0&&(n[e-1][bn]=i[bn]);let o=fa(n,tt+t);GI(i[ne],i);let s=o[oi];s!==null&&s.detachView(o[ne]),i[ot]=null,i[bn]=null,i[se]&=-129}return i}function OT(n,t,e,i){let r=tt+i,o=e.length;i>0&&(e[r-1][bn]=t),i<o-tt?(t[bn]=e[r],gh(e,tt+i,t)):(e.push(t),t[bn]=null),t[ot]=e;let s=t[ar];s!==null&&e!==s&&Nw(s,t);let a=t[oi];a!==null&&a.insertView(n),iu(t),t[se]|=128}function Nw(n,t){let e=n[Gr],i=t[ot];if(si(i))n[se]|=2;else{let r=i[ot][un];t[un]!==r&&(n[se]|=2)}e===null?n[Gr]=[t]:e.push(t)}var ur=class{_lView;_cdRefInjectingView;_appRef=null;_attachedToViewContainer=!1;exhaustive;get rootNodes(){let t=this._lView,e=t[ne];return Ra(e,t,e.firstChild,[])}constructor(t,e){this._lView=t,this._cdRefInjectingView=e}get context(){return this._lView[Je]}set context(t){this._lView[Je]=t}get destroyed(){return qr(this._lView)}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){let t=this._lView[ot];if($n(t)){let e=t[va],i=e?e.indexOf(this):-1;i>-1&&(Oa(t,i),fa(e,i))}this._attachedToViewContainer=!1}Gu(this._lView[ne],this._lView)}onDestroy(t){Oh(this._lView,t)}markForCheck(){lg(this._cdRefInjectingView||this._lView,4)}detach(){this._lView[se]&=-129}reattach(){iu(this._lView),this._lView[se]|=128}detectChanges(){this._lView[se]|=1024,Dw(this._lView)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new F(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null;let t=Xo(this._lView),e=this._lView[ar];e!==null&&!t&&ig(e,this._lView),pw(this._lView[ne],this._lView)}attachToAppRef(t){if(this._attachedToViewContainer)throw new F(902,!1);this._appRef=t;let e=Xo(this._lView),i=this._lView[ar];i!==null&&!e&&Nw(i,this._lView),iu(this._lView)}};var dr=(()=>{class n{_declarationLView;_declarationTContainer;elementRef;static __NG_ELEMENT_ID__=NT;constructor(e,i,r){this._declarationLView=e,this._declarationTContainer=i,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,i){return this.createEmbeddedViewImpl(e,i)}createEmbeddedViewImpl(e,i,r){let o=Ju(this._declarationLView,this._declarationTContainer,e,{embeddedViewInjector:i,dehydratedView:r});return new ur(o)}}return n})();function NT(){return Xu(ht(),ie())}function Xu(n,t){return n.type&4?new dr(t,n,ls(n,t)):null}function ed(n,t,e,i,r){let o=n.data[t];if(o===null)o=PT(n,t,e,i,r),Ry()&&(o.flags|=32);else if(o.type&64){o.type=e,o.value=i,o.attrs=r;let s=Iy();o.injectorIndex=s===null?-1:s.injectorIndex}return ts(o,!0),o}function PT(n,t,e,i,r){let o=kh(),s=Fh(),a=s?o:o&&o.parent,c=n.data[t]=FT(n,a,e,t,i,r);return kT(n,c,o,s),c}function kT(n,t,e,i){n.firstChild===null&&(n.firstChild=t),e!==null&&(i?e.child==null&&t.parent!==null&&(e.child=t):e.next===null&&(e.next=t,t.prev=e))}function FT(n,t,e,i,r,o){let s=t?t.injectorIndex:-1,a=0;return Sy()&&(a|=128),{type:e,index:i,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:null,inputs:null,hostDirectiveInputs:null,outputs:null,hostDirectiveOutputs:null,directiveToIndex:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}var G8=new RegExp(`^(\\d+)*(${oI}|${rI})*(.*)`);function LT(n){let t=n[Dh]??[],i=n[ot][Ae],r=[];for(let o of t)o.data[$b]!==void 0?r.push(o):jT(o,i);n[Dh]=r}function jT(n,t){let e=0,i=n.firstChild;if(i){let r=n.data[Bb];for(;e<r;){let o=i.nextSibling;nw(t,i,!1),i=o,e++}}}var VT=()=>null,zT=()=>null;function ym(n,t){return VT(n,t)}function Pw(n,t,e){return zT(n,t,e)}var kw=class{},td=class{},bm=class{resolveComponentFactory(t){throw new F(917,!1)}},Va=class{static NULL=new bm},Zr=class{},rn=(()=>{class n{destroyNode=null;static __NG_ELEMENT_ID__=()=>UT()}return n})();function UT(){let n=ie(),t=ht(),e=Sn(t.index,n);return(si(e)?e:n)[Ae]}var Fw=(()=>{class n{static \u0275prov=k({token:n,providedIn:"root",factory:()=>null})}return n})();var _u={},wm=class{injector;parentInjector;constructor(t,e){this.injector=t,this.parentInjector=e}get(t,e,i){let r=this.injector.get(t,_u,i);return r!==_u||e===_u?r:this.parentInjector.get(t,e,i)}};function ob(n,t,e){let i=e?n.styles:null,r=e?n.classes:null,o=0;if(t!==null)for(let s=0;s<t.length;s++){let a=t[s];if(typeof a=="number")o=a;else if(o==1)r=Yc(r,a);else if(o==2){let c=a,f=t[++s];i=Yc(i,c+": "+f+";")}}e?n.styles=i:n.stylesWithoutHost=i,e?n.classes=r:n.classesWithoutHost=r}function C(n,t=0){let e=ie();if(e===null)return L(n,t);let i=ht();return Nb(i,e,It(n),t)}function cg(){let n="invalid";throw new Error(n)}function Lw(n,t,e,i,r){let o=i===null?null:{"":-1},s=r(n,e);if(s!==null){let a=s,c=null,f=null;for(let h of s)if(h.resolveHostDirectives!==null){[a,c,f]=h.resolveHostDirectives(s);break}HT(n,t,e,a,o,c,f)}o!==null&&i!==null&&BT(e,i,o)}function BT(n,t,e){let i=n.localNames=[];for(let r=0;r<t.length;r+=2){let o=e[t[r+1]];if(o==null)throw new F(-301,!1);i.push(t[r],o)}}function $T(n,t,e){t.componentOffset=e,(n.components??=[]).push(t.index)}function HT(n,t,e,i,r,o,s){let a=i.length,c=!1;for(let y=0;y<a;y++){let g=i[y];!c&&ai(g)&&(c=!0,$T(n,e,y)),cm(Cu(e,t),n,g.type)}ZT(e,n.data.length,a);for(let y=0;y<a;y++){let g=i[y];g.providersResolver&&g.providersResolver(g)}let f=!1,h=!1,m=ow(n,t,a,null);a>0&&(e.directiveToIndex=new Map);for(let y=0;y<a;y++){let g=i[y];if(e.mergedAttrs=Ta(e.mergedAttrs,g.hostAttrs),GT(n,e,t,m,g),YT(m,g,r),s!==null&&s.has(g)){let[T,x]=s.get(g);e.directiveToIndex.set(g.type,[m,T+e.directiveStart,x+e.directiveStart])}else(o===null||!o.has(g))&&e.directiveToIndex.set(g.type,m);g.contentQueries!==null&&(e.flags|=4),(g.hostBindings!==null||g.hostAttrs!==null||g.hostVars!==0)&&(e.flags|=64);let w=g.type.prototype;!f&&(w.ngOnChanges||w.ngOnInit||w.ngDoCheck)&&((n.preOrderHooks??=[]).push(e.index),f=!0),!h&&(w.ngOnChanges||w.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(e.index),h=!0),m++}WT(n,e,o)}function WT(n,t,e){for(let i=t.directiveStart;i<t.directiveEnd;i++){let r=n.data[i];if(e===null||!e.has(r))sb(0,t,r,i),sb(1,t,r,i),lb(t,i,!1);else{let o=e.get(r);ab(0,t,o,i),ab(1,t,o,i),lb(t,i,!0)}}}function sb(n,t,e,i){let r=n===0?e.inputs:e.outputs;for(let o in r)if(r.hasOwnProperty(o)){let s;n===0?s=t.inputs??={}:s=t.outputs??={},s[o]??=[],s[o].push(i),jw(t,o)}}function ab(n,t,e,i){let r=n===0?e.inputs:e.outputs;for(let o in r)if(r.hasOwnProperty(o)){let s=r[o],a;n===0?a=t.hostDirectiveInputs??={}:a=t.hostDirectiveOutputs??={},a[s]??=[],a[s].push(i,o),jw(t,s)}}function jw(n,t){t==="class"?n.flags|=8:t==="style"&&(n.flags|=16)}function lb(n,t,e){let{attrs:i,inputs:r,hostDirectiveInputs:o}=n;if(i===null||!e&&r===null||e&&o===null||Ym(n)){n.initialInputs??=[],n.initialInputs.push(null);return}let s=null,a=0;for(;a<i.length;){let c=i[a];if(c===0){a+=4;continue}else if(c===5){a+=2;continue}else if(typeof c=="number")break;if(!e&&r.hasOwnProperty(c)){let f=r[c];for(let h of f)if(h===t){s??=[],s.push(c,i[a+1]);break}}else if(e&&o.hasOwnProperty(c)){let f=o[c];for(let h=0;h<f.length;h+=2)if(f[h]===t){s??=[],s.push(f[h+1],i[a+1]);break}}a+=2}n.initialInputs??=[],n.initialInputs.push(s)}function GT(n,t,e,i,r){n.data[i]=r;let o=r.factory||(r.factory=ir(r.type,!0)),s=new Yr(o,ai(r),C,null);n.blueprint[i]=s,e[i]=s,qT(n,t,i,ow(n,e,r.hostVars,gt),r)}function qT(n,t,e,i,r){let o=r.hostBindings;if(o){let s=n.hostBindingOpCodes;s===null&&(s=n.hostBindingOpCodes=[]);let a=~t.index;KT(s)!=a&&s.push(a),s.push(e,i,o)}}function KT(n){let t=n.length;for(;t>0;){let e=n[--t];if(typeof e=="number"&&e<0)return e}return 0}function YT(n,t,e){if(e){if(t.exportAs)for(let i=0;i<t.exportAs.length;i++)e[t.exportAs[i]]=n;ai(t)&&(e[""]=n)}}function ZT(n,t,e){n.flags|=1,n.directiveStart=t,n.directiveEnd=t+e,n.providerIndexes=t}function ug(n,t,e,i,r,o,s,a){let c=t[ne],f=c.consts,h=li(f,s),m=ed(c,n,e,i,h);return o&&Lw(c,t,m,li(f,a),r),m.mergedAttrs=Ta(m.mergedAttrs,m.attrs),m.attrs!==null&&ob(m,m.attrs,!1),m.mergedAttrs!==null&&ob(m,m.mergedAttrs,!0),c.queries!==null&&c.queries.elementStart(c,m),m}function dg(n,t){Sb(n,t),Ih(t)&&n.queries.elementEnd(t)}function fg(n){return nd(n)?Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n:!1}function Vw(n,t){if(Array.isArray(n))for(let e=0;e<n.length;e++)t(n[e]);else{let e=n[Symbol.iterator](),i;for(;!(i=e.next()).done;)t(i.value)}}function nd(n){return n!==null&&(typeof n=="function"||typeof n=="object")}function id(n,t,e){return n[t]=e}function JT(n,t){return n[t]}function nn(n,t,e){if(e===gt)return!1;let i=n[t];return Object.is(i,e)?!1:(n[t]=e,!0)}function pg(n,t,e,i){let r=nn(n,t,e);return nn(n,t+1,i)||r}function zw(n,t,e,i,r){let o=pg(n,t,e,i);return nn(n,t+2,r)||o}function Xh(n,t,e){return function i(r){let o=ki(n)?Sn(n.index,t):t;lg(o,5);let s=t[Je],a=cb(t,s,e,r),c=i.__ngNextListenerFn__;for(;c;)a=cb(t,s,c,r)&&a,c=c.__ngNextListenerFn__;return a}}function cb(n,t,e,i){let r=oe(null);try{return De(6,t,e),e(i)!==!1}catch(o){return gT(n,o),!1}finally{De(7,t,e),oe(r)}}function QT(n,t,e,i,r,o,s,a){let c=Qo(n),f=!1,h=null;if(!i&&c&&(h=eM(t,e,o,n.index)),h!==null){let m=h.__ngLastListenerFn__||h;m.__ngNextListenerFn__=s,h.__ngLastListenerFn__=s,f=!0}else{let m=Cn(n,e),y=i?i(m):m;aI(e,y,o,a);let g=r.listen(y,o,a);if(!XT(o)){let w=i?T=>i(En(T[n.index])):n.index;Uw(w,t,e,o,a,g,!1)}}return f}function XT(n){return n.startsWith("animation")||n.startsWith("transition")}function eM(n,t,e,i){let r=n.cleanup;if(r!=null)for(let o=0;o<r.length-1;o+=2){let s=r[o];if(s===e&&r[o+1]===i){let a=t[Zo],c=r[o+2];return a&&a.length>c?a[c]:null}typeof s=="string"&&(o+=2)}return null}function Uw(n,t,e,i,r,o,s){let a=t.firstCreatePass?Ph(t):null,c=Nh(e),f=c.length;c.push(r,o),a&&a.push(i,n,f,(f+1)*(s?-1:1))}function ub(n,t,e,i,r,o){let s=t[e],a=t[ne],f=a.data[e].outputs[i],m=s[f].subscribe(o);Uw(n.index,a,t,r,o,m,!0)}var Em=Symbol("BINDING");var Au=class extends Va{ngModule;constructor(t){super(),this.ngModule=t}resolveComponentFactory(t){let e=Pi(t);return new Jr(e,this.ngModule)}};function tM(n){return Object.keys(n).map(t=>{let[e,i,r]=n[t],o={propName:e,templateName:t,isSignal:(i&Hu.SignalBased)!==0};return r&&(o.transform=r),o})}function nM(n){return Object.keys(n).map(t=>({propName:n[t],templateName:t}))}function iM(n,t,e){let i=t instanceof Ze?t:t?.injector;return i&&n.getStandaloneInjector!==null&&(i=n.getStandaloneInjector(i)||i),i?new wm(e,i):e}function rM(n){let t=n.get(Zr,null);if(t===null)throw new F(407,!1);let e=n.get(Fw,null),i=n.get(Ai,null);return{rendererFactory:t,sanitizer:e,changeDetectionScheduler:i,ngReflect:!1}}function oM(n,t){let e=Bw(n);return ew(t,e,e==="svg"?hy:e==="math"?my:null)}function Bw(n){return(n.selectors[0][0]||"div").toLowerCase()}var Jr=class extends td{componentDef;ngModule;selector;componentType;ngContentSelectors;isBoundToModule;cachedInputs=null;cachedOutputs=null;get inputs(){return this.cachedInputs??=tM(this.componentDef.inputs),this.cachedInputs}get outputs(){return this.cachedOutputs??=nM(this.componentDef.outputs),this.cachedOutputs}constructor(t,e){super(),this.componentDef=t,this.ngModule=e,this.componentType=t.type,this.selector=xI(t.selectors),this.ngContentSelectors=t.ngContentSelectors??[],this.isBoundToModule=!!e}create(t,e,i,r,o,s){De(22);let a=oe(null);try{let c=this.componentDef,f=sM(i,c,s,o),h=iM(c,r||this.ngModule,t),m=rM(h),y=m.rendererFactory.createRenderer(null,c),g=i?sT(y,i,c.encapsulation,h):oM(c,y),w=s?.some(db)||o?.some(M=>typeof M!="function"&&M.bindings.some(db)),T=Jm(null,f,null,512|rw(c),null,null,m,y,h,null,Gb(g,h,!0));T[Ve]=g,au(T);let x=null;try{let M=ug(Ve,T,2,"#host",()=>f.directiveRegistry,!0,0);iw(y,g,M),os(g,T),Ku(f,T,M),Hm(f,M,T),dg(f,M),e!==void 0&&lM(M,this.ngContentSelectors,e),x=Sn(M.index,T),T[Je]=x[Je],ag(f,T,null)}catch(M){throw x!==null&&dm(x),dm(T),M}finally{De(23),lu()}return new Ru(this.componentType,T,!!w)}finally{oe(a)}}};function sM(n,t,e,i){let r=n?["ng-version","20.3.7"]:DI(t.selectors[0]),o=null,s=null,a=0;if(e)for(let h of e)a+=h[Em].requiredVars,h.create&&(h.targetIdx=0,(o??=[]).push(h)),h.update&&(h.targetIdx=0,(s??=[]).push(h));if(i)for(let h=0;h<i.length;h++){let m=i[h];if(typeof m!="function")for(let y of m.bindings){a+=y[Em].requiredVars;let g=h+1;y.create&&(y.targetIdx=g,(o??=[]).push(y)),y.update&&(y.targetIdx=g,(s??=[]).push(y))}}let c=[t];if(i)for(let h of i){let m=typeof h=="function"?h:h.type,y=bh(m);c.push(y)}return Zm(0,null,aM(o,s),1,a,c,null,null,null,[r],null)}function aM(n,t){return!n&&!t?null:e=>{if(e&1&&n)for(let i of n)i.create();if(e&2&&t)for(let i of t)i.update()}}function db(n){let t=n[Em].kind;return t==="input"||t==="twoWay"}var Ru=class extends kw{_rootLView;_hasInputBindings;instance;hostView;changeDetectorRef;componentType;location;previousInputValues=null;_tNode;constructor(t,e,i){super(),this._rootLView=e,this._hasInputBindings=i,this._tNode=_a(e[ne],Ve),this.location=ls(this._tNode,e),this.instance=Sn(this._tNode.index,e)[Je],this.hostView=this.changeDetectorRef=new ur(e,void 0),this.componentType=t}setInput(t,e){this._hasInputBindings;let i=this._tNode;if(this.previousInputValues??=new Map,this.previousInputValues.has(t)&&Object.is(this.previousInputValues.get(t),e))return;let r=this._rootLView,o=Zu(i,r[ne],r,t,e);this.previousInputValues.set(t,e);let s=Sn(i.index,r);lg(s,1)}get injector(){return new Kr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(t){this.hostView.onDestroy(t)}};function lM(n,t,e){let i=n.projection=[];for(let r=0;r<t.length;r++){let o=e[r];i.push(o!=null&&o.length?Array.from(o):null)}}var ji=(()=>{class n{static __NG_ELEMENT_ID__=cM}return n})();function cM(){let n=ht();return Hw(n,ie())}var uM=ji,$w=class extends uM{_lContainer;_hostTNode;_hostLView;constructor(t,e,i){super(),this._lContainer=t,this._hostTNode=e,this._hostLView=i}get element(){return ls(this._hostTNode,this._hostLView)}get injector(){return new Kr(this._hostTNode,this._hostLView)}get parentInjector(){let t=Vm(this._hostTNode,this._hostLView);if(Ib(t)){let e=wu(t,this._hostLView),i=bu(t),r=e[ne].data[i+8];return new Kr(r,e)}else return new Kr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(t){let e=fb(this._lContainer);return e!==null&&e[t]||null}get length(){return this._lContainer.length-tt}createEmbeddedView(t,e,i){let r,o;typeof i=="number"?r=i:i!=null&&(r=i.index,o=i.injector);let s=ym(this._lContainer,t.ssrId),a=t.createEmbeddedViewImpl(e||{},o,s);return this.insertImpl(a,r,Aa(this._hostTNode,s)),a}createComponent(t,e,i,r,o,s,a){let c=t&&!OD(t),f;if(c)f=e;else{let x=e||{};f=x.index,i=x.injector,r=x.projectableNodes,o=x.environmentInjector||x.ngModuleRef,s=x.directives,a=x.bindings}let h=c?t:new Jr(Pi(t)),m=i||this.parentInjector;if(!o&&h.ngModule==null){let M=(c?m:this.parentInjector).get(Ze,null);M&&(o=M)}let y=Pi(h.componentType??{}),g=ym(this._lContainer,y?.id??null),w=g?.firstChild??null,T=h.create(m,r,w,o,s,a);return this.insertImpl(T.hostView,f,Aa(this._hostTNode,g)),T}insert(t,e){return this.insertImpl(t,e,!0)}insertImpl(t,e,i){let r=t._lView;if(vy(r)){let a=this.indexOf(t);if(a!==-1)this.detach(a);else{let c=r[ot],f=new $w(c,c[wn],c[ot]);f.detach(f.indexOf(t))}}let o=this._adjustIndex(e),s=this._lContainer;return Qu(s,r,o,i),t.attachToViewContainerRef(),gh(em(s),o,t),t}move(t,e){return this.insert(t,e)}indexOf(t){let e=fb(this._lContainer);return e!==null?e.indexOf(t):-1}remove(t){let e=this._adjustIndex(t,-1),i=Oa(this._lContainer,e);i&&(fa(em(this._lContainer),e),Gu(i[ne],i))}detach(t){let e=this._adjustIndex(t,-1),i=Oa(this._lContainer,e);return i&&fa(em(this._lContainer),e)!=null?new ur(i):null}_adjustIndex(t,e=0){return t??this.length+e}};function fb(n){return n[va]}function em(n){return n[va]||(n[va]=[])}function Hw(n,t){let e,i=t[n.index];return $n(i)?e=i:(e=Aw(i,t,null,n),t[n.index]=e,Qm(t,e)),fM(e,t,n,i),new $w(e,n,t)}function dM(n,t){let e=n[Ae],i=e.createComment(""),r=Cn(t,n),o=e.parentNode(r);return Du(e,o,i,e.nextSibling(r),!1),i}var fM=mM,pM=()=>!1;function hM(n,t,e){return pM(n,t,e)}function mM(n,t,e,i){if(n[lr])return;let r;e.type&8?r=En(i):r=dM(t,e),n[lr]=r}var Cm=class n{queryList;matches=null;constructor(t){this.queryList=t}clone(){return new n(this.queryList)}setDirty(){this.queryList.setDirty()}},Sm=class n{queries;constructor(t=[]){this.queries=t}createEmbeddedView(t){let e=t.queries;if(e!==null){let i=t.contentQueries!==null?t.contentQueries[0]:e.length,r=[];for(let o=0;o<i;o++){let s=e.getByIndex(o),a=this.queries[s.indexInDeclarationView];r.push(a.clone())}return new n(r)}return null}insertView(t){this.dirtyQueriesWithMatches(t)}detachView(t){this.dirtyQueriesWithMatches(t)}finishViewCreation(t){this.dirtyQueriesWithMatches(t)}dirtyQueriesWithMatches(t){for(let e=0;e<this.queries.length;e++)hg(t,e).matches!==null&&this.queries[e].setDirty()}},Ou=class{flags;read;predicate;constructor(t,e,i=null){this.flags=e,this.read=i,typeof t=="string"?this.predicate=CM(t):this.predicate=t}},xm=class n{queries;constructor(t=[]){this.queries=t}elementStart(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(t,e)}elementEnd(t){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(t)}embeddedTView(t){let e=null;for(let i=0;i<this.length;i++){let r=e!==null?e.length:0,o=this.getByIndex(i).embeddedTView(t,r);o&&(o.indexInDeclarationView=i,e!==null?e.push(o):e=[o])}return e!==null?new n(e):null}template(t,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(t,e)}getByIndex(t){return this.queries[t]}get length(){return this.queries.length}track(t){this.queries.push(t)}},Dm=class n{metadata;matches=null;indexInDeclarationView=-1;crossesNgTemplate=!1;_declarationNodeIndex;_appliesToNextNode=!0;constructor(t,e=-1){this.metadata=t,this._declarationNodeIndex=e}elementStart(t,e){this.isApplyingToNode(e)&&this.matchTNode(t,e)}elementEnd(t){this._declarationNodeIndex===t.index&&(this._appliesToNextNode=!1)}template(t,e){this.elementStart(t,e)}embeddedTView(t,e){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,e),new n(this.metadata)):null}isApplyingToNode(t){if(this._appliesToNextNode&&(this.metadata.flags&1)!==1){let e=this._declarationNodeIndex,i=t.parent;for(;i!==null&&i.type&8&&i.index!==e;)i=i.parent;return e===(i!==null?i.index:-1)}return this._appliesToNextNode}matchTNode(t,e){let i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){let o=i[r];this.matchTNodeWithReadOption(t,e,gM(e,o)),this.matchTNodeWithReadOption(t,e,vu(e,t,o,!1,!1))}else i===dr?e.type&4&&this.matchTNodeWithReadOption(t,e,-1):this.matchTNodeWithReadOption(t,e,vu(e,t,i,!1,!1))}matchTNodeWithReadOption(t,e,i){if(i!==null){let r=this.metadata.read;if(r!==null)if(r===mt||r===ji||r===dr&&e.type&4)this.addMatch(e.index,-2);else{let o=vu(e,t,r,!1,!1);o!==null&&this.addMatch(e.index,o)}else this.addMatch(e.index,i)}}addMatch(t,e){this.matches===null?this.matches=[t,e]:this.matches.push(t,e)}};function gM(n,t){let e=n.localNames;if(e!==null){for(let i=0;i<e.length;i+=2)if(e[i]===t)return e[i+1]}return null}function vM(n,t){return n.type&11?ls(n,t):n.type&4?Xu(n,t):null}function _M(n,t,e,i){return e===-1?vM(t,n):e===-2?yM(n,t,i):Ma(n,n[ne],e,t)}function yM(n,t,e){if(e===mt)return ls(t,n);if(e===dr)return Xu(t,n);if(e===ji)return Hw(t,n)}function Ww(n,t,e,i){let r=t[oi].queries[i];if(r.matches===null){let o=n.data,s=e.matches,a=[];for(let c=0;s!==null&&c<s.length;c+=2){let f=s[c];if(f<0)a.push(null);else{let h=o[f];a.push(_M(t,h,s[c+1],e.metadata.read))}}r.matches=a}return r.matches}function Im(n,t,e,i){let r=n.queries.getByIndex(e),o=r.matches;if(o!==null){let s=Ww(n,t,r,e);for(let a=0;a<o.length;a+=2){let c=o[a];if(c>0)i.push(s[a/2]);else{let f=o[a+1],h=t[-c];for(let m=tt;m<h.length;m++){let y=h[m];y[ar]===y[ot]&&Im(y[ne],y,f,i)}if(h[Gr]!==null){let m=h[Gr];for(let y=0;y<m.length;y++){let g=m[y];Im(g[ne],g,f,i)}}}}}return i}function bM(n,t){return n[oi].queries[t].queryList}function Gw(n,t,e){let i=new Su((e&4)===4);return by(n,t,i,i.destroy),(t[oi]??=new Sm).queries.push(new Cm(i))-1}function wM(n,t,e){let i=ze();return i.firstCreatePass&&(qw(i,new Ou(n,t,e),-1),(t&2)===2&&(i.staticViewQueries=!0)),Gw(i,ie(),t)}function EM(n,t,e,i){let r=ze();if(r.firstCreatePass){let o=ht();qw(r,new Ou(t,e,i),o.index),SM(r,n),(e&2)===2&&(r.staticContentQueries=!0)}return Gw(r,ie(),e)}function CM(n){return n.split(",").map(t=>t.trim())}function qw(n,t,e){n.queries===null&&(n.queries=new xm),n.queries.track(new Dm(t,e))}function SM(n,t){let e=n.contentQueries||(n.contentQueries=[]),i=e.length?e[e.length-1]:-1;t!==i&&e.push(n.queries.length-1,t)}function hg(n,t){return n.queries.getByIndex(t)}function xM(n,t){let e=n[ne],i=hg(e,t);return i.crossesNgTemplate?Im(e,n,t,[]):Ww(e,n,i,t)}var Qr=class{},rd=class{};var Nu=class extends Qr{ngModuleType;_parent;_bootstrapComponents=[];_r3Injector;instance;destroyCbs=[];componentFactoryResolver=new Au(this);constructor(t,e,i,r=!0){super(),this.ngModuleType=t,this._parent=e;let o=yh(t);this._bootstrapComponents=Qb(o.bootstrap),this._r3Injector=$h(t,e,[{provide:Qr,useValue:this},{provide:Va,useValue:this.componentFactoryResolver},...i],Mi(t),new Set(["environment"])),r&&this.resolveInjectorInitializers()}resolveInjectorInitializers(){this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(this.ngModuleType)}get injector(){return this._r3Injector}destroy(){let t=this._r3Injector;!t.destroyed&&t.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(t){this.destroyCbs.push(t)}},Pu=class extends rd{moduleType;constructor(t){super(),this.moduleType=t}create(t){return new Nu(this.moduleType,t,[])}};var Na=class extends Qr{injector;componentFactoryResolver=new Au(this);instance=null;constructor(t){super();let e=new zr([...t.providers,{provide:Qr,useValue:this},{provide:Va,useValue:this.componentFactoryResolver}],t.parent||ha(),t.debugName,new Set(["environment"]));this.injector=e,t.runEnvironmentInitializers&&e.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(t){this.injector.onDestroy(t)}};function ds(n,t,e=null){return new Na({providers:n,parent:t,debugName:e,runEnvironmentInitializers:!0}).injector}var DM=(()=>{class n{_injector;cachedInjectors=new Map;constructor(e){this._injector=e}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e)){let i=wh(!1,e.type),r=i.length>0?ds([i],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e,r)}return this.cachedInjectors.get(e)}ngOnDestroy(){try{for(let e of this.cachedInjectors.values())e!==null&&e.destroy()}finally{this.cachedInjectors.clear()}}static \u0275prov=k({token:n,providedIn:"environment",factory:()=>new n(L(Ze))})}return n})();function ge(n){return ka(()=>{let t=Kw(n),e=Y(P({},t),{decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===zm.OnPush,directiveDefs:null,pipeDefs:null,dependencies:t.standalone&&n.dependencies||null,getStandaloneInjector:t.standalone?r=>r.get(DM).getOrCreateStandaloneInjector(e):null,getExternalStyles:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Li.Emulated,styles:n.styles||Gt,_:null,schemas:n.schemas||null,tView:null,id:""});t.standalone&&Yn("NgStandalone"),Yw(e);let i=n.dependencies;return e.directiveDefs=pb(i,IM),e.pipeDefs=pb(i,sy),e.id=AM(e),e})}function IM(n){return Pi(n)||bh(n)}function Dn(n){return ka(()=>({type:n.type,bootstrap:n.bootstrap||Gt,declarations:n.declarations||Gt,imports:n.imports||Gt,exports:n.exports||Gt,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function TM(n,t){if(n==null)return or;let e={};for(let i in n)if(n.hasOwnProperty(i)){let r=n[i],o,s,a,c;Array.isArray(r)?(a=r[0],o=r[1],s=r[2]??o,c=r[3]||null):(o=r,s=r,a=Hu.None,c=null),e[o]=[i,a,c],t[o]=s}return e}function MM(n){if(n==null)return or;let t={};for(let e in n)n.hasOwnProperty(e)&&(t[n[e]]=e);return t}function ye(n){return ka(()=>{let t=Kw(n);return Yw(t),t})}function fs(n){return{type:n.type,name:n.name,factory:null,pure:n.pure!==!1,standalone:n.standalone??!0,onDestroy:n.type.prototype.ngOnDestroy||null}}function Kw(n){let t={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:t,inputConfig:n.inputs||or,exportAs:n.exportAs||null,standalone:n.standalone??!0,signals:n.signals===!0,selectors:n.selectors||Gt,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,resolveHostDirectives:null,hostDirectives:null,inputs:TM(n.inputs,t),outputs:MM(n.outputs),debugInfo:null}}function Yw(n){n.features?.forEach(t=>t(n))}function pb(n,t){return n?()=>{let e=typeof n=="function"?n():n,i=[];for(let r of e){let o=t(r);o!==null&&i.push(o)}return i}:null}function AM(n){let t=0,e=typeof n.consts=="function"?"":n.consts,i=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,e,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery];for(let o of i.join("|"))t=Math.imul(31,t)+o.charCodeAt(0)<<0;return t+=2147483648,"c"+t}function RM(n){return Object.getPrototypeOf(n.prototype).constructor}function Qe(n){let t=RM(n.type),e=!0,i=[n];for(;t;){let r;if(ai(n))r=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new F(903,!1);r=t.\u0275dir}if(r){if(e){i.push(r);let s=n;s.inputs=tm(n.inputs),s.declaredInputs=tm(n.declaredInputs),s.outputs=tm(n.outputs);let a=r.hostBindings;a&&FM(n,a);let c=r.viewQuery,f=r.contentQueries;if(c&&PM(n,c),f&&kM(n,f),OM(n,r),Q_(n.outputs,r.outputs),ai(r)&&r.data.animation){let h=n.data;h.animation=(h.animation||[]).concat(r.data.animation)}}let o=r.features;if(o)for(let s=0;s<o.length;s++){let a=o[s];a&&a.ngInherit&&a(n),a===Qe&&(e=!1)}}t=Object.getPrototypeOf(t)}NM(i)}function OM(n,t){for(let e in t.inputs){if(!t.inputs.hasOwnProperty(e)||n.inputs.hasOwnProperty(e))continue;let i=t.inputs[e];i!==void 0&&(n.inputs[e]=i,n.declaredInputs[e]=t.declaredInputs[e])}}function NM(n){let t=0,e=null;for(let i=n.length-1;i>=0;i--){let r=n[i];r.hostVars=t+=r.hostVars,r.hostAttrs=Ta(r.hostAttrs,e=Ta(e,r.hostAttrs))}}function tm(n){return n===or?{}:n===Gt?[]:n}function PM(n,t){let e=n.viewQuery;e?n.viewQuery=(i,r)=>{t(i,r),e(i,r)}:n.viewQuery=t}function kM(n,t){let e=n.contentQueries;e?n.contentQueries=(i,r,o)=>{t(i,r,o),e(i,r,o)}:n.contentQueries=t}function FM(n,t){let e=n.hostBindings;e?n.hostBindings=(i,r)=>{t(i,r),e(i,r)}:n.hostBindings=t}function Zw(n,t,e,i,r,o,s,a){if(e.firstCreatePass){n.mergedAttrs=Ta(n.mergedAttrs,n.attrs);let h=n.tView=Zm(2,n,r,o,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,e.consts,null);e.queries!==null&&(e.queries.template(e,n),h.queries=e.queries.embeddedTView(n))}a&&(n.flags|=a),ts(n,!1);let c=jM(e,t,n,i);cu()&&rg(e,t,c,n),os(c,t);let f=Aw(c,t,c,n);t[i+Ve]=f,Qm(t,f),hM(f,n,t)}function LM(n,t,e,i,r,o,s,a,c,f,h){let m=e+Ve,y;return t.firstCreatePass?(y=ed(t,m,4,s||null,a||null),ru()&&Lw(t,n,y,li(t.consts,f),sg),Sb(t,y)):y=t.data[m],Zw(y,n,t,e,i,r,o,c),Qo(y)&&Ku(t,n,y),f!=null&&Yu(n,y,h),y}function ku(n,t,e,i,r,o,s,a,c,f,h){let m=e+Ve,y;if(t.firstCreatePass){if(y=ed(t,m,4,s||null,a||null),f!=null){let g=li(t.consts,f);y.localNames=[];for(let w=0;w<g.length;w+=2)y.localNames.push(g[w],-1)}}else y=t.data[m];return Zw(y,n,t,e,i,r,o,c),f!=null&&Yu(n,y,h),y}function E(n,t,e,i,r,o,s,a){let c=ie(),f=ze(),h=li(f.consts,o);return LM(c,f,n,t,e,i,r,h,void 0,s,a),E}var jM=VM;function VM(n,t,e,i){return Ca(!0),t[Ae].createComment("")}var mg=(()=>{class n{log(e){console.log(e)}warn(e){console.warn(e)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"platform"})}return n})();var gg=new U("");function fr(n){return!!n&&typeof n.then=="function"}function vg(n){return!!n&&typeof n.subscribe=="function"}var _g=new U("");function od(n){return ii([{provide:_g,multi:!0,useValue:n}])}var yg=(()=>{class n{resolve;reject;initialized=!1;done=!1;donePromise=new Promise((e,i)=>{this.resolve=e,this.reject=i});appInits=A(_g,{optional:!0})??[];injector=A(qt);constructor(){}runInitializers(){if(this.initialized)return;let e=[];for(let r of this.appInits){let o=pt(this.injector,r);if(fr(o))e.push(o);else if(vg(o)){let s=new Promise((a,c)=>{o.subscribe({complete:a,error:c})});e.push(s)}}let i=()=>{this.done=!0,this.resolve()};Promise.all(e).then(()=>{i()}).catch(r=>{this.reject(r)}),e.length===0&&i(),this.initialized=!0}static \u0275fac=function(i){return new(i||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),za=new U("");function Jw(){Dp(()=>{let n="";throw new F(600,n)})}function Qw(n){return n.isBoundToModule}var zM=10;var Vi=(()=>{class n{_runningTick=!1;_destroyed=!1;_destroyListeners=[];_views=[];internalErrorHandler=A(Kt);afterRenderManager=A(ng);zonelessEnabled=A(Sa);rootEffectScheduler=A(Yh);dirtyFlags=0;tracingSnapshot=null;allTestViews=new Set;autoDetectTestViews=new Set;includeAllTestViews=!1;afterTick=new Le;get allViews(){return[...(this.includeAllTestViews?this.allTestViews:this.autoDetectTestViews).keys(),...this._views]}get destroyed(){return this._destroyed}componentTypes=[];components=[];internalPendingTask=A(ci);get isStable(){return this.internalPendingTask.hasPendingTasksObservable.pipe(le(e=>!e))}constructor(){A(eo,{optional:!0})}whenStable(){let e;return new Promise(i=>{e=this.isStable.subscribe({next:r=>{r&&i()}})}).finally(()=>{e.unsubscribe()})}_injector=A(Ze);_rendererFactory=null;get injector(){return this._injector}bootstrap(e,i){return this.bootstrapImpl(e,i)}bootstrapImpl(e,i,r=qt.NULL){return this._injector.get(We).run(()=>{De(10);let s=e instanceof td;if(!this._injector.get(yg).done){let w="";throw new F(405,w)}let c;s?c=e:c=this._injector.get(Va).resolveComponentFactory(e),this.componentTypes.push(c.componentType);let f=Qw(c)?void 0:this._injector.get(Qr),h=i||c.selector,m=c.create(r,[],h,f),y=m.location.nativeElement,g=m.injector.get(gg,null);return g?.registerApplication(y),m.onDestroy(()=>{this.detachView(m.hostView),Ia(this.components,m),g?.unregisterApplication(y)}),this._loadComponent(m),De(11,m),m})}tick(){this.zonelessEnabled||(this.dirtyFlags|=1),this._tick()}_tick(){De(12),this.tracingSnapshot!==null?this.tracingSnapshot.run(Wu.CHANGE_DETECTION,this.tickImpl):this.tickImpl()}tickImpl=()=>{if(this._runningTick)throw new F(101,!1);let e=oe(null);try{this._runningTick=!0,this.synchronize()}finally{this._runningTick=!1,this.tracingSnapshot?.dispose(),this.tracingSnapshot=null,oe(e),this.afterTick.next(),De(13)}};synchronize(){this._rendererFactory===null&&!this._injector.destroyed&&(this._rendererFactory=this._injector.get(Zr,null,{optional:!0}));let e=0;for(;this.dirtyFlags!==0&&e++<zM;)De(14),this.synchronizeOnce(),De(15)}synchronizeOnce(){this.dirtyFlags&16&&(this.dirtyFlags&=-17,this.rootEffectScheduler.flush());let e=!1;if(this.dirtyFlags&7){let i=!!(this.dirtyFlags&1);this.dirtyFlags&=-8,this.dirtyFlags|=8;for(let{_lView:r}of this.allViews){if(!i&&!ba(r))continue;let o=i&&!this.zonelessEnabled?0:1;Dw(r,o),e=!0}if(this.dirtyFlags&=-5,this.syncDirtyFlagsWithViews(),this.dirtyFlags&23)return}e||(this._rendererFactory?.begin?.(),this._rendererFactory?.end?.()),this.dirtyFlags&8&&(this.dirtyFlags&=-9,this.afterRenderManager.execute()),this.syncDirtyFlagsWithViews()}syncDirtyFlagsWithViews(){if(this.allViews.some(({_lView:e})=>ba(e))){this.dirtyFlags|=2;return}else this.dirtyFlags&=-8}attachView(e){let i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){let i=e;Ia(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView);try{this.tick()}catch(r){this.internalErrorHandler(r)}this.components.push(e),this._injector.get(za,[]).forEach(r=>r(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy())}finally{this._destroyed=!0,this._views=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>Ia(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new F(406,!1);let e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}static \u0275fac=function(i){return new(i||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function Ia(n,t){let e=n.indexOf(t);e>-1&&n.splice(e,1)}function pn(n,t){let e=ie(),i=Fi();if(nn(e,i,t)){let r=ze(),o=Ea();if(Zu(o,r,e,n,t))ki(o)&&vw(e,o.index);else{let a=Cn(o,e);_w(e[Ae],a,null,o.value,n,t,null)}}return pn}function ps(n,t,e,i){let r=ie(),o=Fi();if(nn(r,o,t)){let s=ze(),a=Ea();hT(a,r,n,t,e,i)}return ps}var X8=typeof document<"u"&&typeof document?.documentElement?.getAnimations=="function";var Tm=class{destroy(t){}updateValue(t,e){}swap(t,e){let i=Math.min(t,e),r=Math.max(t,e),o=this.detach(r);if(r-i>1){let s=this.detach(i);this.attach(i,o),this.attach(r,s)}else this.attach(i,o)}move(t,e){this.attach(e,this.detach(t,!0))}};function nm(n,t,e,i,r){return n===e&&Object.is(t,i)?1:Object.is(r(n,t),r(e,i))?-1:0}function UM(n,t,e){let i,r,o=0,s=n.length-1,a=void 0;if(Array.isArray(t)){let c=t.length-1;for(;o<=s&&o<=c;){let f=n.at(o),h=t[o],m=nm(o,f,o,h,e);if(m!==0){m<0&&n.updateValue(o,h),o++;continue}let y=n.at(s),g=t[c],w=nm(s,y,c,g,e);if(w!==0){w<0&&n.updateValue(s,g),s--,c--;continue}let T=e(o,f),x=e(s,y),M=e(o,h);if(Object.is(M,x)){let X=e(c,g);Object.is(X,T)?(n.swap(o,s),n.updateValue(s,g),c--,s--):n.move(s,o),n.updateValue(o,h),o++;continue}if(i??=new Fu,r??=mb(n,o,s,e),Mm(n,i,o,M))n.updateValue(o,h),o++,s++;else if(r.has(M))i.set(T,n.detach(o)),s--;else{let X=n.create(o,t[o]);n.attach(o,X),o++,s++}}for(;o<=c;)hb(n,i,e,o,t[o]),o++}else if(t!=null){let c=t[Symbol.iterator](),f=c.next();for(;!f.done&&o<=s;){let h=n.at(o),m=f.value,y=nm(o,h,o,m,e);if(y!==0)y<0&&n.updateValue(o,m),o++,f=c.next();else{i??=new Fu,r??=mb(n,o,s,e);let g=e(o,m);if(Mm(n,i,o,g))n.updateValue(o,m),o++,s++,f=c.next();else if(!r.has(g))n.attach(o,n.create(o,m)),o++,s++,f=c.next();else{let w=e(o,h);i.set(w,n.detach(o)),s--}}}for(;!f.done;)hb(n,i,e,n.length,f.value),f=c.next()}for(;o<=s;)n.destroy(n.detach(s--));i?.forEach(c=>{n.destroy(c)})}function Mm(n,t,e,i){return t!==void 0&&t.has(i)?(n.attach(e,t.get(i)),t.delete(i),!0):!1}function hb(n,t,e,i,r){if(Mm(n,t,i,e(i,r)))n.updateValue(i,r);else{let o=n.create(i,r);n.attach(i,o)}}function mb(n,t,e,i){let r=new Set;for(let o=t;o<=e;o++)r.add(i(o,n.at(o)));return r}var Fu=class{kvMap=new Map;_vMap=void 0;has(t){return this.kvMap.has(t)}delete(t){if(!this.has(t))return!1;let e=this.kvMap.get(t);return this._vMap!==void 0&&this._vMap.has(e)?(this.kvMap.set(t,this._vMap.get(e)),this._vMap.delete(e)):this.kvMap.delete(t),!0}get(t){return this.kvMap.get(t)}set(t,e){if(this.kvMap.has(t)){let i=this.kvMap.get(t);this._vMap===void 0&&(this._vMap=new Map);let r=this._vMap;for(;r.has(i);)i=r.get(i);r.set(i,e)}else this.kvMap.set(t,e)}forEach(t){for(let[e,i]of this.kvMap)if(t(i,e),this._vMap!==void 0){let r=this._vMap;for(;r.has(i);)i=r.get(i),t(i,e)}}};function Z(n,t,e,i,r,o,s,a){Yn("NgControlFlow");let c=ie(),f=ze(),h=li(f.consts,o);return ku(c,f,n,t,e,i,r,h,256,s,a),bg}function bg(n,t,e,i,r,o,s,a){Yn("NgControlFlow");let c=ie(),f=ze(),h=li(f.consts,o);return ku(c,f,n,t,e,i,r,h,512,s,a),bg}function J(n,t){Yn("NgControlFlow");let e=ie(),i=Fi(),r=e[i]!==gt?e[i]:-1,o=r!==-1?Lu(e,Ve+r):void 0,s=0;if(nn(e,i,n)){let a=oe(null);try{if(o!==void 0&&Ow(o,s),n!==-1){let c=Ve+n,f=Lu(e,c),h=Nm(e[ne],c),m=Pw(f,h,e),y=Ju(e,h,t,{dehydratedView:m});Qu(f,y,s,Aa(h,m))}}finally{oe(a)}}else if(o!==void 0){let a=Rw(o,s);a!==void 0&&(a[Je]=t)}}var Am=class{lContainer;$implicit;$index;constructor(t,e,i){this.lContainer=t,this.$implicit=e,this.$index=i}get $count(){return this.lContainer.length-tt}};function wg(n){return n}function pr(n,t){return t}var Rm=class{hasEmptyBlock;trackByFn;liveCollection;constructor(t,e,i){this.hasEmptyBlock=t,this.trackByFn=e,this.liveCollection=i}};function vt(n,t,e,i,r,o,s,a,c,f,h,m,y){Yn("NgControlFlow");let g=ie(),w=ze(),T=c!==void 0,x=ie(),M=a?s.bind(x[un][Je]):s,X=new Rm(T,M);x[Ve+n]=X,ku(g,w,n+1,t,e,i,r,li(w.consts,o),256),T&&ku(g,w,n+2,c,f,h,m,li(w.consts,y),512)}var Om=class extends Tm{lContainer;hostLView;templateTNode;operationsCounter=void 0;needsIndexUpdate=!1;constructor(t,e,i){super(),this.lContainer=t,this.hostLView=e,this.templateTNode=i}get length(){return this.lContainer.length-tt}at(t){return this.getLView(t)[Je].$implicit}attach(t,e){let i=e[Yo];this.needsIndexUpdate||=t!==this.length,Qu(this.lContainer,e,t,Aa(this.templateTNode,i))}detach(t,e){return this.needsIndexUpdate||=t!==this.length-1,e&&BM(this.lContainer,t),$M(this.lContainer,t)}create(t,e){let i=ym(this.lContainer,this.templateTNode.tView.ssrId),r=Ju(this.hostLView,this.templateTNode,new Am(this.lContainer,e,t),{dehydratedView:i});return this.operationsCounter?.recordCreate(),r}destroy(t){Gu(t[ne],t),this.operationsCounter?.recordDestroy()}updateValue(t,e){this.getLView(t)[Je].$implicit=e}reset(){this.needsIndexUpdate=!1,this.operationsCounter?.reset()}updateIndexes(){if(this.needsIndexUpdate)for(let t=0;t<this.length;t++)this.getLView(t)[Je].$index=t}getLView(t){return HM(this.lContainer,t)}};function _t(n){let t=oe(null),e=Hn();try{let i=ie(),r=i[ne],o=i[e],s=e+1,a=Lu(i,s);if(o.liveCollection===void 0){let f=Nm(r,s);o.liveCollection=new Om(a,i,f)}else o.liveCollection.reset();let c=o.liveCollection;if(UM(c,n,o.trackByFn),c.updateIndexes(),o.hasEmptyBlock){let f=Fi(),h=c.length===0;if(nn(i,f,h)){let m=e+2,y=Lu(i,m);if(h){let g=Nm(r,m),w=Pw(y,g,i),T=Ju(i,g,void 0,{dehydratedView:w});Qu(y,T,0,Aa(g,w))}else r.firstUpdatePass&&LT(y),Ow(y,0)}}}finally{oe(t)}}function Lu(n,t){return n[t]}function BM(n,t){if(n.length<=tt)return;let e=tt+t,i=n[e];i&&i[Wr]&&(i[Wr].skipLeaveAnimations=!0)}function $M(n,t){return Oa(n,t)}function HM(n,t){return Rw(n,t)}function Nm(n,t){return _a(n,t)}function _(n,t,e){let i=ie(),r=Fi();if(nn(i,r,t)){let o=ze(),s=Ea();gw(s,i,n,t,i[Ae],e)}return _}function Pm(n,t,e,i,r){Zu(t,n,e,r?"class":"style",i)}function u(n,t,e,i){let r=ie(),o=r[ne],s=n+Ve,a=o.firstCreatePass?ug(s,r,2,t,sg,ru(),e,i):o.data[s];if(yw(a,r,n,t,WM),Qo(a)){let c=r[ne];Ku(c,r,a),Hm(c,a,r)}return i!=null&&Yu(r,a),u}function l(){let n=ze(),t=ht(),e=bw(t);return n.firstCreatePass&&dg(n,e),xy(e)&&Dy(),Cy(),e.classesWithoutHost!=null&&jD(e)&&Pm(n,e,ie(),e.classesWithoutHost,!0),e.stylesWithoutHost!=null&&VD(e)&&Pm(n,e,ie(),e.stylesWithoutHost,!1),l}function N(n,t,e,i){return u(n,t,e,i),l(),N}var WM=(n,t,e,i,r)=>(Ca(!0),ew(t[Ae],i,Vy()));function hn(n,t,e){let i=ie(),r=i[ne],o=n+Ve,s=r.firstCreatePass?ug(o,i,8,"ng-container",sg,ru(),t,e):r.data[o];if(yw(s,i,n,"ng-container",GM),Qo(s)){let a=i[ne];Ku(a,i,s),Hm(a,s,i)}return e!=null&&Yu(i,s),hn}function mn(){let n=ze(),t=ht(),e=bw(t);return n.firstCreatePass&&dg(n,e),mn}var GM=(n,t,e,i,r)=>(Ca(!0),MI(t[Ae],""));function j(){return ie()}var pu=void 0;function qM(n){let t=Math.floor(Math.abs(n)),e=n.toString().replace(/^[^.]*\.?/,"").length;return t===1&&e===0?1:5}var KM=["en",[["a","p"],["AM","PM"]],[["AM","PM"]],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],pu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],pu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",pu,"{1} 'at' {0}",pu],[".",",",";","%","+","-","E","\xD7","\u2030","\u221E","NaN",":"],["#,##0.###","#,##0%","\xA4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",qM],im={};function on(n){let t=YM(n),e=gb(t);if(e)return e;let i=t.split("-")[0];if(e=gb(i),e)return e;if(i==="en")return KM;throw new F(701,!1)}function gb(n){return n in im||(im[n]=Oi.ng&&Oi.ng.common&&Oi.ng.common.locales&&Oi.ng.common.locales[n]),im[n]}var Ge=(function(n){return n[n.LocaleId=0]="LocaleId",n[n.DayPeriodsFormat=1]="DayPeriodsFormat",n[n.DayPeriodsStandalone=2]="DayPeriodsStandalone",n[n.DaysFormat=3]="DaysFormat",n[n.DaysStandalone=4]="DaysStandalone",n[n.MonthsFormat=5]="MonthsFormat",n[n.MonthsStandalone=6]="MonthsStandalone",n[n.Eras=7]="Eras",n[n.FirstDayOfWeek=8]="FirstDayOfWeek",n[n.WeekendRange=9]="WeekendRange",n[n.DateFormat=10]="DateFormat",n[n.TimeFormat=11]="TimeFormat",n[n.DateTimeFormat=12]="DateTimeFormat",n[n.NumberSymbols=13]="NumberSymbols",n[n.NumberFormats=14]="NumberFormats",n[n.CurrencyCode=15]="CurrencyCode",n[n.CurrencySymbol=16]="CurrencySymbol",n[n.CurrencyName=17]="CurrencyName",n[n.Currencies=18]="Currencies",n[n.Directionality=19]="Directionality",n[n.PluralCase=20]="PluralCase",n[n.ExtraData=21]="ExtraData",n})(Ge||{});function YM(n){return n.toLowerCase().replace(/_/g,"-")}var Ua="en-US";var ZM=Ua;function Xw(n){typeof n=="string"&&(ZM=n.toLowerCase().replace(/_/g,"-"))}function S(n,t,e){let i=ie(),r=ze(),o=ht();return eE(r,i,i[Ae],o,n,t,e),S}function eE(n,t,e,i,r,o,s){let a=!0,c=null;if((i.type&3||s)&&(c??=Xh(i,t,o),QT(i,n,t,s,e,r,o,c)&&(a=!1)),a){let f=i.outputs?.[r],h=i.hostDirectiveOutputs?.[r];if(h&&h.length)for(let m=0;m<h.length;m+=2){let y=h[m],g=h[m+1];c??=Xh(i,t,o),ub(i,t,y,g,r,c)}if(f&&f.length)for(let m of f)c??=Xh(i,t,o),ub(i,t,m,r,r,c)}}function v(n=1){return jy(n)}function Eg(n,t,e,i){EM(n,t,e,i)}function Cg(n,t,e){wM(n,t,e)}function Ba(n){let t=ie(),e=ze(),i=zh();su(i+1);let r=hg(e,i);if(n.dirty&&gy(t)===((r.metadata.flags&2)===2)){if(r.matches===null)n.reset([]);else{let o=xM(t,i);n.reset(o,QD),n.notifyOnChanges()}return!0}return!1}function $a(){return bM(ie(),zh())}function zi(n){let t=My();return ya(t,Ve+n)}function hu(n,t){return n<<17|t<<2}function Xr(n){return n>>17&32767}function JM(n){return(n&2)==2}function QM(n,t){return n&131071|t<<17}function km(n){return n|2}function as(n){return(n&131068)>>2}function rm(n,t){return n&-131069|t<<2}function XM(n){return(n&1)===1}function Fm(n){return n|1}function eA(n,t,e,i,r,o){let s=o?t.classBindings:t.styleBindings,a=Xr(s),c=as(s);n[i]=e;let f=!1,h;if(Array.isArray(e)){let m=e;h=m[1],(h===null||Ko(m,h)>0)&&(f=!0)}else h=e;if(r)if(c!==0){let y=Xr(n[a+1]);n[i+1]=hu(y,a),y!==0&&(n[y+1]=rm(n[y+1],i)),n[a+1]=QM(n[a+1],i)}else n[i+1]=hu(a,0),a!==0&&(n[a+1]=rm(n[a+1],i)),a=i;else n[i+1]=hu(c,0),a===0?a=i:n[c+1]=rm(n[c+1],i),c=i;f&&(n[i+1]=km(n[i+1])),vb(n,h,i,!0),vb(n,h,i,!1),tA(t,h,n,i,o),s=hu(a,c),o?t.classBindings=s:t.styleBindings=s}function tA(n,t,e,i,r){let o=r?n.residualClasses:n.residualStyles;o!=null&&typeof t=="string"&&Ko(o,t)>=0&&(e[i+1]=Fm(e[i+1]))}function vb(n,t,e,i){let r=n[e+1],o=t===null,s=i?Xr(r):as(r),a=!1;for(;s!==0&&(a===!1||o);){let c=n[s],f=n[s+1];nA(c,t)&&(a=!0,n[s+1]=i?Fm(f):km(f)),s=i?Xr(f):as(f)}a&&(n[e+1]=i?km(r):Fm(r))}function nA(n,t){return n===null||t==null||(Array.isArray(n)?n[1]:n)===t?!0:Array.isArray(n)&&typeof t=="string"?Ko(n,t)>=0:!1}var qn={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function iA(n){return n.substring(qn.key,qn.keyEnd)}function rA(n){return oA(n),tE(n,nE(n,0,qn.textEnd))}function tE(n,t){let e=qn.textEnd;return e===t?-1:(t=qn.keyEnd=sA(n,qn.key=t,e),nE(n,t,e))}function oA(n){qn.key=0,qn.keyEnd=0,qn.value=0,qn.valueEnd=0,qn.textEnd=n.length}function nE(n,t,e){for(;t<e&&n.charCodeAt(t)<=32;)t++;return t}function sA(n,t,e){for(;t<e&&n.charCodeAt(t)>32;)t++;return t}function di(n,t,e){return iE(n,t,e,!1),di}function we(n,t){return iE(n,t,null,!0),we}function hr(n){lA(hA,aA,n,!0)}function aA(n,t){for(let e=rA(t);e>=0;e=tE(t,e))Xc(n,iA(t),!0)}function iE(n,t,e,i){let r=ie(),o=ze(),s=wa(2);if(o.firstUpdatePass&&oE(o,n,s,i),t!==gt&&nn(r,s,t)){let a=o.data[Hn()];sE(o,a,r,r[Ae],n,r[s+1]=gA(t,e),i,s)}}function lA(n,t,e,i){let r=ze(),o=wa(2);r.firstUpdatePass&&oE(r,null,o,i);let s=ie();if(e!==gt&&nn(s,o,e)){let a=r.data[Hn()];if(aE(a,i)&&!rE(r,o)){let c=i?a.classesWithoutHost:a.stylesWithoutHost;c!==null&&(e=Yc(c,e||"")),Pm(r,a,s,e,i)}else mA(r,a,s,s[Ae],s[o+1],s[o+1]=pA(n,t,e),i,o)}}function rE(n,t){return t>=n.expandoStartIndex}function oE(n,t,e,i){let r=n.data;if(r[e+1]===null){let o=r[Hn()],s=rE(n,e);aE(o,i)&&t===null&&!s&&(t=!1),t=cA(r,o,t,i),eA(r,o,t,e,s,i)}}function cA(n,t,e,i){let r=Py(n),o=i?t.residualClasses:t.residualStyles;if(r===null)(i?t.classBindings:t.styleBindings)===0&&(e=om(null,n,t,e,i),e=Pa(e,t.attrs,i),o=null);else{let s=t.directiveStylingLast;if(s===-1||n[s]!==r)if(e=om(r,n,t,e,i),o===null){let c=uA(n,t,i);c!==void 0&&Array.isArray(c)&&(c=om(null,n,t,c[1],i),c=Pa(c,t.attrs,i),dA(n,t,i,c))}else o=fA(n,t,i)}return o!==void 0&&(i?t.residualClasses=o:t.residualStyles=o),e}function uA(n,t,e){let i=e?t.classBindings:t.styleBindings;if(as(i)!==0)return n[Xr(i)]}function dA(n,t,e,i){let r=e?t.classBindings:t.styleBindings;n[Xr(r)]=i}function fA(n,t,e){let i,r=t.directiveEnd;for(let o=1+t.directiveStylingLast;o<r;o++){let s=n[o].hostAttrs;i=Pa(i,s,e)}return Pa(i,t.attrs,e)}function om(n,t,e,i,r){let o=null,s=e.directiveEnd,a=e.directiveStylingLast;for(a===-1?a=e.directiveStart:a++;a<s&&(o=t[a],i=Pa(i,o.hostAttrs,r),o!==n);)a++;return n!==null&&(e.directiveStylingLast=a),i}function Pa(n,t,e){let i=e?1:2,r=-1;if(t!==null)for(let o=0;o<t.length;o++){let s=t[o];typeof s=="number"?r=s:r===i&&(Array.isArray(n)||(n=n===void 0?[]:["",n]),Xc(n,s,e?!0:t[++o]))}return n===void 0?null:n}function pA(n,t,e){if(e==null||e==="")return Gt;let i=[],r=us(e);if(Array.isArray(r))for(let o=0;o<r.length;o++)n(i,r[o],!0);else if(typeof r=="object")for(let o in r)r.hasOwnProperty(o)&&n(i,o,r[o]);else typeof r=="string"&&t(i,r);return i}function hA(n,t,e){let i=String(t);i!==""&&!i.includes(" ")&&Xc(n,i,e)}function mA(n,t,e,i,r,o,s,a){r===gt&&(r=Gt);let c=0,f=0,h=0<r.length?r[0]:null,m=0<o.length?o[0]:null;for(;h!==null||m!==null;){let y=c<r.length?r[c+1]:void 0,g=f<o.length?o[f+1]:void 0,w=null,T;h===m?(c+=2,f+=2,y!==g&&(w=m,T=g)):m===null||h!==null&&h<m?(c+=2,w=h):(f+=2,w=m,T=g),w!==null&&sE(n,t,e,i,w,T,s,a),h=c<r.length?r[c]:null,m=f<o.length?o[f]:null}}function sE(n,t,e,i,r,o,s,a){if(!(t.type&3))return;let c=n.data,f=c[a+1],h=XM(f)?_b(c,t,e,r,as(f),s):void 0;if(!ju(h)){ju(o)||JM(f)&&(o=_b(c,null,e,r,a,s));let m=Th(Hn(),e);oT(i,s,m,r,o)}}function _b(n,t,e,i,r,o){let s=t===null,a;for(;r>0;){let c=n[r],f=Array.isArray(c),h=f?c[1]:c,m=h===null,y=e[r+1];y===gt&&(y=m?Gt:void 0);let g=m?eu(y,i):h===i?y:void 0;if(f&&!ju(g)&&(g=eu(c,i)),ju(g)&&(a=g,s))return a;let w=n[r+1];r=s?Xr(w):as(w)}if(t!==null){let c=o?t.residualClasses:t.residualStyles;c!=null&&(a=eu(c,i))}return a}function ju(n){return n!==void 0}function gA(n,t){return n==null||n===""||(typeof t=="string"?n=n+t:typeof n=="object"&&(n=Mi(us(n)))),n}function aE(n,t){return(n.flags&(t?8:16))!==0}function d(n,t=""){let e=ie(),i=ze(),r=n+Ve,o=i.firstCreatePass?ed(i,r,1,t,null):i.data[r],s=vA(i,e,o,t,n);e[r]=s,cu()&&rg(i,e,s,o),ts(o,!1)}var vA=(n,t,e,i,r)=>(Ca(!0),II(t[Ae],i));function lE(n,t,e,i=""){return nn(n,Fi(),e)?t+Un(e)+i:gt}function _A(n,t,e,i,r,o=""){let s=Vh(),a=pg(n,s,e,r);return wa(2),a?t+Un(e)+i+Un(r)+o:gt}function yA(n,t,e,i,r,o,s,a=""){let c=Vh(),f=zw(n,c,e,r,s);return wa(3),f?t+Un(e)+i+Un(r)+o+Un(s)+a:gt}function R(n){return O("",n),R}function O(n,t,e){let i=ie(),r=lE(i,n,t,e);return r!==gt&&Sg(i,Hn(),r),O}function be(n,t,e,i,r){let o=ie(),s=_A(o,n,t,e,i,r);return s!==gt&&Sg(o,Hn(),s),be}function sd(n,t,e,i,r,o,s){let a=ie(),c=yA(a,n,t,e,i,r,o,s);return c!==gt&&Sg(a,Hn(),c),sd}function Sg(n,t,e){let i=Th(t,n);TI(n[Ae],i,e)}function W(n,t,e){Gh(t)&&(t=t());let i=ie(),r=Fi();if(nn(i,r,t)){let o=ze(),s=Ea();gw(s,i,n,t,i[Ae],e)}return W}function q(n,t){let e=Gh(n);return e&&n.set(t),e}function G(n,t){let e=ie(),i=ze(),r=ht();return eE(i,e,e[Ae],r,n,t),G}function mr(n){return nn(ie(),Fi(),n)?Un(n):gt}function Ha(n,t,e=""){return lE(ie(),n,t,e)}function bA(n,t,e){let i=ze();if(i.firstCreatePass){let r=ai(n);Lm(e,i.data,i.blueprint,r,!0),Lm(t,i.data,i.blueprint,r,!1)}}function Lm(n,t,e,i,r){if(n=It(n),Array.isArray(n))for(let o=0;o<n.length;o++)Lm(n[o],t,e,i,r);else{let o=ze(),s=ie(),a=ht(),c=Vr(n)?n:It(n.provide),f=Ch(n),h=a.providerIndexes&1048575,m=a.directiveStart,y=a.providerIndexes>>20;if(Vr(n)||!n.multi){let g=new Yr(f,r,C,null),w=am(c,t,r?h:h+y,m);w===-1?(cm(Cu(a,s),o,c),sm(o,n,t.length),t.push(c),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),e.push(g),s.push(g)):(e[w]=g,s[w]=g)}else{let g=am(c,t,h+y,m),w=am(c,t,h,h+y),T=g>=0&&e[g],x=w>=0&&e[w];if(r&&!x||!r&&!T){cm(Cu(a,s),o,c);let M=CA(r?EA:wA,e.length,r,i,f,n);!r&&x&&(e[w].providerFactory=M),sm(o,n,t.length,0),t.push(c),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),e.push(M),s.push(M)}else{let M=cE(e[r?w:g],f,!r&&i);sm(o,n,g>-1?g:w,M)}!r&&i&&x&&e[w].componentProviders++}}}function sm(n,t,e,i){let r=Vr(t),o=dy(t);if(r||o){let c=(o?It(t.useClass):t).prototype.ngOnDestroy;if(c){let f=n.destroyHooks||(n.destroyHooks=[]);if(!r&&t.multi){let h=f.indexOf(e);h===-1?f.push(e,[i,c]):f[h+1].push(i,c)}else f.push(e,c)}}}function cE(n,t,e){return e&&n.componentProviders++,n.multi.push(t)-1}function am(n,t,e,i){for(let r=e;r<i;r++)if(t[r]===n)return r;return-1}function wA(n,t,e,i,r){return jm(this.multi,[])}function EA(n,t,e,i,r){let o=this.multi,s;if(this.providerFactory){let a=this.providerFactory.componentProviders,c=Ma(i,i[ne],this.providerFactory.index,r);s=c.slice(0,a),jm(o,s);for(let f=a;f<c.length;f++)s.push(c[f])}else s=[],jm(o,s);return s}function jm(n,t){for(let e=0;e<n.length;e++){let i=n[e];t.push(i())}return t}function CA(n,t,e,i,r,o){let s=new Yr(n,e,C,null);return s.multi=[],s.index=t,s.componentProviders=0,cE(s,r,i&&!e),s}function kt(n,t=[]){return e=>{e.providersResolver=(i,r)=>bA(i,r?r(n):n,t)}}function yt(n,t,e){let i=ns()+n,r=ie();return r[i]===gt?id(r,i,e?t.call(e):t()):JT(r,i)}function xg(n,t,e,i){return uE(ie(),ns(),n,t,e,i)}function Dg(n,t){let e=n[t];return e===gt?void 0:e}function uE(n,t,e,i,r,o){let s=t+e;return nn(n,s,r)?id(n,s+1,o?i.call(o,r):i(r)):Dg(n,s+1)}function SA(n,t,e,i,r,o,s){let a=t+e;return pg(n,a,r,o)?id(n,a+2,s?i.call(s,r,o):i(r,o)):Dg(n,a+2)}function xA(n,t,e,i,r,o,s,a){let c=t+e;return zw(n,c,r,o,s)?id(n,c+3,a?i.call(a,r,o,s):i(r,o,s)):Dg(n,c+3)}function K(n,t){let e=ze(),i,r=n+Ve;e.firstCreatePass?(i=DA(t,e.pipeRegistry),e.data[r]=i,i.onDestroy&&(e.destroyHooks??=[]).push(r,i.onDestroy)):i=e.data[r];let o=i.factory||(i.factory=ir(i.type,!0)),s,a=Wt(C);try{let c=Eu(!1),f=o();return Eu(c),Mh(e,ie(),r,f),f}finally{Wt(a)}}function DA(n,t){if(t)for(let e=t.length-1;e>=0;e--){let i=t[e];if(n===i.name)return i}}function Ui(n,t,e){let i=n+Ve,r=ie(),o=ya(r,i);return Tg(r,i)?uE(r,ns(),t,o.transform,e,o):o.transform(e)}function te(n,t,e,i){let r=n+Ve,o=ie(),s=ya(o,r);return Tg(o,r)?SA(o,ns(),t,s.transform,e,i,s):s.transform(e,i)}function Ig(n,t,e,i,r){let o=n+Ve,s=ie(),a=ya(s,o);return Tg(s,o)?xA(s,ns(),t,a.transform,e,i,r,a):a.transform(e,i,r)}function Tg(n,t){return n[ne].data[t].pure}function to(n,t){return Xu(n,t)}var Vu=class{ngModuleFactory;componentFactories;constructor(t,e){this.ngModuleFactory=t,this.componentFactories=e}},Mg=(()=>{class n{compileModuleSync(e){return new Pu(e)}compileModuleAsync(e){return Promise.resolve(this.compileModuleSync(e))}compileModuleAndAllComponentsSync(e){let i=this.compileModuleSync(e),r=yh(e),o=Qb(r.declarations).reduce((s,a)=>{let c=Pi(a);return c&&s.push(new Jr(c)),s},[]);return new Vu(i,o)}compileModuleAndAllComponentsAsync(e){return Promise.resolve(this.compileModuleAndAllComponentsSync(e))}clearCache(){}clearCacheFor(e){}getModuleId(e){}static \u0275fac=function(i){return new(i||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var IA=(()=>{class n{zone=A(We);changeDetectionScheduler=A(Ai);applicationRef=A(Vi);applicationErrorHandler=A(Kt);_onMicrotaskEmptySubscription;initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.changeDetectionScheduler.runningTick||this.zone.run(()=>{try{this.applicationRef.dirtyFlags|=1,this.applicationRef._tick()}catch(e){this.applicationErrorHandler(e)}})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),dE=new U("",{factory:()=>!1});function Ag({ngZoneFactory:n,ignoreChangesOutsideZone:t,scheduleInRootZone:e}){return n??=()=>new We(Y(P({},Og()),{scheduleInRootZone:e})),[{provide:We,useFactory:n},{provide:Ni,multi:!0,useFactory:()=>{let i=A(IA,{optional:!0});return()=>i.initialize()}},{provide:Ni,multi:!0,useFactory:()=>{let i=A(TA);return()=>{i.initialize()}}},t===!0?{provide:qh,useValue:!0}:[],{provide:Kh,useValue:e??aw},{provide:Kt,useFactory:()=>{let i=A(We),r=A(Ze),o;return s=>{i.runOutsideAngular(()=>{r.destroyed&&!o?setTimeout(()=>{throw s}):(o??=r.get(zn),o.handleError(s))})}}}]}function Rg(n){let t=n?.ignoreChangesOutsideZone,e=n?.scheduleInRootZone,i=Ag({ngZoneFactory:()=>{let r=Og(n);return r.scheduleInRootZone=e,r.shouldCoalesceEventChangeDetection&&Yn("NgZone_CoalesceEvent"),new We(r)},ignoreChangesOutsideZone:t,scheduleInRootZone:e});return ii([{provide:dE,useValue:!0},{provide:Sa,useValue:!1},i])}function Og(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}var TA=(()=>{class n{subscription=new He;initialized=!1;zone=A(We);pendingTasks=A(ci);initialize(){if(this.initialized)return;this.initialized=!0;let e=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(e=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{We.assertNotInAngularZone(),queueMicrotask(()=>{e!==null&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(e),e=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{We.assertInAngularZone(),e??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(i){return new(i||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var fE=(()=>{class n{applicationErrorHandler=A(Kt);appRef=A(Vi);taskService=A(ci);ngZone=A(We);zonelessEnabled=A(Sa);tracing=A(eo,{optional:!0});disableScheduling=A(qh,{optional:!0})??!1;zoneIsDefined=typeof Zone<"u"&&!!Zone.root.run;schedulerTickApplyArgs=[{data:{__scheduler_tick__:!0}}];subscriptions=new He;angularZoneId=this.zoneIsDefined?this.ngZone._inner?.get(Iu):null;scheduleInRootZone=!this.zonelessEnabled&&this.zoneIsDefined&&(A(Kh,{optional:!0})??!1);cancelScheduledCallback=null;useMicrotaskScheduler=!1;runningTick=!1;pendingRenderTaskId=null;constructor(){this.subscriptions.add(this.appRef.afterTick.subscribe(()=>{this.runningTick||this.cleanup()})),this.subscriptions.add(this.ngZone.onUnstable.subscribe(()=>{this.runningTick||this.cleanup()})),this.disableScheduling||=!this.zonelessEnabled&&(this.ngZone instanceof Tu||!this.zoneIsDefined)}notify(e){if(!this.zonelessEnabled&&e===5)return;let i=!1;switch(e){case 0:{this.appRef.dirtyFlags|=2;break}case 3:case 2:case 4:case 5:case 1:{this.appRef.dirtyFlags|=4;break}case 6:{this.appRef.dirtyFlags|=2,i=!0;break}case 12:{this.appRef.dirtyFlags|=16,i=!0;break}case 13:{this.appRef.dirtyFlags|=2,i=!0;break}case 11:{i=!0;break}case 9:case 8:case 7:case 10:default:this.appRef.dirtyFlags|=8}if(this.appRef.tracingSnapshot=this.tracing?.snapshot(this.appRef.tracingSnapshot)??null,!this.shouldScheduleTick(i))return;let r=this.useMicrotaskScheduler?Xy:lw;this.pendingRenderTaskId=this.taskService.add(),this.scheduleInRootZone?this.cancelScheduledCallback=Zone.root.run(()=>r(()=>this.tick())):this.cancelScheduledCallback=this.ngZone.runOutsideAngular(()=>r(()=>this.tick()))}shouldScheduleTick(e){return!(this.disableScheduling&&!e||this.appRef.destroyed||this.pendingRenderTaskId!==null||this.runningTick||this.appRef._runningTick||!this.zonelessEnabled&&this.zoneIsDefined&&Zone.current.get(Iu+this.angularZoneId))}tick(){if(this.runningTick||this.appRef.destroyed)return;if(this.appRef.dirtyFlags===0){this.cleanup();return}!this.zonelessEnabled&&this.appRef.dirtyFlags&7&&(this.appRef.dirtyFlags|=1);let e=this.taskService.add();try{this.ngZone.run(()=>{this.runningTick=!0,this.appRef._tick()},void 0,this.schedulerTickApplyArgs)}catch(i){this.taskService.remove(e),this.applicationErrorHandler(i)}finally{this.cleanup()}this.useMicrotaskScheduler=!0,Xy(()=>{this.useMicrotaskScheduler=!1,this.taskService.remove(e)})}ngOnDestroy(){this.subscriptions.unsubscribe(),this.cleanup()}cleanup(){if(this.runningTick=!1,this.cancelScheduledCallback?.(),this.cancelScheduledCallback=null,this.pendingRenderTaskId!==null){let e=this.pendingRenderTaskId;this.pendingRenderTaskId=null,this.taskService.remove(e)}}static \u0275fac=function(i){return new(i||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function MA(){return typeof $localize<"u"&&$localize.locale||Ua}var no=new U("",{providedIn:"root",factory:()=>A(no,{optional:!0,skipSelf:!0})||MA()});function at(n){return Y_(n)}function io(n,t){return pc(n,t?.equal)}var pE=class{[Nt];constructor(t){this[Nt]=t}destroy(){this[Nt].destroy()}};var bE=Symbol("InputSignalNode#UNSET"),UA=Y(P({},hc),{transformFn:void 0,applyValueToInputSignal(n,t){Fo(n,t)}});function wE(n,t){let e=Object.create(UA);e.value=n,e.transformFn=t?.transform;function i(){if(No(e),e.value===bE){let r=null;throw new F(-950,r)}return e.value}return i[Nt]=e,i}var ld=class{attributeName;constructor(t){this.attributeName=t}__NG_ELEMENT_ID__=()=>Fa(this.attributeName);toString(){return`HostAttributeToken ${this.attributeName}`}},BA=new U("");BA.__NG_ELEMENT_ID__=n=>{let t=ht();if(t===null)throw new F(204,!1);if(t.type&2)return t.value;if(n&8)return null;throw new F(204,!1)};function hE(n,t){return wE(n,t)}function $A(n){return wE(bE,n)}var EE=(hE.required=$A,hE);var Ng=new U(""),HA=new U("");function Wa(n){return!n.moduleRef}function WA(n){let t=Wa(n)?n.r3Injector:n.moduleRef.injector,e=t.get(We);return e.run(()=>{Wa(n)?n.r3Injector.resolveInjectorInitializers():n.moduleRef.resolveInjectorInitializers();let i=t.get(Kt),r;if(e.runOutsideAngular(()=>{r=e.onError.subscribe({next:i})}),Wa(n)){let o=()=>t.destroy(),s=n.platformInjector.get(Ng);s.add(o),t.onDestroy(()=>{r.unsubscribe(),s.delete(o)})}else{let o=()=>n.moduleRef.destroy(),s=n.platformInjector.get(Ng);s.add(o),n.moduleRef.onDestroy(()=>{Ia(n.allPlatformModules,n.moduleRef),r.unsubscribe(),s.delete(o)})}return qA(i,e,()=>{let o=t.get(ci),s=o.add(),a=t.get(yg);return a.runInitializers(),a.donePromise.then(()=>{let c=t.get(no,Ua);if(Xw(c||Ua),!t.get(HA,!0))return Wa(n)?t.get(Vi):(n.allPlatformModules.push(n.moduleRef),n.moduleRef);if(Wa(n)){let h=t.get(Vi);return n.rootComponent!==void 0&&h.bootstrap(n.rootComponent),h}else return GA?.(n.moduleRef,n.allPlatformModules),n.moduleRef}).finally(()=>void o.remove(s))})})}var GA;function qA(n,t,e){try{let i=e();return fr(i)?i.catch(r=>{throw t.runOutsideAngular(()=>n(r)),r}):i}catch(i){throw t.runOutsideAngular(()=>n(i)),i}}var ad=null;function KA(n=[],t){return qt.create({name:t,providers:[{provide:pa,useValue:"platform"},{provide:Ng,useValue:new Set([()=>ad=null])},...n]})}function YA(n=[]){if(ad)return ad;let t=KA(n);return ad=t,Jw(),ZA(t),t}function ZA(n){let t=n.get(Uu,null);pt(n,()=>{t?.forEach(e=>e())})}var Bi=(()=>{class n{static __NG_ELEMENT_ID__=JA}return n})();function JA(n){return QA(ht(),ie(),(n&16)===16)}function QA(n,t,e){if(ki(n)&&!e){let i=Sn(n.index,t);return new ur(i,i)}else if(n.type&175){let i=t[un];return new ur(i,t)}return null}var Pg=class{constructor(){}supports(t){return fg(t)}create(t){return new kg(t)}},XA=(n,t)=>t,kg=class{length=0;collection;_linkedRecords=null;_unlinkedRecords=null;_previousItHead=null;_itHead=null;_itTail=null;_additionsHead=null;_additionsTail=null;_movesHead=null;_movesTail=null;_removalsHead=null;_removalsTail=null;_identityChangesHead=null;_identityChangesTail=null;_trackByFn;constructor(t){this._trackByFn=t||XA}forEachItem(t){let e;for(e=this._itHead;e!==null;e=e._next)t(e)}forEachOperation(t){let e=this._itHead,i=this._removalsHead,r=0,o=null;for(;e||i;){let s=!i||e&&e.currentIndex<mE(i,r,o)?e:i,a=mE(s,r,o),c=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(e=e._next,s.previousIndex==null)r++;else{o||(o=[]);let f=a-r,h=c-r;if(f!=h){for(let y=0;y<f;y++){let g=y<o.length?o[y]:o[y]=0,w=g+y;h<=w&&w<f&&(o[y]=g+1)}let m=s.previousIndex;o[m]=h-f}}a!==c&&t(s,a,c)}}forEachPreviousItem(t){let e;for(e=this._previousItHead;e!==null;e=e._nextPrevious)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;e!==null;e=e._nextAdded)t(e)}forEachMovedItem(t){let e;for(e=this._movesHead;e!==null;e=e._nextMoved)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;e!==null;e=e._nextRemoved)t(e)}forEachIdentityChange(t){let e;for(e=this._identityChangesHead;e!==null;e=e._nextIdentityChange)t(e)}diff(t){if(t==null&&(t=[]),!fg(t))throw new F(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._itHead,i=!1,r,o,s;if(Array.isArray(t)){this.length=t.length;for(let a=0;a<this.length;a++)o=t[a],s=this._trackByFn(a,o),e===null||!Object.is(e.trackById,s)?(e=this._mismatch(e,o,s,a),i=!0):(i&&(e=this._verifyReinsertion(e,o,s,a)),Object.is(e.item,o)||this._addIdentityChange(e,o)),e=e._next}else r=0,Vw(t,a=>{s=this._trackByFn(r,a),e===null||!Object.is(e.trackById,s)?(e=this._mismatch(e,a,s,r),i=!0):(i&&(e=this._verifyReinsertion(e,a,s,r)),Object.is(e.item,a)||this._addIdentityChange(e,a)),e=e._next,r++}),this.length=r;return this._truncate(e),this.collection=t,this.isDirty}get isDirty(){return this._additionsHead!==null||this._movesHead!==null||this._removalsHead!==null||this._identityChangesHead!==null}_reset(){if(this.isDirty){let t;for(t=this._previousItHead=this._itHead;t!==null;t=t._next)t._nextPrevious=t._next;for(t=this._additionsHead;t!==null;t=t._nextAdded)t.previousIndex=t.currentIndex;for(this._additionsHead=this._additionsTail=null,t=this._movesHead;t!==null;t=t._nextMoved)t.previousIndex=t.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(t,e,i,r){let o;return t===null?o=this._itTail:(o=t._prev,this._remove(t)),t=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null),t!==null?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._reinsertAfter(t,o,r)):(t=this._linkedRecords===null?null:this._linkedRecords.get(i,r),t!==null?(Object.is(t.item,e)||this._addIdentityChange(t,e),this._moveAfter(t,o,r)):t=this._addAfter(new Fg(e,i),o,r)),t}_verifyReinsertion(t,e,i,r){let o=this._unlinkedRecords===null?null:this._unlinkedRecords.get(i,null);return o!==null?t=this._reinsertAfter(o,t._prev,r):t.currentIndex!=r&&(t.currentIndex=r,this._addToMoves(t,r)),t}_truncate(t){for(;t!==null;){let e=t._next;this._addToRemovals(this._unlink(t)),t=e}this._unlinkedRecords!==null&&this._unlinkedRecords.clear(),this._additionsTail!==null&&(this._additionsTail._nextAdded=null),this._movesTail!==null&&(this._movesTail._nextMoved=null),this._itTail!==null&&(this._itTail._next=null),this._removalsTail!==null&&(this._removalsTail._nextRemoved=null),this._identityChangesTail!==null&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(t,e,i){this._unlinkedRecords!==null&&this._unlinkedRecords.remove(t);let r=t._prevRemoved,o=t._nextRemoved;return r===null?this._removalsHead=o:r._nextRemoved=o,o===null?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(t,e,i),this._addToMoves(t,i),t}_moveAfter(t,e,i){return this._unlink(t),this._insertAfter(t,e,i),this._addToMoves(t,i),t}_addAfter(t,e,i){return this._insertAfter(t,e,i),this._additionsTail===null?this._additionsTail=this._additionsHead=t:this._additionsTail=this._additionsTail._nextAdded=t,t}_insertAfter(t,e,i){let r=e===null?this._itHead:e._next;return t._next=r,t._prev=e,r===null?this._itTail=t:r._prev=t,e===null?this._itHead=t:e._next=t,this._linkedRecords===null&&(this._linkedRecords=new cd),this._linkedRecords.put(t),t.currentIndex=i,t}_remove(t){return this._addToRemovals(this._unlink(t))}_unlink(t){this._linkedRecords!==null&&this._linkedRecords.remove(t);let e=t._prev,i=t._next;return e===null?this._itHead=i:e._next=i,i===null?this._itTail=e:i._prev=e,t}_addToMoves(t,e){return t.previousIndex===e||(this._movesTail===null?this._movesTail=this._movesHead=t:this._movesTail=this._movesTail._nextMoved=t),t}_addToRemovals(t){return this._unlinkedRecords===null&&(this._unlinkedRecords=new cd),this._unlinkedRecords.put(t),t.currentIndex=null,t._nextRemoved=null,this._removalsTail===null?(this._removalsTail=this._removalsHead=t,t._prevRemoved=null):(t._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=t),t}_addIdentityChange(t,e){return t.item=e,this._identityChangesTail===null?this._identityChangesTail=this._identityChangesHead=t:this._identityChangesTail=this._identityChangesTail._nextIdentityChange=t,t}},Fg=class{item;trackById;currentIndex=null;previousIndex=null;_nextPrevious=null;_prev=null;_next=null;_prevDup=null;_nextDup=null;_prevRemoved=null;_nextRemoved=null;_nextAdded=null;_nextMoved=null;_nextIdentityChange=null;constructor(t,e){this.item=t,this.trackById=e}},Lg=class{_head=null;_tail=null;add(t){this._head===null?(this._head=this._tail=t,t._nextDup=null,t._prevDup=null):(this._tail._nextDup=t,t._prevDup=this._tail,t._nextDup=null,this._tail=t)}get(t,e){let i;for(i=this._head;i!==null;i=i._nextDup)if((e===null||e<=i.currentIndex)&&Object.is(i.trackById,t))return i;return null}remove(t){let e=t._prevDup,i=t._nextDup;return e===null?this._head=i:e._nextDup=i,i===null?this._tail=e:i._prevDup=e,this._head===null}},cd=class{map=new Map;put(t){let e=t.trackById,i=this.map.get(e);i||(i=new Lg,this.map.set(e,i)),i.add(t)}get(t,e){let i=t,r=this.map.get(i);return r?r.get(t,e):null}remove(t){let e=t.trackById;return this.map.get(e).remove(t)&&this.map.delete(e),t}get isEmpty(){return this.map.size===0}clear(){this.map.clear()}};function mE(n,t,e){let i=n.previousIndex;if(i===null)return i;let r=0;return e&&i<e.length&&(r=e[i]),i+t+r}var jg=class{constructor(){}supports(t){return t instanceof Map||nd(t)}create(){return new Vg}},Vg=class{_records=new Map;_mapHead=null;_appendAfter=null;_previousMapHead=null;_changesHead=null;_changesTail=null;_additionsHead=null;_additionsTail=null;_removalsHead=null;_removalsTail=null;get isDirty(){return this._additionsHead!==null||this._changesHead!==null||this._removalsHead!==null}forEachItem(t){let e;for(e=this._mapHead;e!==null;e=e._next)t(e)}forEachPreviousItem(t){let e;for(e=this._previousMapHead;e!==null;e=e._nextPrevious)t(e)}forEachChangedItem(t){let e;for(e=this._changesHead;e!==null;e=e._nextChanged)t(e)}forEachAddedItem(t){let e;for(e=this._additionsHead;e!==null;e=e._nextAdded)t(e)}forEachRemovedItem(t){let e;for(e=this._removalsHead;e!==null;e=e._nextRemoved)t(e)}diff(t){if(!t)t=new Map;else if(!(t instanceof Map||nd(t)))throw new F(900,!1);return this.check(t)?this:null}onDestroy(){}check(t){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(t,(i,r)=>{if(e&&e.key===r)this._maybeAddToChanges(e,i),this._appendAfter=e,e=e._next;else{let o=this._getOrCreateRecordForKey(r,i);e=this._insertBeforeOrAppend(e,o)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let i=e;i!==null;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(t,e){if(t){let i=t._prev;return e._next=t,e._prev=i,t._prev=e,i&&(i._next=e),t===this._mapHead&&(this._mapHead=e),this._appendAfter=t,t}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(t,e){if(this._records.has(t)){let r=this._records.get(t);this._maybeAddToChanges(r,e);let o=r._prev,s=r._next;return o&&(o._next=s),s&&(s._prev=o),r._next=null,r._prev=null,r}let i=new zg(t);return this._records.set(t,i),i.currentValue=e,this._addToAdditions(i),i}_reset(){if(this.isDirty){let t;for(this._previousMapHead=this._mapHead,t=this._previousMapHead;t!==null;t=t._next)t._nextPrevious=t._next;for(t=this._changesHead;t!==null;t=t._nextChanged)t.previousValue=t.currentValue;for(t=this._additionsHead;t!=null;t=t._nextAdded)t.previousValue=t.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(t,e){Object.is(e,t.currentValue)||(t.previousValue=t.currentValue,t.currentValue=e,this._addToChanges(t))}_addToAdditions(t){this._additionsHead===null?this._additionsHead=this._additionsTail=t:(this._additionsTail._nextAdded=t,this._additionsTail=t)}_addToChanges(t){this._changesHead===null?this._changesHead=this._changesTail=t:(this._changesTail._nextChanged=t,this._changesTail=t)}_forEach(t,e){t instanceof Map?t.forEach(e):Object.keys(t).forEach(i=>e(t[i],i))}},zg=class{key;previousValue=null;currentValue=null;_nextPrevious=null;_next=null;_prev=null;_nextAdded=null;_nextRemoved=null;_nextChanged=null;constructor(t){this.key=t}};function gE(){return new Ug([new Pg])}var Ug=(()=>{class n{factories;static \u0275prov=k({token:n,providedIn:"root",factory:gE});constructor(e){this.factories=e}static create(e,i){if(i!=null){let r=i.factories.slice();e=e.concat(r)}return new n(e)}static extend(e){return{provide:n,useFactory:()=>{let i=A(n,{optional:!0,skipSelf:!0});return n.create(e,i||gE())}}}find(e){let i=this.factories.find(r=>r.supports(e));if(i!=null)return i;throw new F(901,!1)}}return n})();function vE(){return new Bg([new jg])}var Bg=(()=>{class n{static \u0275prov=k({token:n,providedIn:"root",factory:vE});factories;constructor(e){this.factories=e}static create(e,i){if(i){let r=i.factories.slice();e=e.concat(r)}return new n(e)}static extend(e){return{provide:n,useFactory:()=>{let i=A(n,{optional:!0,skipSelf:!0});return n.create(e,i||vE())}}}find(e){let i=this.factories.find(r=>r.supports(e));if(i)return i;throw new F(901,!1)}}return n})();function CE(n){let{rootComponent:t,appProviders:e,platformProviders:i,platformRef:r}=n;De(8);try{let o=r?.injector??YA(i),s=[Ag({}),{provide:Ai,useExisting:fE},Uy,...e||[]],a=new Na({providers:s,parent:o,debugName:"",runEnvironmentInitializers:!1});return WA({r3Injector:a.injector,platformInjector:o,rootComponent:t})}catch(o){return Promise.reject(o)}finally{De(9)}}function ro(n){return typeof n=="boolean"?n:n!=null&&n!=="false"}function SE(n){let t=Pi(n);if(!t)return null;let e=new Jr(t);return{get selector(){return e.selector},get type(){return e.componentType},get inputs(){return e.inputs},get outputs(){return e.outputs},get ngContentSelectors(){return e.ngContentSelectors},get isStandalone(){return t.standalone},get isSignal(){return t.signals}}}var IE=null;function In(){return IE}function $g(n){IE??=n}var Ga=class{},qa=(()=>{class n{historyGo(e){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=k({token:n,factory:()=>A(TE),providedIn:"platform"})}return n})(),Hg=new U(""),TE=(()=>{class n extends qa{_location;_history;_doc=A(Ue);constructor(){super(),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return In().getBaseHref(this._doc)}onPopState(e){let i=In().getGlobalEventTarget(this._doc,"window");return i.addEventListener("popstate",e,!1),()=>i.removeEventListener("popstate",e)}onHashChange(e){let i=In().getGlobalEventTarget(this._doc,"window");return i.addEventListener("hashchange",e,!1),()=>i.removeEventListener("hashchange",e)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(e){this._location.pathname=e}pushState(e,i,r){this._history.pushState(e,i,r)}replaceState(e,i,r){this._history.replaceState(e,i,r)}forward(){this._history.forward()}back(){this._history.back()}historyGo(e=0){this._history.go(e)}getState(){return this._history.state}static \u0275fac=function(i){return new(i||n)};static \u0275prov=k({token:n,factory:()=>new n,providedIn:"platform"})}return n})();function ud(n,t){return n?t?n.endsWith("/")?t.startsWith("/")?n+t.slice(1):n+t:t.startsWith("/")?n+t:`${n}/${t}`:n:t}function xE(n){let t=n.search(/#|\?|$/);return n[t-1]==="/"?n.slice(0,t-1)+n.slice(t):n}function Zn(n){return n&&n[0]!=="?"?`?${n}`:n}var gn=(()=>{class n{historyGo(e){throw new Error("")}static \u0275fac=function(i){return new(i||n)};static \u0275prov=k({token:n,factory:()=>A(fd),providedIn:"root"})}return n})(),dd=new U(""),fd=(()=>{class n extends gn{_platformLocation;_baseHref;_removeListenerFns=[];constructor(e,i){super(),this._platformLocation=e,this._baseHref=i??this._platformLocation.getBaseHrefFromDOM()??A(Ue).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}prepareExternalUrl(e){return ud(this._baseHref,e)}path(e=!1){let i=this._platformLocation.pathname+Zn(this._platformLocation.search),r=this._platformLocation.hash;return r&&e?`${i}${r}`:i}pushState(e,i,r,o){let s=this.prepareExternalUrl(r+Zn(o));this._platformLocation.pushState(e,i,s)}replaceState(e,i,r,o){let s=this.prepareExternalUrl(r+Zn(o));this._platformLocation.replaceState(e,i,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static \u0275fac=function(i){return new(i||n)(L(qa),L(dd,8))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),gr=(()=>{class n{_subject=new Le;_basePath;_locationStrategy;_urlChangeListeners=[];_urlChangeSubscription=null;constructor(e){this._locationStrategy=e;let i=this._locationStrategy.getBaseHref();this._basePath=nR(xE(DE(i))),this._locationStrategy.onPopState(r=>{this._subject.next({url:this.path(!0),pop:!0,state:r.state,type:r.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(e=!1){return this.normalize(this._locationStrategy.path(e))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(e,i=""){return this.path()==this.normalize(e+Zn(i))}normalize(e){return n.stripTrailingSlash(tR(this._basePath,DE(e)))}prepareExternalUrl(e){return e&&e[0]!=="/"&&(e="/"+e),this._locationStrategy.prepareExternalUrl(e)}go(e,i="",r=null){this._locationStrategy.pushState(r,"",e,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Zn(i)),r)}replaceState(e,i="",r=null){this._locationStrategy.replaceState(r,"",e,i),this._notifyUrlChangeListeners(this.prepareExternalUrl(e+Zn(i)),r)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(e=0){this._locationStrategy.historyGo?.(e)}onUrlChange(e){return this._urlChangeListeners.push(e),this._urlChangeSubscription??=this.subscribe(i=>{this._notifyUrlChangeListeners(i.url,i.state)}),()=>{let i=this._urlChangeListeners.indexOf(e);this._urlChangeListeners.splice(i,1),this._urlChangeListeners.length===0&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(e="",i){this._urlChangeListeners.forEach(r=>r(e,i))}subscribe(e,i,r){return this._subject.subscribe({next:e,error:i??void 0,complete:r??void 0})}static normalizeQueryParams=Zn;static joinWithSlash=ud;static stripTrailingSlash=xE;static \u0275fac=function(i){return new(i||n)(L(gn))};static \u0275prov=k({token:n,factory:()=>eR(),providedIn:"root"})}return n})();function eR(){return new gr(L(gn))}function tR(n,t){if(!n||!t.startsWith(n))return t;let e=t.substring(n.length);return e===""||["/",";","?","#"].includes(e[0])?e:t}function DE(n){return n.replace(/\/index.html$/,"")}function nR(n){if(new RegExp("^(https?:)?//").test(n)){let[,e]=n.split(/\/\/[^\/]+/);return e}return n}var Qa=(()=>{class n extends gn{_platformLocation;_baseHref="";_removeListenerFns=[];constructor(e,i){super(),this._platformLocation=e,i!=null&&(this._baseHref=i)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(e){this._removeListenerFns.push(this._platformLocation.onPopState(e),this._platformLocation.onHashChange(e))}getBaseHref(){return this._baseHref}path(e=!1){let i=this._platformLocation.hash??"#";return i.length>0?i.substring(1):i}prepareExternalUrl(e){let i=ud(this._baseHref,e);return i.length>0?"#"+i:i}pushState(e,i,r,o){let s=this.prepareExternalUrl(r+Zn(o))||this._platformLocation.pathname;this._platformLocation.pushState(e,i,s)}replaceState(e,i,r,o){let s=this.prepareExternalUrl(r+Zn(o))||this._platformLocation.pathname;this._platformLocation.replaceState(e,i,s)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(e=0){this._platformLocation.historyGo?.(e)}static \u0275fac=function(i){return new(i||n)(L(qa),L(dd,8))};static \u0275prov=k({token:n,factory:n.\u0275fac})}return n})();var Ed=(function(n){return n[n.Decimal=0]="Decimal",n[n.Percent=1]="Percent",n[n.Currency=2]="Currency",n[n.Scientific=3]="Scientific",n})(Ed||{});var Ft=(function(n){return n[n.Format=0]="Format",n[n.Standalone=1]="Standalone",n})(Ft||{}),Te=(function(n){return n[n.Narrow=0]="Narrow",n[n.Abbreviated=1]="Abbreviated",n[n.Wide=2]="Wide",n[n.Short=3]="Short",n})(Te||{}),sn=(function(n){return n[n.Short=0]="Short",n[n.Medium=1]="Medium",n[n.Long=2]="Long",n[n.Full=3]="Full",n})(sn||{}),bt={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function PE(n){return on(n)[Ge.LocaleId]}function kE(n,t,e){let i=on(n),r=[i[Ge.DayPeriodsFormat],i[Ge.DayPeriodsStandalone]],o=Mn(r,t);return Mn(o,e)}function FE(n,t,e){let i=on(n),r=[i[Ge.DaysFormat],i[Ge.DaysStandalone]],o=Mn(r,t);return Mn(o,e)}function LE(n,t,e){let i=on(n),r=[i[Ge.MonthsFormat],i[Ge.MonthsStandalone]],o=Mn(r,t);return Mn(o,e)}function jE(n,t){let i=on(n)[Ge.Eras];return Mn(i,t)}function Ka(n,t){let e=on(n);return Mn(e[Ge.DateFormat],t)}function Ya(n,t){let e=on(n);return Mn(e[Ge.TimeFormat],t)}function Za(n,t){let i=on(n)[Ge.DateTimeFormat];return Mn(i,t)}function Tn(n,t){let e=on(n),i=e[Ge.NumberSymbols][t];if(typeof i>"u"){if(t===bt.CurrencyDecimal)return e[Ge.NumberSymbols][bt.Decimal];if(t===bt.CurrencyGroup)return e[Ge.NumberSymbols][bt.Group]}return i}function Jg(n,t){return on(n)[Ge.NumberFormats][t]}function VE(n){if(!n[Ge.ExtraData])throw new F(2303,!1)}function zE(n){let t=on(n);return VE(t),(t[Ge.ExtraData][2]||[]).map(i=>typeof i=="string"?Wg(i):[Wg(i[0]),Wg(i[1])])}function UE(n,t,e){let i=on(n);VE(i);let r=[i[Ge.ExtraData][0],i[Ge.ExtraData][1]],o=Mn(r,t)||[];return Mn(o,e)||[]}function Mn(n,t){for(let e=t;e>-1;e--)if(typeof n[e]<"u")return n[e];throw new F(2304,!1)}function Wg(n){let[t,e]=n.split(":");return{hours:+t,minutes:+e}}var iR=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,pd={},rR=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;function BE(n,t,e,i){let r=pR(n);t=$i(e,t)||t;let s=[],a;for(;t;)if(a=rR.exec(t),a){s=s.concat(a.slice(1));let h=s.pop();if(!h)break;t=h}else{s.push(t);break}let c=r.getTimezoneOffset();i&&(c=HE(i,c),r=fR(r,i));let f="";return s.forEach(h=>{let m=uR(h);f+=m?m(r,e,c):h==="''"?"'":h.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),f}function _d(n,t,e){let i=new Date(0);return i.setFullYear(n,t,e),i.setHours(0,0,0),i}function $i(n,t){let e=PE(n);if(pd[e]??={},pd[e][t])return pd[e][t];let i="";switch(t){case"shortDate":i=Ka(n,sn.Short);break;case"mediumDate":i=Ka(n,sn.Medium);break;case"longDate":i=Ka(n,sn.Long);break;case"fullDate":i=Ka(n,sn.Full);break;case"shortTime":i=Ya(n,sn.Short);break;case"mediumTime":i=Ya(n,sn.Medium);break;case"longTime":i=Ya(n,sn.Long);break;case"fullTime":i=Ya(n,sn.Full);break;case"short":let r=$i(n,"shortTime"),o=$i(n,"shortDate");i=hd(Za(n,sn.Short),[r,o]);break;case"medium":let s=$i(n,"mediumTime"),a=$i(n,"mediumDate");i=hd(Za(n,sn.Medium),[s,a]);break;case"long":let c=$i(n,"longTime"),f=$i(n,"longDate");i=hd(Za(n,sn.Long),[c,f]);break;case"full":let h=$i(n,"fullTime"),m=$i(n,"fullDate");i=hd(Za(n,sn.Full),[h,m]);break}return i&&(pd[e][t]=i),i}function hd(n,t){return t&&(n=n.replace(/\{([^}]+)}/g,function(e,i){return t!=null&&i in t?t[i]:e})),n}function Jn(n,t,e="-",i,r){let o="";(n<0||r&&n<=0)&&(r?n=-n+1:(n=-n,o=e));let s=String(n);for(;s.length<t;)s="0"+s;return i&&(s=s.slice(s.length-t)),o+s}function oR(n,t){return Jn(n,3).substring(0,t)}function nt(n,t,e=0,i=!1,r=!1){return function(o,s){let a=sR(n,o);if((e>0||a>-e)&&(a+=e),n===3)a===0&&e===-12&&(a=12);else if(n===6)return oR(a,t);let c=Tn(s,bt.MinusSign);return Jn(a,t,c,i,r)}}function sR(n,t){switch(n){case 0:return t.getFullYear();case 1:return t.getMonth();case 2:return t.getDate();case 3:return t.getHours();case 4:return t.getMinutes();case 5:return t.getSeconds();case 6:return t.getMilliseconds();case 7:return t.getDay();default:throw new F(2301,!1)}}function Oe(n,t,e=Ft.Format,i=!1){return function(r,o){return aR(r,o,n,t,e,i)}}function aR(n,t,e,i,r,o){switch(e){case 2:return LE(t,r,i)[n.getMonth()];case 1:return FE(t,r,i)[n.getDay()];case 0:let s=n.getHours(),a=n.getMinutes();if(o){let f=zE(t),h=UE(t,r,i),m=f.findIndex(y=>{if(Array.isArray(y)){let[g,w]=y,T=s>=g.hours&&a>=g.minutes,x=s<w.hours||s===w.hours&&a<w.minutes;if(g.hours<w.hours){if(T&&x)return!0}else if(T||x)return!0}else if(y.hours===s&&y.minutes===a)return!0;return!1});if(m!==-1)return h[m]}return kE(t,r,i)[s<12?0:1];case 3:return jE(t,i)[n.getFullYear()<=0?0:1];default:let c=e;throw new F(2302,!1)}}function md(n){return function(t,e,i){let r=-1*i,o=Tn(e,bt.MinusSign),s=r>0?Math.floor(r/60):Math.ceil(r/60);switch(n){case 0:return(r>=0?"+":"")+Jn(s,2,o)+Jn(Math.abs(r%60),2,o);case 1:return"GMT"+(r>=0?"+":"")+Jn(s,1,o);case 2:return"GMT"+(r>=0?"+":"")+Jn(s,2,o)+":"+Jn(Math.abs(r%60),2,o);case 3:return i===0?"Z":(r>=0?"+":"")+Jn(s,2,o)+":"+Jn(Math.abs(r%60),2,o);default:throw new F(2310,!1)}}}var lR=0,vd=4;function cR(n){let t=_d(n,lR,1).getDay();return _d(n,0,1+(t<=vd?vd:vd+7)-t)}function $E(n){let t=n.getDay(),e=t===0?-3:vd-t;return _d(n.getFullYear(),n.getMonth(),n.getDate()+e)}function Gg(n,t=!1){return function(e,i){let r;if(t){let o=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,s=e.getDate();r=1+Math.floor((s+o)/7)}else{let o=$E(e),s=cR(o.getFullYear()),a=o.getTime()-s.getTime();r=1+Math.round(a/6048e5)}return Jn(r,n,Tn(i,bt.MinusSign))}}function gd(n,t=!1){return function(e,i){let o=$E(e).getFullYear();return Jn(o,n,Tn(i,bt.MinusSign),t)}}var qg={};function uR(n){if(qg[n])return qg[n];let t;switch(n){case"G":case"GG":case"GGG":t=Oe(3,Te.Abbreviated);break;case"GGGG":t=Oe(3,Te.Wide);break;case"GGGGG":t=Oe(3,Te.Narrow);break;case"y":t=nt(0,1,0,!1,!0);break;case"yy":t=nt(0,2,0,!0,!0);break;case"yyy":t=nt(0,3,0,!1,!0);break;case"yyyy":t=nt(0,4,0,!1,!0);break;case"Y":t=gd(1);break;case"YY":t=gd(2,!0);break;case"YYY":t=gd(3);break;case"YYYY":t=gd(4);break;case"M":case"L":t=nt(1,1,1);break;case"MM":case"LL":t=nt(1,2,1);break;case"MMM":t=Oe(2,Te.Abbreviated);break;case"MMMM":t=Oe(2,Te.Wide);break;case"MMMMM":t=Oe(2,Te.Narrow);break;case"LLL":t=Oe(2,Te.Abbreviated,Ft.Standalone);break;case"LLLL":t=Oe(2,Te.Wide,Ft.Standalone);break;case"LLLLL":t=Oe(2,Te.Narrow,Ft.Standalone);break;case"w":t=Gg(1);break;case"ww":t=Gg(2);break;case"W":t=Gg(1,!0);break;case"d":t=nt(2,1);break;case"dd":t=nt(2,2);break;case"c":case"cc":t=nt(7,1);break;case"ccc":t=Oe(1,Te.Abbreviated,Ft.Standalone);break;case"cccc":t=Oe(1,Te.Wide,Ft.Standalone);break;case"ccccc":t=Oe(1,Te.Narrow,Ft.Standalone);break;case"cccccc":t=Oe(1,Te.Short,Ft.Standalone);break;case"E":case"EE":case"EEE":t=Oe(1,Te.Abbreviated);break;case"EEEE":t=Oe(1,Te.Wide);break;case"EEEEE":t=Oe(1,Te.Narrow);break;case"EEEEEE":t=Oe(1,Te.Short);break;case"a":case"aa":case"aaa":t=Oe(0,Te.Abbreviated);break;case"aaaa":t=Oe(0,Te.Wide);break;case"aaaaa":t=Oe(0,Te.Narrow);break;case"b":case"bb":case"bbb":t=Oe(0,Te.Abbreviated,Ft.Standalone,!0);break;case"bbbb":t=Oe(0,Te.Wide,Ft.Standalone,!0);break;case"bbbbb":t=Oe(0,Te.Narrow,Ft.Standalone,!0);break;case"B":case"BB":case"BBB":t=Oe(0,Te.Abbreviated,Ft.Format,!0);break;case"BBBB":t=Oe(0,Te.Wide,Ft.Format,!0);break;case"BBBBB":t=Oe(0,Te.Narrow,Ft.Format,!0);break;case"h":t=nt(3,1,-12);break;case"hh":t=nt(3,2,-12);break;case"H":t=nt(3,1);break;case"HH":t=nt(3,2);break;case"m":t=nt(4,1);break;case"mm":t=nt(4,2);break;case"s":t=nt(5,1);break;case"ss":t=nt(5,2);break;case"S":t=nt(6,1);break;case"SS":t=nt(6,2);break;case"SSS":t=nt(6,3);break;case"Z":case"ZZ":case"ZZZ":t=md(0);break;case"ZZZZZ":t=md(3);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=md(1);break;case"OOOO":case"ZZZZ":case"zzzz":t=md(2);break;default:return null}return qg[n]=t,t}function HE(n,t){n=n.replace(/:/g,"");let e=Date.parse("Jan 01, 1970 00:00:00 "+n)/6e4;return isNaN(e)?t:e}function dR(n,t){return n=new Date(n.getTime()),n.setMinutes(n.getMinutes()+t),n}function fR(n,t,e){let r=n.getTimezoneOffset(),o=HE(t,r);return dR(n,-1*(o-r))}function pR(n){if(ME(n))return n;if(typeof n=="number"&&!isNaN(n))return new Date(n);if(typeof n=="string"){if(n=n.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(n)){let[r,o=1,s=1]=n.split("-").map(a=>+a);return _d(r,o-1,s)}let e=parseFloat(n);if(!isNaN(n-e))return new Date(e);let i;if(i=n.match(iR))return hR(i)}let t=new Date(n);if(!ME(t))throw new F(2311,!1);return t}function hR(n){let t=new Date(0),e=0,i=0,r=n[8]?t.setUTCFullYear:t.setFullYear,o=n[8]?t.setUTCHours:t.setHours;n[9]&&(e=Number(n[9]+n[10]),i=Number(n[9]+n[11])),r.call(t,Number(n[1]),Number(n[2])-1,Number(n[3]));let s=Number(n[4]||0)-e,a=Number(n[5]||0)-i,c=Number(n[6]||0),f=Math.floor(parseFloat("0."+(n[7]||0))*1e3);return o.call(t,s,a,c,f),t}function ME(n){return n instanceof Date&&!isNaN(n.valueOf())}var mR=/^(\d+)?\.((\d+)(-(\d+))?)?$/,AE=22,yd=".",Ja="0",gR=";",vR=",",Kg="#";var _R="%";function WE(n,t,e,i,r,o,s=!1){let a="",c=!1;if(!isFinite(n))a=Tn(e,bt.Infinity);else{let f=bR(n);s&&(f=yR(f));let h=t.minInt,m=t.minFrac,y=t.maxFrac;if(o){let X=o.match(mR);if(X===null)throw new F(2306,!1);let $=X[1],V=X[3],fe=X[5];$!=null&&(h=Yg($)),V!=null&&(m=Yg(V)),fe!=null?y=Yg(fe):V!=null&&m>y&&(y=m)}wR(f,m,y);let g=f.digits,w=f.integerLen,T=f.exponent,x=[];for(c=g.every(X=>!X);w<h;w++)g.unshift(0);for(;w<0;w++)g.unshift(0);w>0?x=g.splice(w,g.length):(x=g,g=[0]);let M=[];for(g.length>=t.lgSize&&M.unshift(g.splice(-t.lgSize,g.length).join(""));g.length>t.gSize;)M.unshift(g.splice(-t.gSize,g.length).join(""));g.length&&M.unshift(g.join("")),a=M.join(Tn(e,i)),x.length&&(a+=Tn(e,r)+x.join("")),T&&(a+=Tn(e,bt.Exponential)+"+"+T)}return n<0&&!c?a=t.negPre+a+t.negSuf:a=t.posPre+a+t.posSuf,a}function GE(n,t,e){let i=Jg(t,Ed.Percent),r=KE(i,Tn(t,bt.MinusSign));return WE(n,r,t,bt.Group,bt.Decimal,e,!0).replace(new RegExp(_R,"g"),Tn(t,bt.PercentSign))}function qE(n,t,e){let i=Jg(t,Ed.Decimal),r=KE(i,Tn(t,bt.MinusSign));return WE(n,r,t,bt.Group,bt.Decimal,e)}function KE(n,t="-"){let e={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},i=n.split(gR),r=i[0],o=i[1],s=r.indexOf(yd)!==-1?r.split(yd):[r.substring(0,r.lastIndexOf(Ja)+1),r.substring(r.lastIndexOf(Ja)+1)],a=s[0],c=s[1]||"";e.posPre=a.substring(0,a.indexOf(Kg));for(let h=0;h<c.length;h++){let m=c.charAt(h);m===Ja?e.minFrac=e.maxFrac=h+1:m===Kg?e.maxFrac=h+1:e.posSuf+=m}let f=a.split(vR);if(e.gSize=f[1]?f[1].length:0,e.lgSize=f[2]||f[1]?(f[2]||f[1]).length:0,o){let h=r.length-e.posPre.length-e.posSuf.length,m=o.indexOf(Kg);e.negPre=o.substring(0,m).replace(/'/g,""),e.negSuf=o.slice(m+h).replace(/'/g,"")}else e.negPre=t+e.posPre,e.negSuf=e.posSuf;return e}function yR(n){if(n.digits[0]===0)return n;let t=n.digits.length-n.integerLen;return n.exponent?n.exponent+=2:(t===0?n.digits.push(0,0):t===1&&n.digits.push(0),n.integerLen+=2),n}function bR(n){let t=Math.abs(n)+"",e=0,i,r,o,s,a;for((r=t.indexOf(yd))>-1&&(t=t.replace(yd,"")),(o=t.search(/e/i))>0?(r<0&&(r=o),r+=+t.slice(o+1),t=t.substring(0,o)):r<0&&(r=t.length),o=0;t.charAt(o)===Ja;o++);if(o===(a=t.length))i=[0],r=1;else{for(a--;t.charAt(a)===Ja;)a--;for(r-=o,i=[],s=0;o<=a;o++,s++)i[s]=Number(t.charAt(o))}return r>AE&&(i=i.splice(0,AE-1),e=r-1,r=1),{digits:i,exponent:e,integerLen:r}}function wR(n,t,e){if(t>e)throw new F(2307,!1);let i=n.digits,r=i.length-n.integerLen,o=Math.min(Math.max(t,r),e),s=o+n.integerLen,a=i[s];if(s>0){i.splice(Math.max(n.integerLen,s));for(let m=s;m<i.length;m++)i[m]=0}else{r=Math.max(0,r),n.integerLen=1,i.length=Math.max(1,s=o+1),i[0]=0;for(let m=1;m<s;m++)i[m]=0}if(a>=5)if(s-1<0){for(let m=0;m>s;m--)i.unshift(0),n.integerLen++;i.unshift(1),n.integerLen++}else i[s-1]++;for(;r<Math.max(0,o);r++)i.push(0);let c=o!==0,f=t+n.integerLen,h=i.reduceRight(function(m,y,g,w){return y=y+m,w[g]=y<10?y:y-10,c&&(w[g]===0&&g>=f?w.pop():c=!1),y>=10?1:0},0);h&&(i.unshift(h),n.integerLen++)}function Yg(n){let t=parseInt(n);if(isNaN(t))throw new F(2305,!1);return t}var Zg=/\s+/,RE=[],Qg=(()=>{class n{_ngEl;_renderer;initialClasses=RE;rawClass;stateMap=new Map;constructor(e,i){this._ngEl=e,this._renderer=i}set klass(e){this.initialClasses=e!=null?e.trim().split(Zg):RE}set ngClass(e){this.rawClass=typeof e=="string"?e.trim().split(Zg):e}ngDoCheck(){for(let i of this.initialClasses)this._updateState(i,!0);let e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(let i of e)this._updateState(i,!0);else if(e!=null)for(let i of Object.keys(e))this._updateState(i,!!e[i]);this._applyStateDiff()}_updateState(e,i){let r=this.stateMap.get(e);r!==void 0?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(e,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(let e of this.stateMap){let i=e[0],r=e[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(e,i){e=e.trim(),e.length>0&&e.split(Zg).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static \u0275fac=function(i){return new(i||n)(C(mt),C(rn))};static \u0275dir=ye({type:n,selectors:[["","ngClass",""]],inputs:{klass:[0,"class","klass"],ngClass:"ngClass"}})}return n})();var bd=class{$implicit;ngForOf;index;count;constructor(t,e,i,r){this.$implicit=t,this.ngForOf=e,this.index=i,this.count=r}get first(){return this.index===0}get last(){return this.index===this.count-1}get even(){return this.index%2===0}get odd(){return!this.even}},qe=(()=>{class n{_viewContainer;_template;_differs;set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}_ngForOf=null;_ngForOfDirty=!0;_differ=null;_trackByFn;constructor(e,i,r){this._viewContainer=e,this._template=i,this._differs=r}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;let e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){let e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){let i=this._viewContainer;e.forEachOperation((r,o,s)=>{if(r.previousIndex==null)i.createEmbeddedView(this._template,new bd(r.item,this._ngForOf,-1,-1),s===null?void 0:s);else if(s==null)i.remove(o===null?void 0:o);else if(o!==null){let a=i.get(o);i.move(a,s),OE(a,r)}});for(let r=0,o=i.length;r<o;r++){let a=i.get(r).context;a.index=r,a.count=o,a.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{let o=i.get(r.currentIndex);OE(o,r)})}static ngTemplateContextGuard(e,i){return!0}static \u0275fac=function(i){return new(i||n)(C(ji),C(dr),C(Ug))};static \u0275dir=ye({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}})}return n})();function OE(n,t){n.context.$implicit=t.item}var Ee=(()=>{class n{_viewContainer;_context=new wd;_thenTemplateRef=null;_elseTemplateRef=null;_thenViewRef=null;_elseViewRef=null;constructor(e,i){this._viewContainer=e,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){NE(e,!1),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){NE(e,!1),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngIfUseIfTypeGuard;static ngTemplateGuard_ngIf;static ngTemplateContextGuard(e,i){return!0}static \u0275fac=function(i){return new(i||n)(C(ji),C(dr))};static \u0275dir=ye({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}})}return n})(),wd=class{$implicit=null;ngIf=null};function NE(n,t){if(n&&!n.createEmbeddedView)throw new F(2020,!1)}var Xg=(()=>{class n{_ngEl;_differs;_renderer;_ngStyle=null;_differ=null;constructor(e,i,r){this._ngEl=e,this._differs=i,this._renderer=r}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){let e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,i){let[r,o]=e.split("."),s=r.indexOf("-")===-1?void 0:Kn.DashCase;i!=null?this._renderer.setStyle(this._ngEl.nativeElement,r,o?`${i}${o}`:i,s):this._renderer.removeStyle(this._ngEl.nativeElement,r,s)}_applyChanges(e){e.forEachRemovedItem(i=>this._setStyle(i.key,null)),e.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),e.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}static \u0275fac=function(i){return new(i||n)(C(mt),C(Bg),C(rn))};static \u0275dir=ye({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}})}return n})();function Cd(n,t){return new F(2100,!1)}var ER="mediumDate",YE=new U(""),ZE=new U(""),Xe=(()=>{class n{locale;defaultTimezone;defaultOptions;constructor(e,i,r){this.locale=e,this.defaultTimezone=i,this.defaultOptions=r}transform(e,i,r,o){if(e==null||e===""||e!==e)return null;try{let s=i??this.defaultOptions?.dateFormat??ER,a=r??this.defaultOptions?.timezone??this.defaultTimezone??void 0;return BE(e,s,o||this.locale,a)}catch(s){throw Cd(n,s.message)}}static \u0275fac=function(i){return new(i||n)(C(no,16),C(YE,24),C(ZE,24))};static \u0275pipe=fs({name:"date",type:n,pure:!0})}return n})();var Yt=(()=>{class n{_locale;constructor(e){this._locale=e}transform(e,i,r){if(!JE(e))return null;r||=this._locale;try{let o=QE(e);return qE(o,r,i)}catch(o){throw Cd(n,o.message)}}static \u0275fac=function(i){return new(i||n)(C(no,16))};static \u0275pipe=fs({name:"number",type:n,pure:!0})}return n})(),Xa=(()=>{class n{_locale;constructor(e){this._locale=e}transform(e,i,r){if(!JE(e))return null;r||=this._locale;try{let o=QE(e);return GE(o,r,i)}catch(o){throw Cd(n,o.message)}}static \u0275fac=function(i){return new(i||n)(C(no,16))};static \u0275pipe=fs({name:"percent",type:n,pure:!0})}return n})();function JE(n){return!(n==null||n===""||n!==n)}function QE(n){if(typeof n=="string"&&!isNaN(Number(n)-parseFloat(n)))return Number(n);if(typeof n!="number")throw new F(2309,!1);return n}var e0=(()=>{class n{transform(e,i,r){if(e==null)return null;if(!(typeof e=="string"||Array.isArray(e)))throw Cd(n,e);return e.slice(i,r)}static \u0275fac=function(i){return new(i||n)};static \u0275pipe=fs({name:"slice",type:n,pure:!1})}return n})();var _e=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Dn({type:n});static \u0275inj=cn({})}return n})();function el(n,t){t=encodeURIComponent(t);for(let e of n.split(";")){let i=e.indexOf("="),[r,o]=i==-1?[e,""]:[e.slice(0,i),e.slice(i+1)];if(r.trim()===t)return decodeURIComponent(o)}return null}var oo=class{};var XE="browser";var eC=(()=>{class n{static \u0275prov=k({token:n,providedIn:"root",factory:()=>new t0(A(Ue),window)})}return n})(),t0=class{document;window;offset=()=>[0,0];constructor(t,e){this.document=t,this.window=e}setOffset(t){Array.isArray(t)?this.offset=()=>t:this.offset=t}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(t,e){this.window.scrollTo(Y(P({},e),{left:t[0],top:t[1]}))}scrollToAnchor(t,e){let i=CR(this.document,t);i&&(this.scrollToElement(i,e),i.focus())}setHistoryScrollRestoration(t){try{this.window.history.scrollRestoration=t}catch{console.warn(Ri(2400,!1))}}scrollToElement(t,e){let i=t.getBoundingClientRect(),r=i.left+this.window.pageXOffset,o=i.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(Y(P({},e),{left:r-s[0],top:o-s[1]}))}};function CR(n,t){let e=n.getElementById(t)||n.getElementsByName(t)[0];if(e)return e;if(typeof n.createTreeWalker=="function"&&n.body&&typeof n.body.attachShadow=="function"){let i=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT),r=i.currentNode;for(;r;){let o=r.shadowRoot;if(o){let s=o.getElementById(t)||o.querySelector(`[name="${t}"]`);if(s)return s}r=i.nextNode()}}return null}var tl=class{_doc;constructor(t){this._doc=t}manager},Sd=(()=>{class n extends tl{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,r,o){return e.addEventListener(i,r,o),()=>this.removeEventListener(e,i,r,o)}removeEventListener(e,i,r,o){return e.removeEventListener(i,r,o)}static \u0275fac=function(i){return new(i||n)(L(Ue))};static \u0275prov=k({token:n,factory:n.\u0275fac})}return n})(),Dd=new U(""),s0=(()=>{class n{_zone;_plugins;_eventNameToPlugin=new Map;constructor(e,i){this._zone=i,e.forEach(s=>{s.manager=this});let r=e.filter(s=>!(s instanceof Sd));this._plugins=r.slice().reverse();let o=e.find(s=>s instanceof Sd);o&&this._plugins.push(o)}addEventListener(e,i,r,o){return this._findPluginFor(i).addEventListener(e,i,r,o)}getZone(){return this._zone}_findPluginFor(e){let i=this._eventNameToPlugin.get(e);if(i)return i;if(i=this._plugins.find(o=>o.supports(e)),!i)throw new F(5101,!1);return this._eventNameToPlugin.set(e,i),i}static \u0275fac=function(i){return new(i||n)(L(Dd),L(We))};static \u0275prov=k({token:n,factory:n.\u0275fac})}return n})(),n0="ng-app-id";function tC(n){for(let t of n)t.remove()}function nC(n,t){let e=t.createElement("style");return e.textContent=n,e}function SR(n,t,e,i){let r=n.head?.querySelectorAll(`style[${n0}="${t}"],link[${n0}="${t}"]`);if(r)for(let o of r)o.removeAttribute(n0),o instanceof HTMLLinkElement?i.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&e.set(o.textContent,{usage:0,elements:[o]})}function r0(n,t){let e=t.createElement("link");return e.setAttribute("rel","stylesheet"),e.setAttribute("href",n),e}var a0=(()=>{class n{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(e,i,r,o={}){this.doc=e,this.appId=i,this.nonce=r,SR(e,i,this.inline,this.external),this.hosts.add(e.head)}addStyles(e,i){for(let r of e)this.addUsage(r,this.inline,nC);i?.forEach(r=>this.addUsage(r,this.external,r0))}removeStyles(e,i){for(let r of e)this.removeUsage(r,this.inline);i?.forEach(r=>this.removeUsage(r,this.external))}addUsage(e,i,r){let o=i.get(e);o?o.usage++:i.set(e,{usage:1,elements:[...this.hosts].map(s=>this.addElement(s,r(e,this.doc)))})}removeUsage(e,i){let r=i.get(e);r&&(r.usage--,r.usage<=0&&(tC(r.elements),i.delete(e)))}ngOnDestroy(){for(let[,{elements:e}]of[...this.inline,...this.external])tC(e);this.hosts.clear()}addHost(e){this.hosts.add(e);for(let[i,{elements:r}]of this.inline)r.push(this.addElement(e,nC(i,this.doc)));for(let[i,{elements:r}]of this.external)r.push(this.addElement(e,r0(i,this.doc)))}removeHost(e){this.hosts.delete(e)}addElement(e,i){return this.nonce&&i.setAttribute("nonce",this.nonce),e.appendChild(i)}static \u0275fac=function(i){return new(i||n)(L(Ue),L(zu),L(Bu,8),L(cs))};static \u0275prov=k({token:n,factory:n.\u0275fac})}return n})(),i0={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},l0=/%COMP%/g;var rC="%COMP%",xR=`_nghost-${rC}`,DR=`_ngcontent-${rC}`,IR=!0,TR=new U("",{providedIn:"root",factory:()=>IR});function MR(n){return DR.replace(l0,n)}function AR(n){return xR.replace(l0,n)}function oC(n,t){return t.map(e=>e.replace(l0,n))}var c0=(()=>{class n{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;platformId;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(e,i,r,o,s,a,c,f=null,h=null){this.eventManager=e,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=c,this.nonce=f,this.tracingService=h,this.platformIsServer=!1,this.defaultRenderer=new nl(e,s,c,this.platformIsServer,this.tracingService)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;let r=this.getOrCreateRenderer(e,i);return r instanceof xd?r.applyToHost(e):r instanceof il&&r.applyStyles(),r}getOrCreateRenderer(e,i){let r=this.rendererByCompId,o=r.get(i.id);if(!o){let s=this.doc,a=this.ngZone,c=this.eventManager,f=this.sharedStylesHost,h=this.removeStylesOnCompDestroy,m=this.platformIsServer,y=this.tracingService;switch(i.encapsulation){case Li.Emulated:o=new xd(c,f,i,this.appId,h,s,a,m,y);break;case Li.ShadowDom:return new o0(c,f,e,i,s,a,this.nonce,m,y);default:o=new il(c,f,i,h,s,a,m,y);break}r.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(e){this.rendererByCompId.delete(e)}static \u0275fac=function(i){return new(i||n)(L(s0),L(a0),L(zu),L(TR),L(Ue),L(cs),L(We),L(Bu),L(eo,8))};static \u0275prov=k({token:n,factory:n.\u0275fac})}return n})(),nl=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(t,e,i,r,o){this.eventManager=t,this.doc=e,this.ngZone=i,this.platformIsServer=r,this.tracingService=o}destroy(){}destroyNode=null;createElement(t,e){return e?this.doc.createElementNS(i0[e]||e,t):this.doc.createElement(t)}createComment(t){return this.doc.createComment(t)}createText(t){return this.doc.createTextNode(t)}appendChild(t,e){(iC(t)?t.content:t).appendChild(e)}insertBefore(t,e,i){t&&(iC(t)?t.content:t).insertBefore(e,i)}removeChild(t,e){e.remove()}selectRootElement(t,e){let i=typeof t=="string"?this.doc.querySelector(t):t;if(!i)throw new F(-5104,!1);return e||(i.textContent=""),i}parentNode(t){return t.parentNode}nextSibling(t){return t.nextSibling}setAttribute(t,e,i,r){if(r){e=r+":"+e;let o=i0[r];o?t.setAttributeNS(o,e,i):t.setAttribute(e,i)}else t.setAttribute(e,i)}removeAttribute(t,e,i){if(i){let r=i0[i];r?t.removeAttributeNS(r,e):t.removeAttribute(`${i}:${e}`)}else t.removeAttribute(e)}addClass(t,e){t.classList.add(e)}removeClass(t,e){t.classList.remove(e)}setStyle(t,e,i,r){r&(Kn.DashCase|Kn.Important)?t.style.setProperty(e,i,r&Kn.Important?"important":""):t.style[e]=i}removeStyle(t,e,i){i&Kn.DashCase?t.style.removeProperty(e):t.style[e]=""}setProperty(t,e,i){t!=null&&(t[e]=i)}setValue(t,e){t.nodeValue=e}listen(t,e,i,r){if(typeof t=="string"&&(t=In().getGlobalEventTarget(this.doc,t),!t))throw new F(5102,!1);let o=this.decoratePreventDefault(i);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(t,e,o)),this.eventManager.addEventListener(t,e,o,r)}decoratePreventDefault(t){return e=>{if(e==="__ngUnwrap__")return t;t(e)===!1&&e.preventDefault()}}};function iC(n){return n.tagName==="TEMPLATE"&&n.content!==void 0}var o0=class extends nl{sharedStylesHost;hostEl;shadowRoot;constructor(t,e,i,r,o,s,a,c,f){super(t,o,s,c,f),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let h=r.styles;h=oC(r.id,h);for(let y of h){let g=document.createElement("style");a&&g.setAttribute("nonce",a),g.textContent=y,this.shadowRoot.appendChild(g)}let m=r.getExternalStyles?.();if(m)for(let y of m){let g=r0(y,o);a&&g.setAttribute("nonce",a),this.shadowRoot.appendChild(g)}}nodeOrShadowRoot(t){return t===this.hostEl?this.shadowRoot:t}appendChild(t,e){return super.appendChild(this.nodeOrShadowRoot(t),e)}insertBefore(t,e,i){return super.insertBefore(this.nodeOrShadowRoot(t),e,i)}removeChild(t,e){return super.removeChild(null,e)}parentNode(t){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(t)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},il=class extends nl{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(t,e,i,r,o,s,a,c,f){super(t,o,s,a,c),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=r;let h=i.styles;this.styles=f?oC(f,h):h,this.styleUrls=i.getExternalStyles?.(f)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&ss.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},xd=class extends il{contentAttr;hostAttr;constructor(t,e,i,r,o,s,a,c,f){let h=r+"-"+i.id;super(t,e,i,o,s,a,c,f,h),this.contentAttr=MR(h),this.hostAttr=AR(h)}applyToHost(t){this.applyStyles(),this.setAttribute(t,this.hostAttr,"")}createElement(t,e){let i=super.createElement(t,e);return super.setAttribute(i,this.contentAttr,""),i}};var Id=class n extends Ga{supportsDOMEvents=!0;static makeCurrent(){$g(new n)}onAndCancel(t,e,i,r){return t.addEventListener(e,i,r),()=>{t.removeEventListener(e,i,r)}}dispatchEvent(t,e){t.dispatchEvent(e)}remove(t){t.remove()}createElement(t,e){return e=e||this.getDefaultDocument(),e.createElement(t)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}isShadowRoot(t){return t instanceof DocumentFragment}getGlobalEventTarget(t,e){return e==="window"?window:e==="document"?t:e==="body"?t.body:null}getBaseHref(t){let e=RR();return e==null?null:OR(e)}resetBaseElement(){rl=null}getUserAgent(){return window.navigator.userAgent}getCookie(t){return el(document.cookie,t)}},rl=null;function RR(){return rl=rl||document.head.querySelector("base"),rl?rl.getAttribute("href"):null}function OR(n){return new URL(n,document.baseURI).pathname}var NR=(()=>{class n{build(){return new XMLHttpRequest}static \u0275fac=function(i){return new(i||n)};static \u0275prov=k({token:n,factory:n.\u0275fac})}return n})(),sC=["alt","control","meta","shift"],PR={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},kR={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey},aC=(()=>{class n extends tl{constructor(e){super(e)}supports(e){return n.parseEventName(e)!=null}addEventListener(e,i,r,o){let s=n.parseEventName(i),a=n.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>In().onAndCancel(e,s.domEventName,a,o))}static parseEventName(e){let i=e.toLowerCase().split("."),r=i.shift();if(i.length===0||!(r==="keydown"||r==="keyup"))return null;let o=n._normalizeKey(i.pop()),s="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),s="code."),sC.forEach(f=>{let h=i.indexOf(f);h>-1&&(i.splice(h,1),s+=f+".")}),s+=o,i.length!=0||o.length===0)return null;let c={};return c.domEventName=r,c.fullKey=s,c}static matchEventFullKeyCode(e,i){let r=PR[e.key]||e.key,o="";return i.indexOf("code.")>-1&&(r=e.code,o="code."),r==null||!r?!1:(r=r.toLowerCase(),r===" "?r="space":r==="."&&(r="dot"),sC.forEach(s=>{if(s!==r){let a=kR[s];a(e)&&(o+=s+".")}}),o+=r,o===i)}static eventCallback(e,i,r){return o=>{n.matchEventFullKeyCode(o,e)&&r.runGuarded(()=>i(o))}}static _normalizeKey(e){return e==="esc"?"escape":e}static \u0275fac=function(i){return new(i||n)(L(Ue))};static \u0275prov=k({token:n,factory:n.\u0275fac})}return n})();function u0(n,t,e){let i=P({rootComponent:n,platformRef:e?.platformRef},FR(t));return CE(i)}function FR(n){return{appProviders:[...UR,...n?.providers??[]],platformProviders:zR}}function LR(){Id.makeCurrent()}function jR(){return new zn}function VR(){return Um(document),document}var zR=[{provide:cs,useValue:XE},{provide:Uu,useValue:LR,multi:!0},{provide:Ue,useFactory:VR}];var UR=[{provide:pa,useValue:"root"},{provide:zn,useFactory:jR},{provide:Dd,useClass:Sd,multi:!0,deps:[Ue]},{provide:Dd,useClass:aC,multi:!0,deps:[Ue]},c0,a0,s0,{provide:Zr,useExisting:c0},{provide:oo,useClass:NR},[]];var gs=class{},ol=class{},fi=class n{headers;normalizedNames=new Map;lazyInit;lazyUpdate=null;constructor(t){t?typeof t=="string"?this.lazyInit=()=>{this.headers=new Map,t.split(`
`).forEach(e=>{let i=e.indexOf(":");if(i>0){let r=e.slice(0,i),o=e.slice(i+1).trim();this.addHeaderEntry(r,o)}})}:typeof Headers<"u"&&t instanceof Headers?(this.headers=new Map,t.forEach((e,i)=>{this.addHeaderEntry(i,e)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(t).forEach(([e,i])=>{this.setHeaderEntries(e,i)})}:this.headers=new Map}has(t){return this.init(),this.headers.has(t.toLowerCase())}get(t){this.init();let e=this.headers.get(t.toLowerCase());return e&&e.length>0?e[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(t){return this.init(),this.headers.get(t.toLowerCase())||null}append(t,e){return this.clone({name:t,value:e,op:"a"})}set(t,e){return this.clone({name:t,value:e,op:"s"})}delete(t,e){return this.clone({name:t,value:e,op:"d"})}maybeSetNormalizedName(t,e){this.normalizedNames.has(e)||this.normalizedNames.set(e,t)}init(){this.lazyInit&&(this.lazyInit instanceof n?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(t=>this.applyUpdate(t)),this.lazyUpdate=null))}copyFrom(t){t.init(),Array.from(t.headers.keys()).forEach(e=>{this.headers.set(e,t.headers.get(e)),this.normalizedNames.set(e,t.normalizedNames.get(e))})}clone(t){let e=new n;return e.lazyInit=this.lazyInit&&this.lazyInit instanceof n?this.lazyInit:this,e.lazyUpdate=(this.lazyUpdate||[]).concat([t]),e}applyUpdate(t){let e=t.name.toLowerCase();switch(t.op){case"a":case"s":let i=t.value;if(typeof i=="string"&&(i=[i]),i.length===0)return;this.maybeSetNormalizedName(t.name,e);let r=(t.op==="a"?this.headers.get(e):void 0)||[];r.push(...i),this.headers.set(e,r);break;case"d":let o=t.value;if(!o)this.headers.delete(e),this.normalizedNames.delete(e);else{let s=this.headers.get(e);if(!s)return;s=s.filter(a=>o.indexOf(a)===-1),s.length===0?(this.headers.delete(e),this.normalizedNames.delete(e)):this.headers.set(e,s)}break}}addHeaderEntry(t,e){let i=t.toLowerCase();this.maybeSetNormalizedName(t,i),this.headers.has(i)?this.headers.get(i).push(e):this.headers.set(i,[e])}setHeaderEntries(t,e){let i=(Array.isArray(e)?e:[e]).map(o=>o.toString()),r=t.toLowerCase();this.headers.set(r,i),this.maybeSetNormalizedName(t,r)}forEach(t){this.init(),Array.from(this.normalizedNames.keys()).forEach(e=>t(this.normalizedNames.get(e),this.headers.get(e)))}};var Md=class{encodeKey(t){return lC(t)}encodeValue(t){return lC(t)}decodeKey(t){return decodeURIComponent(t)}decodeValue(t){return decodeURIComponent(t)}};function BR(n,t){let e=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(r=>{let o=r.indexOf("="),[s,a]=o==-1?[t.decodeKey(r),""]:[t.decodeKey(r.slice(0,o)),t.decodeValue(r.slice(o+1))],c=e.get(s)||[];c.push(a),e.set(s,c)}),e}var $R=/%(\d[a-f0-9])/gi,HR={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function lC(n){return encodeURIComponent(n).replace($R,(t,e)=>HR[e]??t)}function Td(n){return`${n}`}var Hi=class n{map;encoder;updates=null;cloneFrom=null;constructor(t={}){if(this.encoder=t.encoder||new Md,t.fromString){if(t.fromObject)throw new F(2805,!1);this.map=BR(t.fromString,this.encoder)}else t.fromObject?(this.map=new Map,Object.keys(t.fromObject).forEach(e=>{let i=t.fromObject[e],r=Array.isArray(i)?i.map(Td):[Td(i)];this.map.set(e,r)})):this.map=null}has(t){return this.init(),this.map.has(t)}get(t){this.init();let e=this.map.get(t);return e?e[0]:null}getAll(t){return this.init(),this.map.get(t)||null}keys(){return this.init(),Array.from(this.map.keys())}append(t,e){return this.clone({param:t,value:e,op:"a"})}appendAll(t){let e=[];return Object.keys(t).forEach(i=>{let r=t[i];Array.isArray(r)?r.forEach(o=>{e.push({param:i,value:o,op:"a"})}):e.push({param:i,value:r,op:"a"})}),this.clone(e)}set(t,e){return this.clone({param:t,value:e,op:"s"})}delete(t,e){return this.clone({param:t,value:e,op:"d"})}toString(){return this.init(),this.keys().map(t=>{let e=this.encoder.encodeKey(t);return this.map.get(t).map(i=>e+"="+this.encoder.encodeValue(i)).join("&")}).filter(t=>t!=="").join("&")}clone(t){let e=new n({encoder:this.encoder});return e.cloneFrom=this.cloneFrom||this,e.updates=(this.updates||[]).concat(t),e}init(){this.map===null&&(this.map=new Map),this.cloneFrom!==null&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(t=>this.map.set(t,this.cloneFrom.map.get(t))),this.updates.forEach(t=>{switch(t.op){case"a":case"s":let e=(t.op==="a"?this.map.get(t.param):void 0)||[];e.push(Td(t.value)),this.map.set(t.param,e);break;case"d":if(t.value!==void 0){let i=this.map.get(t.param)||[],r=i.indexOf(Td(t.value));r!==-1&&i.splice(r,1),i.length>0?this.map.set(t.param,i):this.map.delete(t.param)}else{this.map.delete(t.param);break}}}),this.cloneFrom=this.updates=null)}};var Ad=class{map=new Map;set(t,e){return this.map.set(t,e),this}get(t){return this.map.has(t)||this.map.set(t,t.defaultValue()),this.map.get(t)}delete(t){return this.map.delete(t),this}has(t){return this.map.has(t)}keys(){return this.map.keys()}};function WR(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}function cC(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function uC(n){return typeof Blob<"u"&&n instanceof Blob}function dC(n){return typeof FormData<"u"&&n instanceof FormData}function GR(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}var fC="Content-Type",pC="Accept",hC="X-Request-URL",mC="text/plain",gC="application/json",qR=`${gC}, ${mC}, */*`,hs=class n{url;body=null;headers;context;reportProgress=!1;withCredentials=!1;credentials;keepalive=!1;cache;priority;mode;redirect;referrer;integrity;responseType="json";method;params;urlWithParams;transferCache;timeout;constructor(t,e,i,r){this.url=e,this.method=t.toUpperCase();let o;if(WR(this.method)||r?(this.body=i!==void 0?i:null,o=r):o=i,o){if(this.reportProgress=!!o.reportProgress,this.withCredentials=!!o.withCredentials,this.keepalive=!!o.keepalive,o.responseType&&(this.responseType=o.responseType),o.headers&&(this.headers=o.headers),o.context&&(this.context=o.context),o.params&&(this.params=o.params),o.priority&&(this.priority=o.priority),o.cache&&(this.cache=o.cache),o.credentials&&(this.credentials=o.credentials),typeof o.timeout=="number"){if(o.timeout<1||!Number.isInteger(o.timeout))throw new F(2822,"");this.timeout=o.timeout}o.mode&&(this.mode=o.mode),o.redirect&&(this.redirect=o.redirect),o.integrity&&(this.integrity=o.integrity),o.referrer&&(this.referrer=o.referrer),this.transferCache=o.transferCache}if(this.headers??=new fi,this.context??=new Ad,!this.params)this.params=new Hi,this.urlWithParams=e;else{let s=this.params.toString();if(s.length===0)this.urlWithParams=e;else{let a=e.indexOf("?"),c=a===-1?"?":a<e.length-1?"&":"";this.urlWithParams=e+c+s}}}serializeBody(){return this.body===null?null:typeof this.body=="string"||cC(this.body)||uC(this.body)||dC(this.body)||GR(this.body)?this.body:this.body instanceof Hi?this.body.toString():typeof this.body=="object"||typeof this.body=="boolean"||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return this.body===null||dC(this.body)?null:uC(this.body)?this.body.type||null:cC(this.body)?null:typeof this.body=="string"?mC:this.body instanceof Hi?"application/x-www-form-urlencoded;charset=UTF-8":typeof this.body=="object"||typeof this.body=="number"||typeof this.body=="boolean"?gC:null}clone(t={}){let e=t.method||this.method,i=t.url||this.url,r=t.responseType||this.responseType,o=t.keepalive??this.keepalive,s=t.priority||this.priority,a=t.cache||this.cache,c=t.mode||this.mode,f=t.redirect||this.redirect,h=t.credentials||this.credentials,m=t.referrer||this.referrer,y=t.integrity||this.integrity,g=t.transferCache??this.transferCache,w=t.timeout??this.timeout,T=t.body!==void 0?t.body:this.body,x=t.withCredentials??this.withCredentials,M=t.reportProgress??this.reportProgress,X=t.headers||this.headers,$=t.params||this.params,V=t.context??this.context;return t.setHeaders!==void 0&&(X=Object.keys(t.setHeaders).reduce((fe,dt)=>fe.set(dt,t.setHeaders[dt]),X)),t.setParams&&($=Object.keys(t.setParams).reduce((fe,dt)=>fe.set(dt,t.setParams[dt]),$)),new n(e,i,T,{params:$,headers:X,context:V,reportProgress:M,responseType:r,withCredentials:x,transferCache:g,keepalive:o,cache:a,priority:s,timeout:w,mode:c,redirect:f,credentials:h,referrer:m,integrity:y})}},so=(function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n})(so||{}),vs=class{headers;status;statusText;url;ok;type;redirected;constructor(t,e=200,i="OK"){this.headers=t.headers||new fi,this.status=t.status!==void 0?t.status:e,this.statusText=t.statusText||i,this.url=t.url||null,this.redirected=t.redirected,this.ok=this.status>=200&&this.status<300}},Rd=class n extends vs{constructor(t={}){super(t)}type=so.ResponseHeader;clone(t={}){return new n({headers:t.headers||this.headers,status:t.status!==void 0?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0})}},sl=class n extends vs{body;constructor(t={}){super(t),this.body=t.body!==void 0?t.body:null}type=so.Response;clone(t={}){return new n({body:t.body!==void 0?t.body:this.body,headers:t.headers||this.headers,status:t.status!==void 0?t.status:this.status,statusText:t.statusText||this.statusText,url:t.url||this.url||void 0,redirected:t.redirected??this.redirected})}},ms=class extends vs{name="HttpErrorResponse";message;error;ok=!1;constructor(t){super(t,0,"Unknown Error"),this.status>=200&&this.status<300?this.message=`Http failure during parsing for ${t.url||"(unknown url)"}`:this.message=`Http failure response for ${t.url||"(unknown url)"}: ${t.status} ${t.statusText}`,this.error=t.error||null}},KR=200,YR=204;function d0(n,t){return{body:t,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials,credentials:n.credentials,transferCache:n.transferCache,timeout:n.timeout,keepalive:n.keepalive,priority:n.priority,cache:n.cache,mode:n.mode,redirect:n.redirect,integrity:n.integrity,referrer:n.referrer}}var pi=(()=>{class n{handler;constructor(e){this.handler=e}request(e,i,r={}){let o;if(e instanceof hs)o=e;else{let c;r.headers instanceof fi?c=r.headers:c=new fi(r.headers);let f;r.params&&(r.params instanceof Hi?f=r.params:f=new Hi({fromObject:r.params})),o=new hs(e,i,r.body!==void 0?r.body:null,{headers:c,context:r.context,params:f,reportProgress:r.reportProgress,responseType:r.responseType||"json",withCredentials:r.withCredentials,transferCache:r.transferCache,keepalive:r.keepalive,priority:r.priority,cache:r.cache,mode:r.mode,redirect:r.redirect,credentials:r.credentials,referrer:r.referrer,integrity:r.integrity,timeout:r.timeout})}let s=H(o).pipe(ni(c=>this.handler.handle(c)));if(e instanceof hs||r.observe==="events")return s;let a=s.pipe(rt(c=>c instanceof sl));switch(r.observe||"body"){case"body":switch(o.responseType){case"arraybuffer":return a.pipe(le(c=>{if(c.body!==null&&!(c.body instanceof ArrayBuffer))throw new F(2806,!1);return c.body}));case"blob":return a.pipe(le(c=>{if(c.body!==null&&!(c.body instanceof Blob))throw new F(2807,!1);return c.body}));case"text":return a.pipe(le(c=>{if(c.body!==null&&typeof c.body!="string")throw new F(2808,!1);return c.body}));case"json":default:return a.pipe(le(c=>c.body))}case"response":return a;default:throw new F(2809,!1)}}delete(e,i={}){return this.request("DELETE",e,i)}get(e,i={}){return this.request("GET",e,i)}head(e,i={}){return this.request("HEAD",e,i)}jsonp(e,i){return this.request("JSONP",e,{params:new Hi().append(i,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(e,i={}){return this.request("OPTIONS",e,i)}patch(e,i,r={}){return this.request("PATCH",e,d0(r,i))}post(e,i,r={}){return this.request("POST",e,d0(r,i))}put(e,i,r={}){return this.request("PUT",e,d0(r,i))}static \u0275fac=function(i){return new(i||n)(L(gs))};static \u0275prov=k({token:n,factory:n.\u0275fac})}return n})();var ZR=new U("");function JR(n,t){return t(n)}function QR(n,t,e){return(i,r)=>pt(e,()=>t(i,o=>n(o,r)))}var vC=new U(""),_C=new U(""),yC=new U("",{providedIn:"root",factory:()=>!0});var Od=(()=>{class n extends gs{backend;injector;chain=null;pendingTasks=A(du);contributeToStability=A(yC);constructor(e,i){super(),this.backend=e,this.injector=i}handle(e){if(this.chain===null){let i=Array.from(new Set([...this.injector.get(vC),...this.injector.get(_C,[])]));this.chain=i.reduceRight((r,o)=>QR(r,o,this.injector),JR)}if(this.contributeToStability){let i=this.pendingTasks.add();return this.chain(e,r=>this.backend.handle(r)).pipe(Fr(i))}else return this.chain(e,i=>this.backend.handle(i))}static \u0275fac=function(i){return new(i||n)(L(ol),L(Ze))};static \u0275prov=k({token:n,factory:n.\u0275fac})}return n})();var XR=/^\)\]\}',?\n/,eO=RegExp(`^${hC}:`,"m");function tO(n){return"responseURL"in n&&n.responseURL?n.responseURL:eO.test(n.getAllResponseHeaders())?n.getResponseHeader(hC):null}var f0=(()=>{class n{xhrFactory;constructor(e){this.xhrFactory=e}handle(e){if(e.method==="JSONP")throw new F(-2800,!1);let i=this.xhrFactory;return H(null).pipe(je(()=>new me(o=>{let s=i.build();if(s.open(e.method,e.urlWithParams),e.withCredentials&&(s.withCredentials=!0),e.headers.forEach((x,M)=>s.setRequestHeader(x,M.join(","))),e.headers.has(pC)||s.setRequestHeader(pC,qR),!e.headers.has(fC)){let x=e.detectContentTypeHeader();x!==null&&s.setRequestHeader(fC,x)}if(e.timeout&&(s.timeout=e.timeout),e.responseType){let x=e.responseType.toLowerCase();s.responseType=x!=="json"?x:"text"}let a=e.serializeBody(),c=null,f=()=>{if(c!==null)return c;let x=s.statusText||"OK",M=new fi(s.getAllResponseHeaders()),X=tO(s)||e.url;return c=new Rd({headers:M,status:s.status,statusText:x,url:X}),c},h=()=>{let{headers:x,status:M,statusText:X,url:$}=f(),V=null;M!==YR&&(V=typeof s.response>"u"?s.responseText:s.response),M===0&&(M=V?KR:0);let fe=M>=200&&M<300;if(e.responseType==="json"&&typeof V=="string"){let dt=V;V=V.replace(XR,"");try{V=V!==""?JSON.parse(V):null}catch(Ie){V=dt,fe&&(fe=!1,V={error:Ie,text:V})}}fe?(o.next(new sl({body:V,headers:x,status:M,statusText:X,url:$||void 0})),o.complete()):o.error(new ms({error:V,headers:x,status:M,statusText:X,url:$||void 0}))},m=x=>{let{url:M}=f(),X=new ms({error:x,status:s.status||0,statusText:s.statusText||"Unknown Error",url:M||void 0});o.error(X)},y=m;e.timeout&&(y=x=>{let{url:M}=f(),X=new ms({error:new DOMException("Request timed out","TimeoutError"),status:s.status||0,statusText:s.statusText||"Request timeout",url:M||void 0});o.error(X)});let g=!1,w=x=>{g||(o.next(f()),g=!0);let M={type:so.DownloadProgress,loaded:x.loaded};x.lengthComputable&&(M.total=x.total),e.responseType==="text"&&s.responseText&&(M.partialText=s.responseText),o.next(M)},T=x=>{let M={type:so.UploadProgress,loaded:x.loaded};x.lengthComputable&&(M.total=x.total),o.next(M)};return s.addEventListener("load",h),s.addEventListener("error",m),s.addEventListener("timeout",y),s.addEventListener("abort",m),e.reportProgress&&(s.addEventListener("progress",w),a!==null&&s.upload&&s.upload.addEventListener("progress",T)),s.send(a),o.next({type:so.Sent}),()=>{s.removeEventListener("error",m),s.removeEventListener("abort",m),s.removeEventListener("load",h),s.removeEventListener("timeout",y),e.reportProgress&&(s.removeEventListener("progress",w),a!==null&&s.upload&&s.upload.removeEventListener("progress",T)),s.readyState!==s.DONE&&s.abort()}})))}static \u0275fac=function(i){return new(i||n)(L(oo))};static \u0275prov=k({token:n,factory:n.\u0275fac})}return n})(),bC=new U(""),nO="XSRF-TOKEN",iO=new U("",{providedIn:"root",factory:()=>nO}),rO="X-XSRF-TOKEN",oO=new U("",{providedIn:"root",factory:()=>rO}),al=class{},sO=(()=>{class n{doc;cookieName;lastCookieString="";lastToken=null;parseCount=0;constructor(e,i){this.doc=e,this.cookieName=i}getToken(){let e=this.doc.cookie||"";return e!==this.lastCookieString&&(this.parseCount++,this.lastToken=el(e,this.cookieName),this.lastCookieString=e),this.lastToken}static \u0275fac=function(i){return new(i||n)(L(Ue),L(iO))};static \u0275prov=k({token:n,factory:n.\u0275fac})}return n})();function aO(n,t){let e=n.url.toLowerCase();if(!A(bC)||n.method==="GET"||n.method==="HEAD"||e.startsWith("http://")||e.startsWith("https://"))return t(n);let i=A(al).getToken(),r=A(oO);return i!=null&&!n.headers.has(r)&&(n=n.clone({headers:n.headers.set(r,i)})),t(n)}function p0(...n){let t=[pi,f0,Od,{provide:gs,useExisting:Od},{provide:ol,useFactory:()=>A(ZR,{optional:!0})??A(f0)},{provide:vC,useValue:aO,multi:!0},{provide:bC,useValue:!0},{provide:al,useClass:sO}];for(let e of n)t.push(...e.\u0275providers);return ii(t)}var wC=(()=>{class n{_doc;constructor(e){this._doc=e}getTitle(){return this._doc.title}setTitle(e){this._doc.title=e||""}static \u0275fac=function(i){return new(i||n)(L(Ue))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var ce="primary",bl=Symbol("RouteTitle"),_0=class{params;constructor(t){this.params=t||{}}has(t){return Object.prototype.hasOwnProperty.call(this.params,t)}get(t){if(this.has(t)){let e=this.params[t];return Array.isArray(e)?e[0]:e}return null}getAll(t){if(this.has(t)){let e=this.params[t];return Array.isArray(e)?e:[e]}return[]}get keys(){return Object.keys(this.params)}};function co(n){return new _0(n)}function MC(n,t,e){let i=e.path.split("/");if(i.length>n.length||e.pathMatch==="full"&&(t.hasChildren()||i.length<n.length))return null;let r={};for(let o=0;o<i.length;o++){let s=i[o],a=n[o];if(s[0]===":")r[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:n.slice(0,i.length),posParams:r}}function cO(n,t){if(n.length!==t.length)return!1;for(let e=0;e<n.length;++e)if(!hi(n[e],t[e]))return!1;return!0}function hi(n,t){let e=n?y0(n):void 0,i=t?y0(t):void 0;if(!e||!i||e.length!=i.length)return!1;let r;for(let o=0;o<e.length;o++)if(r=e[o],!AC(n[r],t[r]))return!1;return!0}function y0(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}function AC(n,t){if(Array.isArray(n)&&Array.isArray(t)){if(n.length!==t.length)return!1;let e=[...n].sort(),i=[...t].sort();return e.every((r,o)=>i[o]===r)}else return n===t}function RC(n){return n.length>0?n[n.length-1]:null}function Wi(n){return Bp(n)?n:fr(n)?B(Promise.resolve(n)):H(n)}var uO={exact:NC,subset:PC},OC={exact:dO,subset:fO,ignored:()=>!0};function EC(n,t,e){return uO[e.paths](n.root,t.root,e.matrixParams)&&OC[e.queryParams](n.queryParams,t.queryParams)&&!(e.fragment==="exact"&&n.fragment!==t.fragment)}function dO(n,t){return hi(n,t)}function NC(n,t,e){if(!ao(n.segments,t.segments)||!Fd(n.segments,t.segments,e)||n.numberOfChildren!==t.numberOfChildren)return!1;for(let i in t.children)if(!n.children[i]||!NC(n.children[i],t.children[i],e))return!1;return!0}function fO(n,t){return Object.keys(t).length<=Object.keys(n).length&&Object.keys(t).every(e=>AC(n[e],t[e]))}function PC(n,t,e){return kC(n,t,t.segments,e)}function kC(n,t,e,i){if(n.segments.length>e.length){let r=n.segments.slice(0,e.length);return!(!ao(r,e)||t.hasChildren()||!Fd(r,e,i))}else if(n.segments.length===e.length){if(!ao(n.segments,e)||!Fd(n.segments,e,i))return!1;for(let r in t.children)if(!n.children[r]||!PC(n.children[r],t.children[r],i))return!1;return!0}else{let r=e.slice(0,n.segments.length),o=e.slice(n.segments.length);return!ao(n.segments,r)||!Fd(n.segments,r,i)||!n.children[ce]?!1:kC(n.children[ce],t,o,i)}}function Fd(n,t,e){return t.every((i,r)=>OC[e](n[r].parameters,i.parameters))}var gi=class{root;queryParams;fragment;_queryParamMap;constructor(t=new Ce([],{}),e={},i=null){this.root=t,this.queryParams=e,this.fragment=i}get queryParamMap(){return this._queryParamMap??=co(this.queryParams),this._queryParamMap}toString(){return mO.serialize(this)}},Ce=class{segments;children;parent=null;constructor(t,e){this.segments=t,this.children=e,Object.values(e).forEach(i=>i.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Ld(this)}},vr=class{path;parameters;_parameterMap;constructor(t,e){this.path=t,this.parameters=e}get parameterMap(){return this._parameterMap??=co(this.parameters),this._parameterMap}toString(){return LC(this)}};function pO(n,t){return ao(n,t)&&n.every((e,i)=>hi(e.parameters,t[i].parameters))}function ao(n,t){return n.length!==t.length?!1:n.every((e,i)=>e.path===t[i].path)}function hO(n,t){let e=[];return Object.entries(n.children).forEach(([i,r])=>{i===ce&&(e=e.concat(t(r,i)))}),Object.entries(n.children).forEach(([i,r])=>{i!==ce&&(e=e.concat(t(r,i)))}),e}var uo=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=k({token:n,factory:()=>new _r,providedIn:"root"})}return n})(),_r=class{parse(t){let e=new w0(t);return new gi(e.parseRootSegment(),e.parseQueryParams(),e.parseFragment())}serialize(t){let e=`/${ll(t.root,!0)}`,i=_O(t.queryParams),r=typeof t.fragment=="string"?`#${gO(t.fragment)}`:"";return`${e}${i}${r}`}},mO=new _r;function Ld(n){return n.segments.map(t=>LC(t)).join("/")}function ll(n,t){if(!n.hasChildren())return Ld(n);if(t){let e=n.children[ce]?ll(n.children[ce],!1):"",i=[];return Object.entries(n.children).forEach(([r,o])=>{r!==ce&&i.push(`${r}:${ll(o,!1)}`)}),i.length>0?`${e}(${i.join("//")})`:e}else{let e=hO(n,(i,r)=>r===ce?[ll(n.children[ce],!1)]:[`${r}:${ll(i,!1)}`]);return Object.keys(n.children).length===1&&n.children[ce]!=null?`${Ld(n)}/${e[0]}`:`${Ld(n)}/(${e.join("//")})`}}function FC(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Pd(n){return FC(n).replace(/%3B/gi,";")}function gO(n){return encodeURI(n)}function b0(n){return FC(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function jd(n){return decodeURIComponent(n)}function CC(n){return jd(n.replace(/\+/g,"%20"))}function LC(n){return`${b0(n.path)}${vO(n.parameters)}`}function vO(n){return Object.entries(n).map(([t,e])=>`;${b0(t)}=${b0(e)}`).join("")}function _O(n){let t=Object.entries(n).map(([e,i])=>Array.isArray(i)?i.map(r=>`${Pd(e)}=${Pd(r)}`).join("&"):`${Pd(e)}=${Pd(i)}`).filter(e=>e);return t.length?`?${t.join("&")}`:""}var yO=/^[^\/()?;#]+/;function h0(n){let t=n.match(yO);return t?t[0]:""}var bO=/^[^\/()?;=#]+/;function wO(n){let t=n.match(bO);return t?t[0]:""}var EO=/^[^=?&#]+/;function CO(n){let t=n.match(EO);return t?t[0]:""}var SO=/^[^&#]+/;function xO(n){let t=n.match(SO);return t?t[0]:""}var w0=class{url;remaining;constructor(t){this.url=t,this.remaining=t}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ce([],{}):new Ce([],this.parseChildren())}parseQueryParams(){let t={};if(this.consumeOptional("?"))do this.parseQueryParam(t);while(this.consumeOptional("&"));return t}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let t=[];for(this.peekStartsWith("(")||t.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),t.push(this.parseSegment());let e={};this.peekStartsWith("/(")&&(this.capture("/"),e=this.parseParens(!0));let i={};return this.peekStartsWith("(")&&(i=this.parseParens(!1)),(t.length>0||Object.keys(e).length>0)&&(i[ce]=new Ce(t,e)),i}parseSegment(){let t=h0(this.remaining);if(t===""&&this.peekStartsWith(";"))throw new F(4009,!1);return this.capture(t),new vr(jd(t),this.parseMatrixParams())}parseMatrixParams(){let t={};for(;this.consumeOptional(";");)this.parseParam(t);return t}parseParam(t){let e=wO(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){let r=h0(this.remaining);r&&(i=r,this.capture(i))}t[jd(e)]=jd(i)}parseQueryParam(t){let e=CO(this.remaining);if(!e)return;this.capture(e);let i="";if(this.consumeOptional("=")){let s=xO(this.remaining);s&&(i=s,this.capture(i))}let r=CC(e),o=CC(i);if(t.hasOwnProperty(r)){let s=t[r];Array.isArray(s)||(s=[s],t[r]=s),s.push(o)}else t[r]=o}parseParens(t){let e={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let i=h0(this.remaining),r=this.remaining[i.length];if(r!=="/"&&r!==")"&&r!==";")throw new F(4010,!1);let o;i.indexOf(":")>-1?(o=i.slice(0,i.indexOf(":")),this.capture(o),this.capture(":")):t&&(o=ce);let s=this.parseChildren();e[o]=Object.keys(s).length===1&&s[ce]?s[ce]:new Ce([],s),this.consumeOptional("//")}return e}peekStartsWith(t){return this.remaining.startsWith(t)}consumeOptional(t){return this.peekStartsWith(t)?(this.remaining=this.remaining.substring(t.length),!0):!1}capture(t){if(!this.consumeOptional(t))throw new F(4011,!1)}};function jC(n){return n.segments.length>0?new Ce([],{[ce]:n}):n}function VC(n){let t={};for(let[i,r]of Object.entries(n.children)){let o=VC(r);if(i===ce&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))t[s]=a;else(o.segments.length>0||o.hasChildren())&&(t[i]=o)}let e=new Ce(n.segments,t);return DO(e)}function DO(n){if(n.numberOfChildren===1&&n.children[ce]){let t=n.children[ce];return new Ce(n.segments.concat(t.segments),t.children)}return n}function yr(n){return n instanceof gi}function zC(n,t,e=null,i=null){let r=UC(n);return BC(r,t,e,i)}function UC(n){let t;function e(o){let s={};for(let c of o.children){let f=e(c);s[c.outlet]=f}let a=new Ce(o.url,s);return o===n&&(t=a),a}let i=e(n.root),r=jC(i);return t??r}function BC(n,t,e,i){let r=n;for(;r.parent;)r=r.parent;if(t.length===0)return m0(r,r,r,e,i);let o=IO(t);if(o.toRoot())return m0(r,r,new Ce([],{}),e,i);let s=TO(o,r,n),a=s.processChildren?ul(s.segmentGroup,s.index,o.commands):HC(s.segmentGroup,s.index,o.commands);return m0(r,s.segmentGroup,a,e,i)}function Vd(n){return typeof n=="object"&&n!=null&&!n.outlets&&!n.segmentPath}function fl(n){return typeof n=="object"&&n!=null&&n.outlets}function m0(n,t,e,i,r){let o={};i&&Object.entries(i).forEach(([c,f])=>{o[c]=Array.isArray(f)?f.map(h=>`${h}`):`${f}`});let s;n===t?s=e:s=$C(n,t,e);let a=jC(VC(s));return new gi(a,o,r)}function $C(n,t,e){let i={};return Object.entries(n.children).forEach(([r,o])=>{o===t?i[r]=e:i[r]=$C(o,t,e)}),new Ce(n.segments,i)}var zd=class{isAbsolute;numberOfDoubleDots;commands;constructor(t,e,i){if(this.isAbsolute=t,this.numberOfDoubleDots=e,this.commands=i,t&&i.length>0&&Vd(i[0]))throw new F(4003,!1);let r=i.find(fl);if(r&&r!==RC(i))throw new F(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function IO(n){if(typeof n[0]=="string"&&n.length===1&&n[0]==="/")return new zd(!0,0,n);let t=0,e=!1,i=n.reduce((r,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([c,f])=>{a[c]=typeof f=="string"?f.split("/"):f}),[...r,{outlets:a}]}if(o.segmentPath)return[...r,o.segmentPath]}return typeof o!="string"?[...r,o]:s===0?(o.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?e=!0:a===".."?t++:a!=""&&r.push(a))}),r):[...r,o]},[]);return new zd(e,t,i)}var bs=class{segmentGroup;processChildren;index;constructor(t,e,i){this.segmentGroup=t,this.processChildren=e,this.index=i}};function TO(n,t,e){if(n.isAbsolute)return new bs(t,!0,0);if(!e)return new bs(t,!1,NaN);if(e.parent===null)return new bs(e,!0,0);let i=Vd(n.commands[0])?0:1,r=e.segments.length-1+i;return MO(e,r,n.numberOfDoubleDots)}function MO(n,t,e){let i=n,r=t,o=e;for(;o>r;){if(o-=r,i=i.parent,!i)throw new F(4005,!1);r=i.segments.length}return new bs(i,!1,r-o)}function AO(n){return fl(n[0])?n[0].outlets:{[ce]:n}}function HC(n,t,e){if(n??=new Ce([],{}),n.segments.length===0&&n.hasChildren())return ul(n,t,e);let i=RO(n,t,e),r=e.slice(i.commandIndex);if(i.match&&i.pathIndex<n.segments.length){let o=new Ce(n.segments.slice(0,i.pathIndex),{});return o.children[ce]=new Ce(n.segments.slice(i.pathIndex),n.children),ul(o,0,r)}else return i.match&&r.length===0?new Ce(n.segments,{}):i.match&&!n.hasChildren()?E0(n,t,e):i.match?ul(n,0,r):E0(n,t,e)}function ul(n,t,e){if(e.length===0)return new Ce(n.segments,{});{let i=AO(e),r={};if(Object.keys(i).some(o=>o!==ce)&&n.children[ce]&&n.numberOfChildren===1&&n.children[ce].segments.length===0){let o=ul(n.children[ce],t,e);return new Ce(n.segments,o.children)}return Object.entries(i).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(r[o]=HC(n.children[o],t,s))}),Object.entries(n.children).forEach(([o,s])=>{i[o]===void 0&&(r[o]=s)}),new Ce(n.segments,r)}}function RO(n,t,e){let i=0,r=t,o={match:!1,pathIndex:0,commandIndex:0};for(;r<n.segments.length;){if(i>=e.length)return o;let s=n.segments[r],a=e[i];if(fl(a))break;let c=`${a}`,f=i<e.length-1?e[i+1]:null;if(r>0&&c===void 0)break;if(c&&f&&typeof f=="object"&&f.outlets===void 0){if(!xC(c,f,s))return o;i+=2}else{if(!xC(c,{},s))return o;i++}r++}return{match:!0,pathIndex:r,commandIndex:i}}function E0(n,t,e){let i=n.segments.slice(0,t),r=0;for(;r<e.length;){let o=e[r];if(fl(o)){let c=OO(o.outlets);return new Ce(i,c)}if(r===0&&Vd(e[0])){let c=n.segments[t];i.push(new vr(c.path,SC(e[0]))),r++;continue}let s=fl(o)?o.outlets[ce]:`${o}`,a=r<e.length-1?e[r+1]:null;s&&a&&Vd(a)?(i.push(new vr(s,SC(a))),r+=2):(i.push(new vr(s,{})),r++)}return new Ce(i,{})}function OO(n){let t={};return Object.entries(n).forEach(([e,i])=>{typeof i=="string"&&(i=[i]),i!==null&&(t[e]=E0(new Ce([],{}),0,i))}),t}function SC(n){let t={};return Object.entries(n).forEach(([e,i])=>t[e]=`${i}`),t}function xC(n,t,e){return n==e.path&&hi(t,e.parameters)}var ws="imperative",lt=(function(n){return n[n.NavigationStart=0]="NavigationStart",n[n.NavigationEnd=1]="NavigationEnd",n[n.NavigationCancel=2]="NavigationCancel",n[n.NavigationError=3]="NavigationError",n[n.RoutesRecognized=4]="RoutesRecognized",n[n.ResolveStart=5]="ResolveStart",n[n.ResolveEnd=6]="ResolveEnd",n[n.GuardsCheckStart=7]="GuardsCheckStart",n[n.GuardsCheckEnd=8]="GuardsCheckEnd",n[n.RouteConfigLoadStart=9]="RouteConfigLoadStart",n[n.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",n[n.ChildActivationStart=11]="ChildActivationStart",n[n.ChildActivationEnd=12]="ChildActivationEnd",n[n.ActivationStart=13]="ActivationStart",n[n.ActivationEnd=14]="ActivationEnd",n[n.Scroll=15]="Scroll",n[n.NavigationSkipped=16]="NavigationSkipped",n})(lt||{}),_n=class{id;url;constructor(t,e){this.id=t,this.url=e}},br=class extends _n{type=lt.NavigationStart;navigationTrigger;restoredState;constructor(t,e,i="imperative",r=null){super(t,e),this.navigationTrigger=i,this.restoredState=r}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Jt=class extends _n{urlAfterRedirects;type=lt.NavigationEnd;constructor(t,e,i){super(t,e),this.urlAfterRedirects=i}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Zt=(function(n){return n[n.Redirect=0]="Redirect",n[n.SupersededByNewNavigation=1]="SupersededByNewNavigation",n[n.NoDataFromResolver=2]="NoDataFromResolver",n[n.GuardRejected=3]="GuardRejected",n[n.Aborted=4]="Aborted",n})(Zt||{}),Cs=(function(n){return n[n.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",n[n.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",n})(Cs||{}),mi=class extends _n{reason;code;type=lt.NavigationCancel;constructor(t,e,i,r){super(t,e),this.reason=i,this.code=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},vi=class extends _n{reason;code;type=lt.NavigationSkipped;constructor(t,e,i,r){super(t,e),this.reason=i,this.code=r}},Ss=class extends _n{error;target;type=lt.NavigationError;constructor(t,e,i,r){super(t,e),this.error=i,this.target=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},pl=class extends _n{urlAfterRedirects;state;type=lt.RoutesRecognized;constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Ud=class extends _n{urlAfterRedirects;state;type=lt.GuardsCheckStart;constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Bd=class extends _n{urlAfterRedirects;state;shouldActivate;type=lt.GuardsCheckEnd;constructor(t,e,i,r,o){super(t,e),this.urlAfterRedirects=i,this.state=r,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},$d=class extends _n{urlAfterRedirects;state;type=lt.ResolveStart;constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Hd=class extends _n{urlAfterRedirects;state;type=lt.ResolveEnd;constructor(t,e,i,r){super(t,e),this.urlAfterRedirects=i,this.state=r}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Wd=class{route;type=lt.RouteConfigLoadStart;constructor(t){this.route=t}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},Gd=class{route;type=lt.RouteConfigLoadEnd;constructor(t){this.route=t}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},qd=class{snapshot;type=lt.ChildActivationStart;constructor(t){this.snapshot=t}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Kd=class{snapshot;type=lt.ChildActivationEnd;constructor(t){this.snapshot=t}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Yd=class{snapshot;type=lt.ActivationStart;constructor(t){this.snapshot=t}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Zd=class{snapshot;type=lt.ActivationEnd;constructor(t){this.snapshot=t}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},xs=class{routerEvent;position;anchor;type=lt.Scroll;constructor(t,e,i){this.routerEvent=t,this.position=e,this.anchor=i}toString(){let t=this.position?`${this.position[0]}, ${this.position[1]}`:null;return`Scroll(anchor: '${this.anchor}', position: '${t}')`}},hl=class{},Ds=class{url;navigationBehaviorOptions;constructor(t,e){this.url=t,this.navigationBehaviorOptions=e}};function NO(n){return!(n instanceof hl)&&!(n instanceof Ds)}function PO(n,t){return n.providers&&!n._injector&&(n._injector=ds(n.providers,t,`Route: ${n.path}`)),n._injector??t}function Qn(n){return n.outlet||ce}function kO(n,t){let e=n.filter(i=>Qn(i)===t);return e.push(...n.filter(i=>Qn(i)!==t)),e}function Ms(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let t=n.parent;t;t=t.parent){let e=t.routeConfig;if(e?._loadedInjector)return e._loadedInjector;if(e?._injector)return e._injector}return null}var Jd=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return Ms(this.route?.snapshot)??this.rootInjector}constructor(t){this.rootInjector=t,this.children=new fo(this.rootInjector)}},fo=(()=>{class n{rootInjector;contexts=new Map;constructor(e){this.rootInjector=e}onChildOutletCreated(e,i){let r=this.getOrCreateContext(e);r.outlet=i,this.contexts.set(e,r)}onChildOutletDestroyed(e){let i=this.getContext(e);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let i=this.getContext(e);return i||(i=new Jd(this.rootInjector),this.contexts.set(e,i)),i}getContext(e){return this.contexts.get(e)||null}static \u0275fac=function(i){return new(i||n)(L(Ze))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),Qd=class{_root;constructor(t){this._root=t}get root(){return this._root.value}parent(t){let e=this.pathFromRoot(t);return e.length>1?e[e.length-2]:null}children(t){let e=C0(t,this._root);return e?e.children.map(i=>i.value):[]}firstChild(t){let e=C0(t,this._root);return e&&e.children.length>0?e.children[0].value:null}siblings(t){let e=S0(t,this._root);return e.length<2?[]:e[e.length-2].children.map(r=>r.value).filter(r=>r!==t)}pathFromRoot(t){return S0(t,this._root).map(e=>e.value)}};function C0(n,t){if(n===t.value)return t;for(let e of t.children){let i=C0(n,e);if(i)return i}return null}function S0(n,t){if(n===t.value)return[t];for(let e of t.children){let i=S0(n,e);if(i.length)return i.unshift(t),i}return[]}var vn=class{value;children;constructor(t,e){this.value=t,this.children=e}toString(){return`TreeNode(${this.value})`}};function ys(n){let t={};return n&&n.children.forEach(e=>t[e.value.outlet]=e),t}var ml=class extends Qd{snapshot;constructor(t,e){super(t),this.snapshot=e,O0(this,t)}toString(){return this.snapshot.toString()}};function WC(n){let t=FO(n),e=new Ke([new vr("",{})]),i=new Ke({}),r=new Ke({}),o=new Ke({}),s=new Ke(""),a=new Lt(e,i,o,s,r,ce,n,t.root);return a.snapshot=t.root,new ml(new vn(a,[]),t)}function FO(n){let t={},e={},i={},o=new lo([],t,i,"",e,ce,n,null,{});return new gl("",new vn(o,[]))}var Lt=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(t,e,i,r,o,s,a,c){this.urlSubject=t,this.paramsSubject=e,this.queryParamsSubject=i,this.fragmentSubject=r,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(le(f=>f[bl]))??H(void 0),this.url=t,this.params=e,this.queryParams=i,this.fragment=r,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(le(t=>co(t))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(le(t=>co(t))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Xd(n,t,e="emptyOnly"){let i,{routeConfig:r}=n;return t!==null&&(e==="always"||r?.path===""||!t.component&&!t.routeConfig?.loadComponent)?i={params:P(P({},t.params),n.params),data:P(P({},t.data),n.data),resolve:P(P(P(P({},n.data),t.data),r?.data),n._resolvedData)}:i={params:P({},n.params),data:P({},n.data),resolve:P(P({},n.data),n._resolvedData??{})},r&&qC(r)&&(i.resolve[bl]=r.title),i}var lo=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[bl]}constructor(t,e,i,r,o,s,a,c,f){this.url=t,this.params=e,this.queryParams=i,this.fragment=r,this.data=o,this.outlet=s,this.component=a,this.routeConfig=c,this._resolve=f}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=co(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=co(this.queryParams),this._queryParamMap}toString(){let t=this.url.map(i=>i.toString()).join("/"),e=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${t}', path:'${e}')`}},gl=class extends Qd{url;constructor(t,e){super(e),this.url=t,O0(this,e)}toString(){return GC(this._root)}};function O0(n,t){t.value._routerState=n,t.children.forEach(e=>O0(n,e))}function GC(n){let t=n.children.length>0?` { ${n.children.map(GC).join(", ")} } `:"";return`${n.value}${t}`}function g0(n){if(n.snapshot){let t=n.snapshot,e=n._futureSnapshot;n.snapshot=e,hi(t.queryParams,e.queryParams)||n.queryParamsSubject.next(e.queryParams),t.fragment!==e.fragment&&n.fragmentSubject.next(e.fragment),hi(t.params,e.params)||n.paramsSubject.next(e.params),cO(t.url,e.url)||n.urlSubject.next(e.url),hi(t.data,e.data)||n.dataSubject.next(e.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function x0(n,t){let e=hi(n.params,t.params)&&pO(n.url,t.url),i=!n.parent!=!t.parent;return e&&!i&&(!n.parent||x0(n.parent,t.parent))}function qC(n){return typeof n.title=="string"||n.title===null}var KC=new U(""),wl=(()=>{class n{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=ce;activateEvents=new Re;deactivateEvents=new Re;attachEvents=new Re;detachEvents=new Re;routerOutletData=EE(void 0);parentContexts=A(fo);location=A(ji);changeDetector=A(Bi);inputBinder=A(El,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(e){if(e.name){let{firstChange:i,previousValue:r}=e.name;if(i)return;this.isTrackedInParentContexts(r)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(r)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(e){return this.parentContexts.getContext(e)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let e=this.parentContexts.getContext(this.name);e?.route&&(e.attachRef?this.attach(e.attachRef,e.route):this.activateWith(e.route,e.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new F(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new F(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new F(4012,!1);this.location.detach();let e=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(e.instance),e}attach(e,i){this.activated=e,this._activatedRoute=i,this.location.insert(e.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(e.instance)}deactivate(){if(this.activated){let e=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(e)}}activateWith(e,i){if(this.isActivated)throw new F(4013,!1);this._activatedRoute=e;let r=this.location,s=e.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,c=new D0(e,a,r.injector,this.routerOutletData);this.activated=r.createComponent(s,{index:r.length,injector:c,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(i){return new(i||n)};static \u0275dir=ye({type:n,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[fn]})}return n})(),D0=class{route;childContexts;parent;outletData;constructor(t,e,i,r){this.route=t,this.childContexts=e,this.parent=i,this.outletData=r}get(t,e){return t===Lt?this.route:t===fo?this.childContexts:t===KC?this.outletData:this.parent.get(t,e)}},El=new U(""),N0=(()=>{class n{outletDataSubscriptions=new Map;bindActivatedRouteToOutletComponent(e){this.unsubscribeFromRouteData(e),this.subscribeToRouteData(e)}unsubscribeFromRouteData(e){this.outletDataSubscriptions.get(e)?.unsubscribe(),this.outletDataSubscriptions.delete(e)}subscribeToRouteData(e){let{activatedRoute:i}=e,r=sa([i.queryParams,i.params,i.data]).pipe(je(([o,s,a],c)=>(a=P(P(P({},o),s),a),c===0?H(a):Promise.resolve(a)))).subscribe(o=>{if(!e.isActivated||!e.activatedComponentRef||e.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(e);return}let s=SE(i.component);if(!s){this.unsubscribeFromRouteData(e);return}for(let{templateName:a}of s.inputs)e.activatedComponentRef.setInput(a,o[a])});this.outletDataSubscriptions.set(e,r)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=k({token:n,factory:n.\u0275fac})}return n})(),P0=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=ge({type:n,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(i,r){i&1&&N(0,"router-outlet")},dependencies:[wl],encapsulation:2})}return n})();function k0(n){let t=n.children&&n.children.map(k0),e=t?Y(P({},n),{children:t}):P({},n);return!e.component&&!e.loadComponent&&(t||e.loadChildren)&&e.outlet&&e.outlet!==ce&&(e.component=P0),e}function LO(n,t,e){let i=vl(n,t._root,e?e._root:void 0);return new ml(i,t)}function vl(n,t,e){if(e&&n.shouldReuseRoute(t.value,e.value.snapshot)){let i=e.value;i._futureSnapshot=t.value;let r=jO(n,t,e);return new vn(i,r)}else{if(n.shouldAttach(t.value)){let o=n.retrieve(t.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=t.value,s.children=t.children.map(a=>vl(n,a)),s}}let i=VO(t.value),r=t.children.map(o=>vl(n,o));return new vn(i,r)}}function jO(n,t,e){return t.children.map(i=>{for(let r of e.children)if(n.shouldReuseRoute(i.value,r.value.snapshot))return vl(n,i,r);return vl(n,i)})}function VO(n){return new Lt(new Ke(n.url),new Ke(n.params),new Ke(n.queryParams),new Ke(n.fragment),new Ke(n.data),n.outlet,n.component,n)}var Is=class{redirectTo;navigationBehaviorOptions;constructor(t,e){this.redirectTo=t,this.navigationBehaviorOptions=e}},YC="ngNavigationCancelingError";function ef(n,t){let{redirectTo:e,navigationBehaviorOptions:i}=yr(t)?{redirectTo:t,navigationBehaviorOptions:void 0}:t,r=ZC(!1,Zt.Redirect);return r.url=e,r.navigationBehaviorOptions=i,r}function ZC(n,t){let e=new Error(`NavigationCancelingError: ${n||""}`);return e[YC]=!0,e.cancellationCode=t,e}function zO(n){return JC(n)&&yr(n.url)}function JC(n){return!!n&&n[YC]}var UO=(n,t,e,i)=>le(r=>(new I0(t,r.targetRouterState,r.currentRouterState,e,i).activate(n),r)),I0=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(t,e,i,r,o){this.routeReuseStrategy=t,this.futureState=e,this.currState=i,this.forwardEvent=r,this.inputBindingEnabled=o}activate(t){let e=this.futureState._root,i=this.currState?this.currState._root:null;this.deactivateChildRoutes(e,i,t),g0(this.futureState.root),this.activateChildRoutes(e,i,t)}deactivateChildRoutes(t,e,i){let r=ys(e);t.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,r[s],i),delete r[s]}),Object.values(r).forEach(o=>{this.deactivateRouteAndItsChildren(o,i)})}deactivateRoutes(t,e,i){let r=t.value,o=e?e.value:null;if(r===o)if(r.component){let s=i.getContext(r.outlet);s&&this.deactivateChildRoutes(t,e,s.children)}else this.deactivateChildRoutes(t,e,i);else o&&this.deactivateRouteAndItsChildren(e,i)}deactivateRouteAndItsChildren(t,e){t.value.component&&this.routeReuseStrategy.shouldDetach(t.value.snapshot)?this.detachAndStoreRouteSubtree(t,e):this.deactivateRouteAndOutlet(t,e)}detachAndStoreRouteSubtree(t,e){let i=e.getContext(t.value.outlet),r=i&&t.value.component?i.children:e,o=ys(t);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);if(i&&i.outlet){let s=i.outlet.detach(),a=i.children.onOutletDeactivated();this.routeReuseStrategy.store(t.value.snapshot,{componentRef:s,route:t,contexts:a})}}deactivateRouteAndOutlet(t,e){let i=e.getContext(t.value.outlet),r=i&&t.value.component?i.children:e,o=ys(t);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,r);i&&(i.outlet&&(i.outlet.deactivate(),i.children.onOutletDeactivated()),i.attachRef=null,i.route=null)}activateChildRoutes(t,e,i){let r=ys(e);t.children.forEach(o=>{this.activateRoutes(o,r[o.value.outlet],i),this.forwardEvent(new Zd(o.value.snapshot))}),t.children.length&&this.forwardEvent(new Kd(t.value.snapshot))}activateRoutes(t,e,i){let r=t.value,o=e?e.value:null;if(g0(r),r===o)if(r.component){let s=i.getOrCreateContext(r.outlet);this.activateChildRoutes(t,e,s.children)}else this.activateChildRoutes(t,e,i);else if(r.component){let s=i.getOrCreateContext(r.outlet);if(this.routeReuseStrategy.shouldAttach(r.snapshot)){let a=this.routeReuseStrategy.retrieve(r.snapshot);this.routeReuseStrategy.store(r.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),g0(a.route.value),this.activateChildRoutes(t,null,s.children)}else s.attachRef=null,s.route=r,s.outlet&&s.outlet.activateWith(r,s.injector),this.activateChildRoutes(t,null,s.children)}else this.activateChildRoutes(t,null,i)}},tf=class{path;route;constructor(t){this.path=t,this.route=this.path[this.path.length-1]}},Es=class{component;route;constructor(t,e){this.component=t,this.route=e}};function BO(n,t,e){let i=n._root,r=t?t._root:null;return cl(i,r,e,[i.value])}function $O(n){let t=n.routeConfig?n.routeConfig.canActivateChild:null;return!t||t.length===0?null:{node:n,guards:t}}function As(n,t){let e=Symbol(),i=t.get(n,e);return i===e?typeof n=="function"&&!lh(n)?n:t.get(n):i}function cl(n,t,e,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=ys(t);return n.children.forEach(s=>{HO(s,o[s.value.outlet],e,i.concat([s.value]),r),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>dl(a,e.getContext(s),r)),r}function HO(n,t,e,i,r={canDeactivateChecks:[],canActivateChecks:[]}){let o=n.value,s=t?t.value:null,a=e?e.getContext(n.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let c=WO(s,o,o.routeConfig.runGuardsAndResolvers);c?r.canActivateChecks.push(new tf(i)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?cl(n,t,a?a.children:null,i,r):cl(n,t,e,i,r),c&&a&&a.outlet&&a.outlet.isActivated&&r.canDeactivateChecks.push(new Es(a.outlet.component,s))}else s&&dl(t,a,r),r.canActivateChecks.push(new tf(i)),o.component?cl(n,null,a?a.children:null,i,r):cl(n,null,e,i,r);return r}function WO(n,t,e){if(typeof e=="function")return e(n,t);switch(e){case"pathParamsChange":return!ao(n.url,t.url);case"pathParamsOrQueryParamsChange":return!ao(n.url,t.url)||!hi(n.queryParams,t.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!x0(n,t)||!hi(n.queryParams,t.queryParams);case"paramsChange":default:return!x0(n,t)}}function dl(n,t,e){let i=ys(n),r=n.value;Object.entries(i).forEach(([o,s])=>{r.component?t?dl(s,t.children.getContext(o),e):dl(s,null,e):dl(s,t,e)}),r.component?t&&t.outlet&&t.outlet.isActivated?e.canDeactivateChecks.push(new Es(t.outlet.component,r)):e.canDeactivateChecks.push(new Es(null,r)):e.canDeactivateChecks.push(new Es(null,r))}function Cl(n){return typeof n=="function"}function GO(n){return typeof n=="boolean"}function qO(n){return n&&Cl(n.canLoad)}function KO(n){return n&&Cl(n.canActivate)}function YO(n){return n&&Cl(n.canActivateChild)}function ZO(n){return n&&Cl(n.canDeactivate)}function JO(n){return n&&Cl(n.canMatch)}function QC(n){return n instanceof ln||n?.name==="EmptyError"}var kd=Symbol("INITIAL_VALUE");function Ts(){return je(n=>sa(n.map(t=>t.pipe(Pt(1),Yp(kd)))).pipe(le(t=>{for(let e of t)if(e!==!0){if(e===kd)return kd;if(e===!1||QO(e))return e}return!0}),rt(t=>t!==kd),Pt(1)))}function QO(n){return yr(n)||n instanceof Is}function XO(n,t){return Ye(e=>{let{targetSnapshot:i,currentSnapshot:r,guards:{canActivateChecks:o,canDeactivateChecks:s}}=e;return s.length===0&&o.length===0?H(Y(P({},e),{guardsResult:!0})):eN(s,i,r,n).pipe(Ye(a=>a&&GO(a)?tN(i,o,n,t):H(a)),le(a=>Y(P({},e),{guardsResult:a})))})}function eN(n,t,e,i){return B(n).pipe(Ye(r=>sN(r.component,r.route,e,t,i)),Ii(r=>r!==!0,!0))}function tN(n,t,e,i){return B(t).pipe(ni(r=>Wo(iN(r.route.parent,i),nN(r.route,i),oN(n,r.path,e),rN(n,r.route,e))),Ii(r=>r!==!0,!0))}function nN(n,t){return n!==null&&t&&t(new Yd(n)),H(!0)}function iN(n,t){return n!==null&&t&&t(new qd(n)),H(!0)}function rN(n,t,e){let i=t.routeConfig?t.routeConfig.canActivate:null;if(!i||i.length===0)return H(!0);let r=i.map(o=>aa(()=>{let s=Ms(t)??e,a=As(o,s),c=KO(a)?a.canActivate(t,n):pt(s,()=>a(t,n));return Wi(c).pipe(Ii())}));return H(r).pipe(Ts())}function oN(n,t,e){let i=t[t.length-1],o=t.slice(0,t.length-1).reverse().map(s=>$O(s)).filter(s=>s!==null).map(s=>aa(()=>{let a=s.guards.map(c=>{let f=Ms(s.node)??e,h=As(c,f),m=YO(h)?h.canActivateChild(i,n):pt(f,()=>h(i,n));return Wi(m).pipe(Ii())});return H(a).pipe(Ts())}));return H(o).pipe(Ts())}function sN(n,t,e,i,r){let o=t&&t.routeConfig?t.routeConfig.canDeactivate:null;if(!o||o.length===0)return H(!0);let s=o.map(a=>{let c=Ms(t)??r,f=As(a,c),h=ZO(f)?f.canDeactivate(n,t,e,i):pt(c,()=>f(n,t,e,i));return Wi(h).pipe(Ii())});return H(s).pipe(Ts())}function aN(n,t,e,i){let r=t.canLoad;if(r===void 0||r.length===0)return H(!0);let o=r.map(s=>{let a=As(s,n),c=qO(a)?a.canLoad(t,e):pt(n,()=>a(t,e));return Wi(c)});return H(o).pipe(Ts(),XC(i))}function XC(n){return Pp(ft(t=>{if(typeof t!="boolean")throw ef(n,t)}),le(t=>t===!0))}function lN(n,t,e,i){let r=t.canMatch;if(!r||r.length===0)return H(!0);let o=r.map(s=>{let a=As(s,n),c=JO(a)?a.canMatch(t,e):pt(n,()=>a(t,e));return Wi(c)});return H(o).pipe(Ts(),XC(i))}var _l=class{segmentGroup;constructor(t){this.segmentGroup=t||null}},yl=class extends Error{urlTree;constructor(t){super(),this.urlTree=t}};function _s(n){return Ho(new _l(n))}function cN(n){return Ho(new F(4e3,!1))}function uN(n){return Ho(ZC(!1,Zt.GuardRejected))}var T0=class{urlSerializer;urlTree;constructor(t,e){this.urlSerializer=t,this.urlTree=e}lineralizeSegments(t,e){let i=[],r=e.root;for(;;){if(i=i.concat(r.segments),r.numberOfChildren===0)return H(i);if(r.numberOfChildren>1||!r.children[ce])return cN(`${t.redirectTo}`);r=r.children[ce]}}applyRedirectCommands(t,e,i,r,o){return dN(e,r,o).pipe(le(s=>{if(s instanceof gi)throw new yl(s);let a=this.applyRedirectCreateUrlTree(s,this.urlSerializer.parse(s),t,i);if(s[0]==="/")throw new yl(a);return a}))}applyRedirectCreateUrlTree(t,e,i,r){let o=this.createSegmentGroup(t,e.root,i,r);return new gi(o,this.createQueryParams(e.queryParams,this.urlTree.queryParams),e.fragment)}createQueryParams(t,e){let i={};return Object.entries(t).forEach(([r,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);i[r]=e[a]}else i[r]=o}),i}createSegmentGroup(t,e,i,r){let o=this.createSegments(t,e.segments,i,r),s={};return Object.entries(e.children).forEach(([a,c])=>{s[a]=this.createSegmentGroup(t,c,i,r)}),new Ce(o,s)}createSegments(t,e,i,r){return e.map(o=>o.path[0]===":"?this.findPosParam(t,o,r):this.findOrReturn(o,i))}findPosParam(t,e,i){let r=i[e.path.substring(1)];if(!r)throw new F(4001,!1);return r}findOrReturn(t,e){let i=0;for(let r of e){if(r.path===t.path)return e.splice(i),r;i++}return t}};function dN(n,t,e){if(typeof n=="string")return H(n);let i=n,{queryParams:r,fragment:o,routeConfig:s,url:a,outlet:c,params:f,data:h,title:m}=t;return Wi(pt(e,()=>i({params:f,data:h,queryParams:r,fragment:o,routeConfig:s,url:a,outlet:c,title:m})))}var M0={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function fN(n,t,e,i,r){let o=e1(n,t,e);return o.matched?(i=PO(t,i),lN(i,t,e,r).pipe(le(s=>s===!0?o:P({},M0)))):H(o)}function e1(n,t,e){if(t.path==="**")return pN(e);if(t.path==="")return t.pathMatch==="full"&&(n.hasChildren()||e.length>0)?P({},M0):{matched:!0,consumedSegments:[],remainingSegments:e,parameters:{},positionalParamSegments:{}};let r=(t.matcher||MC)(e,n,t);if(!r)return P({},M0);let o={};Object.entries(r.posParams??{}).forEach(([a,c])=>{o[a]=c.path});let s=r.consumed.length>0?P(P({},o),r.consumed[r.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:r.consumed,remainingSegments:e.slice(r.consumed.length),parameters:s,positionalParamSegments:r.posParams??{}}}function pN(n){return{matched:!0,parameters:n.length>0?RC(n).parameters:{},consumedSegments:n,remainingSegments:[],positionalParamSegments:{}}}function DC(n,t,e,i){return e.length>0&&gN(n,e,i)?{segmentGroup:new Ce(t,mN(i,new Ce(e,n.children))),slicedSegments:[]}:e.length===0&&vN(n,e,i)?{segmentGroup:new Ce(n.segments,hN(n,e,i,n.children)),slicedSegments:e}:{segmentGroup:new Ce(n.segments,n.children),slicedSegments:e}}function hN(n,t,e,i){let r={};for(let o of e)if(rf(n,t,o)&&!i[Qn(o)]){let s=new Ce([],{});r[Qn(o)]=s}return P(P({},i),r)}function mN(n,t){let e={};e[ce]=t;for(let i of n)if(i.path===""&&Qn(i)!==ce){let r=new Ce([],{});e[Qn(i)]=r}return e}function gN(n,t,e){return e.some(i=>rf(n,t,i)&&Qn(i)!==ce)}function vN(n,t,e){return e.some(i=>rf(n,t,i))}function rf(n,t,e){return(n.hasChildren()||t.length>0)&&e.pathMatch==="full"?!1:e.path===""}function _N(n,t,e){return t.length===0&&!n.children[e]}var A0=class{};function yN(n,t,e,i,r,o,s="emptyOnly"){return new R0(n,t,e,i,r,s,o).recognize()}var bN=31,R0=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(t,e,i,r,o,s,a){this.injector=t,this.configLoader=e,this.rootComponentType=i,this.config=r,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new T0(this.urlSerializer,this.urlTree)}noMatchError(t){return new F(4002,`'${t.segmentGroup}'`)}recognize(){let t=DC(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(t).pipe(le(({children:e,rootSnapshot:i})=>{let r=new vn(i,e),o=new gl("",r),s=zC(i,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}))}match(t){let e=new lo([],Object.freeze({}),Object.freeze(P({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),ce,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,t,ce,e).pipe(le(i=>({children:i,rootSnapshot:e})),Di(i=>{if(i instanceof yl)return this.urlTree=i.urlTree,this.match(i.urlTree.root);throw i instanceof _l?this.noMatchError(i):i}))}processSegmentGroup(t,e,i,r,o){return i.segments.length===0&&i.hasChildren()?this.processChildren(t,e,i,o):this.processSegment(t,e,i,i.segments,r,!0,o).pipe(le(s=>s instanceof vn?[s]:[]))}processChildren(t,e,i,r){let o=[];for(let s of Object.keys(i.children))s==="primary"?o.unshift(s):o.push(s);return B(o).pipe(ni(s=>{let a=i.children[s],c=kO(e,s);return this.processSegmentGroup(t,c,a,s,r)}),Kp((s,a)=>(s.push(...a),s)),nr(null),qp(),Ye(s=>{if(s===null)return _s(i);let a=t1(s);return wN(a),H(a)}))}processSegment(t,e,i,r,o,s,a){return B(e).pipe(ni(c=>this.processSegmentAgainstRoute(c._injector??t,e,c,i,r,o,s,a).pipe(Di(f=>{if(f instanceof _l)return H(null);throw f}))),Ii(c=>!!c),Di(c=>{if(QC(c))return _N(i,r,o)?H(new A0):_s(i);throw c}))}processSegmentAgainstRoute(t,e,i,r,o,s,a,c){return Qn(i)!==s&&(s===ce||!rf(r,o,i))?_s(r):i.redirectTo===void 0?this.matchSegmentAgainstRoute(t,r,i,o,s,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(t,r,e,i,o,s,c):_s(r)}expandSegmentAgainstRouteUsingRedirect(t,e,i,r,o,s,a){let{matched:c,parameters:f,consumedSegments:h,positionalParamSegments:m,remainingSegments:y}=e1(e,r,o);if(!c)return _s(e);typeof r.redirectTo=="string"&&r.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>bN&&(this.allowRedirects=!1));let g=new lo(o,f,Object.freeze(P({},this.urlTree.queryParams)),this.urlTree.fragment,IC(r),Qn(r),r.component??r._loadedComponent??null,r,TC(r)),w=Xd(g,a,this.paramsInheritanceStrategy);return g.params=Object.freeze(w.params),g.data=Object.freeze(w.data),this.applyRedirects.applyRedirectCommands(h,r.redirectTo,m,g,t).pipe(je(x=>this.applyRedirects.lineralizeSegments(r,x)),Ye(x=>this.processSegment(t,i,e,x.concat(y),s,!1,a)))}matchSegmentAgainstRoute(t,e,i,r,o,s){let a=fN(e,i,r,t,this.urlSerializer);return i.path==="**"&&(e.children={}),a.pipe(je(c=>c.matched?(t=i._injector??t,this.getChildConfig(t,i,r).pipe(je(({routes:f})=>{let h=i._loadedInjector??t,{parameters:m,consumedSegments:y,remainingSegments:g}=c,w=new lo(y,m,Object.freeze(P({},this.urlTree.queryParams)),this.urlTree.fragment,IC(i),Qn(i),i.component??i._loadedComponent??null,i,TC(i)),T=Xd(w,s,this.paramsInheritanceStrategy);w.params=Object.freeze(T.params),w.data=Object.freeze(T.data);let{segmentGroup:x,slicedSegments:M}=DC(e,y,g,f);if(M.length===0&&x.hasChildren())return this.processChildren(h,f,x,w).pipe(le($=>new vn(w,$)));if(f.length===0&&M.length===0)return H(new vn(w,[]));let X=Qn(i)===o;return this.processSegment(h,f,x,M,X?ce:o,!0,w).pipe(le($=>new vn(w,$ instanceof vn?[$]:[])))}))):_s(e)))}getChildConfig(t,e,i){return e.children?H({routes:e.children,injector:t}):e.loadChildren?e._loadedRoutes!==void 0?H({routes:e._loadedRoutes,injector:e._loadedInjector}):aN(t,e,i,this.urlSerializer).pipe(Ye(r=>r?this.configLoader.loadChildren(t,e).pipe(ft(o=>{e._loadedRoutes=o.routes,e._loadedInjector=o.injector})):uN(e))):H({routes:[],injector:t})}};function wN(n){n.sort((t,e)=>t.value.outlet===ce?-1:e.value.outlet===ce?1:t.value.outlet.localeCompare(e.value.outlet))}function EN(n){let t=n.value.routeConfig;return t&&t.path===""}function t1(n){let t=[],e=new Set;for(let i of n){if(!EN(i)){t.push(i);continue}let r=t.find(o=>i.value.routeConfig===o.value.routeConfig);r!==void 0?(r.children.push(...i.children),e.add(r)):t.push(i)}for(let i of e){let r=t1(i.children);t.push(new vn(i.value,r))}return t.filter(i=>!e.has(i))}function IC(n){return n.data||{}}function TC(n){return n.resolve||{}}function CN(n,t,e,i,r,o){return Ye(s=>yN(n,t,e,i,s.extractedUrl,r,o).pipe(le(({state:a,tree:c})=>Y(P({},s),{targetSnapshot:a,urlAfterRedirects:c}))))}function SN(n,t){return Ye(e=>{let{targetSnapshot:i,guards:{canActivateChecks:r}}=e;if(!r.length)return H(e);let o=new Set(r.map(c=>c.route)),s=new Set;for(let c of o)if(!s.has(c))for(let f of n1(c))s.add(f);let a=0;return B(s).pipe(ni(c=>o.has(c)?xN(c,i,n,t):(c.data=Xd(c,c.parent,n).resolve,H(void 0))),ft(()=>a++),Go(1),Ye(c=>a===s.size?H(e):Dt))})}function n1(n){let t=n.children.map(e=>n1(e)).flat();return[n,...t]}function xN(n,t,e,i){let r=n.routeConfig,o=n._resolve;return r?.title!==void 0&&!qC(r)&&(o[bl]=r.title),aa(()=>(n.data=Xd(n,n.parent,e).resolve,DN(o,n,t,i).pipe(le(s=>(n._resolvedData=s,n.data=P(P({},n.data),s),null)))))}function DN(n,t,e,i){let r=y0(n);if(r.length===0)return H({});let o={};return B(r).pipe(Ye(s=>IN(n[s],t,e,i).pipe(Ii(),ft(a=>{if(a instanceof Is)throw ef(new _r,a);o[s]=a}))),Go(1),le(()=>o),Di(s=>QC(s)?Dt:Ho(s)))}function IN(n,t,e,i){let r=Ms(t)??i,o=As(n,r),s=o.resolve?o.resolve(t,e):pt(r,()=>o(t,e));return Wi(s)}function v0(n){return je(t=>{let e=n(t);return e?B(e).pipe(le(()=>t)):H(t)})}var F0=(()=>{class n{buildTitle(e){let i,r=e.root;for(;r!==void 0;)i=this.getResolvedTitleForRoute(r)??i,r=r.children.find(o=>o.outlet===ce);return i}getResolvedTitleForRoute(e){return e.data[bl]}static \u0275fac=function(i){return new(i||n)};static \u0275prov=k({token:n,factory:()=>A(i1),providedIn:"root"})}return n})(),i1=(()=>{class n extends F0{title;constructor(e){super(),this.title=e}updateTitle(e){let i=this.buildTitle(e);i!==void 0&&this.title.setTitle(i)}static \u0275fac=function(i){return new(i||n)(L(wC))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),wr=new U("",{providedIn:"root",factory:()=>({})}),po=new U(""),of=(()=>{class n{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=A(Mg);loadComponent(e,i){if(this.componentLoaders.get(i))return this.componentLoaders.get(i);if(i._loadedComponent)return H(i._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(i);let r=Wi(pt(e,()=>i.loadComponent())).pipe(le(o1),je(s1),ft(s=>{this.onLoadEndListener&&this.onLoadEndListener(i),i._loadedComponent=s}),Fr(()=>{this.componentLoaders.delete(i)})),o=new Bo(r,()=>new Le).pipe(Uo());return this.componentLoaders.set(i,o),o}loadChildren(e,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return H({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let o=r1(i,this.compiler,e,this.onLoadEndListener).pipe(Fr(()=>{this.childrenLoaders.delete(i)})),s=new Bo(o,()=>new Le).pipe(Uo());return this.childrenLoaders.set(i,s),s}static \u0275fac=function(i){return new(i||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function r1(n,t,e,i){return Wi(pt(e,()=>n.loadChildren())).pipe(le(o1),je(s1),Ye(r=>r instanceof rd||Array.isArray(r)?H(r):B(t.compileModuleAsync(r))),le(r=>{i&&i(n);let o,s,a=!1;return Array.isArray(r)?(s=r,a=!0):(o=r.create(e).injector,s=o.get(po,[],{optional:!0,self:!0}).flat()),{routes:s.map(k0),injector:o}}))}function TN(n){return n&&typeof n=="object"&&"default"in n}function o1(n){return TN(n)?n.default:n}function s1(n){return H(n)}var sf=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=k({token:n,factory:()=>A(MN),providedIn:"root"})}return n})(),MN=(()=>{class n{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,i){return e}static \u0275fac=function(i){return new(i||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),L0=new U(""),j0=new U("");function a1(n,t,e){let i=n.get(j0),r=n.get(Ue);if(!r.startViewTransition||i.skipNextTransition)return i.skipNextTransition=!1,new Promise(f=>setTimeout(f));let o,s=new Promise(f=>{o=f}),a=r.startViewTransition(()=>(o(),AN(n)));a.ready.catch(f=>{});let{onViewTransitionCreated:c}=i;return c&&pt(n,()=>c({transition:a,from:t,to:e})),s}function AN(n){return new Promise(t=>{ja({read:()=>setTimeout(t)},{injector:n})})}var V0=new U(""),af=(()=>{class n{currentNavigation=Be(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=null;events=new Le;transitionAbortWithErrorSubject=new Le;configLoader=A(of);environmentInjector=A(Ze);destroyRef=A(Wn);urlSerializer=A(uo);rootContexts=A(fo);location=A(gr);inputBindingEnabled=A(El,{optional:!0})!==null;titleStrategy=A(F0);options=A(wr,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=A(sf);createViewTransition=A(L0,{optional:!0});navigationErrorHandler=A(V0,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>H(void 0);rootComponentType=null;destroyed=!1;constructor(){let e=r=>this.events.next(new Wd(r)),i=r=>this.events.next(new Gd(r));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=e,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(e){let i=++this.navigationId;at(()=>{this.transitions?.next(Y(P({},e),{extractedUrl:this.urlHandlingStrategy.extract(e.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,abortController:new AbortController,id:i}))})}setupNavigations(e){return this.transitions=new Ke(null),this.transitions.pipe(rt(i=>i!==null),je(i=>{let r=!1;return H(i).pipe(je(o=>{if(this.navigationId>i.id)return this.cancelNavigationTransition(i,"",Zt.SupersededByNewNavigation),Dt;this.currentTransition=i,this.currentNavigation.set({id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,targetBrowserUrl:typeof o.extras.browserUrl=="string"?this.urlSerializer.parse(o.extras.browserUrl):o.extras.browserUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?Y(P({},this.lastSuccessfulNavigation),{previousNavigation:null}):null,abort:()=>o.abortController.abort()});let s=!e.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),a=o.extras.onSameUrlNavigation??e.onSameUrlNavigation;if(!s&&a!=="reload")return this.events.next(new vi(o.id,this.urlSerializer.serialize(o.rawUrl),"",Cs.IgnoredSameUrlNavigation)),o.resolve(!1),Dt;if(this.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return H(o).pipe(je(c=>(this.events.next(new br(c.id,this.urlSerializer.serialize(c.extractedUrl),c.source,c.restoredState)),c.id!==this.navigationId?Dt:Promise.resolve(c))),CN(this.environmentInjector,this.configLoader,this.rootComponentType,e.config,this.urlSerializer,this.paramsInheritanceStrategy),ft(c=>{i.targetSnapshot=c.targetSnapshot,i.urlAfterRedirects=c.urlAfterRedirects,this.currentNavigation.update(h=>(h.finalUrl=c.urlAfterRedirects,h));let f=new pl(c.id,this.urlSerializer.serialize(c.extractedUrl),this.urlSerializer.serialize(c.urlAfterRedirects),c.targetSnapshot);this.events.next(f)}));if(s&&this.urlHandlingStrategy.shouldProcessUrl(o.currentRawUrl)){let{id:c,extractedUrl:f,source:h,restoredState:m,extras:y}=o,g=new br(c,this.urlSerializer.serialize(f),h,m);this.events.next(g);let w=WC(this.rootComponentType).snapshot;return this.currentTransition=i=Y(P({},o),{targetSnapshot:w,urlAfterRedirects:f,extras:Y(P({},y),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(T=>(T.finalUrl=f,T)),H(i)}else return this.events.next(new vi(o.id,this.urlSerializer.serialize(o.extractedUrl),"",Cs.IgnoredByUrlHandlingStrategy)),o.resolve(!1),Dt}),ft(o=>{let s=new Ud(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(s)}),le(o=>(this.currentTransition=i=Y(P({},o),{guards:BO(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),i)),XO(this.environmentInjector,o=>this.events.next(o)),ft(o=>{if(i.guardsResult=o.guardsResult,o.guardsResult&&typeof o.guardsResult!="boolean")throw ef(this.urlSerializer,o.guardsResult);let s=new Bd(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(s)}),rt(o=>o.guardsResult?!0:(this.cancelNavigationTransition(o,"",Zt.GuardRejected),!1)),v0(o=>{if(o.guards.canActivateChecks.length!==0)return H(o).pipe(ft(s=>{let a=new $d(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(a)}),je(s=>{let a=!1;return H(s).pipe(SN(this.paramsInheritanceStrategy,this.environmentInjector),ft({next:()=>a=!0,complete:()=>{a||this.cancelNavigationTransition(s,"",Zt.NoDataFromResolver)}}))}),ft(s=>{let a=new Hd(s.id,this.urlSerializer.serialize(s.extractedUrl),this.urlSerializer.serialize(s.urlAfterRedirects),s.targetSnapshot);this.events.next(a)}))}),v0(o=>{let s=a=>{let c=[];if(a.routeConfig?.loadComponent){let f=Ms(a)??this.environmentInjector;c.push(this.configLoader.loadComponent(f,a.routeConfig).pipe(ft(h=>{a.component=h}),le(()=>{})))}for(let f of a.children)c.push(...s(f));return c};return sa(s(o.targetSnapshot.root)).pipe(nr(null),Pt(1))}),v0(()=>this.afterPreactivation()),je(()=>{let{currentSnapshot:o,targetSnapshot:s}=i,a=this.createViewTransition?.(this.environmentInjector,o.root,s.root);return a?B(a).pipe(le(()=>i)):H(i)}),le(o=>{let s=LO(e.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return this.currentTransition=i=Y(P({},o),{targetRouterState:s}),this.currentNavigation.update(a=>(a.targetRouterState=s,a)),i}),ft(()=>{this.events.next(new hl)}),UO(this.rootContexts,e.routeReuseStrategy,o=>this.events.next(o),this.inputBindingEnabled),Pt(1),Vn(new me(o=>{let s=i.abortController.signal,a=()=>o.next();return s.addEventListener("abort",a),()=>s.removeEventListener("abort",a)}).pipe(rt(()=>!r&&!i.targetRouterState),ft(()=>{this.cancelNavigationTransition(i,i.abortController.signal.reason+"",Zt.Aborted)}))),ft({next:o=>{r=!0,this.lastSuccessfulNavigation=at(this.currentNavigation),this.events.next(new Jt(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects))),this.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{r=!0}}),Vn(this.transitionAbortWithErrorSubject.pipe(ft(o=>{throw o}))),Fr(()=>{r||this.cancelNavigationTransition(i,"",Zt.SupersededByNewNavigation),this.currentTransition?.id===i.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),Di(o=>{if(this.destroyed)return i.resolve(!1),Dt;if(r=!0,JC(o))this.events.next(new mi(i.id,this.urlSerializer.serialize(i.extractedUrl),o.message,o.cancellationCode)),zO(o)?this.events.next(new Ds(o.url,o.navigationBehaviorOptions)):i.resolve(!1);else{let s=new Ss(i.id,this.urlSerializer.serialize(i.extractedUrl),o,i.targetSnapshot??void 0);try{let a=pt(this.environmentInjector,()=>this.navigationErrorHandler?.(s));if(a instanceof Is){let{message:c,cancellationCode:f}=ef(this.urlSerializer,a);this.events.next(new mi(i.id,this.urlSerializer.serialize(i.extractedUrl),c,f)),this.events.next(new Ds(a.redirectTo,a.navigationBehaviorOptions))}else throw this.events.next(s),o}catch(a){this.options.resolveNavigationPromiseOnError?i.resolve(!1):i.reject(a)}}return Dt}))}))}cancelNavigationTransition(e,i,r){let o=new mi(e.id,this.urlSerializer.serialize(e.extractedUrl),i,r);this.events.next(o),e.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let e=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=at(this.currentNavigation),r=i?.targetBrowserUrl??i?.extractedUrl;return e.toString()!==r?.toString()&&!i?.extras.skipLocationChange}static \u0275fac=function(i){return new(i||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function RN(n){return n!==ws}var l1=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275prov=k({token:n,factory:()=>A(ON),providedIn:"root"})}return n})(),nf=class{shouldDetach(t){return!1}store(t,e){}shouldAttach(t){return!1}retrieve(t){return null}shouldReuseRoute(t,e){return t.routeConfig===e.routeConfig}},ON=(()=>{class n extends nf{static \u0275fac=(()=>{let e;return function(r){return(e||(e=xn(n)))(r||n)}})();static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),c1=(()=>{class n{urlSerializer=A(uo);options=A(wr,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=A(gr);urlHandlingStrategy=A(sf);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new gi;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:e,initialUrl:i,targetBrowserUrl:r}){let o=e!==void 0?this.urlHandlingStrategy.merge(e,i):i,s=r??o;return s instanceof gi?this.urlSerializer.serialize(s):s}commitTransition({targetRouterState:e,finalUrl:i,initialUrl:r}){i&&e?(this.currentUrlTree=i,this.rawUrlTree=this.urlHandlingStrategy.merge(i,r),this.routerState=e):this.rawUrlTree=r}routerState=WC(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:e}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,e??this.rawUrlTree)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=k({token:n,factory:()=>A(NN),providedIn:"root"})}return n})(),NN=(()=>{class n extends c1{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(e){return this.location.subscribe(i=>{i.type==="popstate"&&setTimeout(()=>{e(i.url,i.state,"popstate")})})}handleRouterEvent(e,i){e instanceof br?this.updateStateMemento():e instanceof vi?this.commitTransition(i):e instanceof pl?this.urlUpdateStrategy==="eager"&&(i.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(i),i)):e instanceof hl?(this.commitTransition(i),this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(i),i)):e instanceof mi&&e.code!==Zt.SupersededByNewNavigation&&e.code!==Zt.Redirect?this.restoreHistory(i):e instanceof Ss?this.restoreHistory(i,!0):e instanceof Jt&&(this.lastSuccessfulId=e.id,this.currentPageId=this.browserPageId)}setBrowserUrl(e,{extras:i,id:r}){let{replaceUrl:o,state:s}=i;if(this.location.isCurrentPathEqualTo(e)||o){let a=this.browserPageId,c=P(P({},s),this.generateNgRouterState(r,a));this.location.replaceState(e,"",c)}else{let a=P(P({},s),this.generateNgRouterState(r,this.browserPageId+1));this.location.go(e,"",a)}}restoreHistory(e,i=!1){if(this.canceledNavigationResolution==="computed"){let r=this.browserPageId,o=this.currentPageId-r;o!==0?this.location.historyGo(o):this.getCurrentUrlTree()===e.finalUrl&&o===0&&(this.resetInternalState(e),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetInternalState(e),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(e,i){return this.canceledNavigationResolution==="computed"?{navigationId:e,\u0275routerPageId:i}:{navigationId:e}}static \u0275fac=(()=>{let e;return function(r){return(e||(e=xn(n)))(r||n)}})();static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function lf(n,t){n.events.pipe(rt(e=>e instanceof Jt||e instanceof mi||e instanceof Ss||e instanceof vi),le(e=>e instanceof Jt||e instanceof vi?0:(e instanceof mi?e.code===Zt.Redirect||e.code===Zt.SupersededByNewNavigation:!1)?2:1),rt(e=>e!==2),Pt(1)).subscribe(()=>{t()})}var PN={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},kN={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},Se=(()=>{class n{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=A(mg);stateManager=A(c1);options=A(wr,{optional:!0})||{};pendingTasks=A(ci);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=A(af);urlSerializer=A(uo);location=A(gr);urlHandlingStrategy=A(sf);injector=A(Ze);_events=new Le;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=A(l1);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=A(po,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!A(El,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:e=>{this.console.warn(e)}}),this.subscribeToNavigationEvents()}eventsSubscription=new He;subscribeToNavigationEvents(){let e=this.navigationTransitions.events.subscribe(i=>{try{let r=this.navigationTransitions.currentTransition,o=at(this.navigationTransitions.currentNavigation);if(r!==null&&o!==null){if(this.stateManager.handleRouterEvent(i,o),i instanceof mi&&i.code!==Zt.Redirect&&i.code!==Zt.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Jt)this.navigated=!0;else if(i instanceof Ds){let s=i.navigationBehaviorOptions,a=this.urlHandlingStrategy.merge(i.url,r.currentRawUrl),c=P({browserUrl:r.extras.browserUrl,info:r.extras.info,skipLocationChange:r.extras.skipLocationChange,replaceUrl:r.extras.replaceUrl||this.urlUpdateStrategy==="eager"||RN(r.source)},s);this.scheduleNavigation(a,ws,null,c,{resolve:r.resolve,reject:r.reject,promise:r.promise})}}NO(i)&&this._events.next(i)}catch(r){this.navigationTransitions.transitionAbortWithErrorSubject.next(r)}});this.eventsSubscription.add(e)}resetRootComponentType(e){this.routerState.root.component=e,this.navigationTransitions.rootComponentType=e}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),ws,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((e,i,r)=>{this.navigateToSyncWithBrowser(e,r,i)})}navigateToSyncWithBrowser(e,i,r){let o={replaceUrl:!0},s=r?.navigationId?r:null;if(r){let c=P({},r);delete c.navigationId,delete c.\u0275routerPageId,Object.keys(c).length!==0&&(o.state=c)}let a=this.parseUrl(e);this.scheduleNavigation(a,i,s,o).catch(c=>{this.disposed||this.injector.get(Kt)(c)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return at(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(e){this.config=e.map(k0),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(e,i={}){let{relativeTo:r,queryParams:o,fragment:s,queryParamsHandling:a,preserveFragment:c}=i,f=c?this.currentUrlTree.fragment:s,h=null;switch(a??this.options.defaultQueryParamsHandling){case"merge":h=P(P({},this.currentUrlTree.queryParams),o);break;case"preserve":h=this.currentUrlTree.queryParams;break;default:h=o||null}h!==null&&(h=this.removeEmptyProps(h));let m;try{let y=r?r.snapshot:this.routerState.snapshot.root;m=UC(y)}catch{(typeof e[0]!="string"||e[0][0]!=="/")&&(e=[]),m=this.currentUrlTree.root}return BC(m,e,h,f??null)}navigateByUrl(e,i={skipLocationChange:!1}){let r=yr(e)?e:this.parseUrl(e),o=this.urlHandlingStrategy.merge(r,this.rawUrlTree);return this.scheduleNavigation(o,ws,null,i)}navigate(e,i={skipLocationChange:!1}){return FN(e),this.navigateByUrl(this.createUrlTree(e,i),i)}serializeUrl(e){return this.urlSerializer.serialize(e)}parseUrl(e){try{return this.urlSerializer.parse(e)}catch{return this.console.warn(Ri(4018,!1)),this.urlSerializer.parse("/")}}isActive(e,i){let r;if(i===!0?r=P({},PN):i===!1?r=P({},kN):r=i,yr(e))return EC(this.currentUrlTree,e,r);let o=this.parseUrl(e);return EC(this.currentUrlTree,o,r)}removeEmptyProps(e){return Object.entries(e).reduce((i,[r,o])=>(o!=null&&(i[r]=o),i),{})}scheduleNavigation(e,i,r,o,s){if(this.disposed)return Promise.resolve(!1);let a,c,f;s?(a=s.resolve,c=s.reject,f=s.promise):f=new Promise((m,y)=>{a=m,c=y});let h=this.pendingTasks.add();return lf(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(h))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:r,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:e,extras:o,resolve:a,reject:c,promise:f,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),f.catch(m=>Promise.reject(m))}static \u0275fac=function(i){return new(i||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function FN(n){for(let t=0;t<n.length;t++)if(n[t]==null)throw new F(4008,!1)}var jt=(()=>{class n{router;route;tabIndexAttribute;renderer;el;locationStrategy;reactiveHref=Be(null);get href(){return at(this.reactiveHref)}set href(e){this.reactiveHref.set(e)}target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new Le;applicationErrorHandler=A(Kt);options=A(wr,{optional:!0});constructor(e,i,r,o,s,a){this.router=e,this.route=i,this.tabIndexAttribute=r,this.renderer=o,this.el=s,this.locationStrategy=a,this.reactiveHref.set(A(new ld("href"),{optional:!0}));let c=s.nativeElement.tagName?.toLowerCase();this.isAnchorElement=c==="a"||c==="area"||!!(typeof customElements=="object"&&customElements.get(c)?.observedAttributes?.includes?.("href")),this.isAnchorElement?this.setTabIndexIfNotOnNativeEl("0"):this.subscribeToNavigationEventsIfNecessary()}subscribeToNavigationEventsIfNecessary(){if(this.subscription!==void 0||!this.isAnchorElement)return;let e=this.preserveFragment,i=r=>r==="merge"||r==="preserve";e||=i(this.queryParamsHandling),e||=!this.queryParamsHandling&&!i(this.options?.defaultQueryParamsHandling),e&&(this.subscription=this.router.events.subscribe(r=>{r instanceof Jt&&this.updateHref()}))}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(e){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",e)}ngOnChanges(e){this.isAnchorElement&&(this.updateHref(),this.subscribeToNavigationEventsIfNecessary()),this.onChanges.next(this)}routerLinkInput=null;set routerLink(e){e==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(yr(e)?this.routerLinkInput=e:this.routerLinkInput=Array.isArray(e)?e:[e],this.setTabIndexIfNotOnNativeEl("0"))}onClick(e,i,r,o,s){let a=this.urlTree;if(a===null||this.isAnchorElement&&(e!==0||i||r||o||s||typeof this.target=="string"&&this.target!="_self"))return!0;let c={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(a,c)?.catch(f=>{this.applicationErrorHandler(f)}),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let e=this.urlTree;this.reactiveHref.set(e!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(e))??"":null)}applyAttributeValue(e,i){let r=this.renderer,o=this.el.nativeElement;i!==null?r.setAttribute(o,e,i):r.removeAttribute(o,e)}get urlTree(){return this.routerLinkInput===null?null:yr(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(i){return new(i||n)(C(Se),C(Lt),Fa("tabindex"),C(rn),C(mt),C(gn))};static \u0275dir=ye({type:n,selectors:[["","routerLink",""]],hostVars:2,hostBindings:function(i,r){i&1&&S("click",function(s){return r.onClick(s.button,s.ctrlKey,s.shiftKey,s.altKey,s.metaKey)}),i&2&&ps("href",r.reactiveHref(),Gm)("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",ro],skipLocationChange:[2,"skipLocationChange","skipLocationChange",ro],replaceUrl:[2,"replaceUrl","replaceUrl",ro],routerLink:"routerLink"},features:[fn]})}return n})(),U0=(()=>{class n{router;element;renderer;cdr;link;links;classes=[];routerEventsSubscription;linkInputChangesSubscription;_isActive=!1;get isActive(){return this._isActive}routerLinkActiveOptions={exact:!1};ariaCurrentWhenActive;isActiveChange=new Re;constructor(e,i,r,o,s){this.router=e,this.element=i,this.renderer=r,this.cdr=o,this.link=s,this.routerEventsSubscription=e.events.subscribe(a=>{a instanceof Jt&&this.update()})}ngAfterContentInit(){H(this.links.changes,H(null)).pipe(tr()).subscribe(e=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();let e=[...this.links.toArray(),this.link].filter(i=>!!i).map(i=>i.onChanges);this.linkInputChangesSubscription=B(e).pipe(tr()).subscribe(i=>{this._isActive!==this.isLinkActive(this.router)(i)&&this.update()})}set routerLinkActive(e){let i=Array.isArray(e)?e:e.split(" ");this.classes=i.filter(r=>!!r)}ngOnChanges(e){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{let e=this.hasActiveLinks();this.classes.forEach(i=>{e?this.renderer.addClass(this.element.nativeElement,i):this.renderer.removeClass(this.element.nativeElement,i)}),e&&this.ariaCurrentWhenActive!==void 0?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this._isActive!==e&&(this._isActive=e,this.cdr.markForCheck(),this.isActiveChange.emit(e))})}isLinkActive(e){let i=LN(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return r=>{let o=r.urlTree;return o?e.isActive(o,i):!1}}hasActiveLinks(){let e=this.isLinkActive(this.router);return this.link&&e(this.link)||this.links.some(e)}static \u0275fac=function(i){return new(i||n)(C(Se),C(mt),C(rn),C(Bi),C(jt,8))};static \u0275dir=ye({type:n,selectors:[["","routerLinkActive",""]],contentQueries:function(i,r,o){if(i&1&&Eg(o,jt,5),i&2){let s;Ba(s=$a())&&(r.links=s)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],features:[fn]})}return n})();function LN(n){return!!n.paths}var Sl=class{};var u1=(()=>{class n{router;injector;preloadingStrategy;loader;subscription;constructor(e,i,r,o){this.router=e,this.injector=i,this.preloadingStrategy=r,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(rt(e=>e instanceof Jt),ni(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(e,i){let r=[];for(let o of i){o.providers&&!o._injector&&(o._injector=ds(o.providers,e,`Route: ${o.path}`));let s=o._injector??e,a=o._loadedInjector??s;(o.loadChildren&&!o._loadedRoutes&&o.canLoad===void 0||o.loadComponent&&!o._loadedComponent)&&r.push(this.preloadConfig(s,o)),(o.children||o._loadedRoutes)&&r.push(this.processRoutes(a,o.children??o._loadedRoutes))}return B(r).pipe(tr())}preloadConfig(e,i){return this.preloadingStrategy.preload(i,()=>{let r;i.loadChildren&&i.canLoad===void 0?r=this.loader.loadChildren(e,i):r=H(null);let o=r.pipe(Ye(s=>s===null?H(void 0):(i._loadedRoutes=s.routes,i._loadedInjector=s.injector,this.processRoutes(s.injector??e,s.routes))));if(i.loadComponent&&!i._loadedComponent){let s=this.loader.loadComponent(e,i);return B([o,s]).pipe(tr())}else return o})}static \u0275fac=function(i){return new(i||n)(L(Se),L(Ze),L(Sl),L(of))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),d1=new U(""),jN=(()=>{class n{urlSerializer;transitions;viewportScroller;zone;options;routerEventsSubscription;scrollEventsSubscription;lastId=0;lastSource=ws;restoredId=0;store={};constructor(e,i,r,o,s={}){this.urlSerializer=e,this.transitions=i,this.viewportScroller=r,this.zone=o,this.options=s,s.scrollPositionRestoration||="disabled",s.anchorScrolling||="disabled"}init(){this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(e=>{e instanceof br?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=e.navigationTrigger,this.restoredId=e.restoredState?e.restoredState.navigationId:0):e instanceof Jt?(this.lastId=e.id,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.urlAfterRedirects).fragment)):e instanceof vi&&e.code===Cs.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(e,this.urlSerializer.parse(e.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(e=>{if(!(e instanceof xs))return;let i={behavior:"instant"};e.position?this.options.scrollPositionRestoration==="top"?this.viewportScroller.scrollToPosition([0,0],i):this.options.scrollPositionRestoration==="enabled"&&this.viewportScroller.scrollToPosition(e.position,i):e.anchor&&this.options.anchorScrolling==="enabled"?this.viewportScroller.scrollToAnchor(e.anchor):this.options.scrollPositionRestoration!=="disabled"&&this.viewportScroller.scrollToPosition([0,0])})}scheduleScrollEvent(e,i){this.zone.runOutsideAngular(()=>b(this,null,function*(){yield new Promise(r=>{setTimeout(r),typeof requestAnimationFrame<"u"&&requestAnimationFrame(r)}),this.zone.run(()=>{this.transitions.events.next(new xs(e,this.lastSource==="popstate"?this.store[this.restoredId]:null,i))})}))}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static \u0275fac=function(i){cg()};static \u0275prov=k({token:n,factory:n.\u0275fac})}return n})();function B0(n,...t){return ii([{provide:po,multi:!0,useValue:n},[],{provide:Lt,useFactory:f1,deps:[Se]},{provide:za,multi:!0,useFactory:p1},t.map(e=>e.\u0275providers)])}function f1(n){return n.routerState.root}function xl(n,t){return{\u0275kind:n,\u0275providers:t}}function p1(){let n=A(qt);return t=>{let e=n.get(Vi);if(t!==e.components[0])return;let i=n.get(Se),r=n.get(h1);n.get($0)===1&&i.initialNavigation(),n.get(v1,null,{optional:!0})?.setUpPreloading(),n.get(d1,null,{optional:!0})?.init(),i.resetRootComponentType(e.componentTypes[0]),r.closed||(r.next(),r.complete(),r.unsubscribe())}}var h1=new U("",{factory:()=>new Le}),$0=new U("",{providedIn:"root",factory:()=>1});function m1(){let n=[{provide:Bm,useValue:!0},{provide:$0,useValue:0},od(()=>{let t=A(qt);return t.get(Hg,Promise.resolve()).then(()=>new Promise(i=>{let r=t.get(Se),o=t.get(h1);lf(r,()=>{i(!0)}),t.get(af).afterPreactivation=()=>(i(!0),o.closed?H(void 0):o),r.initialNavigation()}))})];return xl(2,n)}function g1(){let n=[od(()=>{A(Se).setUpLocationChangeListener()}),{provide:$0,useValue:2}];return xl(3,n)}var v1=new U("");function _1(n){return xl(0,[{provide:v1,useExisting:u1},{provide:Sl,useExisting:n}])}function y1(){return xl(8,[N0,{provide:El,useExisting:N0}])}function b1(n){Yn("NgRouterViewTransitions");let t=[{provide:L0,useValue:a1},{provide:j0,useValue:P({skipNextTransition:!!n?.skipInitialTransition},n)}];return xl(9,t)}var w1=[gr,{provide:uo,useClass:_r},Se,fo,{provide:Lt,useFactory:f1,deps:[Se]},of,[]],At=(()=>{class n{constructor(){}static forRoot(e,i){return{ngModule:n,providers:[w1,[],{provide:po,multi:!0,useValue:e},[],i?.errorHandler?{provide:V0,useValue:i.errorHandler}:[],{provide:wr,useValue:i||{}},i?.useHash?zN():UN(),VN(),i?.preloadingStrategy?_1(i.preloadingStrategy).\u0275providers:[],i?.initialNavigation?BN(i):[],i?.bindToComponentInputs?y1().\u0275providers:[],i?.enableViewTransitions?b1().\u0275providers:[],$N()]}}static forChild(e){return{ngModule:n,providers:[{provide:po,multi:!0,useValue:e}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=Dn({type:n});static \u0275inj=cn({})}return n})();function VN(){return{provide:d1,useFactory:()=>{let n=A(eC),t=A(We),e=A(wr),i=A(af),r=A(uo);return e.scrollOffset&&n.setOffset(e.scrollOffset),new jN(r,i,n,t,e)}}}function zN(){return{provide:gn,useClass:Qa}}function UN(){return{provide:gn,useClass:fd}}function BN(n){return[n.initialNavigation==="disabled"?g1().\u0275providers:[],n.initialNavigation==="enabledBlocking"?m1().\u0275providers:[]]}var z0=new U("");function $N(){return[{provide:z0,useFactory:p1},{provide:za,multi:!0,useExisting:z0}]}var A1=(()=>{class n{_renderer;_elementRef;onChange=e=>{};onTouched=()=>{};constructor(e,i){this._renderer=e,this._elementRef=i}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static \u0275fac=function(i){return new(i||n)(C(rn),C(mt))};static \u0275dir=ye({type:n})}return n})(),ks=(()=>{class n extends A1{static \u0275fac=(()=>{let e;return function(r){return(e||(e=xn(n)))(r||n)}})();static \u0275dir=ye({type:n,features:[Qe]})}return n})(),Gi=new U(""),HN={provide:Gi,useExisting:st(()=>ho),multi:!0},ho=(()=>{class n extends ks{writeValue(e){this.setProperty("checked",e)}static \u0275fac=(()=>{let e;return function(r){return(e||(e=xn(n)))(r||n)}})();static \u0275dir=ye({type:n,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(i,r){i&1&&S("change",function(s){return r.onChange(s.target.checked)})("blur",function(){return r.onTouched()})},standalone:!1,features:[kt([HN]),Qe]})}return n})(),WN={provide:Gi,useExisting:st(()=>Ne),multi:!0};function GN(){let n=In()?In().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}var qN=new U(""),Ne=(()=>{class n extends A1{_compositionMode;_composing=!1;constructor(e,i,r){super(e,i),this._compositionMode=r,this._compositionMode==null&&(this._compositionMode=!GN())}writeValue(e){let i=e??"";this.setProperty("value",i)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static \u0275fac=function(i){return new(i||n)(C(rn),C(mt),C(qN,8))};static \u0275dir=ye({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){i&1&&S("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},standalone:!1,features:[kt([WN]),Qe]})}return n})();function q0(n){return n==null||K0(n)===0}function K0(n){return n==null?null:Array.isArray(n)||typeof n=="string"?n.length:n instanceof Set?n.size:null}var Cr=new U(""),mo=new U(""),KN=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Q=class{static min(t){return R1(t)}static max(t){return YN(t)}static required(t){return ZN(t)}static requiredTrue(t){return JN(t)}static email(t){return QN(t)}static minLength(t){return XN(t)}static maxLength(t){return eP(t)}static pattern(t){return tP(t)}static nullValidator(t){return uf()}static compose(t){return L1(t)}static composeAsync(t){return j1(t)}};function R1(n){return t=>{if(t.value==null||n==null)return null;let e=parseFloat(t.value);return!isNaN(e)&&e<n?{min:{min:n,actual:t.value}}:null}}function YN(n){return t=>{if(t.value==null||n==null)return null;let e=parseFloat(t.value);return!isNaN(e)&&e>n?{max:{max:n,actual:t.value}}:null}}function ZN(n){return q0(n.value)?{required:!0}:null}function JN(n){return n.value===!0?null:{required:!0}}function QN(n){return q0(n.value)||KN.test(n.value)?null:{email:!0}}function XN(n){return t=>{let e=t.value?.length??K0(t.value);return e===null||e===0?null:e<n?{minlength:{requiredLength:n,actualLength:e}}:null}}function eP(n){return t=>{let e=t.value?.length??K0(t.value);return e!==null&&e>n?{maxlength:{requiredLength:n,actualLength:e}}:null}}function tP(n){if(!n)return uf;let t,e;return typeof n=="string"?(e="",n.charAt(0)!=="^"&&(e+="^"),e+=n,n.charAt(n.length-1)!=="$"&&(e+="$"),t=new RegExp(e)):(e=n.toString(),t=n),i=>{if(q0(i.value))return null;let r=i.value;return t.test(r)?null:{pattern:{requiredPattern:e,actualValue:r}}}}function uf(n){return null}function O1(n){return n!=null}function N1(n){return fr(n)?B(n):n}function P1(n){let t={};return n.forEach(e=>{t=e!=null?P(P({},t),e):t}),Object.keys(t).length===0?null:t}function k1(n,t){return t.map(e=>e(n))}function nP(n){return!n.validate}function F1(n){return n.map(t=>nP(t)?t:e=>t.validate(e))}function L1(n){if(!n)return null;let t=n.filter(O1);return t.length==0?null:function(e){return P1(k1(e,t))}}function Y0(n){return n!=null?L1(F1(n)):null}function j1(n){if(!n)return null;let t=n.filter(O1);return t.length==0?null:function(e){let i=k1(e,t).map(N1);return Hp(i).pipe(le(P1))}}function Z0(n){return n!=null?j1(F1(n)):null}function E1(n,t){return n===null?[t]:Array.isArray(n)?[...n,t]:[n,t]}function V1(n){return n._rawValidators}function z1(n){return n._rawAsyncValidators}function H0(n){return n?Array.isArray(n)?n:[n]:[]}function df(n,t){return Array.isArray(n)?n.includes(t):n===t}function C1(n,t){let e=H0(t);return H0(n).forEach(r=>{df(e,r)||e.push(r)}),e}function S1(n,t){return H0(t).filter(e=>!df(n,e))}var ff=class{get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators=[];_rawAsyncValidators=[];_setValidators(t){this._rawValidators=t||[],this._composedValidatorFn=Y0(this._rawValidators)}_setAsyncValidators(t){this._rawAsyncValidators=t||[],this._composedAsyncValidatorFn=Z0(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_onDestroyCallbacks=[];_registerOnDestroy(t){this._onDestroyCallbacks.push(t)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(t=>t()),this._onDestroyCallbacks=[]}reset(t=void 0){this.control&&this.control.reset(t)}hasError(t,e){return this.control?this.control.hasError(t,e):!1}getError(t,e){return this.control?this.control.getError(t,e):null}},Qt=class extends ff{name;get formDirective(){return null}get path(){return null}},yi=class extends ff{_parent=null;name=null;valueAccessor=null},pf=class{_cd;constructor(t){this._cd=t}get isTouched(){return this._cd?.control?._touched?.(),!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return this._cd?.control?._pristine?.(),!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return this._cd?.control?._status?.(),!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return this._cd?._submitted?.(),!!this._cd?.submitted}},iP={"[class.ng-untouched]":"isUntouched","[class.ng-touched]":"isTouched","[class.ng-pristine]":"isPristine","[class.ng-dirty]":"isDirty","[class.ng-valid]":"isValid","[class.ng-invalid]":"isInvalid","[class.ng-pending]":"isPending"},bZ=Y(P({},iP),{"[class.ng-submitted]":"isSubmitted"}),Pe=(()=>{class n extends pf{constructor(e){super(e)}static \u0275fac=function(i){return new(i||n)(C(yi,2))};static \u0275dir=ye({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){i&2&&we("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},standalone:!1,features:[Qe]})}return n})(),An=(()=>{class n extends pf{constructor(e){super(e)}static \u0275fac=function(i){return new(i||n)(C(Qt,10))};static \u0275dir=ye({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){i&2&&we("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},standalone:!1,features:[Qe]})}return n})();var Dl="VALID",cf="INVALID",Rs="PENDING",Il="DISABLED",Er=class{},hf=class extends Er{value;source;constructor(t,e){super(),this.value=t,this.source=e}},Ml=class extends Er{pristine;source;constructor(t,e){super(),this.pristine=t,this.source=e}},Al=class extends Er{touched;source;constructor(t,e){super(),this.touched=t,this.source=e}},Os=class extends Er{status;source;constructor(t,e){super(),this.status=t,this.source=e}},mf=class extends Er{source;constructor(t){super(),this.source=t}},Ol=class extends Er{source;constructor(t){super(),this.source=t}};function J0(n){return(yf(n)?n.validators:n)||null}function rP(n){return Array.isArray(n)?Y0(n):n||null}function Q0(n,t){return(yf(t)?t.asyncValidators:n)||null}function oP(n){return Array.isArray(n)?Z0(n):n||null}function yf(n){return n!=null&&!Array.isArray(n)&&typeof n=="object"}function U1(n,t,e){let i=n.controls;if(!(t?Object.keys(i):i).length)throw new F(1e3,"");if(!i[e])throw new F(1001,"")}function B1(n,t,e){n._forEachChild((i,r)=>{if(e[r]===void 0)throw new F(1002,"")})}var Ns=class{_pendingDirty=!1;_hasOwnPendingAsyncValidator=null;_pendingTouched=!1;_onCollectionChange=()=>{};_updateOn;_parent=null;_asyncValidationSubscription;_composedValidatorFn;_composedAsyncValidatorFn;_rawValidators;_rawAsyncValidators;value;constructor(t,e){this._assignValidators(t),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(t){this._rawValidators=this._composedValidatorFn=t}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(t){this._rawAsyncValidators=this._composedAsyncValidatorFn=t}get parent(){return this._parent}get status(){return at(this.statusReactive)}set status(t){at(()=>this.statusReactive.set(t))}_status=io(()=>this.statusReactive());statusReactive=Be(void 0);get valid(){return this.status===Dl}get invalid(){return this.status===cf}get pending(){return this.status==Rs}get disabled(){return this.status===Il}get enabled(){return this.status!==Il}errors;get pristine(){return at(this.pristineReactive)}set pristine(t){at(()=>this.pristineReactive.set(t))}_pristine=io(()=>this.pristineReactive());pristineReactive=Be(!0);get dirty(){return!this.pristine}get touched(){return at(this.touchedReactive)}set touched(t){at(()=>this.touchedReactive.set(t))}_touched=io(()=>this.touchedReactive());touchedReactive=Be(!1);get untouched(){return!this.touched}_events=new Le;events=this._events.asObservable();valueChanges;statusChanges;get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(t){this._assignValidators(t)}setAsyncValidators(t){this._assignAsyncValidators(t)}addValidators(t){this.setValidators(C1(t,this._rawValidators))}addAsyncValidators(t){this.setAsyncValidators(C1(t,this._rawAsyncValidators))}removeValidators(t){this.setValidators(S1(t,this._rawValidators))}removeAsyncValidators(t){this.setAsyncValidators(S1(t,this._rawAsyncValidators))}hasValidator(t){return df(this._rawValidators,t)}hasAsyncValidator(t){return df(this._rawAsyncValidators,t)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(t={}){let e=this.touched===!1;this.touched=!0;let i=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsTouched(Y(P({},t),{sourceControl:i})),e&&t.emitEvent!==!1&&this._events.next(new Al(!0,i))}markAllAsDirty(t={}){this.markAsDirty({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsDirty(t))}markAllAsTouched(t={}){this.markAsTouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:this}),this._forEachChild(e=>e.markAllAsTouched(t))}markAsUntouched(t={}){let e=this.touched===!0;this.touched=!1,this._pendingTouched=!1;let i=t.sourceControl??this;this._forEachChild(r=>{r.markAsUntouched({onlySelf:!0,emitEvent:t.emitEvent,sourceControl:i})}),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,i),e&&t.emitEvent!==!1&&this._events.next(new Al(!1,i))}markAsDirty(t={}){let e=this.pristine===!0;this.pristine=!1;let i=t.sourceControl??this;this._parent&&!t.onlySelf&&this._parent.markAsDirty(Y(P({},t),{sourceControl:i})),e&&t.emitEvent!==!1&&this._events.next(new Ml(!1,i))}markAsPristine(t={}){let e=this.pristine===!1;this.pristine=!0,this._pendingDirty=!1;let i=t.sourceControl??this;this._forEachChild(r=>{r.markAsPristine({onlySelf:!0,emitEvent:t.emitEvent})}),this._parent&&!t.onlySelf&&this._parent._updatePristine(t,i),e&&t.emitEvent!==!1&&this._events.next(new Ml(!0,i))}markAsPending(t={}){this.status=Rs;let e=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new Os(this.status,e)),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.markAsPending(Y(P({},t),{sourceControl:e}))}disable(t={}){let e=this._parentMarkedDirty(t.onlySelf);this.status=Il,this.errors=null,this._forEachChild(r=>{r.disable(Y(P({},t),{onlySelf:!0}))}),this._updateValue();let i=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new hf(this.value,i)),this._events.next(new Os(this.status,i)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Y(P({},t),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(r=>r(!0))}enable(t={}){let e=this._parentMarkedDirty(t.onlySelf);this.status=Dl,this._forEachChild(i=>{i.enable(Y(P({},t),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent}),this._updateAncestors(Y(P({},t),{skipPristineCheck:e}),this),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(t,e){this._parent&&!t.onlySelf&&(this._parent.updateValueAndValidity(t),t.skipPristineCheck||this._parent._updatePristine({},e),this._parent._updateTouched({},e))}setParent(t){this._parent=t}getRawValue(){return this.value}updateValueAndValidity(t={}){if(this._setInitialStatus(),this._updateValue(),this.enabled){let i=this._cancelExistingSubscription();this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===Dl||this.status===Rs)&&this._runAsyncValidator(i,t.emitEvent)}let e=t.sourceControl??this;t.emitEvent!==!1&&(this._events.next(new hf(this.value,e)),this._events.next(new Os(this.status,e)),this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!t.onlySelf&&this._parent.updateValueAndValidity(Y(P({},t),{sourceControl:e}))}_updateTreeValidity(t={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(t)),this.updateValueAndValidity({onlySelf:!0,emitEvent:t.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Il:Dl}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(t,e){if(this.asyncValidator){this.status=Rs,this._hasOwnPendingAsyncValidator={emitEvent:e!==!1,shouldHaveEmitted:t!==!1};let i=N1(this.asyncValidator(this));this._asyncValidationSubscription=i.subscribe(r=>{this._hasOwnPendingAsyncValidator=null,this.setErrors(r,{emitEvent:e,shouldHaveEmitted:t})})}}_cancelExistingSubscription(){if(this._asyncValidationSubscription){this._asyncValidationSubscription.unsubscribe();let t=(this._hasOwnPendingAsyncValidator?.emitEvent||this._hasOwnPendingAsyncValidator?.shouldHaveEmitted)??!1;return this._hasOwnPendingAsyncValidator=null,t}return!1}setErrors(t,e={}){this.errors=t,this._updateControlsErrors(e.emitEvent!==!1,this,e.shouldHaveEmitted)}get(t){let e=t;return e==null||(Array.isArray(e)||(e=e.split(".")),e.length===0)?null:e.reduce((i,r)=>i&&i._find(r),this)}getError(t,e){let i=e?this.get(e):this;return i&&i.errors?i.errors[t]:null}hasError(t,e){return!!this.getError(t,e)}get root(){let t=this;for(;t._parent;)t=t._parent;return t}_updateControlsErrors(t,e,i){this.status=this._calculateStatus(),t&&this.statusChanges.emit(this.status),(t||i)&&this._events.next(new Os(this.status,e)),this._parent&&this._parent._updateControlsErrors(t,e,i)}_initObservables(){this.valueChanges=new Re,this.statusChanges=new Re}_calculateStatus(){return this._allControlsDisabled()?Il:this.errors?cf:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Rs)?Rs:this._anyControlsHaveStatus(cf)?cf:Dl}_anyControlsHaveStatus(t){return this._anyControls(e=>e.status===t)}_anyControlsDirty(){return this._anyControls(t=>t.dirty)}_anyControlsTouched(){return this._anyControls(t=>t.touched)}_updatePristine(t,e){let i=!this._anyControlsDirty(),r=this.pristine!==i;this.pristine=i,this._parent&&!t.onlySelf&&this._parent._updatePristine(t,e),r&&this._events.next(new Ml(this.pristine,e))}_updateTouched(t={},e){this.touched=this._anyControlsTouched(),this._events.next(new Al(this.touched,e)),this._parent&&!t.onlySelf&&this._parent._updateTouched(t,e)}_onDisabledChange=[];_registerOnCollectionChange(t){this._onCollectionChange=t}_setUpdateStrategy(t){yf(t)&&t.updateOn!=null&&(this._updateOn=t.updateOn)}_parentMarkedDirty(t){let e=this._parent&&this._parent.dirty;return!t&&!!e&&!this._parent._anyControlsDirty()}_find(t){return null}_assignValidators(t){this._rawValidators=Array.isArray(t)?t.slice():t,this._composedValidatorFn=rP(this._rawValidators)}_assignAsyncValidators(t){this._rawAsyncValidators=Array.isArray(t)?t.slice():t,this._composedAsyncValidatorFn=oP(this._rawAsyncValidators)}},Ps=class extends Ns{constructor(t,e,i){super(J0(e),Q0(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;registerControl(t,e){return this.controls[t]?this.controls[t]:(this.controls[t]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(t,e,i={}){this.registerControl(t,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(t,e={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(t,e,i={}){this.controls[t]&&this.controls[t]._registerOnCollectionChange(()=>{}),delete this.controls[t],e&&this.registerControl(t,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(t){return this.controls.hasOwnProperty(t)&&this.controls[t].enabled}setValue(t,e={}){B1(this,!0,t),Object.keys(t).forEach(i=>{U1(this,!0,i),this.controls[i].setValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t!=null&&(Object.keys(t).forEach(i=>{let r=this.controls[i];r&&r.patchValue(t[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t={},e={}){this._forEachChild((i,r)=>{i.reset(t?t[r]:null,{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e),e?.emitEvent!==!1&&this._events.next(new Ol(this))}getRawValue(){return this._reduceChildren({},(t,e,i)=>(t[i]=e.getRawValue(),t))}_syncPendingControls(){let t=this._reduceChildren(!1,(e,i)=>i._syncPendingControls()?!0:e);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){Object.keys(this.controls).forEach(e=>{let i=this.controls[e];i&&t(i,e)})}_setUpControls(){this._forEachChild(t=>{t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(t){for(let[e,i]of Object.entries(this.controls))if(this.contains(e)&&t(i))return!0;return!1}_reduceValue(){let t={};return this._reduceChildren(t,(e,i,r)=>((i.enabled||this.disabled)&&(e[r]=i.value),e))}_reduceChildren(t,e){let i=t;return this._forEachChild((r,o)=>{i=e(i,r,o)}),i}_allControlsDisabled(){for(let t of Object.keys(this.controls))if(this.controls[t].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(t){return this.controls.hasOwnProperty(t)?this.controls[t]:null}};var W0=class extends Ps{};var go=new U("",{providedIn:"root",factory:()=>Pl}),Pl="always";function bf(n,t){return[...t.path,n]}function Nl(n,t,e=Pl){X0(n,t),t.valueAccessor.writeValue(n.value),(n.disabled||e==="always")&&t.valueAccessor.setDisabledState?.(n.disabled),aP(n,t),cP(n,t),lP(n,t),sP(n,t)}function gf(n,t,e=!0){let i=()=>{};t.valueAccessor&&(t.valueAccessor.registerOnChange(i),t.valueAccessor.registerOnTouched(i)),_f(n,t),n&&(t._invokeOnDestroyCallbacks(),n._registerOnCollectionChange(()=>{}))}function vf(n,t){n.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function sP(n,t){if(t.valueAccessor.setDisabledState){let e=i=>{t.valueAccessor.setDisabledState(i)};n.registerOnDisabledChange(e),t._registerOnDestroy(()=>{n._unregisterOnDisabledChange(e)})}}function X0(n,t){let e=V1(n);t.validator!==null?n.setValidators(E1(e,t.validator)):typeof e=="function"&&n.setValidators([e]);let i=z1(n);t.asyncValidator!==null?n.setAsyncValidators(E1(i,t.asyncValidator)):typeof i=="function"&&n.setAsyncValidators([i]);let r=()=>n.updateValueAndValidity();vf(t._rawValidators,r),vf(t._rawAsyncValidators,r)}function _f(n,t){let e=!1;if(n!==null){if(t.validator!==null){let r=V1(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(s=>s!==t.validator);o.length!==r.length&&(e=!0,n.setValidators(o))}}if(t.asyncValidator!==null){let r=z1(n);if(Array.isArray(r)&&r.length>0){let o=r.filter(s=>s!==t.asyncValidator);o.length!==r.length&&(e=!0,n.setAsyncValidators(o))}}}let i=()=>{};return vf(t._rawValidators,i),vf(t._rawAsyncValidators,i),e}function aP(n,t){t.valueAccessor.registerOnChange(e=>{n._pendingValue=e,n._pendingChange=!0,n._pendingDirty=!0,n.updateOn==="change"&&$1(n,t)})}function lP(n,t){t.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,n.updateOn==="blur"&&n._pendingChange&&$1(n,t),n.updateOn!=="submit"&&n.markAsTouched()})}function $1(n,t){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}function cP(n,t){let e=(i,r)=>{t.valueAccessor.writeValue(i),r&&t.viewToModelUpdate(i)};n.registerOnChange(e),t._registerOnDestroy(()=>{n._unregisterOnChange(e)})}function H1(n,t){n==null,X0(n,t)}function uP(n,t){return _f(n,t)}function ev(n,t){if(!n.hasOwnProperty("model"))return!1;let e=n.model;return e.isFirstChange()?!0:!Object.is(t,e.currentValue)}function dP(n){return Object.getPrototypeOf(n.constructor)===ks}function W1(n,t){n._syncPendingControls(),t.forEach(e=>{let i=e.control;i.updateOn==="submit"&&i._pendingChange&&(e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}function tv(n,t){if(!t)return null;Array.isArray(t);let e,i,r;return t.forEach(o=>{o.constructor===Ne?e=o:dP(o)?i=o:r=o}),r||i||e||null}function fP(n,t){let e=n.indexOf(t);e>-1&&n.splice(e,1)}var pP={provide:Qt,useExisting:st(()=>nv)},Tl=Promise.resolve(),nv=(()=>{class n extends Qt{callSetDisabledState;get submitted(){return at(this.submittedReactive)}_submitted=io(()=>this.submittedReactive());submittedReactive=Be(!1);_directives=new Set;form;ngSubmit=new Re;options;constructor(e,i,r){super(),this.callSetDisabledState=r,this.form=new Ps({},Y0(e),Z0(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){Tl.then(()=>{let i=this._findContainer(e.path);e.control=i.registerControl(e.name,e.control),Nl(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){Tl.then(()=>{let i=this._findContainer(e.path);i&&i.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){Tl.then(()=>{let i=this._findContainer(e.path),r=new Ps({});H1(r,e),i.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){Tl.then(()=>{let i=this._findContainer(e.path);i&&i.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,i){Tl.then(()=>{this.form.get(e.path).setValue(i)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submittedReactive.set(!0),W1(this.form,this._directives),this.ngSubmit.emit(e),this.form._events.next(new mf(this.control)),e?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submittedReactive.set(!1)}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}static \u0275fac=function(i){return new(i||n)(C(Cr,10),C(mo,10),C(go,8))};static \u0275dir=ye({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,r){i&1&&S("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{options:[0,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[kt([pP]),Qe]})}return n})();function x1(n,t){let e=n.indexOf(t);e>-1&&n.splice(e,1)}function D1(n){return typeof n=="object"&&n!==null&&Object.keys(n).length===2&&"value"in n&&"disabled"in n}var Rl=class extends Ns{defaultValue=null;_onChange=[];_pendingValue;_pendingChange=!1;constructor(t=null,e,i){super(J0(e),Q0(i,e)),this._applyFormState(t),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),yf(e)&&(e.nonNullable||e.initialValueIsDefault)&&(D1(t)?this.defaultValue=t.value:this.defaultValue=t)}setValue(t,e={}){this.value=this._pendingValue=t,this._onChange.length&&e.emitModelToViewChange!==!1&&this._onChange.forEach(i=>i(this.value,e.emitViewToModelChange!==!1)),this.updateValueAndValidity(e)}patchValue(t,e={}){this.setValue(t,e)}reset(t=this.defaultValue,e={}){this._applyFormState(t),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1,e?.emitEvent!==!1&&this._events.next(new Ol(this))}_updateValue(){}_anyControls(t){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(t){this._onChange.push(t)}_unregisterOnChange(t){x1(this._onChange,t)}registerOnDisabledChange(t){this._onDisabledChange.push(t)}_unregisterOnDisabledChange(t){x1(this._onDisabledChange,t)}_forEachChild(t){}_syncPendingControls(){return this.updateOn==="submit"&&(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),this._pendingChange)?(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),!0):!1}_applyFormState(t){D1(t)?(this.value=this._pendingValue=t.value,t.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=t}};var hP=n=>n instanceof Rl,mP=(()=>{class n extends Qt{_parent;ngOnInit(){this._checkParentType(),this.formDirective.addFormGroup(this)}ngOnDestroy(){this.formDirective&&this.formDirective.removeFormGroup(this)}get control(){return this.formDirective.getFormGroup(this)}get path(){return bf(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_checkParentType(){}static \u0275fac=(()=>{let e;return function(r){return(e||(e=xn(n)))(r||n)}})();static \u0275dir=ye({type:n,standalone:!1,features:[Qe]})}return n})();var gP={provide:yi,useExisting:st(()=>ct)},I1=Promise.resolve(),ct=(()=>{class n extends yi{_changeDetectorRef;callSetDisabledState;control=new Rl;static ngAcceptInputType_isDisabled;_registered=!1;viewModel;name="";isDisabled;model;options;update=new Re;constructor(e,i,r,o,s,a){super(),this._changeDetectorRef=s,this.callSetDisabledState=a,this._parent=e,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=tv(this,o)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){let i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),ev(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&this.options.updateOn!=null&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!!(this.options&&this.options.standalone)}_setUpStandalone(){Nl(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._checkName()}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),!this._isStandalone()&&this.name}_updateValue(e){I1.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){let i=e.isDisabled.currentValue,r=i!==0&&ro(i);I1.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?bf(e,this._parent):[e]}static \u0275fac=function(i){return new(i||n)(C(Qt,9),C(Cr,10),C(mo,10),C(Gi,10),C(Bi,8),C(go,8))};static \u0275dir=ye({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"],options:[0,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],standalone:!1,features:[kt([gP]),Qe,fn]})}return n})();var Rn=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275dir=ye({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""],standalone:!1})}return n})(),vP={provide:Gi,useExisting:st(()=>kl),multi:!0},kl=(()=>{class n extends ks{writeValue(e){let i=e??"";this.setProperty("value",i)}registerOnChange(e){this.onChange=i=>{e(i==""?null:parseFloat(i))}}static \u0275fac=(()=>{let e;return function(r){return(e||(e=xn(n)))(r||n)}})();static \u0275dir=ye({type:n,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,r){i&1&&S("input",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},standalone:!1,features:[kt([vP]),Qe]})}return n})(),_P={provide:Gi,useExisting:st(()=>iv),multi:!0};var yP=(()=>{class n{_accessors=[];add(e,i){this._accessors.push([e,i])}remove(e){for(let i=this._accessors.length-1;i>=0;--i)if(this._accessors[i][1]===e){this._accessors.splice(i,1);return}}select(e){this._accessors.forEach(i=>{this._isSameGroup(i,e)&&i[1]!==e&&i[1].fireUncheck(e.value)})}_isSameGroup(e,i){return e[0].control?e[0]._parent===i._control._parent&&e[1].name===i.name:!1}static \u0275fac=function(i){return new(i||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})(),iv=(()=>{class n extends ks{_registry;_injector;_state;_control;_fn;setDisabledStateFired=!1;onChange=()=>{};name;formControlName;value;callSetDisabledState=A(go,{optional:!0})??Pl;constructor(e,i,r,o){super(e,i),this._registry=r,this._injector=o}ngOnInit(){this._control=this._injector.get(yi),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(e){this._state=e===this.value,this.setProperty("checked",this._state)}registerOnChange(e){this._fn=e,this.onChange=()=>{e(this.value),this._registry.select(this)}}setDisabledState(e){(this.setDisabledStateFired||e||this.callSetDisabledState==="whenDisabledForLegacyCode")&&this.setProperty("disabled",e),this.setDisabledStateFired=!0}fireUncheck(e){this.writeValue(e)}_checkName(){this.name&&this.formControlName&&(this.name,this.formControlName),!this.name&&this.formControlName&&(this.name=this.formControlName)}static \u0275fac=function(i){return new(i||n)(C(rn),C(mt),C(yP),C(qt))};static \u0275dir=ye({type:n,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(i,r){i&1&&S("change",function(){return r.onChange()})("blur",function(){return r.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},standalone:!1,features:[kt([_P]),Qe]})}return n})();var rv=new U(""),bP={provide:yi,useExisting:st(()=>ov)},ov=(()=>{class n extends yi{_ngModelWarningConfig;callSetDisabledState;viewModel;form;set isDisabled(e){}model;update=new Re;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(e,i,r,o,s){super(),this._ngModelWarningConfig=o,this.callSetDisabledState=s,this._setValidators(e),this._setAsyncValidators(i),this.valueAccessor=tv(this,r)}ngOnChanges(e){if(this._isControlChanged(e)){let i=e.form.previousValue;i&&gf(i,this,!1),Nl(this.form,this,this.callSetDisabledState),this.form.updateValueAndValidity({emitEvent:!1})}ev(e,this.viewModel)&&(this.form.setValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.form&&gf(this.form,this,!1)}get path(){return[]}get control(){return this.form}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_isControlChanged(e){return e.hasOwnProperty("form")}static \u0275fac=function(i){return new(i||n)(C(Cr,10),C(mo,10),C(Gi,10),C(rv,8),C(go,8))};static \u0275dir=ye({type:n,selectors:[["","formControl",""]],inputs:{form:[0,"formControl","form"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},exportAs:["ngForm"],standalone:!1,features:[kt([bP]),Qe,fn]})}return n})(),wP={provide:Qt,useExisting:st(()=>On)},On=(()=>{class n extends Qt{callSetDisabledState;get submitted(){return at(this._submittedReactive)}set submitted(e){this._submittedReactive.set(e)}_submitted=io(()=>this._submittedReactive());_submittedReactive=Be(!1);_oldForm;_onCollectionChange=()=>this._updateDomValue();directives=[];form=null;ngSubmit=new Re;constructor(e,i,r){super(),this.callSetDisabledState=r,this._setValidators(e),this._setAsyncValidators(i)}ngOnChanges(e){e.hasOwnProperty("form")&&(this._updateValidators(),this._updateDomValue(),this._updateRegistrations(),this._oldForm=this.form)}ngOnDestroy(){this.form&&(_f(this.form,this),this.form._onCollectionChange===this._onCollectionChange&&this.form._registerOnCollectionChange(()=>{}))}get formDirective(){return this}get control(){return this.form}get path(){return[]}addControl(e){let i=this.form.get(e.path);return Nl(i,e,this.callSetDisabledState),i.updateValueAndValidity({emitEvent:!1}),this.directives.push(e),i}getControl(e){return this.form.get(e.path)}removeControl(e){gf(e.control||null,e,!1),fP(this.directives,e)}addFormGroup(e){this._setUpFormContainer(e)}removeFormGroup(e){this._cleanUpFormContainer(e)}getFormGroup(e){return this.form.get(e.path)}addFormArray(e){this._setUpFormContainer(e)}removeFormArray(e){this._cleanUpFormContainer(e)}getFormArray(e){return this.form.get(e.path)}updateModel(e,i){this.form.get(e.path).setValue(i)}onSubmit(e){return this._submittedReactive.set(!0),W1(this.form,this.directives),this.ngSubmit.emit(e),this.form._events.next(new mf(this.control)),e?.target?.method==="dialog"}onReset(){this.resetForm()}resetForm(e=void 0,i={}){this.form.reset(e,i),this._submittedReactive.set(!1)}_updateDomValue(){this.directives.forEach(e=>{let i=e.control,r=this.form.get(e.path);i!==r&&(gf(i||null,e),hP(r)&&(Nl(r,e,this.callSetDisabledState),e.control=r))}),this.form._updateTreeValidity({emitEvent:!1})}_setUpFormContainer(e){let i=this.form.get(e.path);H1(i,e),i.updateValueAndValidity({emitEvent:!1})}_cleanUpFormContainer(e){if(this.form){let i=this.form.get(e.path);i&&uP(i,e)&&i.updateValueAndValidity({emitEvent:!1})}}_updateRegistrations(){this.form._registerOnCollectionChange(this._onCollectionChange),this._oldForm&&this._oldForm._registerOnCollectionChange(()=>{})}_updateValidators(){X0(this.form,this),this._oldForm&&_f(this._oldForm,this)}static \u0275fac=function(i){return new(i||n)(C(Cr,10),C(mo,10),C(go,8))};static \u0275dir=ye({type:n,selectors:[["","formGroup",""]],hostBindings:function(i,r){i&1&&S("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{form:[0,"formGroup","form"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],standalone:!1,features:[kt([wP]),Qe,fn]})}return n})(),EP={provide:Qt,useExisting:st(()=>Fs)},Fs=(()=>{class n extends mP{name=null;constructor(e,i,r){super(),this._parent=e,this._setValidators(i),this._setAsyncValidators(r)}_checkParentType(){q1(this._parent)}static \u0275fac=function(i){return new(i||n)(C(Qt,13),C(Cr,10),C(mo,10))};static \u0275dir=ye({type:n,selectors:[["","formGroupName",""]],inputs:{name:[0,"formGroupName","name"]},standalone:!1,features:[kt([EP]),Qe]})}return n})(),CP={provide:Qt,useExisting:st(()=>G1)},G1=(()=>{class n extends Qt{_parent;name=null;constructor(e,i,r){super(),this._parent=e,this._setValidators(i),this._setAsyncValidators(r)}ngOnInit(){q1(this._parent),this.formDirective.addFormArray(this)}ngOnDestroy(){this.formDirective?.removeFormArray(this)}get control(){return this.formDirective.getFormArray(this)}get formDirective(){return this._parent?this._parent.formDirective:null}get path(){return bf(this.name==null?this.name:this.name.toString(),this._parent)}static \u0275fac=function(i){return new(i||n)(C(Qt,13),C(Cr,10),C(mo,10))};static \u0275dir=ye({type:n,selectors:[["","formArrayName",""]],inputs:{name:[0,"formArrayName","name"]},standalone:!1,features:[kt([CP]),Qe]})}return n})();function q1(n){return!(n instanceof Fs)&&!(n instanceof On)&&!(n instanceof G1)}var SP={provide:yi,useExisting:st(()=>Xn)},Xn=(()=>{class n extends yi{_ngModelWarningConfig;_added=!1;viewModel;control;name=null;set isDisabled(e){}model;update=new Re;static _ngModelWarningSentOnce=!1;_ngModelWarningSent=!1;constructor(e,i,r,o,s){super(),this._ngModelWarningConfig=s,this._parent=e,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=tv(this,o)}ngOnChanges(e){this._added||this._setUpControl(),ev(e,this.viewModel)&&(this.viewModel=this.model,this.formDirective.updateModel(this,this.model))}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}get path(){return bf(this.name==null?this.name:this.name.toString(),this._parent)}get formDirective(){return this._parent?this._parent.formDirective:null}_setUpControl(){this.control=this.formDirective.addControl(this),this._added=!0}static \u0275fac=function(i){return new(i||n)(C(Qt,13),C(Cr,10),C(mo,10),C(Gi,10),C(rv,8))};static \u0275dir=ye({type:n,selectors:[["","formControlName",""]],inputs:{name:[0,"formControlName","name"],isDisabled:[0,"disabled","isDisabled"],model:[0,"ngModel","model"]},outputs:{update:"ngModelChange"},standalone:!1,features:[kt([SP]),Qe,fn]})}return n})();var xP={provide:Gi,useExisting:st(()=>wt),multi:!0};function K1(n,t){return n==null?`${t}`:(t&&typeof t=="object"&&(t="Object"),`${n}: ${t}`.slice(0,50))}function DP(n){return n.split(":")[0]}var wt=(()=>{class n extends ks{value;_optionMap=new Map;_idCounter=0;set compareWith(e){this._compareWith=e}_compareWith=Object.is;appRefInjector=A(Vi).injector;destroyRef=A(Wn);cdr=A(Bi);_queuedWrite=!1;_writeValueAfterRender(){this._queuedWrite||this.appRefInjector.destroyed||(this._queuedWrite=!0,ja({write:()=>{this.destroyRef.destroyed||(this._queuedWrite=!1,this.writeValue(this.value))}},{injector:this.appRefInjector}))}writeValue(e){this.cdr.markForCheck(),this.value=e;let i=this._getOptionId(e),r=K1(i,e);this.setProperty("value",r)}registerOnChange(e){this.onChange=i=>{this.value=this._getOptionValue(i),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),e))return i;return null}_getOptionValue(e){let i=DP(e);return this._optionMap.has(i)?this._optionMap.get(i):e}static \u0275fac=(()=>{let e;return function(r){return(e||(e=xn(n)))(r||n)}})();static \u0275dir=ye({type:n,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,r){i&1&&S("change",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[kt([xP]),Qe]})}return n})(),Vt=(()=>{class n{_element;_renderer;_select;id;constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(e){this._select!=null&&(this._select._optionMap.set(this.id,e),this._setElementValue(K1(this.id,e)),this._select._writeValueAfterRender())}set value(e){this._setElementValue(e),this._select&&this._select._writeValueAfterRender()}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select._writeValueAfterRender())}static \u0275fac=function(i){return new(i||n)(C(mt),C(rn),C(wt,9))};static \u0275dir=ye({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})(),IP={provide:Gi,useExisting:st(()=>Y1),multi:!0};function T1(n,t){return n==null?`${t}`:(typeof t=="string"&&(t=`'${t}'`),t&&typeof t=="object"&&(t="Object"),`${n}: ${t}`.slice(0,50))}function TP(n){return n.split(":")[0]}var Y1=(()=>{class n extends ks{value;_optionMap=new Map;_idCounter=0;set compareWith(e){this._compareWith=e}_compareWith=Object.is;writeValue(e){this.value=e;let i;if(Array.isArray(e)){let r=e.map(o=>this._getOptionId(o));i=(o,s)=>{o._setSelected(r.indexOf(s.toString())>-1)}}else i=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(e){this.onChange=i=>{let r=[],o=i.selectedOptions;if(o!==void 0){let s=o;for(let a=0;a<s.length;a++){let c=s[a],f=this._getOptionValue(c.value);r.push(f)}}else{let s=i.options;for(let a=0;a<s.length;a++){let c=s[a];if(c.selected){let f=this._getOptionValue(c.value);r.push(f)}}}this.value=r,e(r)}}_registerOption(e){let i=(this._idCounter++).toString();return this._optionMap.set(i,e),i}_getOptionId(e){for(let i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,e))return i;return null}_getOptionValue(e){let i=TP(e);return this._optionMap.has(i)?this._optionMap.get(i)._value:e}static \u0275fac=(()=>{let e;return function(r){return(e||(e=xn(n)))(r||n)}})();static \u0275dir=ye({type:n,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,r){i&1&&S("change",function(s){return r.onChange(s.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},standalone:!1,features:[kt([IP]),Qe]})}return n})(),zt=(()=>{class n{_element;_renderer;_select;id;_value;constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){this._select!=null&&(this._value=e,this._setElementValue(T1(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(T1(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static \u0275fac=function(i){return new(i||n)(C(mt),C(rn),C(Y1,9))};static \u0275dir=ye({type:n,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"},standalone:!1})}return n})();function MP(n){return typeof n=="number"?n:parseFloat(n)}var AP=(()=>{class n{_validator=uf;_onChange;_enabled;ngOnChanges(e){if(this.inputName in e){let i=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):uf,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return e!=null}static \u0275fac=function(i){return new(i||n)};static \u0275dir=ye({type:n,features:[fn]})}return n})();var RP={provide:Cr,useExisting:st(()=>sv),multi:!0},sv=(()=>{class n extends AP{min;inputName="min";normalizeInput=e=>MP(e);createValidator=e=>R1(e);static \u0275fac=(()=>{let e;return function(r){return(e||(e=xn(n)))(r||n)}})();static \u0275dir=ye({type:n,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(i,r){i&2&&ps("min",r._enabled?r.min:null)},inputs:{min:"min"},standalone:!1,features:[kt([RP]),Qe]})}return n})();var Z1=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=Dn({type:n});static \u0275inj=cn({})}return n})(),G0=class extends Ns{constructor(t,e,i){super(J0(e),Q0(i,e)),this.controls=t,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}controls;at(t){return this.controls[this._adjustIndex(t)]}push(t,e={}){Array.isArray(t)?t.forEach(i=>{this.controls.push(i),this._registerControl(i)}):(this.controls.push(t),this._registerControl(t)),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(t,e,i={}){this.controls.splice(t,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(t,e={}){let i=this._adjustIndex(t);i<0&&(i=0),this.controls[i]&&this.controls[i]._registerOnCollectionChange(()=>{}),this.controls.splice(i,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(t,e,i={}){let r=this._adjustIndex(t);r<0&&(r=0),this.controls[r]&&this.controls[r]._registerOnCollectionChange(()=>{}),this.controls.splice(r,1),e&&(this.controls.splice(r,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(t,e={}){B1(this,!1,t),t.forEach((i,r)=>{U1(this,!1,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(t,e={}){t!=null&&(t.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(t=[],e={}){this._forEachChild((i,r)=>{i.reset(t[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e,this),this._updateTouched(e,this),this.updateValueAndValidity(e),e?.emitEvent!==!1&&this._events.next(new Ol(this))}getRawValue(){return this.controls.map(t=>t.getRawValue())}clear(t={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:t.emitEvent}))}_adjustIndex(t){return t<0?t+this.length:t}_syncPendingControls(){let t=this.controls.reduce((e,i)=>i._syncPendingControls()?!0:e,!1);return t&&this.updateValueAndValidity({onlySelf:!0}),t}_forEachChild(t){this.controls.forEach((e,i)=>{t(e,i)})}_updateValue(){this.value=this.controls.filter(t=>t.enabled||this.disabled).map(t=>t.value)}_anyControls(t){return this.controls.some(e=>e.enabled&&t(e))}_setUpControls(){this._forEachChild(t=>this._registerControl(t))}_allControlsDisabled(){for(let t of this.controls)if(t.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(t){t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange)}_find(t){return this.at(t)??null}};function M1(n){return!!n&&(n.asyncValidators!==void 0||n.validators!==void 0||n.updateOn!==void 0)}var bi=(()=>{class n{useNonNullable=!1;get nonNullable(){let e=new n;return e.useNonNullable=!0,e}group(e,i=null){let r=this._reduceControls(e),o={};return M1(i)?o=i:i!==null&&(o.validators=i.validator,o.asyncValidators=i.asyncValidator),new Ps(r,o)}record(e,i=null){let r=this._reduceControls(e);return new W0(r,i)}control(e,i,r){let o={};return this.useNonNullable?(M1(i)?o=i:(o.validators=i,o.asyncValidators=r),new Rl(e,Y(P({},o),{nonNullable:!0}))):new Rl(e,i,r)}array(e,i,r){let o=e.map(s=>this._createControl(s));return new G0(o,i,r)}_reduceControls(e){let i={};return Object.keys(e).forEach(r=>{i[r]=this._createControl(e[r])}),i}_createControl(e){if(e instanceof Rl)return e;if(e instanceof Ns)return e;if(Array.isArray(e)){let i=e[0],r=e.length>1?e[1]:null,o=e.length>2?e[2]:null;return this.control(i,r,o)}else return this.control(e)}static \u0275fac=function(i){return new(i||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var Et=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:go,useValue:e.callSetDisabledState??Pl}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=Dn({type:n});static \u0275inj=cn({imports:[Z1]})}return n})(),wi=(()=>{class n{static withConfig(e){return{ngModule:n,providers:[{provide:rv,useValue:e.warnOnNgModelWithFormControl??"always"},{provide:go,useValue:e.callSetDisabledState??Pl}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=Dn({type:n});static \u0275inj=cn({imports:[Z1]})}return n})();ke();var J1=n=>{let t;return n?t=n:typeof fetch>"u"?t=(...e)=>import("./chunk-HXKWO5LS.js").then(({default:i})=>i(...e)):t=fetch,(...e)=>t(...e)};var Fl=class extends Error{constructor(t,e="FunctionsError",i){super(t),this.name=e,this.context=i}},Ll=class extends Fl{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}},jl=class extends Fl{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}},Vl=class extends Fl{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}},av=(function(n){return n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2",n})(av||{});var zl=class{constructor(t,{headers:e={},customFetch:i,region:r=av.Any}={}){this.url=t,this.headers=e,this.region=r,this.fetch=J1(i)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t){return z(this,arguments,void 0,function*(e,i={}){var r;try{let{headers:o,method:s,body:a,signal:c}=i,f={},{region:h}=i;h||(h=this.region);let m=new URL(`${this.url}/${e}`);h&&h!=="any"&&(f["x-region"]=h,m.searchParams.set("forceFunctionRegion",h));let y;a&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(f["Content-Type"]="application/octet-stream",y=a):typeof a=="string"?(f["Content-Type"]="text/plain",y=a):typeof FormData<"u"&&a instanceof FormData?y=a:(f["Content-Type"]="application/json",y=JSON.stringify(a)):y=a;let g=yield this.fetch(m.toString(),{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},f),this.headers),o),body:y,signal:c}).catch(M=>{throw M.name==="AbortError"?M:new Ll(M)}),w=g.headers.get("x-relay-error");if(w&&w==="true")throw new jl(g);if(!g.ok)throw new Vl(g);let T=((r=g.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),x;return T==="application/json"?x=yield g.json():T==="application/octet-stream"||T==="application/pdf"?x=yield g.blob():T==="text/event-stream"?x=g:T==="multipart/form-data"?x=yield g.formData():x=yield g.text(),{data:x,error:null,response:g}}catch(o){return o instanceof Error&&o.name==="AbortError"?{data:null,error:new Ll(o)}:{data:null,error:o,response:o instanceof Vl||o instanceof jl?o.context:void 0}}})}};var Sv=bx(aS(),1),{PostgrestClient:lS,PostgrestQueryBuilder:VZ,PostgrestFilterBuilder:zZ,PostgrestTransformBuilder:UZ,PostgrestBuilder:BZ,PostgrestError:BP}=Sv.default||Sv;var xv=class{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){let e=process.versions;if(e&&e.node){let i=e.node,r=parseInt(i.replace(/^v/,"").split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){let t=this.detectEnvironment();if(t.constructor)return t.constructor;let e=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(e+=`

Suggested solution: ${t.workaround}`),new Error(e)}static createWebSocket(t,e){let i=this.getWebSocketConstructor();return new i(t,e)}static isWebSocketSupported(){try{let t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}},Dv=xv;var cS="2.77.0";var uS=`realtime-js/${cS}`,dS="1.0.0";var Bl=1e4,fS=1e3,pS=100,$l=(function(n){return n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed",n})($l||{}),ut=(function(n){return n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving",n})(ut||{}),Nn=(function(n){return n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token",n})(Nn||{}),Iv=(function(n){return n.websocket="websocket",n})(Iv||{}),vo=(function(n){return n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed",n})(vo||{});var Ef=class{constructor(){this.HEADER_LENGTH=1}decode(t,e){return t.constructor===ArrayBuffer?e(this._binaryDecode(t)):e(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){let e=new DataView(t),i=new TextDecoder;return this._decodeBroadcast(t,e,i)}_decodeBroadcast(t,e,i){let r=e.getUint8(1),o=e.getUint8(2),s=this.HEADER_LENGTH+2,a=i.decode(t.slice(s,s+r));s=s+r;let c=i.decode(t.slice(s,s+o));s=s+o;let f=JSON.parse(i.decode(t.slice(s,t.byteLength)));return{ref:null,topic:a,event:c,payload:f}}};var js=class{constructor(t,e){this.callback=t,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var Fe=(function(n){return n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange",n})(Fe||{}),Mv=(n,t,e={})=>{var i;let r=(i=e.skipTypes)!==null&&i!==void 0?i:[];return t?Object.keys(t).reduce((o,s)=>(o[s]=$P(s,n,t,r),o),{}):{}},$P=(n,t,e,i)=>{let r=t.find(a=>a.name===n),o=r?.type,s=e[n];return o&&!i.includes(o)?hS(o,s):Tv(s)},hS=(n,t)=>{if(n.charAt(0)==="_"){let e=n.slice(1,n.length);return qP(t,e)}switch(n){case Fe.bool:return HP(t);case Fe.float4:case Fe.float8:case Fe.int2:case Fe.int4:case Fe.int8:case Fe.numeric:case Fe.oid:return WP(t);case Fe.json:case Fe.jsonb:return GP(t);case Fe.timestamp:return KP(t);case Fe.abstime:case Fe.date:case Fe.daterange:case Fe.int4range:case Fe.int8range:case Fe.money:case Fe.reltime:case Fe.text:case Fe.time:case Fe.timestamptz:case Fe.timetz:case Fe.tsrange:case Fe.tstzrange:return Tv(t);default:return Tv(t)}},Tv=n=>n,HP=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},WP=n=>{if(typeof n=="string"){let t=parseFloat(n);if(!Number.isNaN(t))return t}return n},GP=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(t){return console.log(`JSON parse error: ${t}`),n}return n},qP=(n,t)=>{if(typeof n!="string")return n;let e=n.length-1,i=n[e];if(n[0]==="{"&&i==="}"){let o,s=n.slice(1,e);try{o=JSON.parse("["+s+"]")}catch{o=s?s.split(","):[]}return o.map(a=>hS(t,a))}return n},KP=n=>typeof n=="string"?n.replace(" ","T"):n,Cf=n=>{let t=new URL(n);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),t.pathname===""||t.pathname==="/"?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};var Vs=class{constructor(t,e,i={},r=Bl){this.channel=t,this.event=e,this.payload=i,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,e){var i;return this._hasReceived(t)&&e((i=this.receivedResp)===null||i===void 0?void 0:i.response),this.recHooks.push({status:t,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);let t=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:e}){this.recHooks.filter(i=>i.status===t).forEach(i=>i.callback(e))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}};var Hl=class n{constructor(t,e){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let i=e?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(i.state,{},r=>{let{onJoin:o,onLeave:s,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=n.syncState(this.state,r,o,s),this.pendingDiffs.forEach(c=>{this.state=n.syncDiff(this.state,c,o,s)}),this.pendingDiffs=[],a()}),this.channel._on(i.diff,{},r=>{let{onJoin:o,onLeave:s,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=n.syncDiff(this.state,r,o,s),a())}),this.onJoin((r,o,s)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:o,newPresences:s})}),this.onLeave((r,o,s)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:o,leftPresences:s})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,e,i,r){let o=this.cloneDeep(t),s=this.transformState(e),a={},c={};return this.map(o,(f,h)=>{s[f]||(c[f]=h)}),this.map(s,(f,h)=>{let m=o[f];if(m){let y=h.map(x=>x.presence_ref),g=m.map(x=>x.presence_ref),w=h.filter(x=>g.indexOf(x.presence_ref)<0),T=m.filter(x=>y.indexOf(x.presence_ref)<0);w.length>0&&(a[f]=w),T.length>0&&(c[f]=T)}else a[f]=h}),this.syncDiff(o,{joins:a,leaves:c},i,r)}static syncDiff(t,e,i,r){let{joins:o,leaves:s}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return i||(i=()=>{}),r||(r=()=>{}),this.map(o,(a,c)=>{var f;let h=(f=t[a])!==null&&f!==void 0?f:[];if(t[a]=this.cloneDeep(c),h.length>0){let m=t[a].map(g=>g.presence_ref),y=h.filter(g=>m.indexOf(g.presence_ref)<0);t[a].unshift(...y)}i(a,h,c)}),this.map(s,(a,c)=>{let f=t[a];if(!f)return;let h=c.map(m=>m.presence_ref);f=f.filter(m=>h.indexOf(m.presence_ref)<0),t[a]=f,r(a,f,c),f.length===0&&delete t[a]}),t}static map(t,e){return Object.getOwnPropertyNames(t).map(i=>e(i,t[i]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((e,i)=>{let r=t[i];return"metas"in r?e[i]=r.metas.map(o=>(o.presence_ref=o.phx_ref,delete o.phx_ref,delete o.phx_ref_prev,o)):e[i]=r,e},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}};var Wl=(function(n){return n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system",n})(Wl||{}),qi=(function(n){return n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR",n})(qi||{});var Gl=class n{constructor(t,e={config:{}},i){var r,o;if(this.topic=t,this.params=e,this.socket=i,this.bindings={},this.state=ut.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},e.config),this.timeout=this.socket.timeout,this.joinPush=new Vs(this,Nn.join,this.params,this.timeout),this.rejoinTimer=new js(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ut.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ut.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=ut.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ut.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=ut.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Nn.reply,{},(s,a)=>{this._trigger(this._replyEventName(a),s)}),this.presence=new Hl(this),this.broadcastEndpointURL=Cf(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((o=(r=this.params.config)===null||r===void 0?void 0:r.broadcast)===null||o===void 0)&&o.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(t,e=this.timeout){var i,r,o;if(this.socket.isConnected()||this.socket.connect(),this.state==ut.closed){let{config:{broadcast:s,presence:a,private:c}}=this.params,f=(r=(i=this.bindings.postgres_changes)===null||i===void 0?void 0:i.map(g=>g.filter))!==null&&r!==void 0?r:[],h=!!this.bindings[Wl.PRESENCE]&&this.bindings[Wl.PRESENCE].length>0||((o=this.params.config.presence)===null||o===void 0?void 0:o.enabled)===!0,m={},y={broadcast:s,presence:Object.assign(Object.assign({},a),{enabled:h}),postgres_changes:f,private:c};this.socket.accessTokenValue&&(m.access_token=this.socket.accessTokenValue),this._onError(g=>t?.(qi.CHANNEL_ERROR,g)),this._onClose(()=>t?.(qi.CLOSED)),this.updateJoinPayload(Object.assign({config:y},m)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",w=>b(this,[w],function*({postgres_changes:g}){var T;if(this.socket.setAuth(),g===void 0){t?.(qi.SUBSCRIBED);return}else{let x=this.bindings.postgres_changes,M=(T=x?.length)!==null&&T!==void 0?T:0,X=[];for(let $=0;$<M;$++){let V=x[$],{filter:{event:fe,schema:dt,table:Ie,filter:it}}=V,Ji=g&&g[$];if(Ji&&Ji.event===fe&&Ji.schema===dt&&Ji.table===Ie&&Ji.filter===it)X.push(Object.assign(Object.assign({},V),{id:Ji.id}));else{this.unsubscribe(),this.state=ut.errored,t?.(qi.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=X,t&&t(qi.SUBSCRIBED);return}})).receive("error",g=>{this.state=ut.errored,t?.(qi.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{t?.(qi.TIMED_OUT)})}return this}presenceState(){return this.presence.state}track(i){return b(this,arguments,function*(t,e={}){return yield this.send({type:"presence",event:"track",payload:t},e.timeout||this.timeout)})}untrack(){return b(this,arguments,function*(t={}){return yield this.send({type:"presence",event:"untrack"},t)})}on(t,e,i){return this.state===ut.joined&&t===Wl.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,e,i)}httpSend(r,o){return b(this,arguments,function*(t,e,i={}){var s;let a=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(e==null)return Promise.reject("Payload is required for httpSend()");let c={method:"POST",headers:{Authorization:a,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:t,payload:e,private:this.private}]})},f=yield this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=i.timeout)!==null&&s!==void 0?s:this.timeout);if(f.status===202)return{success:!0};let h=f.statusText;try{let m=yield f.json();h=m.error||m.message||h}catch{}return Promise.reject(new Error(h))})}send(i){return b(this,arguments,function*(t,e={}){var r,o;if(!this._canPush()&&t.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");let{event:s,payload:a}=t,f={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:a,private:this.private}]})};try{let h=yield this._fetchWithTimeout(this.broadcastEndpointURL,f,(r=e.timeout)!==null&&r!==void 0?r:this.timeout);return yield(o=h.body)===null||o===void 0?void 0:o.cancel(),h.ok?"ok":"error"}catch(h){return h.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var a,c,f;let h=this._push(t.type,t,e.timeout||this.timeout);t.type==="broadcast"&&!(!((f=(c=(a=this.params)===null||a===void 0?void 0:a.config)===null||c===void 0?void 0:c.broadcast)===null||f===void 0)&&f.ack)&&s("ok"),h.receive("ok",()=>s("ok")),h.receive("error",()=>s("error")),h.receive("timeout",()=>s("timed out"))})})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=ut.leaving;let e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Nn.close,"leave",this._joinRef())};this.joinPush.destroy();let i=null;return new Promise(r=>{i=new Vs(this,Nn.leave,{},t),i.receive("ok",()=>{e(),r("ok")}).receive("timeout",()=>{e(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})}).finally(()=>{i?.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ut.closed,this.bindings={}}_fetchWithTimeout(t,e,i){return b(this,null,function*(){let r=new AbortController,o=setTimeout(()=>r.abort(),i),s=yield this.socket.fetch(t,Object.assign(Object.assign({},e),{signal:r.signal}));return clearTimeout(o),s})}_push(t,e,i=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Vs(this,t,e,i);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>pS){let e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(t,e,i){return e}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,e,i){var r,o;let s=t.toLocaleLowerCase(),{close:a,error:c,leave:f,join:h}=Nn;if(i&&[a,c,f,h].indexOf(s)>=0&&i!==this._joinRef())return;let y=this._onMessage(s,e,i);if(e&&!y)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(g=>{var w,T,x;return((w=g.filter)===null||w===void 0?void 0:w.event)==="*"||((x=(T=g.filter)===null||T===void 0?void 0:T.event)===null||x===void 0?void 0:x.toLocaleLowerCase())===s}).map(g=>g.callback(y,i)):(o=this.bindings[s])===null||o===void 0||o.filter(g=>{var w,T,x,M,X,$;if(["broadcast","presence","postgres_changes"].includes(s))if("id"in g){let V=g.id,fe=(w=g.filter)===null||w===void 0?void 0:w.event;return V&&((T=e.ids)===null||T===void 0?void 0:T.includes(V))&&(fe==="*"||fe?.toLocaleLowerCase()===((x=e.data)===null||x===void 0?void 0:x.type.toLocaleLowerCase()))}else{let V=(X=(M=g?.filter)===null||M===void 0?void 0:M.event)===null||X===void 0?void 0:X.toLocaleLowerCase();return V==="*"||V===(($=e?.event)===null||$===void 0?void 0:$.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===s}).map(g=>{if(typeof y=="object"&&"ids"in y){let w=y.data,{schema:T,table:x,commit_timestamp:M,type:X,errors:$}=w;y=Object.assign(Object.assign({},{schema:T,table:x,commit_timestamp:M,eventType:X,new:{},old:{},errors:$}),this._getPayloadRecords(w))}g.callback(y,i)})}_isClosed(){return this.state===ut.closed}_isJoined(){return this.state===ut.joined}_isJoining(){return this.state===ut.joining}_isLeaving(){return this.state===ut.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,e,i){let r=t.toLocaleLowerCase(),o={type:r,filter:e,callback:i};return this.bindings[r]?this.bindings[r].push(o):this.bindings[r]=[o],this}_off(t,e){let i=t.toLocaleLowerCase();return this.bindings[i]&&(this.bindings[i]=this.bindings[i].filter(r=>{var o;return!(((o=r.type)===null||o===void 0?void 0:o.toLocaleLowerCase())===i&&n.isEqual(r.filter,e))})),this}static isEqual(t,e){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(let i in t)if(t[i]!==e[i])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Nn.close,{},t)}_onError(t){this._on(Nn.error,{},e=>t(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ut.joining,this.joinPush.resend(t))}_getPayloadRecords(t){let e={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(e.new=Mv(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(e.old=Mv(t.columns,t.old_record)),e}};var Av=()=>{},Sf={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},ZP=[1e3,2e3,5e3,1e4],JP=1e4,QP=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`,ql=class{constructor(t,e){var i;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Bl,this.transport=null,this.heartbeatIntervalMs=Sf.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Av,this.ref=0,this.reconnectTimer=null,this.logger=Av,this.conn=null,this.sendBuffer=[],this.serializer=new Ef,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>{let o;return r?o=r:typeof fetch>"u"?o=(...s)=>import("./chunk-HXKWO5LS.js").then(({default:a})=>a(...s)).catch(a=>{throw new Error(`Failed to load @supabase/node-fetch: ${a.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):o=fetch,(...s)=>o(...s)},!(!((i=e?.params)===null||i===void 0)&&i.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=e.params.apikey,this.endPoint=`${t}/${Iv.websocket}`,this.httpEndpoint=Cf(t),this._initializeOptions(e),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(e?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Dv.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");let e=t.message;throw e.includes("Node.js")?new Error(`${e}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${e}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:dS}))}disconnect(t,e){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){let i=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(i),this._setConnectionState("disconnected")},t?this.conn.close(t,e??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}removeChannel(t){return b(this,null,function*(){let e=yield t.unsubscribe();return this.channels.length===0&&this.disconnect(),e})}removeAllChannels(){return b(this,null,function*(){let t=yield Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),t})}log(t,e,i){this.logger(t,e,i)}connectionState(){switch(this.conn&&this.conn.readyState){case $l.connecting:return vo.Connecting;case $l.open:return vo.Open;case $l.closing:return vo.Closing;default:return vo.Closed}}isConnected(){return this.connectionState()===vo.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,e={config:{}}){let i=`realtime:${t}`,r=this.getChannels().find(o=>o.topic===i);if(r)return r;{let o=new Gl(`realtime:${t}`,e,this);return this.channels.push(o),o}}push(t){let{topic:e,event:i,payload:r,ref:o}=t,s=()=>{this.encode(t,a=>{var c;(c=this.conn)===null||c===void 0||c.send(a)})};this.log("push",`${e} ${i} (${o})`,r),this.isConnected()?s():this.sendBuffer.push(s)}setAuth(t=null){return b(this,null,function*(){this._authPromise=this._performAuth(t);try{yield this._authPromise}finally{this._authPromise=null}})}sendHeartbeat(){return b(this,null,function*(){var t;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(e){this.log("error","error in heartbeat callback",e)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(e){this.log("error","error in heartbeat callback",e)}this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(fS,"heartbeat timeout"),setTimeout(()=>{var e;this.isConnected()||(e=this.reconnectTimer)===null||e===void 0||e.scheduleTimeout()},Sf.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(e){this.log("error","error in heartbeat callback",e)}this._setAuthSafely("heartbeat")})}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let e=this.channels.find(i=>i.topic===t&&(i._isJoined()||i._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${t}"`),e.unsubscribe())}_remove(t){this.channels=this.channels.filter(e=>e.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,e=>{if(e.topic==="phoenix"&&e.event==="phx_reply")try{this.heartbeatCallback(e.payload.status==="ok"?"ok":"error")}catch(f){this.log("error","error in heartbeat callback",f)}e.ref&&e.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);let{topic:i,event:r,payload:o,ref:s}=e,a=s?`(${s})`:"",c=o.status||"";this.log("receive",`${c} ${i} ${r} ${a}`.trim(),o),this.channels.filter(f=>f._isMember(i)).forEach(f=>f._trigger(r,o,s)),this._triggerStateCallbacks("message",e)})}_clearTimer(t){var e;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((e=this.reconnectTimer)===null||e===void 0||e.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{e.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var e;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(e=this.reconnectTimer)===null||e===void 0||e.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Nn.error))}_appendParams(t,e){if(Object.keys(e).length===0)return t;let i=t.match(/\?/)?"&":"?",r=new URLSearchParams(e);return`${t}${i}${r}`}_workerObjectUrl(t){let e;if(t)e=t;else{let i=new Blob([QP],{type:"application/javascript"});e=URL.createObjectURL(i)}return e}_setConnectionState(t,e=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=e)}_performAuth(t=null){return b(this,null,function*(){let e;t?e=t:this.accessToken?e=yield this.accessToken():e=this.accessTokenValue,this.accessTokenValue!=e&&(this.accessTokenValue=e,this.channels.forEach(i=>{let r={access_token:e,version:uS};e&&i.updateJoinPayload(r),i.joinedOnce&&i._isJoined()&&i._push(Nn.access_token,{access_token:e})}))})}_waitForAuthIfNeeded(){return b(this,null,function*(){this._authPromise&&(yield this._authPromise)})}_setAuthSafely(t="general"){this.setAuth().catch(e=>{this.log("error",`error setting auth in ${t}`,e)})}_triggerStateCallbacks(t,e){try{this.stateChangeCallbacks[t].forEach(i=>{try{i(e)}catch(r){this.log("error",`error in ${t} callback`,r)}})}catch(i){this.log("error",`error triggering ${t} callbacks`,i)}}_setupReconnectionTimer(){this.reconnectTimer=new js(()=>b(this,null,function*(){setTimeout(()=>b(this,null,function*(){yield this._waitForAuthIfNeeded(),this.isConnected()||this.connect()}),Sf.RECONNECT_DELAY)}),this.reconnectAfterMs)}_initializeOptions(t){var e,i,r,o,s,a,c,f,h;if(this.transport=(e=t?.transport)!==null&&e!==void 0?e:null,this.timeout=(i=t?.timeout)!==null&&i!==void 0?i:Bl,this.heartbeatIntervalMs=(r=t?.heartbeatIntervalMs)!==null&&r!==void 0?r:Sf.HEARTBEAT_INTERVAL,this.worker=(o=t?.worker)!==null&&o!==void 0?o:!1,this.accessToken=(s=t?.accessToken)!==null&&s!==void 0?s:null,this.heartbeatCallback=(a=t?.heartbeatCallback)!==null&&a!==void 0?a:Av,t?.params&&(this.params=t.params),t?.logger&&(this.logger=t.logger),(t?.logLevel||t?.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(c=t?.reconnectAfterMs)!==null&&c!==void 0?c:m=>ZP[m-1]||JP,this.encode=(f=t?.encode)!==null&&f!==void 0?f:(m,y)=>y(JSON.stringify(m)),this.decode=(h=t?.decode)!==null&&h!==void 0?h:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t?.workerUrl}}};ke();var zs=class extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}};function Me(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}var xf=class extends zs{constructor(t,e,i){super(t),this.name="StorageApiError",this.status=e,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},_o=class extends zs{constructor(t,e){super(t),this.name="StorageUnknownError",this.originalError=e}};ke();ke();var Us=n=>{let t;return n?t=n:typeof fetch>"u"?t=(...e)=>import("./chunk-HXKWO5LS.js").then(({default:i})=>i(...e)):t=fetch,(...e)=>t(...e)},mS=()=>z(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield import("./chunk-HXKWO5LS.js")).Response:Response}),Df=n=>{if(Array.isArray(n))return n.map(e=>Df(e));if(typeof n=="function"||n!==Object(n))return n;let t={};return Object.entries(n).forEach(([e,i])=>{let r=e.replace(/([-_][a-z])/gi,o=>o.toUpperCase().replace(/[-_]/g,""));t[r]=Df(i)}),t},gS=n=>{if(typeof n!="object"||n===null)return!1;let t=Object.getPrototypeOf(n);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var Rv=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),XP=(n,t,e)=>z(void 0,void 0,void 0,function*(){let i=yield mS();n instanceof i&&!e?.noResolveJson?n.json().then(r=>{let o=n.status||500,s=r?.statusCode||o+"";t(new xf(Rv(r),o,s))}).catch(r=>{t(new _o(Rv(r),r))}):t(new _o(Rv(n),n))}),ek=(n,t,e,i)=>{let r={method:n,headers:t?.headers||{}};return n==="GET"||!i?r:(gS(i)?(r.headers=Object.assign({"Content-Type":"application/json"},t?.headers),r.body=JSON.stringify(i)):r.body=i,t?.duplex&&(r.duplex=t.duplex),Object.assign(Object.assign({},r),e))};function Kl(n,t,e,i,r,o){return z(this,void 0,void 0,function*(){return new Promise((s,a)=>{n(e,ek(t,i,r,o)).then(c=>{if(!c.ok)throw c;return i?.noResolveJson?c:c.json()}).then(c=>s(c)).catch(c=>XP(c,a,i))})})}function Sr(n,t,e,i){return z(this,void 0,void 0,function*(){return Kl(n,"GET",t,e,i)})}function an(n,t,e,i,r){return z(this,void 0,void 0,function*(){return Kl(n,"POST",t,i,r,e)})}function Yl(n,t,e,i,r){return z(this,void 0,void 0,function*(){return Kl(n,"PUT",t,i,r,e)})}function vS(n,t,e,i){return z(this,void 0,void 0,function*(){return Kl(n,"HEAD",t,Object.assign(Object.assign({},e),{noResolveJson:!0}),i)})}function Bs(n,t,e,i,r){return z(this,void 0,void 0,function*(){return Kl(n,"DELETE",t,i,r,e)})}ke();ke();var If=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e}then(t,e){return this.execute().then(t,e)}execute(){return z(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Me(t))return{data:null,error:t};throw t}})}};var _S,Ov=class{constructor(t,e){this.downloadFn=t,this.shouldThrowOnError=e,this[_S]="BlobDownloadBuilder",this.promise=null}asStream(){return new If(this.downloadFn,this.shouldThrowOnError)}then(t,e){return this.getPromise().then(t,e)}catch(t){return this.getPromise().catch(t)}finally(t){return this.getPromise().finally(t)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return z(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Me(t))return{data:null,error:t};throw t}})}};_S=Symbol.toStringTag;var yS=Ov;var tk={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},bS={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1},Tf=class{constructor(t,e={},i,r){this.shouldThrowOnError=!1,this.url=t,this.headers=e,this.bucketId=i,this.fetch=Us(r)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(t,e,i,r){return z(this,void 0,void 0,function*(){try{let o,s=Object.assign(Object.assign({},bS),r),a=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(s.upsert)}),c=s.metadata;typeof Blob<"u"&&i instanceof Blob?(o=new FormData,o.append("cacheControl",s.cacheControl),c&&o.append("metadata",this.encodeMetadata(c)),o.append("",i)):typeof FormData<"u"&&i instanceof FormData?(o=i,o.append("cacheControl",s.cacheControl),c&&o.append("metadata",this.encodeMetadata(c))):(o=i,a["cache-control"]=`max-age=${s.cacheControl}`,a["content-type"]=s.contentType,c&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),r?.headers&&(a=Object.assign(Object.assign({},a),r.headers));let f=this._removeEmptyFolders(e),h=this._getFinalPath(f),m=yield(t=="PUT"?Yl:an)(this.fetch,`${this.url}/object/${h}`,o,Object.assign({headers:a},s?.duplex?{duplex:s.duplex}:{}));return{data:{path:f,id:m.Id,fullPath:m.Key},error:null}}catch(o){if(this.shouldThrowOnError)throw o;if(Me(o))return{data:null,error:o};throw o}})}upload(t,e,i){return z(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,e,i)})}uploadToSignedUrl(t,e,i,r){return z(this,void 0,void 0,function*(){let o=this._removeEmptyFolders(t),s=this._getFinalPath(o),a=new URL(this.url+`/object/upload/sign/${s}`);a.searchParams.set("token",e);try{let c,f=Object.assign({upsert:bS.upsert},r),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(f.upsert)});typeof Blob<"u"&&i instanceof Blob?(c=new FormData,c.append("cacheControl",f.cacheControl),c.append("",i)):typeof FormData<"u"&&i instanceof FormData?(c=i,c.append("cacheControl",f.cacheControl)):(c=i,h["cache-control"]=`max-age=${f.cacheControl}`,h["content-type"]=f.contentType);let m=yield Yl(this.fetch,a.toString(),c,{headers:h});return{data:{path:o,fullPath:m.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Me(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,e){return z(this,void 0,void 0,function*(){try{let i=this._getFinalPath(t),r=Object.assign({},this.headers);e?.upsert&&(r["x-upsert"]="true");let o=yield an(this.fetch,`${this.url}/object/upload/sign/${i}`,{},{headers:r}),s=new URL(this.url+o.url),a=s.searchParams.get("token");if(!a)throw new zs("No token returned by API");return{data:{signedUrl:s.toString(),path:t,token:a},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Me(i))return{data:null,error:i};throw i}})}update(t,e,i){return z(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,e,i)})}move(t,e,i){return z(this,void 0,void 0,function*(){try{return{data:yield an(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:i?.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Me(r))return{data:null,error:r};throw r}})}copy(t,e,i){return z(this,void 0,void 0,function*(){try{return{data:{path:(yield an(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:e,destinationBucket:i?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Me(r))return{data:null,error:r};throw r}})}createSignedUrl(t,e,i){return z(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t),o=yield an(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:e},i?.transform?{transform:i.transform}:{}),{headers:this.headers}),s=i?.download?`&download=${i.download===!0?"":i.download}`:"";return o={signedUrl:encodeURI(`${this.url}${o.signedURL}${s}`)},{data:o,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Me(r))return{data:null,error:r};throw r}})}createSignedUrls(t,e,i){return z(this,void 0,void 0,function*(){try{let r=yield an(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:t},{headers:this.headers}),o=i?.download?`&download=${i.download===!0?"":i.download}`:"";return{data:r.map(s=>Object.assign(Object.assign({},s),{signedUrl:s.signedURL?encodeURI(`${this.url}${s.signedURL}${o}`):null})),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Me(r))return{data:null,error:r};throw r}})}download(t,e){let r=typeof e?.transform<"u"?"render/image/authenticated":"object",o=this.transformOptsToQueryString(e?.transform||{}),s=o?`?${o}`:"",a=this._getFinalPath(t),c=()=>Sr(this.fetch,`${this.url}/${r}/${a}${s}`,{headers:this.headers,noResolveJson:!0});return new yS(c,this.shouldThrowOnError)}info(t){return z(this,void 0,void 0,function*(){let e=this._getFinalPath(t);try{let i=yield Sr(this.fetch,`${this.url}/object/info/${e}`,{headers:this.headers});return{data:Df(i),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Me(i))return{data:null,error:i};throw i}})}exists(t){return z(this,void 0,void 0,function*(){let e=this._getFinalPath(t);try{return yield vS(this.fetch,`${this.url}/object/${e}`,{headers:this.headers}),{data:!0,error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Me(i)&&i instanceof _o){let r=i.originalError;if([400,404].includes(r?.status))return{data:!1,error:i}}throw i}})}getPublicUrl(t,e){let i=this._getFinalPath(t),r=[],o=e?.download?`download=${e.download===!0?"":e.download}`:"";o!==""&&r.push(o);let a=typeof e?.transform<"u"?"render/image":"object",c=this.transformOptsToQueryString(e?.transform||{});c!==""&&r.push(c);let f=r.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${i}${f}`)}}}remove(t){return z(this,void 0,void 0,function*(){try{return{data:yield Bs(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Me(e))return{data:null,error:e};throw e}})}list(t,e,i){return z(this,void 0,void 0,function*(){try{let r=Object.assign(Object.assign(Object.assign({},tk),e),{prefix:t||""});return{data:yield an(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},i),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Me(r))return{data:null,error:r};throw r}})}listV2(t,e){return z(this,void 0,void 0,function*(){try{let i=Object.assign({},t);return{data:yield an(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,i,{headers:this.headers},e),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Me(i))return{data:null,error:i};throw i}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){let e=[];return t.width&&e.push(`width=${t.width}`),t.height&&e.push(`height=${t.height}`),t.resize&&e.push(`resize=${t.resize}`),t.format&&e.push(`format=${t.format}`),t.quality&&e.push(`quality=${t.quality}`),e.join("&")}};ke();var Mf="2.77.0";var Af={"X-Client-Info":`storage-js/${Mf}`};var Rf=class{constructor(t,e={},i,r){this.shouldThrowOnError=!1;let o=new URL(t);r?.useNewHostname&&/supabase\.(co|in|red)$/.test(o.hostname)&&!o.hostname.includes("storage.supabase.")&&(o.hostname=o.hostname.replace("supabase.","storage.supabase.")),this.url=o.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Af),e),this.fetch=Us(i)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(t){return z(this,void 0,void 0,function*(){try{let e=this.listBucketOptionsToQueryString(t);return{data:yield Sr(this.fetch,`${this.url}/bucket${e}`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Me(e))return{data:null,error:e};throw e}})}getBucket(t){return z(this,void 0,void 0,function*(){try{return{data:yield Sr(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Me(e))return{data:null,error:e};throw e}})}createBucket(t){return z(this,arguments,void 0,function*(e,i={public:!1}){try{return{data:yield an(this.fetch,`${this.url}/bucket`,{id:e,name:e,type:i.type,public:i.public,file_size_limit:i.fileSizeLimit,allowed_mime_types:i.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Me(r))return{data:null,error:r};throw r}})}updateBucket(t,e){return z(this,void 0,void 0,function*(){try{return{data:yield Yl(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Me(i))return{data:null,error:i};throw i}})}emptyBucket(t){return z(this,void 0,void 0,function*(){try{return{data:yield an(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Me(e))return{data:null,error:e};throw e}})}deleteBucket(t){return z(this,void 0,void 0,function*(){try{return{data:yield Bs(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Me(e))return{data:null,error:e};throw e}})}listBucketOptionsToQueryString(t){let e={};return t&&("limit"in t&&(e.limit=String(t.limit)),"offset"in t&&(e.offset=String(t.offset)),t.search&&(e.search=t.search),t.sortColumn&&(e.sortColumn=t.sortColumn),t.sortOrder&&(e.sortOrder=t.sortOrder)),Object.keys(e).length>0?"?"+new URLSearchParams(e).toString():""}};ke();var Of=class{constructor(t,e={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},Af),e),this.fetch=Us(i)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return z(this,void 0,void 0,function*(){try{return{data:yield an(this.fetch,`${this.url}/bucket`,{name:t},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Me(e))return{data:null,error:e};throw e}})}listBuckets(t){return z(this,void 0,void 0,function*(){try{let e=new URLSearchParams;t?.limit!==void 0&&e.set("limit",t.limit.toString()),t?.offset!==void 0&&e.set("offset",t.offset.toString()),t?.sortColumn&&e.set("sortColumn",t.sortColumn),t?.sortOrder&&e.set("sortOrder",t.sortOrder),t?.search&&e.set("search",t.search);let i=e.toString(),r=i?`${this.url}/bucket?${i}`:`${this.url}/bucket`;return{data:yield Sr(this.fetch,r,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Me(e))return{data:null,error:e};throw e}})}deleteBucket(t){return z(this,void 0,void 0,function*(){try{return{data:yield Bs(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Me(e))return{data:null,error:e};throw e}})}};ke();ke();var $s={"X-Client-Info":`storage-js/${Mf}`,"Content-Type":"application/json"};var Nf=class extends Error{constructor(t){super(t),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}};function Ut(n){return typeof n=="object"&&n!==null&&"__isStorageVectorsError"in n}var Hs=class extends Nf{constructor(t,e,i){super(t),this.name="StorageVectorsApiError",this.status=e,this.statusCode=i}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},Pf=class extends Nf{constructor(t,e){super(t),this.name="StorageVectorsUnknownError",this.originalError=e}};ke();var Ws=n=>{let t;return n?t=n:typeof fetch>"u"?t=(...e)=>import("./chunk-HXKWO5LS.js").then(({default:i})=>i(...e)):t=fetch,(...e)=>t(...e)};var wS=n=>{if(typeof n!="object"||n===null)return!1;let t=Object.getPrototypeOf(n);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)};var ES=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),nk=(n,t,e)=>z(void 0,void 0,void 0,function*(){if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!e?.noResolveJson){let r=n.status||500,o=n;if(typeof o.json=="function")o.json().then(s=>{let a=s?.statusCode||s?.code||r+"";t(new Hs(ES(s),r,a))}).catch(()=>{let s=r+"",a=o.statusText||`HTTP ${r} error`;t(new Hs(a,r,s))});else{let s=r+"",a=o.statusText||`HTTP ${r} error`;t(new Hs(a,r,s))}}else t(new Pf(ES(n),n))}),ik=(n,t,e,i)=>{let r={method:n,headers:t?.headers||{}};return n==="GET"||!i?r:(wS(i)?(r.headers=Object.assign({"Content-Type":"application/json"},t?.headers),r.body=JSON.stringify(i)):r.body=i,Object.assign(Object.assign({},r),e))};function rk(n,t,e,i,r,o){return z(this,void 0,void 0,function*(){return new Promise((s,a)=>{n(e,ik(t,i,r,o)).then(c=>{if(!c.ok)throw c;if(i?.noResolveJson)return c;let f=c.headers.get("content-type");return!f||!f.includes("application/json")?{}:c.json()}).then(c=>s(c)).catch(c=>nk(c,a,i))})})}function Bt(n,t,e,i,r){return z(this,void 0,void 0,function*(){return rk(n,"POST",t,i,r,e)})}var kf=class{constructor(t,e={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},$s),e),this.fetch=Ws(i)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(t){return z(this,void 0,void 0,function*(){try{return{data:(yield Bt(this.fetch,`${this.url}/CreateIndex`,t,{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ut(e))return{data:null,error:e};throw e}})}getIndex(t,e){return z(this,void 0,void 0,function*(){try{return{data:yield Bt(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:t,indexName:e},{headers:this.headers}),error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ut(i))return{data:null,error:i};throw i}})}listIndexes(t){return z(this,void 0,void 0,function*(){try{return{data:yield Bt(this.fetch,`${this.url}/ListIndexes`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ut(e))return{data:null,error:e};throw e}})}deleteIndex(t,e){return z(this,void 0,void 0,function*(){try{return{data:(yield Bt(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:t,indexName:e},{headers:this.headers}))||{},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(Ut(i))return{data:null,error:i};throw i}})}};ke();var Ff=class{constructor(t,e={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},$s),e),this.fetch=Ws(i)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(t){return z(this,void 0,void 0,function*(){try{if(t.vectors.length<1||t.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield Bt(this.fetch,`${this.url}/PutVectors`,t,{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ut(e))return{data:null,error:e};throw e}})}getVectors(t){return z(this,void 0,void 0,function*(){try{return{data:yield Bt(this.fetch,`${this.url}/GetVectors`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ut(e))return{data:null,error:e};throw e}})}listVectors(t){return z(this,void 0,void 0,function*(){try{if(t.segmentCount!==void 0){if(t.segmentCount<1||t.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(t.segmentIndex!==void 0&&(t.segmentIndex<0||t.segmentIndex>=t.segmentCount))throw new Error(`segmentIndex must be between 0 and ${t.segmentCount-1}`)}return{data:yield Bt(this.fetch,`${this.url}/ListVectors`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ut(e))return{data:null,error:e};throw e}})}queryVectors(t){return z(this,void 0,void 0,function*(){try{return{data:yield Bt(this.fetch,`${this.url}/QueryVectors`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ut(e))return{data:null,error:e};throw e}})}deleteVectors(t){return z(this,void 0,void 0,function*(){try{if(t.keys.length<1||t.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield Bt(this.fetch,`${this.url}/DeleteVectors`,t,{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ut(e))return{data:null,error:e};throw e}})}};ke();var Lf=class{constructor(t,e={},i){this.shouldThrowOnError=!1,this.url=t.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},$s),e),this.fetch=Ws(i)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(t){return z(this,void 0,void 0,function*(){try{return{data:(yield Bt(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ut(e))return{data:null,error:e};throw e}})}getBucket(t){return z(this,void 0,void 0,function*(){try{return{data:yield Bt(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:t},{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ut(e))return{data:null,error:e};throw e}})}listBuckets(){return z(this,arguments,void 0,function*(t={}){try{return{data:yield Bt(this.fetch,`${this.url}/ListVectorBuckets`,t,{headers:this.headers}),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ut(e))return{data:null,error:e};throw e}})}deleteBucket(t){return z(this,void 0,void 0,function*(){try{return{data:(yield Bt(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:t},{headers:this.headers}))||{},error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Ut(e))return{data:null,error:e};throw e}})}};var Zl=class extends Lf{constructor(t,e={}){super(t,e.headers||{},e.fetch)}from(t){return new jf(this.url,this.headers,t,this.fetch)}},jf=class extends kf{constructor(t,e,i,r){super(t,e,r),this.vectorBucketName=i}createIndex(t){let e=Object.create(null,{createIndex:{get:()=>super.createIndex}});return z(this,void 0,void 0,function*(){return e.createIndex.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){let t=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return z(this,arguments,void 0,function*(e={}){return t.listIndexes.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}getIndex(t){let e=Object.create(null,{getIndex:{get:()=>super.getIndex}});return z(this,void 0,void 0,function*(){return e.getIndex.call(this,this.vectorBucketName,t)})}deleteIndex(t){let e=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return z(this,void 0,void 0,function*(){return e.deleteIndex.call(this,this.vectorBucketName,t)})}index(t){return new Vf(this.url,this.headers,this.vectorBucketName,t,this.fetch)}},Vf=class extends Ff{constructor(t,e,i,r,o){super(t,e,o),this.vectorBucketName=i,this.indexName=r}putVectors(t){let e=Object.create(null,{putVectors:{get:()=>super.putVectors}});return z(this,void 0,void 0,function*(){return e.putVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(t){let e=Object.create(null,{getVectors:{get:()=>super.getVectors}});return z(this,void 0,void 0,function*(){return e.getVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){let t=Object.create(null,{listVectors:{get:()=>super.listVectors}});return z(this,arguments,void 0,function*(e={}){return t.listVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(t){let e=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return z(this,void 0,void 0,function*(){return e.queryVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(t){let e=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return z(this,void 0,void 0,function*(){return e.deleteVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}};var Jl=class extends Rf{constructor(t,e={},i,r){super(t,e,i,r)}from(t){return new Tf(this.url,this.headers,t,this.fetch)}get vectors(){return new Zl(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new Of(this.url+"/iceberg",this.headers,this.fetch)}};var CS="2.77.0";var Ql="";typeof Deno<"u"?Ql="deno":typeof document<"u"?Ql="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ql="react-native":Ql="node";var ok={"X-Client-Info":`supabase-js-${Ql}/${CS}`},SS={headers:ok},xS={schema:"public"},DS={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},IS={};Zv();var sk=n=>{let t;return n?t=n:typeof fetch>"u"?t=Kv:t=fetch,(...e)=>t(...e)},ak=()=>typeof Headers>"u"?Yv:Headers,TS=(n,t,e)=>{let i=sk(e),r=ak();return(o,s)=>b(null,null,function*(){var a;let c=(a=yield t())!==null&&a!==void 0?a:n,f=new r(s?.headers);return f.has("apikey")||f.set("apikey",n),f.has("Authorization")||f.set("Authorization",`Bearer ${c}`),i(o,Object.assign(Object.assign({},s),{headers:f}))})};function lk(n){return n.endsWith("/")?n:n+"/"}function MS(n,t){var e,i;let{db:r,auth:o,realtime:s,global:a}=n,{db:c,auth:f,realtime:h,global:m}=t,y={db:Object.assign(Object.assign({},c),r),auth:Object.assign(Object.assign({},f),o),realtime:Object.assign(Object.assign({},h),s),storage:{},global:Object.assign(Object.assign(Object.assign({},m),a),{headers:Object.assign(Object.assign({},(e=m?.headers)!==null&&e!==void 0?e:{}),(i=a?.headers)!==null&&i!==void 0?i:{})}),accessToken:()=>b(null,null,function*(){return""})};return n.accessToken?y.accessToken=n.accessToken:delete y.accessToken,y}function AS(n){let t=n?.trim();if(!t)throw new Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(lk(t))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}ke();ke();var zf="2.77.0";var yo=30*1e3,Uf=3,Bf=Uf*yo,RS="http://localhost:9999",OS="supabase.auth.token";var NS={"X-Client-Info":`gotrue-js/${zf}`};var Xl="X-Supabase-Api-Version",Nv={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},PS=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,kS=600*1e3;var xr=class extends Error{constructor(t,e,i){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=e,this.code=i}};function ee(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}var $f=class extends xr{constructor(t,e,i){super(t,e,i),this.name="AuthApiError",this.status=e,this.code=i}};function FS(n){return ee(n)&&n.name==="AuthApiError"}var Pn=class extends xr{constructor(t,e){super(t),this.name="AuthUnknownError",this.originalError=e}},Ei=class extends xr{constructor(t,e,i,r){super(t,i,r),this.name=e,this.status=i}},kn=class extends Ei{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}};function LS(n){return ee(n)&&n.name==="AuthSessionMissingError"}var Ki=class extends Ei{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}},bo=class extends Ei{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}},wo=class extends Ei{constructor(t,e=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}};function jS(n){return ee(n)&&n.name==="AuthImplicitGrantRedirectError"}var ec=class extends Ei{constructor(t,e=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}},Gs=class extends Ei{constructor(t,e){super(t,"AuthRetryableFetchError",e,void 0)}};function Hf(n){return ee(n)&&n.name==="AuthRetryableFetchError"}var tc=class extends Ei{constructor(t,e,i){super(t,"AuthWeakPasswordError",e,"weak_password"),this.reasons=i}};var Eo=class extends Ei{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}};var Wf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),VS=` 	
\r=`.split(""),ck=(()=>{let n=new Array(128);for(let t=0;t<n.length;t+=1)n[t]=-1;for(let t=0;t<VS.length;t+=1)n[VS[t].charCodeAt(0)]=-2;for(let t=0;t<Wf.length;t+=1)n[Wf[t].charCodeAt(0)]=t;return n})();function zS(n,t,e){if(n!==null)for(t.queue=t.queue<<8|n,t.queuedBits+=8;t.queuedBits>=6;){let i=t.queue>>t.queuedBits-6&63;e(Wf[i]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){let i=t.queue>>t.queuedBits-6&63;e(Wf[i]),t.queuedBits-=6}}function US(n,t,e){let i=ck[n];if(i>-1)for(t.queue=t.queue<<6|i,t.queuedBits+=6;t.queuedBits>=8;)e(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(i===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function Pv(n){let t=[],e=s=>{t.push(String.fromCodePoint(s))},i={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},o=s=>{fk(s,i,e)};for(let s=0;s<n.length;s+=1)US(n.charCodeAt(s),r,o);return t.join("")}function uk(n,t){if(n<=127){t(n);return}else if(n<=2047){t(192|n>>6),t(128|n&63);return}else if(n<=65535){t(224|n>>12),t(128|n>>6&63),t(128|n&63);return}else if(n<=1114111){t(240|n>>18),t(128|n>>12&63),t(128|n>>6&63),t(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function dk(n,t){for(let e=0;e<n.length;e+=1){let i=n.charCodeAt(e);if(i>55295&&i<=56319){let r=(i-55296)*1024&65535;i=(n.charCodeAt(e+1)-56320&65535|r)+65536,e+=1}uk(i,t)}}function fk(n,t,e){if(t.utf8seq===0){if(n<=127){e(n);return}for(let i=1;i<6;i+=1)if((n>>7-i&1)===0){t.utf8seq=i;break}if(t.utf8seq===2)t.codepoint=n&31;else if(t.utf8seq===3)t.codepoint=n&15;else if(t.utf8seq===4)t.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|n&63,t.utf8seq-=1,t.utf8seq===0&&e(t.codepoint)}}function Dr(n){let t=[],e={queue:0,queuedBits:0},i=r=>{t.push(r)};for(let r=0;r<n.length;r+=1)US(n.charCodeAt(r),e,i);return new Uint8Array(t)}function BS(n){let t=[];return dk(n,e=>t.push(e)),new Uint8Array(t)}function Yi(n){let t=[],e={queue:0,queuedBits:0},i=r=>{t.push(r)};return n.forEach(r=>zS(r,e,i)),zS(null,e,i),t.join("")}function $S(n){return Math.round(Date.now()/1e3)+n}function HS(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){let t=Math.random()*16|0;return(n=="x"?t:t&3|8).toString(16)})}var en=()=>typeof window<"u"&&typeof document<"u",Co={tested:!1,writable:!1},Gf=()=>{if(!en())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Co.tested)return Co.writable;let n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Co.tested=!0,Co.writable=!0}catch{Co.tested=!0,Co.writable=!1}return Co.writable};function WS(n){let t={},e=new URL(n);if(e.hash&&e.hash[0]==="#")try{new URLSearchParams(e.hash.substring(1)).forEach((r,o)=>{t[o]=r})}catch{}return e.searchParams.forEach((i,r)=>{t[r]=i}),t}var qf=n=>{let t;return n?t=n:typeof fetch>"u"?t=(...e)=>import("./chunk-HXKWO5LS.js").then(({default:i})=>i(...e)):t=fetch,(...e)=>t(...e)},GS=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",So=(n,t,e)=>b(null,null,function*(){yield n.setItem(t,JSON.stringify(e))}),Ir=(n,t)=>b(null,null,function*(){let e=yield n.getItem(t);if(!e)return null;try{return JSON.parse(e)}catch{return e}}),Zi=(n,t)=>b(null,null,function*(){yield n.removeItem(t)}),nc=class n{constructor(){this.promise=new n.promiseConstructor((t,e)=>{this.resolve=t,this.reject=e})}};nc.promiseConstructor=Promise;function Kf(n){let t=n.split(".");if(t.length!==3)throw new Eo("Invalid JWT structure");for(let i=0;i<t.length;i++)if(!PS.test(t[i]))throw new Eo("JWT not in base64url format");return{header:JSON.parse(Pv(t[0])),payload:JSON.parse(Pv(t[1])),signature:Dr(t[2]),raw:{header:t[0],payload:t[1]}}}function qS(n){return b(this,null,function*(){return yield new Promise(t=>{setTimeout(()=>t(null),n)})})}function KS(n,t){return new Promise((i,r)=>{b(null,null,function*(){for(let o=0;o<1/0;o++)try{let s=yield n(o);if(!t(o,null,s)){i(s);return}}catch(s){if(!t(o,s)){r(s);return}}})})}function pk(n){return("0"+n.toString(16)).substr(-2)}function hk(){let t=new Uint32Array(56);if(typeof crypto>"u"){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",i=e.length,r="";for(let o=0;o<56;o++)r+=e.charAt(Math.floor(Math.random()*i));return r}return crypto.getRandomValues(t),Array.from(t,pk).join("")}function mk(n){return b(this,null,function*(){let e=new TextEncoder().encode(n),i=yield crypto.subtle.digest("SHA-256",e),r=new Uint8Array(i);return Array.from(r).map(o=>String.fromCharCode(o)).join("")})}function gk(n){return b(this,null,function*(){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;let e=yield mk(n);return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")})}function xo(n,t,e=!1){return b(this,null,function*(){let i=hk(),r=i;e&&(r+="/PASSWORD_RECOVERY"),yield So(n,`${t}-code-verifier`,r);let o=yield gk(i);return[o,i===o?"plain":"s256"]})}var vk=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function YS(n){let t=n.headers.get(Xl);if(!t||!t.match(vk))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function ZS(n){if(!n)throw new Error("Missing exp claim");let t=Math.floor(Date.now()/1e3);if(n<=t)throw new Error("JWT has expired")}function JS(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var _k=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Do(n){if(!_k.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Yf(){let n={};return new Proxy(n,{get:(t,e)=>{if(e==="__isUserNotAvailableProxy")return!0;if(typeof e=="symbol"){let i=e.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${e}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,e)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,e)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${e}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function kv(n){return JSON.parse(JSON.stringify(n))}var Io=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),yk=[502,503,504];function QS(n){return b(this,null,function*(){var t;if(!GS(n))throw new Gs(Io(n),0);if(yk.includes(n.status))throw new Gs(Io(n),n.status);let e;try{e=yield n.json()}catch(o){throw new Pn(Io(o),o)}let i,r=YS(n);if(r&&r.getTime()>=Nv["2024-01-01"].timestamp&&typeof e=="object"&&e&&typeof e.code=="string"?i=e.code:typeof e=="object"&&e&&typeof e.error_code=="string"&&(i=e.error_code),i){if(i==="weak_password")throw new tc(Io(e),n.status,((t=e.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(i==="session_not_found")throw new kn}else if(typeof e=="object"&&e&&typeof e.weak_password=="object"&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((o,s)=>o&&typeof s=="string",!0))throw new tc(Io(e),n.status,e.weak_password.reasons);throw new $f(Io(e),n.status||500,i)})}var bk=(n,t,e,i)=>{let r={method:n,headers:t?.headers||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t?.headers),r.body=JSON.stringify(i),Object.assign(Object.assign({},r),e))};function re(n,t,e,i){return b(this,null,function*(){var r;let o=Object.assign({},i?.headers);o[Xl]||(o[Xl]=Nv["2024-01-01"].name),i?.jwt&&(o.Authorization=`Bearer ${i.jwt}`);let s=(r=i?.query)!==null&&r!==void 0?r:{};i?.redirectTo&&(s.redirect_to=i.redirectTo);let a=Object.keys(s).length?"?"+new URLSearchParams(s).toString():"",c=yield wk(n,t,e+a,{headers:o,noResolveJson:i?.noResolveJson},{},i?.body);return i?.xform?i?.xform(c):{data:Object.assign({},c),error:null}})}function wk(n,t,e,i,r,o){return b(this,null,function*(){let s=bk(t,i,r,o),a;try{a=yield n(e,Object.assign({},s))}catch(c){throw console.error(c),new Gs(Io(c),0)}if(a.ok||(yield QS(a)),i?.noResolveJson)return a;try{return yield a.json()}catch(c){yield QS(c)}})}function Fn(n){var t;let e=null;Ek(n)&&(e=Object.assign({},n),n.expires_at||(e.expires_at=$S(n.expires_in)));let i=(t=n.user)!==null&&t!==void 0?t:n;return{data:{session:e,user:i},error:null}}function Fv(n){let t=Fn(n);return!t.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((e,i)=>e&&typeof i=="string",!0)&&(t.data.weak_password=n.weak_password),t}function Ci(n){var t;return{data:{user:(t=n.user)!==null&&t!==void 0?t:n},error:null}}function XS(n){return{data:n,error:null}}function ex(n){let{action_link:t,email_otp:e,hashed_token:i,redirect_to:r,verification_type:o}=n,s=xi(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),a={action_link:t,email_otp:e,hashed_token:i,redirect_to:r,verification_type:o},c=Object.assign({},s);return{data:{properties:a,user:c},error:null}}function Lv(n){return n}function Ek(n){return n.access_token&&n.refresh_token&&n.expires_in}var Zf=["global","local","others"];var qs=class{constructor({url:t="",headers:e={},fetch:i}){this.url=t,this.headers=e,this.fetch=qf(i),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}signOut(i){return b(this,arguments,function*(t,e=Zf[0]){if(Zf.indexOf(e)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Zf.join(", ")}`);try{return yield re(this.fetch,"POST",`${this.url}/logout?scope=${e}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ee(r))return{data:null,error:r};throw r}})}inviteUserByEmail(i){return b(this,arguments,function*(t,e={}){try{return yield re(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:e.data},headers:this.headers,redirectTo:e.redirectTo,xform:Ci})}catch(r){if(ee(r))return{data:{user:null},error:r};throw r}})}generateLink(t){return b(this,null,function*(){try{let{options:e}=t,i=xi(t,["options"]),r=Object.assign(Object.assign({},i),e);return"newEmail"in i&&(r.new_email=i?.newEmail,delete r.newEmail),yield re(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:ex,redirectTo:e?.redirectTo})}catch(e){if(ee(e))return{data:{properties:null,user:null},error:e};throw e}})}createUser(t){return b(this,null,function*(){try{return yield re(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Ci})}catch(e){if(ee(e))return{data:{user:null},error:e};throw e}})}listUsers(t){return b(this,null,function*(){var e,i,r,o,s,a,c;try{let f={nextPage:null,lastPage:0,total:0},h=yield re(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(e=t?.page)===null||e===void 0?void 0:e.toString())!==null&&i!==void 0?i:"",per_page:(o=(r=t?.perPage)===null||r===void 0?void 0:r.toString())!==null&&o!==void 0?o:""},xform:Lv});if(h.error)throw h.error;let m=yield h.json(),y=(s=h.headers.get("x-total-count"))!==null&&s!==void 0?s:0,g=(c=(a=h.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&c!==void 0?c:[];return g.length>0&&(g.forEach(w=>{let T=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(w.split(";")[1].split("=")[1]);f[`${x}Page`]=T}),f.total=parseInt(y)),{data:Object.assign(Object.assign({},m),f),error:null}}catch(f){if(ee(f))return{data:{users:[]},error:f};throw f}})}getUserById(t){return b(this,null,function*(){Do(t);try{return yield re(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Ci})}catch(e){if(ee(e))return{data:{user:null},error:e};throw e}})}updateUserById(t,e){return b(this,null,function*(){Do(t);try{return yield re(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:e,headers:this.headers,xform:Ci})}catch(i){if(ee(i))return{data:{user:null},error:i};throw i}})}deleteUser(t,e=!1){return b(this,null,function*(){Do(t);try{return yield re(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:e},xform:Ci})}catch(i){if(ee(i))return{data:{user:null},error:i};throw i}})}_listFactors(t){return b(this,null,function*(){Do(t.userId);try{let{data:e,error:i}=yield re(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:e,error:i}}catch(e){if(ee(e))return{data:null,error:e};throw e}})}_deleteFactor(t){return b(this,null,function*(){Do(t.userId),Do(t.id);try{return{data:yield re(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(e){if(ee(e))return{data:null,error:e};throw e}})}_listOAuthClients(t){return b(this,null,function*(){var e,i,r,o,s,a,c;try{let f={nextPage:null,lastPage:0,total:0},h=yield re(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(i=(e=t?.page)===null||e===void 0?void 0:e.toString())!==null&&i!==void 0?i:"",per_page:(o=(r=t?.perPage)===null||r===void 0?void 0:r.toString())!==null&&o!==void 0?o:""},xform:Lv});if(h.error)throw h.error;let m=yield h.json(),y=(s=h.headers.get("x-total-count"))!==null&&s!==void 0?s:0,g=(c=(a=h.headers.get("link"))===null||a===void 0?void 0:a.split(","))!==null&&c!==void 0?c:[];return g.length>0&&(g.forEach(w=>{let T=parseInt(w.split(";")[0].split("=")[1].substring(0,1)),x=JSON.parse(w.split(";")[1].split("=")[1]);f[`${x}Page`]=T}),f.total=parseInt(y)),{data:Object.assign(Object.assign({},m),f),error:null}}catch(f){if(ee(f))return{data:{clients:[]},error:f};throw f}})}_createOAuthClient(t){return b(this,null,function*(){try{return yield re(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:t,headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(ee(e))return{data:null,error:e};throw e}})}_getOAuthClient(t){return b(this,null,function*(){try{return yield re(this.fetch,"GET",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(ee(e))return{data:null,error:e};throw e}})}_deleteOAuthClient(t){return b(this,null,function*(){try{return yield re(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${t}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(e){if(ee(e))return{data:null,error:e};throw e}})}_regenerateOAuthClientSecret(t){return b(this,null,function*(){try{return yield re(this.fetch,"POST",`${this.url}/admin/oauth/clients/${t}/regenerate_secret`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(ee(e))return{data:null,error:e};throw e}})}};function jv(n={}){return{getItem:t=>n[t]||null,setItem:(t,e)=>{n[t]=e},removeItem:t=>{delete n[t]}}}var To={debug:!!(globalThis&&Gf()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")},ic=class extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}},Jf=class extends ic{};function Vv(n,t,e){return b(this,null,function*(){To.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,t);let i=new globalThis.AbortController;return t>0&&setTimeout(()=>{i.abort(),To.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},t),yield Promise.resolve().then(()=>globalThis.navigator.locks.request(n,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},r=>b(null,null,function*(){if(r){To.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,r.name);try{return yield e()}finally{To.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,r.name)}}else{if(t===0)throw To.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new Jf(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(To.debug)try{let o=yield globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),yield e()}})))})}function tx(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function zv(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function nx(n){return parseInt(n,16)}function ix(n){let t=new TextEncoder().encode(n);return"0x"+Array.from(t,i=>i.toString(16).padStart(2,"0")).join("")}function rx(n){var t;let{chainId:e,domain:i,expirationTime:r,issuedAt:o=new Date,nonce:s,notBefore:a,requestId:c,resources:f,scheme:h,uri:m,version:y}=n;{if(!Number.isInteger(e))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${e}`);if(!i)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(s&&s.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${s}`);if(!m)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(y!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${y}`);if(!((t=n.statement)===null||t===void 0)&&t.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}let g=zv(n.address),w=h?`${h}://${i}`:i,T=n.statement?`${n.statement}
`:"",x=`${w} wants you to sign in with your Ethereum account:
${g}

${T}`,M=`URI: ${m}
Version: ${y}
Chain ID: ${e}${s?`
Nonce: ${s}`:""}
Issued At: ${o.toISOString()}`;if(r&&(M+=`
Expiration Time: ${r.toISOString()}`),a&&(M+=`
Not Before: ${a.toISOString()}`),c&&(M+=`
Request ID: ${c}`),f){let X=`
Resources:`;for(let $ of f){if(!$||typeof $!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${$}`);X+=`
- ${$}`}M+=X}return`${x}
${M}`}ke();var $e=class extends Error{constructor({message:t,code:e,cause:i,name:r}){var o;super(t,{cause:i}),this.__isWebAuthnError=!0,this.name=(o=r??(i instanceof Error?i.name:void 0))!==null&&o!==void 0?o:"Unknown Error",this.code=e}},Mo=class extends $e{constructor(t,e){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e,message:t}),this.name="WebAuthnUnknownError",this.originalError=e}};function ox({error:n,options:t}){var e,i,r;let{publicKey:o}=t;if(!o)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(t.signal instanceof AbortSignal)return new $e({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((e=o.authenticatorSelection)===null||e===void 0?void 0:e.requireResidentKey)===!0)return new $e({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(t.mediation==="conditional"&&((i=o.authenticatorSelection)===null||i===void 0?void 0:i.userVerification)==="required")return new $e({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((r=o.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new $e({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new $e({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new $e({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return o.pubKeyCredParams.filter(a=>a.type==="public-key").length===0?new $e({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new $e({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){let s=window.location.hostname;if(Uv(s)){if(o.rp.id!==s)return new $e({message:`The RP ID "${o.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new $e({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(o.user.id.byteLength<1||o.user.id.byteLength>64)return new $e({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new $e({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new $e({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function sx({error:n,options:t}){let{publicKey:e}=t;if(!e)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(t.signal instanceof AbortSignal)return new $e({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new $e({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){let i=window.location.hostname;if(Uv(i)){if(e.rpId!==i)return new $e({message:`The RP ID "${e.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new $e({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new $e({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new $e({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}var Bv=class{createNewAbortSignal(){if(this.controller){let e=new Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}let t=new AbortController;return this.controller=t,t.signal}cancelCeremony(){if(this.controller){let t=new Error("Manually cancelling existing WebAuthn API call");t.name="AbortError",this.controller.abort(t),this.controller=void 0}}},Ck=new Bv;function lx(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);let{challenge:t,user:e,excludeCredentials:i}=n,r=xi(n,["challenge","user","excludeCredentials"]),o=Dr(t).buffer,s=Object.assign(Object.assign({},e),{id:Dr(e.id).buffer}),a=Object.assign(Object.assign({},r),{challenge:o,user:s});if(i&&i.length>0){a.excludeCredentials=new Array(i.length);for(let c=0;c<i.length;c++){let f=i[c];a.excludeCredentials[c]=Object.assign(Object.assign({},f),{id:Dr(f.id).buffer,type:f.type||"public-key",transports:f.transports})}}return a}function cx(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);let{challenge:t,allowCredentials:e}=n,i=xi(n,["challenge","allowCredentials"]),r=Dr(t).buffer,o=Object.assign(Object.assign({},i),{challenge:r});if(e&&e.length>0){o.allowCredentials=new Array(e.length);for(let s=0;s<e.length;s++){let a=e[s];o.allowCredentials[s]=Object.assign(Object.assign({},a),{id:Dr(a.id).buffer,type:a.type||"public-key",transports:a.transports})}}return o}function ux(n){var t;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();let e=n;return{id:n.id,rawId:n.id,response:{attestationObject:Yi(new Uint8Array(n.response.attestationObject)),clientDataJSON:Yi(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(t=e.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function dx(n){var t;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();let e=n,i=n.getClientExtensionResults(),r=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:Yi(new Uint8Array(r.authenticatorData)),clientDataJSON:Yi(new Uint8Array(r.clientDataJSON)),signature:Yi(new Uint8Array(r.signature)),userHandle:r.userHandle?Yi(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:i,authenticatorAttachment:(t=e.authenticatorAttachment)!==null&&t!==void 0?t:void 0}}function Uv(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function ax(){var n,t;return!!(en()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator?.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((t=navigator?.credentials)===null||t===void 0?void 0:t.get)=="function")}function Sk(n){return b(this,null,function*(){try{let t=yield navigator.credentials.create(n);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Mo("Browser returned unexpected credential type",t)}:{data:null,error:new Mo("Empty credential response",t)}}catch(t){return{data:null,error:ox({error:t,options:n})}}})}function xk(n){return b(this,null,function*(){try{let t=yield navigator.credentials.get(n);return t?t instanceof PublicKeyCredential?{data:t,error:null}:{data:null,error:new Mo("Browser returned unexpected credential type",t)}:{data:null,error:new Mo("Empty credential response",t)}}catch(t){return{data:null,error:sx({error:t,options:n})}}})}var Dk={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"none"},Ik={userVerification:"preferred",hints:["security-key"]};function Qf(...n){let t=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),e=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),i={};for(let r of n)if(r)for(let o in r){let s=r[o];if(s!==void 0)if(Array.isArray(s))i[o]=s;else if(e(s))i[o]=s;else if(t(s)){let a=i[o];t(a)?i[o]=Qf(a,s):i[o]=Qf(s)}else i[o]=s}return i}function Tk(n,t){return Qf(Dk,n,t||{})}function Mk(n,t){return Qf(Ik,n,t||{})}var Xf=class{constructor(t){this.client=t,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}_enroll(t){return b(this,null,function*(){return this.client.mfa.enroll(Object.assign(Object.assign({},t),{factorType:"webauthn"}))})}_challenge(s,a){return b(this,arguments,function*({factorId:t,webauthn:e,friendlyName:i,signal:r},o){try{let{data:c,error:f}=yield this.client.mfa.challenge({factorId:t,webauthn:e});if(!c)return{data:null,error:f};let h=r??Ck.createNewAbortSignal();if(c.webauthn.type==="create"){let{user:m}=c.webauthn.credential_options.publicKey;m.name||(m.name=`${m.id}:${i}`),m.displayName||(m.displayName=m.name)}switch(c.webauthn.type){case"create":{let m=Tk(c.webauthn.credential_options.publicKey,o?.create),{data:y,error:g}=yield Sk({publicKey:m,signal:h});return y?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:y}},error:null}:{data:null,error:g}}case"request":{let m=Mk(c.webauthn.credential_options.publicKey,o?.request),{data:y,error:g}=yield xk(Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:m,signal:h}));return y?{data:{factorId:t,challengeId:c.id,webauthn:{type:c.webauthn.type,credential_response:y}},error:null}:{data:null,error:g}}}}catch(c){return ee(c)?{data:null,error:c}:{data:null,error:new Pn("Unexpected error in challenge",c)}}})}_verify(r){return b(this,arguments,function*({challengeId:t,factorId:e,webauthn:i}){return this.client.mfa.verify({factorId:e,challengeId:t,webauthn:i})})}_authenticate(s,a){return b(this,arguments,function*({factorId:t,webauthn:{rpId:e=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:r}},o){if(!e)return{data:null,error:new xr("rpId is required for WebAuthn authentication")};try{if(!ax())return{data:null,error:new Pn("Browser does not support WebAuthn",null)};let{data:c,error:f}=yield this.challenge({factorId:t,webauthn:{rpId:e,rpOrigins:i},signal:r},{request:o});if(!c)return{data:null,error:f};let{webauthn:h}=c;return this._verify({factorId:t,challengeId:c.challengeId,webauthn:{type:h.type,rpId:e,rpOrigins:i,credential_response:h.credential_response}})}catch(c){return ee(c)?{data:null,error:c}:{data:null,error:new Pn("Unexpected error in authenticate",c)}}})}_register(s,a){return b(this,arguments,function*({friendlyName:t,rpId:e=typeof window<"u"?window.location.hostname:void 0,rpOrigins:i=typeof window<"u"?[window.location.origin]:void 0,signal:r},o){if(!e)return{data:null,error:new xr("rpId is required for WebAuthn registration")};try{if(!ax())return{data:null,error:new Pn("Browser does not support WebAuthn",null)};let{data:c,error:f}=yield this._enroll({friendlyName:t});if(!c)return yield this.client.mfa.listFactors().then(y=>{var g;return(g=y.data)===null||g===void 0?void 0:g.all.find(w=>w.factor_type==="webauthn"&&w.friendly_name===t&&w.status!=="unverified")}).then(y=>y?this.client.mfa.unenroll({factorId:y?.id}):void 0),{data:null,error:f};let{data:h,error:m}=yield this._challenge({factorId:c.id,friendlyName:c.friendly_name,webauthn:{rpId:e,rpOrigins:i},signal:r},{create:o});return h?this._verify({factorId:c.id,challengeId:h.challengeId,webauthn:{rpId:e,rpOrigins:i,type:h.webauthn.type,credential_response:h.webauthn.credential_response}}):{data:null,error:m}}catch(c){return ee(c)?{data:null,error:c}:{data:null,error:new Pn("Unexpected error in register",c)}}})}};tx();var Ak={url:RS,storageKey:OS,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:NS,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};function fx(n,t,e){return b(this,null,function*(){return yield e()})}var Ks={},Rk=(()=>{class n{get jwks(){var e,i;return(i=(e=Ks[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&i!==void 0?i:{keys:[]}}set jwks(e){Ks[this.storageKey]=Object.assign(Object.assign({},Ks[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,i;return(i=(e=Ks[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&i!==void 0?i:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Ks[this.storageKey]=Object.assign(Object.assign({},Ks[this.storageKey]),{cachedAt:e})}constructor(e){var i,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=n.nextInstanceID,n.nextInstanceID+=1,this.instanceID>0&&en()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");let o=Object.assign(Object.assign({},Ak),e);if(this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new qs({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=qf(o.fetch),this.lock=o.lock||fx,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:en()&&(!((i=globalThis?.navigator)===null||i===void 0)&&i.locks)?this.lock=Vv:this.lock=fx,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new Xf(this)},this.persistSession?(o.storage?this.storage=o.storage:Gf()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=jv(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=jv(this.memoryStorage)),en()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",s=>b(this,null,function*(){this._debug("received broadcast notification from other tab or client",s),yield this._notifyAllSubscribers(s.data.event,s.data.session,!1)}))}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${zf}) ${new Date().toISOString()}`,...e),this}initialize(){return b(this,null,function*(){return this.initializePromise?yield this.initializePromise:(this.initializePromise=b(this,null,function*(){return yield this._acquireLock(-1,()=>b(this,null,function*(){return yield this._initialize()}))}),yield this.initializePromise)})}_initialize(){return b(this,null,function*(){var e;try{let i=WS(window.location.href),r="none";if(this._isImplicitGrantCallback(i)?r="implicit":(yield this._isPKCECallback(i))&&(r="pkce"),en()&&this.detectSessionInUrl&&r!=="none"){let{data:o,error:s}=yield this._getSessionFromURL(i,r);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),jS(s)){let f=(e=s.details)===null||e===void 0?void 0:e.code;if(f==="identity_already_exists"||f==="identity_not_found"||f==="single_identity_not_deletable")return{error:s}}return yield this._removeSession(),{error:s}}let{session:a,redirectType:c}=o;return this._debug("#_initialize()","detected session in URL",a,"redirect type",c),yield this._saveSession(a),setTimeout(()=>b(this,null,function*(){c==="recovery"?yield this._notifyAllSubscribers("PASSWORD_RECOVERY",a):yield this._notifyAllSubscribers("SIGNED_IN",a)}),0),{error:null}}return yield this._recoverAndRefresh(),{error:null}}catch(i){return ee(i)?{error:i}:{error:new Pn("Unexpected error during initialization",i)}}finally{yield this._handleVisibilityChange(),this._debug("#_initialize()","end")}})}signInAnonymously(e){return b(this,null,function*(){var i,r,o;try{let s=yield re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(i=e?.options)===null||i===void 0?void 0:i.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(o=e?.options)===null||o===void 0?void 0:o.captchaToken}},xform:Fn}),{data:a,error:c}=s;if(c||!a)return{data:{user:null,session:null},error:c};let f=a.session,h=a.user;return a.session&&(yield this._saveSession(a.session),yield this._notifyAllSubscribers("SIGNED_IN",f)),{data:{user:h,session:f},error:null}}catch(s){if(ee(s))return{data:{user:null,session:null},error:s};throw s}})}signUp(e){return b(this,null,function*(){var i,r,o;try{let s;if("email"in e){let{email:m,password:y,options:g}=e,w=null,T=null;this.flowType==="pkce"&&([w,T]=yield xo(this.storage,this.storageKey)),s=yield re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:g?.emailRedirectTo,body:{email:m,password:y,data:(i=g?.data)!==null&&i!==void 0?i:{},gotrue_meta_security:{captcha_token:g?.captchaToken},code_challenge:w,code_challenge_method:T},xform:Fn})}else if("phone"in e){let{phone:m,password:y,options:g}=e;s=yield re(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:m,password:y,data:(r=g?.data)!==null&&r!==void 0?r:{},channel:(o=g?.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:g?.captchaToken}},xform:Fn})}else throw new bo("You must provide either an email or phone number and a password");let{data:a,error:c}=s;if(c||!a)return{data:{user:null,session:null},error:c};let f=a.session,h=a.user;return a.session&&(yield this._saveSession(a.session),yield this._notifyAllSubscribers("SIGNED_IN",f)),{data:{user:h,session:f},error:null}}catch(s){if(ee(s))return{data:{user:null,session:null},error:s};throw s}})}signInWithPassword(e){return b(this,null,function*(){try{let i;if("email"in e){let{email:s,password:a,options:c}=e;i=yield re(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:a,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Fv})}else if("phone"in e){let{phone:s,password:a,options:c}=e;i=yield re(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:a,gotrue_meta_security:{captcha_token:c?.captchaToken}},xform:Fv})}else throw new bo("You must provide either an email or phone number and a password");let{data:r,error:o}=i;return o?{data:{user:null,session:null},error:o}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Ki}:(r.session&&(yield this._saveSession(r.session),yield this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:o})}catch(i){if(ee(i))return{data:{user:null,session:null},error:i};throw i}})}signInWithOAuth(e){return b(this,null,function*(){var i,r,o,s;return yield this._handleProviderSignIn(e.provider,{redirectTo:(i=e.options)===null||i===void 0?void 0:i.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(o=e.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(s=e.options)===null||s===void 0?void 0:s.skipBrowserRedirect})})}exchangeCodeForSession(e){return b(this,null,function*(){return yield this.initializePromise,this._acquireLock(-1,()=>b(this,null,function*(){return this._exchangeCodeForSession(e)}))})}signInWithWeb3(e){return b(this,null,function*(){let{chain:i}=e;switch(i){case"ethereum":return yield this.signInWithEthereum(e);case"solana":return yield this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${i}"`)}})}signInWithEthereum(e){return b(this,null,function*(){var i,r,o,s,a,c,f,h,m,y,g;let w,T;if("message"in e)w=e.message,T=e.signature;else{let{chain:x,wallet:M,statement:X,options:$}=e,V;if(en())if(typeof M=="object")V=M;else{let Si=window;if("ethereum"in Si&&typeof Si.ethereum=="object"&&"request"in Si.ethereum&&typeof Si.ethereum.request=="function")V=Si.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof M!="object"||!$?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");V=M}let fe=new URL((i=$?.url)!==null&&i!==void 0?i:window.location.href),dt=yield V.request({method:"eth_requestAccounts"}).then(Si=>Si).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!dt||dt.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");let Ie=zv(dt[0]),it=(r=$?.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!it){let Si=yield V.request({method:"eth_chainId"});it=nx(Si)}let Ji={domain:fe.host,address:Ie,statement:X,uri:fe.href,version:"1",chainId:it,nonce:(o=$?.signInWithEthereum)===null||o===void 0?void 0:o.nonce,issuedAt:(a=(s=$?.signInWithEthereum)===null||s===void 0?void 0:s.issuedAt)!==null&&a!==void 0?a:new Date,expirationTime:(c=$?.signInWithEthereum)===null||c===void 0?void 0:c.expirationTime,notBefore:(f=$?.signInWithEthereum)===null||f===void 0?void 0:f.notBefore,requestId:(h=$?.signInWithEthereum)===null||h===void 0?void 0:h.requestId,resources:(m=$?.signInWithEthereum)===null||m===void 0?void 0:m.resources};w=rx(Ji),T=yield V.request({method:"personal_sign",params:[ix(w),Ie]})}try{let{data:x,error:M}=yield re(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:w,signature:T},!((y=e.options)===null||y===void 0)&&y.captchaToken?{gotrue_meta_security:{captcha_token:(g=e.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:Fn});if(M)throw M;return!x||!x.session||!x.user?{data:{user:null,session:null},error:new Ki}:(x.session&&(yield this._saveSession(x.session),yield this._notifyAllSubscribers("SIGNED_IN",x.session)),{data:Object.assign({},x),error:M})}catch(x){if(ee(x))return{data:{user:null,session:null},error:x};throw x}})}signInWithSolana(e){return b(this,null,function*(){var i,r,o,s,a,c,f,h,m,y,g,w;let T,x;if("message"in e)T=e.message,x=e.signature;else{let{chain:M,wallet:X,statement:$,options:V}=e,fe;if(en())if(typeof X=="object")fe=X;else{let Ie=window;if("solana"in Ie&&typeof Ie.solana=="object"&&("signIn"in Ie.solana&&typeof Ie.solana.signIn=="function"||"signMessage"in Ie.solana&&typeof Ie.solana.signMessage=="function"))fe=Ie.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof X!="object"||!V?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");fe=X}let dt=new URL((i=V?.url)!==null&&i!==void 0?i:window.location.href);if("signIn"in fe&&fe.signIn){let Ie=yield fe.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},V?.signInWithSolana),{version:"1",domain:dt.host,uri:dt.href}),$?{statement:$}:null)),it;if(Array.isArray(Ie)&&Ie[0]&&typeof Ie[0]=="object")it=Ie[0];else if(Ie&&typeof Ie=="object"&&"signedMessage"in Ie&&"signature"in Ie)it=Ie;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in it&&"signature"in it&&(typeof it.signedMessage=="string"||it.signedMessage instanceof Uint8Array)&&it.signature instanceof Uint8Array)T=typeof it.signedMessage=="string"?it.signedMessage:new TextDecoder().decode(it.signedMessage),x=it.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in fe)||typeof fe.signMessage!="function"||!("publicKey"in fe)||typeof fe!="object"||!fe.publicKey||!("toBase58"in fe.publicKey)||typeof fe.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");T=[`${dt.host} wants you to sign in with your Solana account:`,fe.publicKey.toBase58(),...$?["",$,""]:[""],"Version: 1",`URI: ${dt.href}`,`Issued At: ${(o=(r=V?.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((s=V?.signInWithSolana)===null||s===void 0)&&s.notBefore?[`Not Before: ${V.signInWithSolana.notBefore}`]:[],...!((a=V?.signInWithSolana)===null||a===void 0)&&a.expirationTime?[`Expiration Time: ${V.signInWithSolana.expirationTime}`]:[],...!((c=V?.signInWithSolana)===null||c===void 0)&&c.chainId?[`Chain ID: ${V.signInWithSolana.chainId}`]:[],...!((f=V?.signInWithSolana)===null||f===void 0)&&f.nonce?[`Nonce: ${V.signInWithSolana.nonce}`]:[],...!((h=V?.signInWithSolana)===null||h===void 0)&&h.requestId?[`Request ID: ${V.signInWithSolana.requestId}`]:[],...!((y=(m=V?.signInWithSolana)===null||m===void 0?void 0:m.resources)===null||y===void 0)&&y.length?["Resources",...V.signInWithSolana.resources.map(it=>`- ${it}`)]:[]].join(`
`);let Ie=yield fe.signMessage(new TextEncoder().encode(T),"utf8");if(!Ie||!(Ie instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");x=Ie}}try{let{data:M,error:X}=yield re(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:T,signature:Yi(x)},!((g=e.options)===null||g===void 0)&&g.captchaToken?{gotrue_meta_security:{captcha_token:(w=e.options)===null||w===void 0?void 0:w.captchaToken}}:null),xform:Fn});if(X)throw X;return!M||!M.session||!M.user?{data:{user:null,session:null},error:new Ki}:(M.session&&(yield this._saveSession(M.session),yield this._notifyAllSubscribers("SIGNED_IN",M.session)),{data:Object.assign({},M),error:X})}catch(M){if(ee(M))return{data:{user:null,session:null},error:M};throw M}})}_exchangeCodeForSession(e){return b(this,null,function*(){let i=yield Ir(this.storage,`${this.storageKey}-code-verifier`),[r,o]=(i??"").split("/");try{let{data:s,error:a}=yield re(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Fn});if(yield Zi(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new Ki}:(s.session&&(yield this._saveSession(s.session),yield this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:o??null}),error:a})}catch(s){if(ee(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}})}signInWithIdToken(e){return b(this,null,function*(){try{let{options:i,provider:r,token:o,access_token:s,nonce:a}=e,c=yield re(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:o,access_token:s,nonce:a,gotrue_meta_security:{captcha_token:i?.captchaToken}},xform:Fn}),{data:f,error:h}=c;return h?{data:{user:null,session:null},error:h}:!f||!f.session||!f.user?{data:{user:null,session:null},error:new Ki}:(f.session&&(yield this._saveSession(f.session),yield this._notifyAllSubscribers("SIGNED_IN",f.session)),{data:f,error:h})}catch(i){if(ee(i))return{data:{user:null,session:null},error:i};throw i}})}signInWithOtp(e){return b(this,null,function*(){var i,r,o,s,a;try{if("email"in e){let{email:c,options:f}=e,h=null,m=null;this.flowType==="pkce"&&([h,m]=yield xo(this.storage,this.storageKey));let{error:y}=yield re(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:c,data:(i=f?.data)!==null&&i!==void 0?i:{},create_user:(r=f?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:h,code_challenge_method:m},redirectTo:f?.emailRedirectTo});return{data:{user:null,session:null},error:y}}if("phone"in e){let{phone:c,options:f}=e,{data:h,error:m}=yield re(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:c,data:(o=f?.data)!==null&&o!==void 0?o:{},create_user:(s=f?.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:f?.captchaToken},channel:(a=f?.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:h?.message_id},error:m}}throw new bo("You must provide either an email or phone number.")}catch(c){if(ee(c))return{data:{user:null,session:null},error:c};throw c}})}verifyOtp(e){return b(this,null,function*(){var i,r;try{let o,s;"options"in e&&(o=(i=e.options)===null||i===void 0?void 0:i.redirectTo,s=(r=e.options)===null||r===void 0?void 0:r.captchaToken);let{data:a,error:c}=yield re(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:s}}),redirectTo:o,xform:Fn});if(c)throw c;if(!a)throw new Error("An error occurred on token verification.");let f=a.session,h=a.user;return f?.access_token&&(yield this._saveSession(f),yield this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",f)),{data:{user:h,session:f},error:null}}catch(o){if(ee(o))return{data:{user:null,session:null},error:o};throw o}})}signInWithSSO(e){return b(this,null,function*(){var i,r,o;try{let s=null,a=null;return this.flowType==="pkce"&&([s,a]=yield xo(this.storage,this.storageKey)),yield re(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(i=e.options)===null||i===void 0?void 0:i.redirectTo)!==null&&r!==void 0?r:void 0}),!((o=e?.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:a}),headers:this.headers,xform:XS})}catch(s){if(ee(s))return{data:null,error:s};throw s}})}reauthenticate(){return b(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>b(this,null,function*(){return yield this._reauthenticate()}))})}_reauthenticate(){return b(this,null,function*(){try{return yield this._useSession(e=>b(this,null,function*(){let{data:{session:i},error:r}=e;if(r)throw r;if(!i)throw new kn;let{error:o}=yield re(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:i.access_token});return{data:{user:null,session:null},error:o}}))}catch(e){if(ee(e))return{data:{user:null,session:null},error:e};throw e}})}resend(e){return b(this,null,function*(){try{let i=`${this.url}/resend`;if("email"in e){let{email:r,type:o,options:s}=e,{error:a}=yield re(this.fetch,"POST",i,{headers:this.headers,body:{email:r,type:o,gotrue_meta_security:{captcha_token:s?.captchaToken}},redirectTo:s?.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){let{phone:r,type:o,options:s}=e,{data:a,error:c}=yield re(this.fetch,"POST",i,{headers:this.headers,body:{phone:r,type:o,gotrue_meta_security:{captcha_token:s?.captchaToken}}});return{data:{user:null,session:null,messageId:a?.message_id},error:c}}throw new bo("You must provide either an email or phone number and a type")}catch(i){if(ee(i))return{data:{user:null,session:null},error:i};throw i}})}getSession(){return b(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>b(this,null,function*(){return this._useSession(i=>b(this,null,function*(){return i}))}))})}_acquireLock(e,i){return b(this,null,function*(){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=b(this,null,function*(){return yield r,yield i()});return this.pendingInLock.push(b(this,null,function*(){try{yield o}catch{}})),o}return yield this.lock(`lock:${this.storageKey}`,e,()=>b(this,null,function*(){this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let r=i();for(this.pendingInLock.push(b(this,null,function*(){try{yield r}catch{}})),yield r;this.pendingInLock.length;){let o=[...this.pendingInLock];yield Promise.all(o),this.pendingInLock.splice(0,o.length)}return yield r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}})}_useSession(e){return b(this,null,function*(){this._debug("#_useSession","begin");try{let i=yield this.__loadSession();return yield e(i)}finally{this._debug("#_useSession","end")}})}__loadSession(){return b(this,null,function*(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null,i=yield Ir(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",i),i!==null&&(this._isValidSession(i)?e=i:(this._debug("#getSession()","session from storage is not valid"),yield this._removeSession())),!e)return{data:{session:null},error:null};let r=e.expires_at?e.expires_at*1e3-Date.now()<Bf:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){let a=yield Ir(this.userStorage,this.storageKey+"-user");a?.user?e.user=a.user:e.user=Yf()}if(this.storage.isServer&&e.user){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(f,h,m)=>(!a&&h==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(f,h,m))})}return{data:{session:e},error:null}}let{data:o,error:s}=yield this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}})}getUser(e){return b(this,null,function*(){return e?yield this._getUser(e):(yield this.initializePromise,yield this._acquireLock(-1,()=>b(this,null,function*(){return yield this._getUser()})))})}_getUser(e){return b(this,null,function*(){try{return e?yield re(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ci}):yield this._useSession(i=>b(this,null,function*(){var r,o,s;let{data:a,error:c}=i;if(c)throw c;return!(!((r=a.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new kn}:yield re(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(o=a.session)===null||o===void 0?void 0:o.access_token)!==null&&s!==void 0?s:void 0,xform:Ci})}))}catch(i){if(ee(i))return LS(i)&&(yield this._removeSession(),yield Zi(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:i};throw i}})}updateUser(r){return b(this,arguments,function*(e,i={}){return yield this.initializePromise,yield this._acquireLock(-1,()=>b(this,null,function*(){return yield this._updateUser(e,i)}))})}_updateUser(r){return b(this,arguments,function*(e,i={}){try{return yield this._useSession(o=>b(this,null,function*(){let{data:s,error:a}=o;if(a)throw a;if(!s.session)throw new kn;let c=s.session,f=null,h=null;this.flowType==="pkce"&&e.email!=null&&([f,h]=yield xo(this.storage,this.storageKey));let{data:m,error:y}=yield re(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:i?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:f,code_challenge_method:h}),jwt:c.access_token,xform:Ci});if(y)throw y;return c.user=m.user,yield this._saveSession(c),yield this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}}))}catch(o){if(ee(o))return{data:{user:null},error:o};throw o}})}setSession(e){return b(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>b(this,null,function*(){return yield this._setSession(e)}))})}_setSession(e){return b(this,null,function*(){try{if(!e.access_token||!e.refresh_token)throw new kn;let i=Date.now()/1e3,r=i,o=!0,s=null,{payload:a}=Kf(e.access_token);if(a.exp&&(r=a.exp,o=r<=i),o){let{data:c,error:f}=yield this._callRefreshToken(e.refresh_token);if(f)return{data:{user:null,session:null},error:f};if(!c)return{data:{user:null,session:null},error:null};s=c}else{let{data:c,error:f}=yield this._getUser(e.access_token);if(f)throw f;s={access_token:e.access_token,refresh_token:e.refresh_token,user:c.user,token_type:"bearer",expires_in:r-i,expires_at:r},yield this._saveSession(s),yield this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(i){if(ee(i))return{data:{session:null,user:null},error:i};throw i}})}refreshSession(e){return b(this,null,function*(){return yield this.initializePromise,yield this._acquireLock(-1,()=>b(this,null,function*(){return yield this._refreshSession(e)}))})}_refreshSession(e){return b(this,null,function*(){try{return yield this._useSession(i=>b(this,null,function*(){var r;if(!e){let{data:a,error:c}=i;if(c)throw c;e=(r=a.session)!==null&&r!==void 0?r:void 0}if(!e?.refresh_token)throw new kn;let{data:o,error:s}=yield this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}}))}catch(i){if(ee(i))return{data:{user:null,session:null},error:i};throw i}})}_getSessionFromURL(e,i){return b(this,null,function*(){try{if(!en())throw new wo("No browser detected.");if(e.error||e.error_description||e.error_code)throw new wo(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(i){case"implicit":if(this.flowType==="pkce")throw new ec("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new wo("Not a valid implicit grant flow url.");break;default:}if(i==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ec("No code detected.");let{data:$,error:V}=yield this._exchangeCodeForSession(e.code);if(V)throw V;let fe=new URL(window.location.href);return fe.searchParams.delete("code"),window.history.replaceState(window.history.state,"",fe.toString()),{data:{session:$.session,redirectType:null},error:null}}let{provider_token:r,provider_refresh_token:o,access_token:s,refresh_token:a,expires_in:c,expires_at:f,token_type:h}=e;if(!s||!c||!a||!h)throw new wo("No session defined in URL");let m=Math.round(Date.now()/1e3),y=parseInt(c),g=m+y;f&&(g=parseInt(f));let w=g-m;w*1e3<=yo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${w}s, should have been closer to ${y}s`);let T=g-y;m-T>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",T,g,m):m-T<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",T,g,m);let{data:x,error:M}=yield this._getUser(s);if(M)throw M;let X={provider_token:r,provider_refresh_token:o,access_token:s,expires_in:y,expires_at:g,refresh_token:a,token_type:h,user:x.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:X,redirectType:e.type},error:null}}catch(r){if(ee(r))return{data:{session:null,redirectType:null},error:r};throw r}})}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}_isPKCECallback(e){return b(this,null,function*(){let i=yield Ir(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&i)})}signOut(){return b(this,arguments,function*(e={scope:"global"}){return yield this.initializePromise,yield this._acquireLock(-1,()=>b(this,null,function*(){return yield this._signOut(e)}))})}_signOut(){return b(this,arguments,function*({scope:e}={scope:"global"}){return yield this._useSession(i=>b(this,null,function*(){var r;let{data:o,error:s}=i;if(s)return{error:s};let a=(r=o.session)===null||r===void 0?void 0:r.access_token;if(a){let{error:c}=yield this.admin.signOut(a,e);if(c&&!(FS(c)&&(c.status===404||c.status===401||c.status===403)))return{error:c}}return e!=="others"&&(yield this._removeSession(),yield Zi(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))})}onAuthStateChange(e){let i=HS(),r={id:i,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",i),this.stateChangeEmitters.delete(i)}};return this._debug("#onAuthStateChange()","registered callback with id",i),this.stateChangeEmitters.set(i,r),b(this,null,function*(){yield this.initializePromise,yield this._acquireLock(-1,()=>b(this,null,function*(){this._emitInitialSession(i)}))}),{data:{subscription:r}}}_emitInitialSession(e){return b(this,null,function*(){return yield this._useSession(i=>b(this,null,function*(){var r,o;try{let{data:{session:s},error:a}=i;if(a)throw a;yield(r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",s),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){yield(o=this.stateChangeEmitters.get(e))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}}))})}resetPasswordForEmail(r){return b(this,arguments,function*(e,i={}){let o=null,s=null;this.flowType==="pkce"&&([o,s]=yield xo(this.storage,this.storageKey,!0));try{return yield re(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:o,code_challenge_method:s,gotrue_meta_security:{captcha_token:i.captchaToken}},headers:this.headers,redirectTo:i.redirectTo})}catch(a){if(ee(a))return{data:null,error:a};throw a}})}getUserIdentities(){return b(this,null,function*(){var e;try{let{data:i,error:r}=yield this.getUser();if(r)throw r;return{data:{identities:(e=i.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(i){if(ee(i))return{data:null,error:i};throw i}})}linkIdentity(e){return b(this,null,function*(){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)})}linkIdentityOAuth(e){return b(this,null,function*(){var i;try{let{data:r,error:o}=yield this._useSession(s=>b(this,null,function*(){var a,c,f,h,m;let{data:y,error:g}=s;if(g)throw g;let w=yield this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(c=e.options)===null||c===void 0?void 0:c.scopes,queryParams:(f=e.options)===null||f===void 0?void 0:f.queryParams,skipBrowserRedirect:!0});return yield re(this.fetch,"GET",w,{headers:this.headers,jwt:(m=(h=y.session)===null||h===void 0?void 0:h.access_token)!==null&&m!==void 0?m:void 0})}));if(o)throw o;return en()&&!(!((i=e.options)===null||i===void 0)&&i.skipBrowserRedirect)&&window.location.assign(r?.url),{data:{provider:e.provider,url:r?.url},error:null}}catch(r){if(ee(r))return{data:{provider:e.provider,url:null},error:r};throw r}})}linkIdentityIdToken(e){return b(this,null,function*(){return yield this._useSession(i=>b(this,null,function*(){var r;try{let{error:o,data:{session:s}}=i;if(o)throw o;let{options:a,provider:c,token:f,access_token:h,nonce:m}=e,y=yield re(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=s?.access_token)!==null&&r!==void 0?r:void 0,body:{provider:c,id_token:f,access_token:h,nonce:m,link_identity:!0,gotrue_meta_security:{captcha_token:a?.captchaToken}},xform:Fn}),{data:g,error:w}=y;return w?{data:{user:null,session:null},error:w}:!g||!g.session||!g.user?{data:{user:null,session:null},error:new Ki}:(g.session&&(yield this._saveSession(g.session),yield this._notifyAllSubscribers("USER_UPDATED",g.session)),{data:g,error:w})}catch(o){if(ee(o))return{data:{user:null,session:null},error:o};throw o}}))})}unlinkIdentity(e){return b(this,null,function*(){try{return yield this._useSession(i=>b(this,null,function*(){var r,o;let{data:s,error:a}=i;if(a)throw a;return yield re(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(o=(r=s.session)===null||r===void 0?void 0:r.access_token)!==null&&o!==void 0?o:void 0})}))}catch(i){if(ee(i))return{data:null,error:i};throw i}})}_refreshAccessToken(e){return b(this,null,function*(){let i=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{let r=Date.now();return yield KS(o=>b(this,null,function*(){return o>0&&(yield qS(200*Math.pow(2,o-1))),this._debug(i,"refreshing attempt",o),yield re(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Fn})}),(o,s)=>{let a=200*Math.pow(2,o);return s&&Hf(s)&&Date.now()+a-r<yo})}catch(r){if(this._debug(i,"error",r),ee(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(i,"end")}})}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}_handleProviderSignIn(e,i){return b(this,null,function*(){let r=yield this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:i.redirectTo,scopes:i.scopes,queryParams:i.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",i,"url",r),en()&&!i.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}})}_recoverAndRefresh(){return b(this,null,function*(){var e,i;let r="#_recoverAndRefresh()";this._debug(r,"begin");try{let o=yield Ir(this.storage,this.storageKey);if(o&&this.userStorage){let a=yield Ir(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!a&&(a={user:o.user},yield So(this.userStorage,this.storageKey+"-user",a)),o.user=(e=a?.user)!==null&&e!==void 0?e:Yf()}else if(o&&!o.user&&!o.user){let a=yield Ir(this.storage,this.storageKey+"-user");a&&a?.user?(o.user=a.user,yield Zi(this.storage,this.storageKey+"-user"),yield So(this.storage,this.storageKey,o)):o.user=Yf()}if(this._debug(r,"session from storage",o),!this._isValidSession(o)){this._debug(r,"session is not valid"),o!==null&&(yield this._removeSession());return}let s=((i=o.expires_at)!==null&&i!==void 0?i:1/0)*1e3-Date.now()<Bf;if(this._debug(r,`session has${s?"":" not"} expired with margin of ${Bf}s`),s){if(this.autoRefreshToken&&o.refresh_token){let{error:a}=yield this._callRefreshToken(o.refresh_token);a&&(console.error(a),Hf(a)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",a),yield this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{let{data:a,error:c}=yield this._getUser(o.access_token);!c&&a?.user?(o.user=a.user,yield this._saveSession(o),yield this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(a){console.error("Error getting user data:",a),this._debug(r,"error getting user data, skipping SIGNED_IN notification",a)}else yield this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(r,"error",o),console.error(o);return}finally{this._debug(r,"end")}})}_callRefreshToken(e){return b(this,null,function*(){var i,r;if(!e)throw new kn;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let o=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new nc;let{data:s,error:a}=yield this._refreshAccessToken(e);if(a)throw a;if(!s.session)throw new kn;yield this._saveSession(s.session),yield this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);let c={data:s.session,error:null};return this.refreshingDeferred.resolve(c),c}catch(s){if(this._debug(o,"error",s),ee(s)){let a={data:null,error:s};return Hf(s)||(yield this._removeSession()),(i=this.refreshingDeferred)===null||i===void 0||i.resolve(a),a}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(s),s}finally{this.refreshingDeferred=null,this._debug(o,"end")}})}_notifyAllSubscribers(e,i,r=!0){return b(this,null,function*(){let o=`#_notifyAllSubscribers(${e})`;this._debug(o,"begin",i,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:i});let s=[],a=Array.from(this.stateChangeEmitters.values()).map(c=>b(this,null,function*(){try{yield c.callback(e,i)}catch(f){s.push(f)}}));if(yield Promise.all(a),s.length>0){for(let c=0;c<s.length;c+=1)console.error(s[c]);throw s[0]}}finally{this._debug(o,"end")}})}_saveSession(e){return b(this,null,function*(){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;let i=Object.assign({},e),r=i.user&&i.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&i.user&&(yield So(this.userStorage,this.storageKey+"-user",{user:i.user}));let o=Object.assign({},i);delete o.user;let s=kv(o);yield So(this.storage,this.storageKey,s)}else{let o=kv(i);yield So(this.storage,this.storageKey,o)}})}_removeSession(){return b(this,null,function*(){this._debug("#_removeSession()"),yield Zi(this.storage,this.storageKey),yield Zi(this.storage,this.storageKey+"-code-verifier"),yield Zi(this.storage,this.storageKey+"-user"),this.userStorage&&(yield Zi(this.userStorage,this.storageKey+"-user")),yield this._notifyAllSubscribers("SIGNED_OUT",null)})}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&en()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(i){console.error("removing visibilitychange callback failed",i)}}_startAutoRefresh(){return b(this,null,function*(){yield this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),yo);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(()=>b(this,null,function*(){yield this.initializePromise,yield this._autoRefreshTokenTick()}),0)})}_stopAutoRefresh(){return b(this,null,function*(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)})}startAutoRefresh(){return b(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._startAutoRefresh()})}stopAutoRefresh(){return b(this,null,function*(){this._removeVisibilityChangedCallback(),yield this._stopAutoRefresh()})}_autoRefreshTokenTick(){return b(this,null,function*(){this._debug("#_autoRefreshTokenTick()","begin");try{yield this._acquireLock(0,()=>b(this,null,function*(){try{let e=Date.now();try{return yield this._useSession(i=>b(this,null,function*(){let{data:{session:r}}=i;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}let o=Math.floor((r.expires_at*1e3-e)/yo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${yo}ms, refresh threshold is ${Uf} ticks`),o<=Uf&&(yield this._callRefreshToken(r.refresh_token))}))}catch(i){console.error("Auto refresh tick failed with error. This is likely a transient error.",i)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(e){if(e.isAcquireTimeout||e instanceof ic)this._debug("auto refresh token tick lock not available");else throw e}})}_handleVisibilityChange(){return b(this,null,function*(){if(this._debug("#_handleVisibilityChange()"),!en()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=()=>b(this,null,function*(){return yield this._onVisibilityChanged(!1)}),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),yield this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}})}_onVisibilityChanged(e){return b(this,null,function*(){let i=`#_onVisibilityChanged(${e})`;this._debug(i,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(yield this.initializePromise,yield this._acquireLock(-1,()=>b(this,null,function*(){if(document.visibilityState!=="visible"){this._debug(i,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}yield this._recoverAndRefresh()})))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()})}_getUrlForProvider(e,i,r){return b(this,null,function*(){let o=[`provider=${encodeURIComponent(i)}`];if(r?.redirectTo&&o.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&o.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){let[s,a]=yield xo(this.storage,this.storageKey),c=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(a)}`});o.push(c.toString())}if(r?.queryParams){let s=new URLSearchParams(r.queryParams);o.push(s.toString())}return r?.skipBrowserRedirect&&o.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${o.join("&")}`})}_unenroll(e){return b(this,null,function*(){try{return yield this._useSession(i=>b(this,null,function*(){var r;let{data:o,error:s}=i;return s?{data:null,error:s}:yield re(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=o?.session)===null||r===void 0?void 0:r.access_token})}))}catch(i){if(ee(i))return{data:null,error:i};throw i}})}_enroll(e){return b(this,null,function*(){try{return yield this._useSession(i=>b(this,null,function*(){var r,o;let{data:s,error:a}=i;if(a)return{data:null,error:a};let c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:f,error:h}=yield re(this.fetch,"POST",`${this.url}/factors`,{body:c,headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token});return h?{data:null,error:h}:(e.factorType==="totp"&&f.type==="totp"&&(!((o=f?.totp)===null||o===void 0)&&o.qr_code)&&(f.totp.qr_code=`data:image/svg+xml;utf-8,${f.totp.qr_code}`),{data:f,error:null})}))}catch(i){if(ee(i))return{data:null,error:i};throw i}})}_verify(e){return b(this,null,function*(){return this._acquireLock(-1,()=>b(this,null,function*(){try{return yield this._useSession(i=>b(this,null,function*(){var r;let{data:o,error:s}=i;if(s)return{data:null,error:s};let a=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?ux(e.webauthn.credential_response):dx(e.webauthn.credential_response)})}:{code:e.code}),{data:c,error:f}=yield re(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:a,headers:this.headers,jwt:(r=o?.session)===null||r===void 0?void 0:r.access_token});return f?{data:null,error:f}:(yield this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),yield this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),{data:c,error:f})}))}catch(i){if(ee(i))return{data:null,error:i};throw i}}))})}_challenge(e){return b(this,null,function*(){return this._acquireLock(-1,()=>b(this,null,function*(){try{return yield this._useSession(i=>b(this,null,function*(){var r;let{data:o,error:s}=i;if(s)return{data:null,error:s};let a=yield re(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(r=o?.session)===null||r===void 0?void 0:r.access_token});if(a.error)return a;let{data:c}=a;if(c.type!=="webauthn")return{data:c,error:null};switch(c.webauthn.type){case"create":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:lx(c.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},c),{webauthn:Object.assign(Object.assign({},c.webauthn),{credential_options:Object.assign(Object.assign({},c.webauthn.credential_options),{publicKey:cx(c.webauthn.credential_options.publicKey)})})}),error:null}}}))}catch(i){if(ee(i))return{data:null,error:i};throw i}}))})}_challengeAndVerify(e){return b(this,null,function*(){let{data:i,error:r}=yield this._challenge({factorId:e.factorId});return r?{data:null,error:r}:yield this._verify({factorId:e.factorId,challengeId:i.id,code:e.code})})}_listFactors(){return b(this,null,function*(){var e;let{data:{user:i},error:r}=yield this.getUser();if(r)return{data:null,error:r};let o={all:[],phone:[],totp:[],webauthn:[]};for(let s of(e=i?.factors)!==null&&e!==void 0?e:[])o.all.push(s),s.status==="verified"&&o[s.factor_type].push(s);return{data:o,error:null}})}_getAuthenticatorAssuranceLevel(){return b(this,null,function*(){return this._acquireLock(-1,()=>b(this,null,function*(){return yield this._useSession(e=>b(this,null,function*(){var i,r;let{data:{session:o},error:s}=e;if(s)return{data:null,error:s};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let{payload:a}=Kf(o.access_token),c=null;a.aal&&(c=a.aal);let f=c;((r=(i=o.user.factors)===null||i===void 0?void 0:i.filter(y=>y.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(f="aal2");let m=a.amr||[];return{data:{currentLevel:c,nextLevel:f,currentAuthenticationMethods:m},error:null}}))}))})}fetchJwk(r){return b(this,arguments,function*(e,i={keys:[]}){let o=i.keys.find(f=>f.kid===e);if(o)return o;let s=Date.now();if(o=this.jwks.keys.find(f=>f.kid===e),o&&this.jwks_cached_at+kS>s)return o;let{data:a,error:c}=yield re(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=s,o=a.keys.find(f=>f.kid===e),!o)?null:o})}getClaims(r){return b(this,arguments,function*(e,i={}){try{let o=e;if(!o){let{data:T,error:x}=yield this.getSession();if(x||!T.session)return{data:null,error:x};o=T.session.access_token}let{header:s,payload:a,signature:c,raw:{header:f,payload:h}}=Kf(o);i?.allowExpired||ZS(a.exp);let m=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:yield this.fetchJwk(s.kid,i?.keys?{keys:i.keys}:i?.jwks);if(!m){let{error:T}=yield this.getUser(o);if(T)throw T;return{data:{claims:a,header:s,signature:c},error:null}}let y=JS(s.alg),g=yield crypto.subtle.importKey("jwk",m,y,!0,["verify"]);if(!(yield crypto.subtle.verify(y,g,c,BS(`${f}.${h}`))))throw new Eo("Invalid JWT signature");return{data:{claims:a,header:s,signature:c},error:null}}catch(o){if(ee(o))return{data:null,error:o};throw o}})}}return n.nextInstanceID=0,n})(),$v=Rk;var Ok=$v,Hv=Ok;var ep=class extends Hv{constructor(t){super(t)}};var tp=class{constructor(t,e,i){var r,o,s;this.supabaseUrl=t,this.supabaseKey=e;let a=AS(t);if(!e)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",a),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",a),this.storageUrl=new URL("storage/v1",a),this.functionsUrl=new URL("functions/v1",a);let c=`sb-${a.hostname.split(".")[0]}-auth-token`,f={db:xS,realtime:IS,auth:Object.assign(Object.assign({},DS),{storageKey:c}),global:SS},h=MS(i??{},f);this.storageKey=(r=h.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(o=h.global.headers)!==null&&o!==void 0?o:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(m,y)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(y)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((s=h.auth)!==null&&s!==void 0?s:{},this.headers,h.global.fetch),this.fetch=TS(e,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new lS(new URL("rest/v1",a).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new Jl(this.storageUrl.href,this.headers,this.fetch,i?.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new zl(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,e={},i={head:!1,get:!1,count:void 0}){return this.rest.rpc(t,e,i)}channel(t,e={config:{}}){return this.realtime.channel(t,e)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){return b(this,null,function*(){var t,e;if(this.accessToken)return yield this.accessToken();let{data:i}=yield this.auth.getSession();return(e=(t=i.session)===null||t===void 0?void 0:t.access_token)!==null&&e!==void 0?e:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:e,detectSessionInUrl:i,storage:r,userStorage:o,storageKey:s,flowType:a,lock:c,debug:f},h,m){let y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new ep({url:this.authUrl.href,headers:Object.assign(Object.assign({},y),h),storageKey:s,autoRefreshToken:t,persistSession:e,detectSessionInUrl:i,storage:r,userStorage:o,flowType:a,lock:c,debug:f,fetch:m,hasCustomAuthorizationHeader:Object.keys(this.headers).some(g=>g.toLowerCase()==="authorization")})}_initRealtimeClient(t){return new ql(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,i)=>{this._handleTokenChanged(e,"CLIENT",i?.access_token)})}_handleTokenChanged(t,e,i){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==i?(this.changedAccessToken=i,this.realtime.setAuth(i)):t==="SIGNED_OUT"&&(this.realtime.setAuth(),e=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}};var px=(n,t,e)=>new tp(n,t,e);function Nk(){if(typeof window<"u"||typeof process>"u")return!1;let n=process.version;if(n==null)return!1;let t=n.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}Nk()&&console.warn("\u26A0\uFE0F  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");var Wv={production:!1,supabaseUrl:"https://qgtquamtmzqvytxwlwst.supabase.co",supabaseKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFndHF1YW10bXpxdnl0eHdsd3N0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjE2NTU0NzMsImV4cCI6MjA3NzIzMTQ3M30.xR4HjqI1lYoFLgbZl1zJ4eLRXjM_uraIdK2l_6t2G4A"};var Ct=class n{supabase;constructor(){let t={getItem:e=>b(null,null,function*(){return localStorage.getItem(e)}),setItem:(e,i)=>b(null,null,function*(){localStorage.setItem(e,i)}),removeItem:e=>b(null,null,function*(){localStorage.removeItem(e)})};this.supabase=px(Wv.supabaseUrl,Wv.supabaseKey,{auth:{storage:t,detectSessionInUrl:!1}})}getClient(){return this.supabase}static \u0275fac=function(e){return new(e||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};var he=class n{constructor(t,e,i){this.http=t;this.router=e;this.supabaseService=i;this.initializeAuth()}apiUrl="http://localhost:3000/api";currentUserSubject=new Ke(null);currentUser$=this.currentUserSubject.asObservable();isInitialized=!1;initializeAuth(){return b(this,null,function*(){if(!this.isInitialized)try{let t=this.supabaseService.getClient(),{data:{session:e}}=yield t.auth.getSession();e?.user?yield this.loadAndPublishUser(e.user.id):this.checkStoredToken(),t.auth.onAuthStateChange((i,r)=>b(this,null,function*(){console.log("Auth state changed:",i,r),r?.user?yield this.loadAndPublishUser(r.user.id):(this.currentUserSubject.next(null),this.clearAuthData(),this.router.url.includes("/login")||this.router.navigate(["/login"]))})),this.isInitialized=!0}catch(t){console.error("Error initializing auth:",t),this.clearAuthData()}})}loadAndPublishUser(t){return b(this,null,function*(){try{let e=this.supabaseService.getClient(),{data:i,error:r}=yield e.from("users").select("*").eq("id",t).maybeSingle();if(r){console.error("[AuthService] load user error",r),this.currentUserSubject.next(null);return}let o=i;if(o&&!o.company_id&&o.role==="admin"){let{data:s,error:a}=yield e.from("companies").select("id").eq("admin_user_id",t).maybeSingle();if(!a&&s?.id){let{error:c}=yield e.from("users").update({company_id:s.id}).eq("id",t);c||(o=Y(P({},o),{company_id:s.id}))}}o&&typeof o.company_id=="string"&&(o.company_id==="null"||o.company_id==="undefined"||o.company_id.trim()==="")&&(o=Y(P({},o),{company_id:null})),this.currentUserSubject.next(o),this.storeAuthData({user:o})}catch(e){console.error("[AuthService] unexpected error loadAndPublishUser",e),this.currentUserSubject.next(null)}})}clearAuthData(){localStorage.removeItem("auth_token"),localStorage.removeItem("user_data")}register(t){return B(this.registerWithSupabase(t))}login(t,e){return b(this,null,function*(){try{let i=this.supabaseService.getClient(),{data:r,error:o}=yield i.auth.signInWithPassword({email:t,password:e});if(o)throw o;if(!r?.user)throw new Error("Login fallito: nessun user restituito");return yield this.loadAndPublishUser(r.user.id),{auth:r,user:this.currentUserSubject.value}}catch(i){throw console.error("Login error:",i),i}})}loginWithSupabase(t){return b(this,null,function*(){let e=this.supabaseService.getClient(),{data:i,error:r}=yield e.auth.signInWithPassword({email:t.email,password:t.password});if(r)throw r;if(i.user){let{data:o,error:s}=yield e.from("users").select("*").eq("id",i.user.id).single();if(s)throw s;this.storeAuthData({token:i.session.access_token,user:o}),this.currentUserSubject.next(o)}return i})}getAuthHeaders(){let t=this.getToken();return new fi({Authorization:`Bearer ${t}`,"Content-Type":"application/json"})}logout(){return b(this,null,function*(){try{yield this.supabaseService.getClient().auth.signOut()}catch(t){console.error("Logout error:",t)}finally{this.clearAuthData(),this.currentUserSubject.next(null),this.router.navigate(["/login"])}})}getToken(){return localStorage.getItem("auth_token")}isAuthenticated(){return!!this.currentUserSubject.value}hasRole(t){return this.currentUserSubject.value?.role===t}storeAuthData(t){t.token&&localStorage.setItem("auth_token",t.token),t.user&&localStorage.setItem("user_data",JSON.stringify(t.user))}checkStoredToken(){let t=this.getToken(),e=localStorage.getItem("user_data");if(t&&e)try{let i=JSON.parse(e);this.currentUserSubject.next(i)}catch{this.clearAuthData()}}retryOnLock(t,e=4,i=120){return b(this,null,function*(){let r=0;for(;;)try{return yield t()}catch(o){let s=o?.name??"",a=o?.message??"";if(!(s==="NavigatorLockAcquireTimeoutError"||a.includes("NavigatorLock")||a.includes("acquire"))||r>=e-1)throw o;let f=i*Math.pow(2,r)+Math.round(Math.random()*i);yield new Promise(h=>setTimeout(h,f)),r++}})}registerAdmin(t){return B(this.registerWithSupabase(t))}registerUser(t){return B(this.registerUserWithSupabase(t))}registerWithSupabase(t){return b(this,null,function*(){let e=this.supabaseService.getClient(),{data:i,error:r}=yield e.auth.signUp({email:t.admin.email,password:t.admin.password,options:{data:{first_name:t.admin.first_name,last_name:t.admin.last_name,role:"admin"}}});if(r)throw r;if(!i||!i.user)throw new Error("Auth provider non ha restituito user");let o=i.user.id;console.debug("[AuthService] Admin auth creato con ID:",o);try{let{error:s}=yield e.from("users").insert([{id:o,company_id:null,first_name:t.admin.first_name,last_name:t.admin.last_name,email:t.admin.email,phone:t.admin.phone,timezone:t.admin.timezone||"Europe/Rome",is_active:!0,role:"admin"}]);if(s)throw s;let{data:a,error:c}=yield e.from("companies").insert([{name:t.company.name,vat:t.company.vat,address:t.company.address,city:t.company.city,province:t.company.province,civic_number:t.company.civic_number,website:t.company.website,legal_form:t.company.legal_form,category:t.company.category,opening_hours:t.company.opening_hours,admin_user_id:o}]).select().single();if(c)throw yield e.from("users").delete().eq("id",o),c;console.debug("[AuthService] Company creata con ID:",a.id);let{error:f}=yield e.from("users").update({company_id:a.id}).eq("id",o);if(f)throw yield e.from("companies").delete().eq("id",a.id),yield e.from("users").delete().eq("id",o),f;return{user:i.user,company:a}}catch(s){throw console.error("[AuthService] Errore durante registrazione admin:",s),s}})}registerUserWithSupabase(t){return b(this,null,function*(){let e=this.supabaseService.getClient();if(console.debug("[AuthService] registerUserWithSupabase payload:",t),!t.company_id)throw new Error("Company ID non fornito per la registrazione utente");console.debug("[AuthService] Company ID from payload:",t.company_id),console.debug("[AuthService] Saltando verifica azienda - procedo con company_id:",t.company_id);let{data:i,error:r}=yield e.auth.signUp({email:t.user.email,password:t.user.password,options:{data:{first_name:t.user.first_name,last_name:t.user.last_name,role:"employee"}}});if(r)throw console.error("[AuthService] Auth signup error:",r),r;if(!i||!i.user)throw new Error("Registrazione fallita: impossibile creare l'utente (auth returned no user)");let o=i.user.id;console.debug("[AuthService] User auth creato con ID:",o);let{error:s}=yield e.from("users").insert([{id:o,company_id:t.company_id,first_name:t.user.first_name,last_name:t.user.last_name,email:t.user.email,phone:t.user.phone,timezone:t.user.timezone||"Europe/Rome",is_active:!0,role:"employee"}]);if(s)throw console.error("[AuthService] Errore inserimento utente:",s),s.code==="23503"?new Error("Azienda non trovata nel database. Contatta l'amministratore."):s;return console.debug("[AuthService] Registrazione utente completata con successo"),{user:i.user}})}updateUserProfile(t,e){return b(this,null,function*(){let i=this.supabaseService.getClient();try{let s=yield i.auth.getSession();console.debug("[AuthService] session user id:",s?.data?.session?.user?.id??null)}catch(s){console.debug("[AuthService] getSession failed",s)}console.debug("[AuthService] updateUserProfile patch:",e,"target userId:",t);let{data:r,error:o}=yield i.from("users").update(e).eq("id",t).select().maybeSingle();if(o)throw console.error("[AuthService] updateUserProfile error:",o),o;return r&&this.currentUserSubject.next(r),r})}hasManagerPermission(t,e){return b(this,null,function*(){let i=this.currentUserSubject.value;if(!i)return!1;if(i.role==="admin")return!0;if(i.role!=="manager")return!1;e||(e=i.company_id);try{let r=this.supabaseService.getClient(),{data:o}=yield r.from("companies").select("manager_visibility").eq("id",e).maybeSingle(),a=(o?.manager_visibility||{})[i.id]||{};switch(t){case"manage_departments":return!!a.can_manage_departments;case"view_all_employees":return!!a.can_view_all_employees;default:return!1}}catch(r){return console.error("[AuthService] hasManagerPermission error",r),!1}})}static \u0275fac=function(e){return new(e||n)(L(pi),L(Se),L(Ct))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};function Pk(n,t){if(n&1&&(u(0,"div",19),d(1),l()),n&2){let e=v();p(),O(" ",e.errorMessage," ")}}function kk(n,t){n&1&&(u(0,"span",22),d(1,"Email obbligatoria"),l())}function Fk(n,t){n&1&&(u(0,"span",22),d(1,"Email non valida"),l())}function Lk(n,t){if(n&1&&(u(0,"div",20),E(1,kk,2,0,"span",21)(2,Fk,2,0,"span",21),l()),n&2){let e=v();p(),_("ngIf",e.email==null||e.email.errors==null?null:e.email.errors.required),p(),_("ngIf",e.email==null||e.email.errors==null?null:e.email.errors.email)}}function jk(n,t){n&1&&(u(0,"span",22),d(1,"Password obbligatoria"),l())}function Vk(n,t){if(n&1&&(u(0,"span",22),d(1),l()),n&2){let e=v(2);p(),O(" Minimo ",e.password==null||e.password.errors==null?null:e.password.errors.minlength.requiredLength," caratteri ")}}function zk(n,t){if(n&1&&(u(0,"div",20),E(1,jk,2,0,"span",21)(2,Vk,2,1,"span",21),l()),n&2){let e=v();p(),_("ngIf",e.password==null||e.password.errors==null?null:e.password.errors.required),p(),_("ngIf",e.password==null||e.password.errors==null?null:e.password.errors.minlength)}}function Uk(n,t){n&1&&(u(0,"span"),d(1,"Accedi"),l())}function Bk(n,t){n&1&&N(0,"div",23)}var np=class n{constructor(t,e,i){this.fb=t;this.authService=e;this.router=i;this.loginForm=this.fb.group({email:["",[Q.required,Q.email]],password:["",[Q.required,Q.minLength(6)]]})}loginForm;isLoading=!1;errorMessage="";ngOnInit(){this.authService.isAuthenticated()&&this.router.navigate(["/home"])}onSubmit(){return b(this,null,function*(){if(this.loginForm.valid){this.isLoading=!0,this.errorMessage="";let t=this.loginForm.value;try{yield this.authService.login(t.email,t.password),this.isLoading=!1,yield this.router.navigate(["/home"])}catch(e){this.isLoading=!1,this.errorMessage=e?.message||e?.error?.message||"Errore durante il login. Riprova.",console.error("Login error:",e)}}else this.markFormGroupTouched()})}markFormGroupTouched(){Object.keys(this.loginForm.controls).forEach(t=>{this.loginForm.get(t)?.markAsTouched()})}get email(){return this.loginForm.get("email")}get password(){return this.loginForm.get("password")}static \u0275fac=function(e){return new(e||n)(C(bi),C(he),C(Se))};static \u0275cmp=ge({type:n,selectors:[["app-login"]],decls:31,vars:11,consts:[[1,"gradient-container"],[1,"form-card",2,"max-width","440px"],[1,"section-header"],[1,"section-titles"],[1,"section-title"],[1,"text-muted"],[1,"generic-form",3,"ngSubmit","formGroup"],["class","status-message error",4,"ngIf"],[1,"form-group"],[1,"form-label"],["type","email","formControlName","email","placeholder","inserisci@email.com",1,"form-input"],["class","error-messages",4,"ngIf"],["type","password","formControlName","password","placeholder","Inserisci la password",1,"form-input"],["type","submit",1,"promethea-button","outline",3,"disabled"],[4,"ngIf"],["class","loading-spinner small",4,"ngIf"],[1,"form-footer"],["routerLink","/register",1,"link"],["routerLink","/forgot-password",1,"link","text-sm"],[1,"status-message","error"],[1,"error-messages"],["class","error",4,"ngIf"],[1,"error"],[1,"loading-spinner","small"]],template:function(e,i){e&1&&(u(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),d(5,"Accedi alla Piattaforma"),l(),u(6,"p",5),d(7,"Inserisci le tue credenziali per accedere"),l()()(),u(8,"form",6),S("ngSubmit",function(){return i.onSubmit()}),E(9,Pk,2,1,"div",7),u(10,"div",8)(11,"label",9),d(12,"Email"),l(),N(13,"input",10),E(14,Lk,3,2,"div",11),l(),u(15,"div",8)(16,"label",9),d(17,"Password"),l(),N(18,"input",12),E(19,zk,3,2,"div",11),l(),u(20,"button",13),E(21,Uk,2,0,"span",14)(22,Bk,1,0,"div",15),l(),u(23,"div",16)(24,"div",5),d(25," Non hai un account? "),N(26,"br"),u(27,"a",17),d(28,"Registrati"),l()(),u(29,"a",18),d(30,"Password dimenticata?"),l()()()()()),e&2&&(p(8),_("formGroup",i.loginForm),p(),_("ngIf",i.errorMessage),p(4),we("error",(i.email==null?null:i.email.invalid)&&(i.email==null?null:i.email.touched)),p(),_("ngIf",(i.email==null?null:i.email.invalid)&&(i.email==null?null:i.email.touched)),p(4),we("error",(i.password==null?null:i.password.invalid)&&(i.password==null?null:i.password.touched)),p(),_("ngIf",(i.password==null?null:i.password.invalid)&&(i.password==null?null:i.password.touched)),p(),_("disabled",i.isLoading),p(),_("ngIf",!i.isLoading),p(),_("ngIf",i.isLoading))},dependencies:[_e,Ee,wi,Rn,Ne,Pe,An,On,Xn,jt],styles:[".link[_ngcontent-%COMP%]{color:var(--text-color)}.form-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:var(--gutter-sm)}"]})};var Ys=class n{constructor(t){this.supabaseService=t}listByCompany(t){let e=this.supabaseService.getClient();return B(e.from("employee_invitations").select("*").eq("company_id",t).order("created_at",{ascending:!0}).then(i=>{if(i.error)throw i.error;return i.data||[]}))}addInvite(t,e,i){let r=this.supabaseService.getClient(),s={company_id:t?String(t).trim().replace(/^["']+|["']+$/g,""):null,email:(e||"").toLowerCase().trim(),invited_by:i??null,accepted:!1,token:null};return B(r.from("employee_invitations").insert([s]).select().then(a=>{if(a.error)throw a.error;return a.data&&a.data[0]?a.data[0]:null}))}removeInviteById(t){let e=this.supabaseService.getClient();return B(e.from("employee_invitations").delete().eq("id",t).then(i=>{if(i.error)throw i.error;return i}))}isEmailInvited(t,e){if(!t)return B(Promise.resolve(!1));let i=this.supabaseService.getClient();return B(i.from("employee_invitations").select("id").eq("company_id",t).ilike("email",e).limit(1).then(r=>{if(r.error)throw r.error;return r.data&&r.data.length>0}))}getInviteForEmail(t){let e=this.supabaseService.getClient(),i=(t||"").toString().trim().toLowerCase(),r=e.from("employee_invitations").select("*").ilike("email",i).eq("accepted",!1).order("created_at",{ascending:!1}).limit(1).then(o=>{if(o.error)throw o.error;let s=Array.isArray(o.data)&&o.data.length?o.data[0]:null;return s&&s.company_id&&(s.company_id=String(s.company_id).trim().replace(/^["']+|["']+$/g,"")||null),s});return B(r)}markAccepted(t){let e=this.supabaseService.getClient();return B(e.from("employee_invitations").update({accepted:!0}).eq("id",t).then(i=>{if(i.error)throw i.error;return i.data}))}static \u0275fac=function(e){return new(e||n)(L(Ct))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};var St=class n{constructor(t,e,i){this.http=t;this.authService=e;this.supabaseService=i}baseUrl="/api/companies";getAziendaByAdmin(t){if(!t||t==="null"||t==="undefined")return console.warn("[CompanyService] getAziendaByAdmin called with invalid adminUserId:",t),H(null);let e=this.supabaseService.getClient(),i=b(this,null,function*(){try{let r=yield e.from("companies").select("*").eq("admin_user_id",t).maybeSingle();return console.debug("[CompanyService.getAziendaByAdmin] supabase response",{adminUserId:t,res:r}),r?.error?(console.warn("[CompanyService] getAziendaByAdmin supabase error",r.error),null):r?.data??null}catch(r){return console.error("[CompanyService] getAziendaByAdmin unexpected",r),null}});return B(i)}getAzienda(t){if(!t)return H(null);let e=this.supabaseService.getClient(),i=b(this,null,function*(){try{if(/^[0-9a-f]{8}-[0-9a-f]{4}-4[0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)){let s=yield e.from("companies").select("*").eq("id",t).maybeSingle();if(!s.error&&s.data)return s.data}return(yield e.from("companies").select("*").eq("vat",t).maybeSingle()).data||null}catch(r){return console.error("[CompanyService] getAzienda unexpected",r),null}});return B(i)}getAziendaById(t){if(!t)return H(null);let e=this.supabaseService.getClient(),i=b(this,null,function*(){try{console.debug("[CompanyService] getAziendaById searching for:",t);let{data:r,error:o}=yield e.from("companies").select("*").eq("id",t).maybeSingle();return console.debug("[CompanyService] getAziendaById result:",{data:r,error:o}),o?(console.error("[CompanyService] getAziendaById supabase error:",o),null):r}catch(r){return console.error("[CompanyService] getAziendaById unexpected error:",r),null}});return B(i)}getAllCompanies(){let t=this.supabaseService.getClient(),e=b(this,null,function*(){try{let i=yield t.from("companies").select("*");return i?.error?(console.error("[CompanyService] getAllCompanies error",i.error),[]):i?.data||[]}catch(i){return console.error("[CompanyService] getAllCompanies unexpected",i),[]}});return B(e)}getAziendaForUser(t,e){let i=this.supabaseService.getClient(),r=b(this,null,function*(){try{if(e&&e!=="null"&&e!=="undefined"){let o=yield i.from("companies").select("*").eq("id",e).maybeSingle();if(!o?.error&&o?.data)return o.data}if(t){let o=yield i.from("companies").select("*").eq("admin_user_id",t).maybeSingle();if(!o?.error&&o?.data)return o.data}return null}catch(o){return console.error("[CompanyService] getAziendaForUser unexpected",o),null}});return B(r)}aggiornaAzienda(t,e){let i=this.supabaseService.getClient(),r=b(this,null,function*(){try{let o=yield i.from("companies").update(e).eq("id",t).select().maybeSingle();if(!o?.error&&o?.data)return console.debug("[CompanyService] aggiornaAzienda supabase success",o.data),o.data;let s=this.authService.getAuthHeaders();try{let a=yield this.http.patch(`${this.baseUrl}/${t}`,e,{headers:s}).toPromise();return console.debug("[CompanyService] aggiornaAzienda fallback HTTP success",a),a}catch(a){throw console.error("[CompanyService] aggiornaAzienda fallback HTTP error",a),a}}catch(o){throw console.error("[CompanyService] aggiornaAzienda unexpected",o,{companyId:t,payload:e}),o}});return B(r)}getDipendenti(t){let e=this.authService.getAuthHeaders();return this.http.get(`${this.baseUrl}/${t}/users`,{headers:e})}cambiaStatoDipendente(t,e){let i=this.authService.getAuthHeaders();return this.http.patch(`${this.baseUrl}/users/${t}`,{is_active:e},{headers:i})}eliminaDipendente(t){let e=this.authService.getAuthHeaders();return this.http.delete(`${this.baseUrl}/users/${t}`,{headers:e})}creaDipendente(t){let e=this.authService.getAuthHeaders(),i={company_vat:t.company_vat||t.company_vat_field||t.company?.vat||null,user:{first_name:t.first_name,last_name:t.last_name,email:t.email,phone:t.phone??null,timezone:t.timezone??"Europe/Rome",hire_date:t.hire_date??null,password:t.password??(()=>{let r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%",o="";for(let s=0;s<12;s++)o+=r.charAt(Math.floor(Math.random()*r.length));return o})()}};return this.http.post(`${this.baseUrl}/users`,i,{headers:e})}static \u0275fac=function(e){return new(e||n)(L(pi),L(he),L(Ct))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};function $k(n,t){n&1&&(u(0,"span",42),d(1,"Obbligatorio"),l())}function Hk(n,t){if(n&1&&(u(0,"div",40),E(1,$k,2,0,"span",41),l()),n&2){let e=v(2);p(),_("ngIf",e.company_name==null||e.company_name.errors==null?null:e.company_name.errors.required)}}function Wk(n,t){n&1&&(u(0,"span",42),d(1,"Obbligatorio"),l())}function Gk(n,t){n&1&&(u(0,"span",42),d(1,"Formato non valido"),l())}function qk(n,t){if(n&1&&(u(0,"div",40),E(1,Wk,2,0,"span",41)(2,Gk,2,0,"span",41),l()),n&2){let e=v(2);p(),_("ngIf",e.vat==null||e.vat.errors==null?null:e.vat.errors.required),p(),_("ngIf",e.vat==null||e.vat.errors==null?null:e.vat.errors.pattern)}}function Kk(n,t){if(n&1&&(u(0,"option",43),d(1),l()),n&2){let e=t.$implicit;_("value",e),p(),R(e)}}function Yk(n,t){if(n&1&&(u(0,"option",43),d(1),l()),n&2){let e=t.$implicit;_("value",e),p(),R(e)}}function Zk(n,t){if(n&1&&(u(0,"div",44)(1,"div",45),d(2),l(),N(3,"input",46),u(4,"span",5),d(5,"\u2014"),l(),N(6,"input",47),u(7,"label",48),N(8,"input",49),u(9,"span",5),d(10,"Chiuso"),l()()()),n&2){let e,i,r,o=t.$implicit,s=v(2);we("closed",(e=s.registerForm.get("opening_hours."+o.key+".closed"))==null?null:e.value),_("formGroupName",o.key),p(2),R(o.label),p(),pn("aria-label",Ha("",o.label," apertura")),_("disabled",(i=s.registerForm.get("opening_hours."+o.key+".closed"))==null?null:i.value),p(3),pn("aria-label",Ha("",o.label," chiusura")),_("disabled",(r=s.registerForm.get("opening_hours."+o.key+".closed"))==null?null:r.value),p(2),pn("aria-label",Ha("",o.label," chiuso"))}}function Jk(n,t){if(n&1&&(u(0,"div",10)(1,"h2",4)(2,"span",22),d(3,"business"),l(),d(4," Dati Azienda"),l(),u(5,"div",23)(6,"div")(7,"label",24),d(8,"Nome Azienda *"),l(),N(9,"input",25),E(10,Hk,2,1,"div",15),l(),u(11,"div")(12,"label",24),d(13,"Partita IVA *"),l(),N(14,"input",26),E(15,qk,3,2,"div",15),l(),u(16,"div")(17,"label",24),d(18,"Provincia"),l(),N(19,"input",27),l(),u(20,"div")(21,"label",24),d(22,"Citt\xE0"),l(),N(23,"input",28),l(),u(24,"div")(25,"label",24),d(26,"Indirizzo"),l(),N(27,"input",29),l(),u(28,"div")(29,"label",24),d(30,"Civico"),l(),N(31,"input",30),l(),u(32,"div")(33,"label",24),d(34,"Sito web"),l(),N(35,"input",31),l(),u(36,"div")(37,"label",24),d(38,"Forma legale"),l(),u(39,"select",32)(40,"option",33),d(41,"Seleziona forma legale"),l(),E(42,Kk,2,2,"option",34),l()(),u(43,"div")(44,"label",24),d(45,"Categoria"),l(),u(46,"select",35)(47,"option",33),d(48,"Seleziona categoria"),l(),E(49,Yk,2,2,"option",34),l()(),u(50,"div",36)(51,"label",24),d(52,"Orari settimanali"),l(),u(53,"div",37),E(54,Zk,11,12,"div",38),l(),u(55,"div",39),d(56,' Lascia vuoto open/close per i giorni chiusi oppure seleziona "Chiuso". '),l()()()()),n&2){let e=v();p(10),_("ngIf",(e.company_name==null?null:e.company_name.invalid)&&(e.company_name==null?null:e.company_name.touched)),p(5),_("ngIf",(e.vat==null?null:e.vat.invalid)&&(e.vat==null?null:e.vat.touched)),p(27),_("ngForOf",e.companyLegalForms),p(7),_("ngForOf",e.companyCategories),p(5),_("ngForOf",e.days)}}function Qk(n,t){if(n&1&&(u(0,"div",10)(1,"h2",4)(2,"span",22),d(3,"person"),l(),d(4),l(),u(5,"div",23)(6,"div")(7,"label",24),d(8,"Nome *"),l(),N(9,"input",50),l(),u(10,"div")(11,"label",24),d(12,"Cognome *"),l(),N(13,"input",51),l(),u(14,"div")(15,"label",24),d(16,"Email *"),l(),N(17,"input",52),l(),u(18,"div")(19,"label",24),d(20,"Telefono *"),l(),N(21,"input",53),l(),u(22,"div")(23,"label",24),d(24,"Password *"),l(),N(25,"input",54),l(),u(26,"div")(27,"label",24),d(28,"Conferma Password *"),l(),N(29,"input",55),l()()()),n&2){let e=v();p(4),O(" ",e.mode==="admin"?"Dati Amministratore":"Dati Utente"," ")}}function Xk(n,t){n&1&&(u(0,"div",40)(1,"span",42),d(2,"Devi accettare i termini"),l()())}function e2(n,t){if(n&1&&(u(0,"div",56),d(1),l()),n&2){let e=v();p(),R(e.errorMessage)}}function t2(n,t){if(n&1&&(u(0,"div",57),d(1),l()),n&2){let e=v();p(),R(e.successMessage)}}function n2(n,t){n&1&&(u(0,"span"),d(1,"Registrati"),l())}function i2(n,t){n&1&&(u(0,"span"),d(1,"Attendere\u2026"),l())}var r2=["S.r.l.","S.r.l.s.","S.p.A.","S.a.s.","S.n.c.","S.s.","Ditta Individuale","Libero Professionista"],o2=["Agricoltura","Industria","Costruzioni","Commercio","Alimentare","Trasporti","Servizi","ICT","Professioni","Altro"],ip=class n{constructor(t,e,i,r,o,s){this.fb=t;this.authService=e;this.router=i;this.route=r;this.invitiService=o;this.companyService=s;let a=this.fb.group({});this.days.forEach(c=>{a.addControl(c.key,this.fb.group({open:[""],close:[""],closed:[!1]}))}),this.registerForm=this.fb.group({company_name:["",[Q.required,Q.minLength(2)]],vat:["",[Q.required,Q.pattern(/^[0-9]{11}$/)]],address:[""],city:[""],province:[""],civic_number:[""],website:[""],legal_form:[""],category:[""],opening_hours:a,first_name:["",[Q.required,Q.minLength(2)]],last_name:["",[Q.required,Q.minLength(2)]],email:["",[Q.required,Q.email]],phone:["",[Q.required,Q.pattern(/^[0-9+\s\-()]{6,20}$/)]],birth_date:[""],birth_place:[""],fiscal_code:[""],timezone:["Europe/Rome"],is_active:[!1],hire_date:[""],password:["",[Q.required,Q.minLength(8)]],confirmPassword:["",[Q.required]],terms:[!1,[Q.requiredTrue]]},{validators:this.passwordMatchValidator})}mode="user";registerForm;isLoading=!1;errorMessage="";successMessage="";closed_days=[];weekDays=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];sub;companyLegalForms=r2;companyCategories=o2;days=[{key:"monday",label:"Luned\xEC"},{key:"tuesday",label:"Marted\xEC"},{key:"wednesday",label:"Mercoled\xEC"},{key:"thursday",label:"Gioved\xEC"},{key:"friday",label:"Venerd\xEC"},{key:"saturday",label:"Sabato"},{key:"sunday",label:"Domenica"}];ngOnInit(){let t=this.route.snapshot.queryParamMap.get("mode");(t==="user"||t==="admin")&&(this.mode=t),this.setMode(this.mode)}setMode(t){this.mode=t,t==="admin"?(this.registerForm.get("company_name")?.setValidators([Q.required,Q.minLength(2)]),this.registerForm.get("vat")?.setValidators([Q.required,Q.pattern(/^[0-9]{11}$/)]),this.registerForm.get("first_name")?.setValidators([Q.required,Q.minLength(2)]),this.registerForm.get("last_name")?.setValidators([Q.required,Q.minLength(2)]),this.registerForm.get("email")?.setValidators([Q.required,Q.email]),this.registerForm.get("phone")?.setValidators([Q.required,Q.pattern(/^[0-9+\s\-()]{6,20}$/)])):(this.registerForm.get("company_name")?.clearValidators(),this.registerForm.get("vat")?.clearValidators(),this.registerForm.get("first_name")?.setValidators([Q.required,Q.minLength(2)]),this.registerForm.get("last_name")?.setValidators([Q.required,Q.minLength(2)]),this.registerForm.get("email")?.setValidators([Q.required,Q.email]),this.registerForm.get("phone")?.setValidators([Q.required,Q.pattern(/^[0-9+\s\-()]{6,20}$/)])),Object.keys(this.registerForm.controls).forEach(e=>this.registerForm.get(e)?.updateValueAndValidity())}toggleClosedDay(t){let e=t.target,i=e.value;e.checked?this.closed_days.includes(i)||this.closed_days.push(i):this.closed_days=this.closed_days.filter(r=>r!==i)}passwordMatchValidator(t){let e=t.get("password")?.value,i=t.get("confirmPassword")?.value;return e&&i&&e!==i?{passwordMismatch:!0}:null}get company_name(){return this.registerForm.get("company_name")}get vat(){return this.registerForm.get("vat")}get first_name(){return this.registerForm.get("first_name")}get last_name(){return this.registerForm.get("last_name")}get email(){return this.registerForm.get("email")}get phone(){return this.registerForm.get("phone")}get password(){return this.registerForm.get("password")}get confirmPassword(){return this.registerForm.get("confirmPassword")}get terms(){return this.registerForm.get("terms")}onSubmit(){if(console.log("onSubmit invoked",{mode:this.mode,valid:this.registerForm.valid}),this.registerForm.invalid){this.registerForm.markAllAsTouched();return}this.isLoading=!0;let t=this.registerForm.value;if(this.mode==="admin"){let e={company:{name:t.company_name,vat:t.vat,address:t.address||null,city:t.city||null,province:t.province||null,civic_number:t.civic_number||null,website:t.website||null,legal_form:t.legal_form||null,category:t.category||null,opening_hours:t.opening_hours},admin:{first_name:t.first_name,last_name:t.last_name,email:t.email,phone:t.phone||null,birth_date:t.birth_date||null,birth_place:t.birth_place||null,fiscal_code:t.fiscal_code||null,timezone:t.timezone||"Europe/Rome",is_active:!!t.is_active,hire_date:t.hire_date||null,password:t.password}};this.sub=this.authService.registerAdmin(e).subscribe({next:i=>{this.isLoading=!1,this.successMessage="Registrazione admin completata",setTimeout(()=>this.router.navigate(["/login"]),1500)},error:i=>{this.isLoading=!1,this.errorMessage=i?.message||"Errore",console.error(i)}})}else this.isLoading=!0,this.sub=this.invitiService.getInviteForEmail(t.email).pipe(Pt(1),je(e=>{if(!e)return this.isLoading=!1,this.errorMessage="La tua email non \xE8 autorizzata. Contatta l'amministratore dell'azienda.",Dt;console.debug("[Register] invite found:",e);let r=(o=>{if(!o)return null;let s=String(o).trim();return s=s.replace(/^["']+|["']+$/g,""),s||null})(e.company_id);return console.debug("[Register] companyIdFromInvite:",r),r?this.completeUserRegistration(t,e,r):(this.isLoading=!1,this.errorMessage="Invito non valido: company_id mancante.",Dt)})).subscribe({next:e=>{this.isLoading=!1,this.successMessage="Registrazione utente completata",setTimeout(()=>this.router.navigate(["/login"]),1500)},error:e=>{this.isLoading=!1,this.errorMessage=e?.message||"Errore durante la registrazione",console.error("Registration error:",e)}})}completeUserRegistration(t,e,i){let r={user:{first_name:t.first_name,last_name:t.last_name,email:t.email,phone:t.phone,password:t.password,timezone:t.timezone||"Europe/Rome"},company_id:i};return console.debug("[Register] Final payload:",r),this.authService.registerUser(r).pipe(Pt(1),je(o=>this.invitiService.markAccepted(e.id).pipe(Pt(1),le(()=>o))))}ngOnDestroy(){this.sub?.unsubscribe()}goToLogin(){this.router.navigate(["/login"])}static \u0275fac=function(e){return new(e||n)(C(bi),C(he),C(Se),C(Lt),C(Ys),C(St))};static \u0275cmp=ge({type:n,selectors:[["app-register"]],decls:36,vars:14,consts:[[1,"gradient-container"],[1,"form-card",2,"max-width","900px","margin","auto"],[1,"section-header"],[1,"section-titles"],[1,"section-title"],[1,"text-muted"],[1,"section-header",2,"justify-content","center","padding","var(--gutter-md)"],["type","button",1,"promethea-button",3,"click"],["novalidate","",1,"generic-form",3,"ngSubmit","formGroup"],["class","form-section",4,"ngIf"],[1,"form-section"],[1,"form-group"],[1,"checkbox-label"],["type","checkbox","formControlName","terms",1,"checkbox-input"],["href","#",1,"link"],["class","error-messages",4,"ngIf"],["class","status-message error",4,"ngIf"],["class","status-message info",4,"ngIf"],[1,"form-footer",2,"display","flex","justify-content","flex-end","gap","var(--gutter-sm)","margin-top","var(--gutter-md)"],["type","button",1,"promethea-button","ghost",3,"click","disabled"],["type","submit",1,"promethea-button",3,"disabled"],[4,"ngIf"],[1,"material-icons"],[1,"grid-form"],[1,"form-label"],["type","text","formControlName","company_name","placeholder","Nome azienda",1,"form-input"],["type","text","formControlName","vat","placeholder","12345678901",1,"form-input"],["type","text","formControlName","province","placeholder","MI",1,"form-input"],["type","text","formControlName","city","placeholder","Milano",1,"form-input"],["type","text","formControlName","address","placeholder","Via Roma 1",1,"form-input"],["type","text","formControlName","civic_number","placeholder","1/A",1,"form-input"],["type","url","formControlName","website","placeholder","https://esempio.it",1,"form-input"],["formControlName","legal_form",1,"form-input"],["value","","disabled","","selected",""],[3,"value",4,"ngFor","ngForOf"],["formControlName","category",1,"form-input"],[1,"form-group",2,"grid-column","1 / -1"],["formGroupName","opening_hours",2,"display","flex","flex-direction","column","gap","0.5rem"],["class","opening-row","style","display:flex; gap:0.5rem; align-items:center;",3,"formGroupName","closed",4,"ngFor","ngForOf"],[1,"text-muted",2,"font-size","0.9rem","margin-top","0.35rem"],[1,"error-messages"],["class","error",4,"ngIf"],[1,"error"],[3,"value"],[1,"opening-row",2,"display","flex","gap","0.5rem","align-items","center",3,"formGroupName"],[2,"width","110px","font-weight","600"],["type","time","formControlName","open",1,"form-input",2,"width","140px",3,"disabled","aria-label"],["type","time","formControlName","close",1,"form-input",2,"width","140px",3,"disabled","aria-label"],[1,"closed-label",2,"display","flex","align-items","center","gap","0.3rem","margin-left","0.5rem"],["type","checkbox","formControlName","closed",3,"aria-label"],["type","text","formControlName","first_name",1,"form-input"],["type","text","formControlName","last_name",1,"form-input"],["type","email","formControlName","email",1,"form-input"],["type","tel","formControlName","phone",1,"form-input"],["type","password","formControlName","password",1,"form-input"],["type","password","formControlName","confirmPassword",1,"form-input"],[1,"status-message","error"],[1,"status-message","info"]],template:function(e,i){e&1&&(u(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),d(5,"Crea il Tuo Account"),l(),u(6,"p",5),d(7,"Seleziona il tipo di registrazione"),l()()(),u(8,"div",6)(9,"button",7),S("click",function(){return i.setMode("admin")}),d(10,"Azienda / Admin"),l(),u(11,"button",7),S("click",function(){return i.setMode("user")}),d(12,"Dipendente"),l()(),u(13,"form",8),S("ngSubmit",function(){return i.onSubmit()}),E(14,Jk,57,5,"div",9)(15,Qk,30,1,"div",9),u(16,"div",10)(17,"div",11)(18,"label",12),N(19,"input",13),d(20," Accetto i "),u(21,"a",14),d(22,"Termini e Condizioni"),l(),d(23," e la "),u(24,"a",14),d(25,"Privacy"),l(),d(26," * "),l(),E(27,Xk,3,0,"div",15),l()(),E(28,e2,2,1,"div",16)(29,t2,2,1,"div",17),u(30,"div",18)(31,"button",19),S("click",function(){return i.goToLogin()}),d(32,"Annulla"),l(),u(33,"button",20),E(34,n2,2,0,"span",21)(35,i2,2,0,"span",21),l()()()()()),e&2&&(p(9),we("active",i.mode==="admin"),p(2),we("active",i.mode==="user"),p(2),_("formGroup",i.registerForm),p(),_("ngIf",i.mode==="admin"),p(),_("ngIf",i.mode==="user"||i.mode==="admin"),p(12),_("ngIf",(i.terms==null?null:i.terms.invalid)&&(i.terms==null?null:i.terms.touched)),p(),_("ngIf",i.errorMessage),p(),_("ngIf",i.successMessage),p(2),_("disabled",i.isLoading),p(2),_("disabled",i.isLoading||i.registerForm.invalid),p(),_("ngIf",!i.isLoading),p(),_("ngIf",i.isLoading))},dependencies:[_e,qe,Ee,wi,Rn,Vt,zt,Ne,ho,wt,Pe,An,On,Xn,Fs],styles:[".opening-row[_ngcontent-%COMP%]{padding:.35rem 0;align-items:center;transition:opacity .18s ease,background-color .18s ease}.opening-row[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{height:40px;padding:.45rem .75rem}.opening-row.closed[_ngcontent-%COMP%]{opacity:.6;pointer-events:auto;background:color-mix(in srgb,var(--background) 92%,transparent);border-radius:8px;padding-left:.5rem}.opening-row[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]:disabled{background:color-mix(in srgb,var(--smoke-color-1) 6%,var(--background));border-color:color-mix(in srgb,var(--smoke-color-1) 45%,transparent);color:color-mix(in srgb,var(--text-color) 60%,transparent);cursor:not-allowed;box-shadow:none}.closed-label[_ngcontent-%COMP%]   .text-muted[_ngcontent-%COMP%]{font-size:.92rem;color:color-mix(in srgb,var(--text-color) 60%,transparent);font-weight:600}@media (max-width: 640px){.opening-row[_ngcontent-%COMP%]{flex-wrap:wrap;gap:.4rem}.opening-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{width:100%;font-size:.95rem}.opening-row[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{width:48%;min-width:120px}}"]})};function s2(n,t){n&1&&d(0," Email obbligatoria ")}function a2(n,t){n&1&&d(0," Inserisci un indirizzo email valido ")}function l2(n,t){if(n&1&&(u(0,"div",14),Z(1,s2,1,0),Z(2,a2,1,0),l()),n&2){let e,i,r=v();p(),J(!((e=r.forgotPasswordForm.get("email"))==null||e.errors==null)&&e.errors.required?1:-1),p(),J(!((i=r.forgotPasswordForm.get("email"))==null||i.errors==null)&&i.errors.email?2:-1)}}function c2(n,t){if(n&1&&(u(0,"div",23)(1,"span",4),d(2,"error"),l(),d(3),l()),n&2){let e=v();p(3),O(" ",e.errorMessage," ")}}function u2(n,t){if(n&1&&(u(0,"div",24)(1,"span",4),d(2,"check_circle"),l(),d(3),l()),n&2){let e=v();p(3),O(" ",e.successMessage," ")}}function d2(n,t){n&1&&(u(0,"span",4),d(1,"send"),l())}function f2(n,t){n&1&&N(0,"span",28)}var rp=class n{constructor(t,e,i){this.fb=t;this.authService=e;this.router=i;this.forgotPasswordForm=this.fb.group({email:["",[Q.required,Q.email]]})}forgotPasswordForm;isLoading=!1;errorMessage="";successMessage="";ngOnInit(){}onSubmit(){return b(this,null,function*(){if(this.forgotPasswordForm.invalid){this.markFormGroupTouched();return}this.isLoading=!0,this.errorMessage="",this.successMessage="";try{let t=this.forgotPasswordForm.get("email")?.value;yield this.simulaInvioEmailReset(t),this.successMessage="Email di recupero inviata! Controlla la tua casella di posta.",this.forgotPasswordForm.reset(),setTimeout(()=>{this.router.navigate(["/login"])},3e3)}catch(t){console.error("Errore nel recupero password:",t),this.errorMessage=this.getErrorMessage(t)}finally{this.isLoading=!1}})}markFormGroupTouched(){Object.keys(this.forgotPasswordForm.controls).forEach(t=>{this.forgotPasswordForm.get(t)?.markAsTouched()})}simulaInvioEmailReset(t){return b(this,null,function*(){return new Promise((e,i)=>{setTimeout(()=>{Math.random()<.1?i({code:"NETWORK_ERROR",message:"Errore di connessione. Riprova pi\xF9 tardi."}):e()},1500)})})}getErrorMessage(t){return t?.code==="NETWORK_ERROR"?t.message:t?.code==="USER_NOT_FOUND"?"Nessun account trovato con questa email.":t?.code==="TOO_MANY_REQUESTS"?"Troppi tentativi. Riprova pi\xF9 tardi.":"Si \xE8 verificato un errore. Riprova pi\xF9 tardi."}hasError(t,e){let i=this.forgotPasswordForm.get(t);return i?i.hasError(e)&&i.touched:!1}static \u0275fac=function(e){return new(e||n)(C(bi),C(he),C(Se))};static \u0275cmp=ge({type:n,selectors:[["app-forgot-password"]],decls:73,vars:8,consts:[[1,"gradient-container"],[1,"form-card"],[1,"section-header"],[1,"header-icon"],[1,"material-icons"],[1,"section-titles"],[1,"section-title"],[1,"text-muted"],[1,"generic-form",3,"ngSubmit","formGroup"],[1,"form-section"],[1,"grid-form"],[1,"filter-group"],[1,"form-label"],["type","email","formControlName","email","placeholder","inserisci la tua email","autocomplete","email"],[1,"error"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-content"],[1,"info-item"],[1,"contact-info"],[1,"info-label"],[1,"info-value"],[1,"status-message","error"],[1,"status-message","info"],[1,"form-actions"],["type","button","routerLink","/login",1,"promethea-button","ghost"],["type","submit",1,"promethea-button",3,"disabled"],[1,"loading-spinner"],[1,"form-footer"],["routerLink","/support",1,"link"]],template:function(e,i){if(e&1&&(u(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),d(5,"key"),l()(),u(6,"div",5)(7,"h1",6),d(8,"Recupera Password"),l(),u(9,"p",7),d(10,"Inserisci la tua email per reimpostare la password"),l()()(),u(11,"form",8),S("ngSubmit",function(){return i.onSubmit()}),u(12,"div",9)(13,"h2",6)(14,"span",4),d(15,"email"),l(),d(16," Informazioni Account "),l(),u(17,"div",10)(18,"div",11)(19,"label",12)(20,"span",4),d(21,"alternate_email"),l(),d(22," Email * "),l(),N(23,"input",13),Z(24,l2,3,2,"div",14),l()()(),u(25,"div",9)(26,"div",15)(27,"div",16)(28,"span",4),d(29,"info"),l(),u(30,"h3",17),d(31,"Cosa succede dopo?"),l()(),u(32,"div",18)(33,"div",19)(34,"span",4),d(35,"send"),l(),u(36,"div",20)(37,"span",21),d(38,"Invio email"),l(),u(39,"span",22),d(40,"Riceverai un link per reimpostare la password"),l()()(),u(41,"div",19)(42,"span",4),d(43,"schedule"),l(),u(44,"div",20)(45,"span",21),d(46,"Validit\xE0"),l(),u(47,"span",22),d(48,"Il link scade dopo 24 ore"),l()()(),u(49,"div",19)(50,"span",4),d(51,"security"),l(),u(52,"div",20)(53,"span",21),d(54,"Sicurezza"),l(),u(55,"span",22),d(56,"Il link \xE8 personale e sicuro"),l()()()()()(),Z(57,c2,4,1,"div",23),Z(58,u2,4,1,"div",24),u(59,"div",25)(60,"button",26)(61,"span",4),d(62,"arrow_back"),l(),d(63," Torna al Login "),l(),u(64,"button",27),Z(65,d2,2,0,"span",4),Z(66,f2,1,0,"span",28),d(67),l()(),u(68,"div",29)(69,"p",7),d(70," Problemi? "),u(71,"a",30),d(72,"Contatta il supporto"),l()()()()()()),e&2){let r;p(11),_("formGroup",i.forgotPasswordForm),p(13),J((r=i.forgotPasswordForm.get("email"))!=null&&r.invalid&&((r=i.forgotPasswordForm.get("email"))!=null&&r.touched)?24:-1),p(33),J(i.errorMessage?57:-1),p(),J(i.successMessage?58:-1),p(6),_("disabled",i.forgotPasswordForm.invalid||i.isLoading),p(),J(i.isLoading?-1:65),p(),J(i.isLoading?66:-1),p(),O(" ",i.isLoading?"Invio in corso...":"Invia Link di Reset"," ")}},dependencies:[_e,wi,Rn,Ne,Pe,An,On,Xn,At,jt],styles:["[_nghost-%COMP%]{display:block;width:100%}@media (max-width: 768px){.form-card[_ngcontent-%COMP%]{max-width:95%!important;padding:var(--gutter-lg)!important}.form-actions[_ngcontent-%COMP%]{flex-direction:column;gap:var(--gutter-sm)}.form-actions[_ngcontent-%COMP%]   .promethea-button[_ngcontent-%COMP%]{width:100%;justify-content:center}}"]})};var xt=class n{constructor(t,e,i){this.http=t;this.authService=e;this.supabaseService=i}timbrature=Be([]);base="/api/timbrature";getRecent(t=10){let e=this.authService.getAuthHeaders();return this.http.get(`${this.base}?limit=${t}`,{headers:e})}approve(t){let e=this.authService.getAuthHeaders();return this.http.post(`${this.base}/${t}/approve`,{},{headers:e})}punchIn(){let t=this.authService.getAuthHeaders();return this.http.post(`${this.base}/punch-in`,{},{headers:t})}punchOut(){let t=this.authService.getAuthHeaders();return this.http.post(`${this.base}/punch-out`,{},{headers:t})}eliminaTimbratura(t){let e=this.authService.getAuthHeaders();return this.http.delete(`${this.base}/${t}`,{headers:e})}getTimbraturaBId(t){return b(this,null,function*(){try{let e=this.supabaseService.getClient(),{data:i,error:r}=yield e.from("timbrature").select("*, user:users(id,first_name,last_name,role)").eq("id",t).maybeSingle();if(r)throw console.error("[TimbratureService] getTimbraturaBId error",r),r;return i}catch(e){throw console.error("[TimbratureService] getTimbraturaBId unexpected",e),e}})}creaRichiestaModifica(t){return b(this,null,function*(){try{let e=this.supabaseService.getClient(),{data:i,error:r}=yield e.from("richieste_modifica_timbrature").insert(t).select().maybeSingle();if(r)throw console.error("[TimbratureService] creaRichiestaModifica error",r),r;return i}catch(e){throw console.error("[TimbratureService] creaRichiestaModifica unexpected",e),e}})}aggiornaTimbratura(t,e){return b(this,null,function*(){try{let i=this.supabaseService.getClient(),{data:r,error:o}=yield i.from("timbrature").update(e).eq("id",t).select().maybeSingle();if(o)throw console.error("[TimbratureService] aggiornaTimbratura error",o),o;return r}catch(i){throw console.error("[TimbratureService] aggiornaTimbratura unexpected",i),i}})}creaTimbraturaSupabase(t){return b(this,null,function*(){let e=this.supabaseService.getClient(),{data:i,error:r}=yield e.from("timbrature").insert(t).select().maybeSingle();if(r)throw console.error("[TimbratureService] creaTimbraturaSupabase error",r),r;return i})}getTimbraturePerGiorno(t,e){return e.filter(i=>{let r=new Date(i.start_ts);return this.isStessoGiorno(r,t)})}isStessoGiorno(t,e){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()}formattaOrarioTimbratura(t){let e=new Date(t.start_ts),i=t.end_ts?new Date(t.end_ts):null,r=e.toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"});if(i){let o=i.toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"}),s=t.total_minutes||Math.round((i.getTime()-e.getTime())/(1e3*60)),a=Math.floor(s/60),c=s%60;return`${r} - ${o} (${a}h ${c}m)`}else return`${r} - In corso`}getColoreTimbratura(t){return t.end_ts?"var(--primary)":"#ef4444"}getTimbratureUtente(t){return b(this,null,function*(){try{let e=this.supabaseService.getClient(),{data:i,error:r}=yield e.from("timbrature").select("*, user:users(id,first_name,last_name,role)").eq("user_id",t).order("start_ts",{ascending:!1});if(r)throw console.error("[TimbratureService] getTimbratureUtente error",r),r;return i??[]}catch(e){throw console.error("[TimbratureService] getTimbratureUtente unexpected",e),e}})}getTimbratureAzienda(t){return b(this,null,function*(){try{let e=this.supabaseService.getClient(),{data:i,error:r}=yield e.from("timbrature").select("*, user:users(id,first_name,last_name,role)").eq("company_id",t).order("start_ts",{ascending:!1});if(r)throw console.error("[TimbratureService] getTimbratureAzienda error",r),r;return i??[]}catch(e){throw console.error("[TimbratureService] getTimbratureAzienda unexpected",e),e}})}creaTimbratura(t){return b(this,null,function*(){try{let e=this.supabaseService.getClient(),{data:i,error:r}=yield e.from("timbrature").insert(t).select().maybeSingle();if(r)throw console.error("[TimbratureService] creaTimbratura error",r),r;return i}catch(e){throw console.error("[TimbratureService] creaTimbratura unexpected",e),e}})}getTimbraturePerCalendario(){return b(this,null,function*(){try{let t=this.supabaseService.getClient(),{data:e,error:i}=yield t.from("timbrature").select("*, user:users(id,first_name,last_name,role)").order("start_ts",{ascending:!1});if(i)throw console.error("[TimbratureService] getTimbraturePerCalendario error",i),i;return e??[]}catch(t){throw console.error("[TimbratureService] getTimbraturePerCalendario unexpected",t),t}})}static \u0275fac=function(e){return new(e||n)(L(pi),L(he),L(Ct))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};function p2(n,t){if(n&1&&(u(0,"p",10),d(1),l()),n&2){let e=v();p(),O("Benvenuto in ",e.company.name)}}function h2(n,t){n&1&&(u(0,"div",11),N(1,"div",12),u(2,"p"),d(3,"Caricamento dati..."),l()())}function m2(n,t){if(n&1&&(hn(0),d(1),mn()),n&2){let e=v(2);p(),O(" ",e.timbratureService.formattaOrarioTimbratura(e.todaysTimbratura)," ")}}function g2(n,t){n&1&&(u(0,"div",27),d(1,"Non presente"),l())}function v2(n,t){if(n&1&&(u(0,"div",15)(1,"h3",16),d(2,"Dipendenti Attivi"),l(),u(3,"div",17),d(4),l(),u(5,"p",10),d(6,"Nell'azienda"),l()()),n&2){let e=v(2);p(4),R(e.getDipendentiAttivi())}}function _2(n,t){n&1&&(u(0,"button",28)(1,"span",4),d(2,"people"),l(),d(3," Gestisci Dipendenti "),l())}function y2(n,t){if(n&1){let e=j();u(0,"div",13)(1,"div",14)(2,"div",15)(3,"h3",16),d(4,"Ore Lavorate"),l(),u(5,"div",17),d(6),K(7,"number"),l(),u(8,"p",10),d(9),l()(),u(10,"div",15)(11,"h3",16),d(12,"Timbrature Oggi"),l(),u(13,"div",17),E(14,m2,2,1,"ng-container",18)(15,g2,2,0,"ng-template",null,0,to),l(),u(17,"p",10),d(18),l()(),E(19,v2,7,1,"div",19),u(20,"div",15)(21,"h3",16),d(22,"Stato"),l(),u(23,"div",17)(24,"span",20),d(25),l()(),u(26,"p",10),d(27,"Il tuo account"),l()()(),u(28,"div",21)(29,"h2",6)(30,"span",4),d(31,"flash_on"),l(),d(32," Azioni Rapide "),l(),u(33,"div",22)(34,"button",23),S("click",function(){D(e);let r=v();return I(r.nuovaTimbraturaWithCheck())}),u(35,"span",4),d(36,"add_circle"),l(),d(37," Nuova Timbratura "),l(),u(38,"button",24)(39,"span",4),d(40,"list"),l(),d(41," Vedi Timbrature "),l(),u(42,"button",25)(43,"span",4),d(44,"settings"),l(),d(45," Impostazioni "),l(),E(46,_2,4,0,"button",26),l()()()}if(n&2){let e=zi(16),i=v();p(6),O("",te(7,10,i.getOreLavorateMese(),"1.1-1"),"h"),p(3),O(" ",(i.currentUser==null?null:i.currentUser.role)==="employee"?"Tue ore questo mese":"Totale ore questo mese"," "),p(5),_("ngIf",i.todaysTimbratura)("ngIfElse",e),p(4),O(" ",(i.currentUser==null?null:i.currentUser.role)==="employee"?"La tua timbratura di oggi":"Timbratura di oggi"," "),p(),_("ngIf",i.hasRole("admin")||i.hasRole("manager")),p(5),hr(i.currentUser!=null&&i.currentUser.is_active?"active":"inactive"),p(),O(" ",i.currentUser!=null&&i.currentUser.is_active?"Attivo":"Inattivo"," "),p(21),_("ngIf",i.hasRole("admin"))}}var op=class n{constructor(t,e,i,r){this.authService=t;this.companyService=e;this.timbratureService=i;this.router=r}currentUser=null;company=null;timbrature=[];todaysTimbratura=null;dipendenti=[];isLoading=!0;ngOnInit(){this.authService.currentUser$.subscribe(t=>{this.currentUser=t,t&&this.caricaDatiHome(t.company_id)})}caricaDatiHome(t){return b(this,null,function*(){this.isLoading=!0;try{this.companyService.getAzienda(t).subscribe({next:e=>{this.company=e},error:e=>{console.error("Errore nel caricamento dati azienda:",e)}}),this.currentUser&&(this.currentUser.role==="employee"?this.timbrature=yield this.timbratureService.getTimbratureUtente(this.currentUser.id):this.currentUser.role==="admin"?this.timbrature=yield this.timbratureService.getTimbratureAzienda(t):this.currentUser.role==="manager"&&(this.timbrature=yield this.timbratureService.getTimbratureUtente(this.currentUser.id)),this.updateTodayTimbratura()),this.hasRole("admin")||this.hasRole("manager")?this.companyService.getDipendenti(t).subscribe({next:e=>{this.dipendenti=e,this.isLoading=!1},error:e=>{console.error("Errore nel caricamento dipendenti:",e),this.isLoading=!1}}):this.isLoading=!1}catch(e){console.error("Errore nel caricamento dati home:",e),this.isLoading=!1}})}hasRole(t){return this.authService.hasRole(t)}getOreLavorateSettimana(){if(!this.timbrature||this.timbrature.length===0)return 0;let{inizioSettimana:t,oggi:e}=this.getIntervaloSettimanaCorrente(),i=this.timbrature.filter(s=>{if(!s.end_ts)return!1;let a=new Date(s.start_ts);return a>=t&&a<=e}),r=i;return this.currentUser?.role==="employee"&&(r=i.filter(s=>s.user_id===this.currentUser?.id)),r.reduce((s,a)=>s+(a.total_minutes||0),0)/60}getTimbratureOggi(){if(!this.timbrature||this.timbrature.length===0)return 0;let t=new Date;t.setHours(0,0,0,0);let e=new Date(t);e.setDate(e.getDate()+1);let i=this.timbrature.filter(r=>{let o=new Date(r.start_ts);return o>=t&&o<e});return this.currentUser?.role==="employee"?i.filter(r=>r.user_id===this.currentUser?.id).length:i.length}getDipendentiAttivi(){return this.dipendenti.filter(t=>t.is_active).length}getIntervaloSettimanaCorrente(){let t=new Date;t.setHours(23,59,59,999);let e=t.getDay(),i=e===0?6:e-1,r=new Date(t);return r.setDate(t.getDate()-i),r.setHours(0,0,0,0),{inizioSettimana:r,oggi:t}}nuovaTimbraturaWithCheck(){return b(this,null,function*(){try{if(!this.currentUser){this.router.navigate(["/crea-timbratura"]);return}let t=yield this.timbratureService.getTimbratureUtente(this.currentUser.id),e=new Date;e.setHours(0,0,0,0);let i=new Date(e);i.setDate(i.getDate()+1);let r=t.find(o=>{let s=new Date(o.start_ts);return s>=e&&s<i});if(r){let o=new Date(r.start_ts).toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"});window.confirm(`\xC8 gi\xE0 presente una timbratura in data di oggi con ingresso alle ${o}.
Vuoi modificarla?`)&&this.router.navigate(["/crea-timbratura"],{queryParams:{edit:r.id,mode:"edit"}})}else this.router.navigate(["/crea-timbratura"])}catch(t){console.error("[Home] nuovaTimbraturaWithCheck error",t),this.router.navigate(["/crea-timbratura"])}})}updateTodayTimbratura(){if(this.todaysTimbratura=null,!this.currentUser||!this.timbrature||!this.timbrature.length)return;let t=new Date;t.setHours(0,0,0,0);let e=new Date(t);e.setDate(t.getDate()+1);let i=this.timbrature.find(r=>{if(!r?.start_ts)return!1;let o=new Date(r.start_ts);return o>=t&&o<e&&(this.currentUser?.role==="admin"||r.user_id===this.currentUser?.id)})||null;this.todaysTimbratura=i}getOreLavorateMese(){if(!this.timbrature||!this.timbrature.length)return 0;let t=new Date,e=t.getFullYear(),i=t.getMonth(),r=0;for(let o of this.timbrature){if(!o?.start_ts)continue;let s=new Date(o.start_ts);if(!(s.getFullYear()!==e||s.getMonth()!==i)){if(typeof o.total_minutes=="number"){r+=o.total_minutes;continue}if(o.end_ts){let a=new Date(o.end_ts),f=Math.max(0,Math.round((a.getTime()-s.getTime())/6e4)),h=o.breaks;if(Array.isArray(h)&&h.length){for(let m of h)if(typeof m=="number")f-=m;else if(typeof m?.minutes=="number")f-=m.minutes;else if(m?.start&&m?.end){let y=new Date(m.start),g=new Date(m.end);f-=Math.max(0,Math.round((g.getTime()-y.getTime())/6e4))}}r+=Math.max(0,f)}}}return r/60}static \u0275fac=function(e){return new(e||n)(C(he),C(St),C(xt),C(Se))};static \u0275cmp=ge({type:n,selectors:[["app-home"]],decls:11,vars:3,consts:[["noTimbr",""],[1,"page-container"],[1,"section-header"],[1,"header-icon"],[1,"material-icons"],[1,"section-titles"],[1,"section-title"],["class","text-muted",4,"ngIf"],["class","loading-container",4,"ngIf"],["class","dashboard-grid",4,"ngIf"],[1,"text-muted"],[1,"loading-container"],[1,"loading-spinner"],[1,"dashboard-grid"],[1,"grid-cards"],[1,"card"],[1,"card-title"],[1,"card-number"],[4,"ngIf","ngIfElse"],["class","card",4,"ngIf"],[1,"chip"],[1,"form-section"],[1,"grid-alternative"],["type","button",1,"promethea-button",3,"click"],["routerLink","/timbrature",1,"promethea-button","outline"],["routerLink","/impostazioni",1,"promethea-button","secondary"],["class","promethea-button ghost","routerLink","/dipendenti",4,"ngIf"],[1,"muted"],["routerLink","/dipendenti",1,"promethea-button","ghost"]],template:function(e,i){e&1&&(u(0,"div",1)(1,"div",2)(2,"div",3)(3,"span",4),d(4,"dashboard"),l()(),u(5,"div",5)(6,"h1",6),d(7,"Dashboard"),l(),E(8,p2,2,1,"p",7),l()(),E(9,h2,4,0,"div",8)(10,y2,47,13,"div",9),l()),e&2&&(p(8),_("ngIf",i.company),p(),_("ngIf",i.isLoading),p(),_("ngIf",!i.isLoading))},dependencies:[_e,Ee,At,jt,Yt],encapsulation:2})};function b2(n,t){n&1&&(u(0,"th"),d(1,"Dipendente"),l())}function w2(n,t){if(n&1&&(u(0,"td")(1,"div",30)(2,"div",31),d(3),l(),u(4,"div",32)(5,"strong"),d(6),l()()()()),n&2){let e=v().$implicit,i=v();p(3),O(" ",i.getInitials(e.user==null?null:e.user.first_name,e.user==null?null:e.user.last_name)," "),p(3),be("",e.user==null?null:e.user.first_name," ",e.user==null?null:e.user.last_name)}}function E2(n,t){if(n&1&&(u(0,"span"),d(1),l()),n&2){let e=v().$implicit;p(),O(" ",e.breaks.length," ")}}function C2(n,t){n&1&&(u(0,"span"),d(1,"-"),l())}function S2(n,t){if(n&1&&(u(0,"span",33),d(1),l()),n&2){let e=v().$implicit,i=v();_("title",e.notes),p(),O(" ",i.troncaTesto(e.notes,30)," ")}}function x2(n,t){n&1&&(u(0,"span"),d(1,"-"),l())}function D2(n,t){if(n&1){let e=j();u(0,"tr"),E(1,w2,7,3,"td",22),u(2,"td"),d(3),K(4,"date"),l(),u(5,"td"),d(6),K(7,"date"),l(),u(8,"td"),d(9),K(10,"date"),l(),u(11,"td"),d(12),K(13,"number"),l(),u(14,"td"),E(15,E2,2,1,"span",22)(16,C2,2,0,"span",22),l(),u(17,"td"),E(18,S2,2,2,"span",26)(19,x2,2,0,"span",22),l(),u(20,"td")(21,"div",27)(22,"button",28),S("click",function(){let r=D(e).$implicit,o=v();return I(o.visualizzaTimbratura(r))}),u(23,"span",3),d(24,"visibility"),l()(),u(25,"button",29),S("click",function(){let r=D(e).$implicit,o=v();return I(o.eliminaTimbratura(r))}),u(26,"span",3),d(27,"delete"),l()()()()()}if(n&2){let e=t.$implicit,i=v();p(),_("ngIf",i.hasRole("admin")),p(2),R(te(4,9,e.start_ts,"dd/MM/yyyy")),p(3),R(te(7,12,e.start_ts,"HH:mm")),p(3),R(e.end_ts?te(10,15,e.end_ts,"HH:mm"):"In corso..."),p(3),O("",te(13,18,e.total_minutes/60,"1.1-1"),"h"),p(3),_("ngIf",e.breaks&&e.breaks.length>0),p(),_("ngIf",!e.breaks||e.breaks.length===0),p(2),_("ngIf",e.notes),p(),_("ngIf",!e.notes)}}function I2(n,t){n&1&&(u(0,"div",34)(1,"span",3),d(2,"inbox"),l(),u(3,"h3"),d(4,"Nessuna timbratura trovata"),l(),u(5,"p"),d(6,"Non sono state trovate timbrature con i filtri attuali."),l()())}function T2(n,t){if(n&1&&(u(0,"div",35)(1,"div",36),d(2),l()()),n&2){let e=v();p(2),be(" Mostrando ",e.timbratureFiltrate.length," di ",e.timbrature.length," timbrature ")}}var sp=class n{constructor(t,e,i,r){this.timbratureService=t;this.authService=e;this.companyService=i;this.router=r}timbrature=[];timbratureFiltrate=[];currentUser=null;isLoading=!1;filtroDataInizio="";filtroDataFine="";filtroStato="";filtroOggi=!1;ngOnInit(){this.authService.currentUser$.subscribe(t=>{this.currentUser=t,t?this.caricaTimbrature():(this.timbrature=[],this.timbratureFiltrate=[])})}caricaTimbrature(){return b(this,null,function*(){if(this.currentUser){this.isLoading=!0;try{let t=[],e=this.currentUser;if(e.role==="employee")t=yield this.timbratureService.getTimbratureUtente(e.id);else if(e.role==="admin")t=yield this.timbratureService.getTimbratureAzienda(e.company_id);else if(e.role==="manager"){let i=yield this.timbratureService.getTimbraturePerCalendario(),s=(((yield this.companyService.getAzienda(e.company_id).toPromise)?yield this.companyService.getAzienda(e.company_id).toPromise():yield this.companyService.getAzienda(e.company_id))?.manager_visibility??{})[e.id]??{mode:"self",user_ids:[],roles:[]};if(s.mode==="self")t=i.filter(a=>a.user_id===e.id);else if(s.mode==="selected_users"){let a=Array.isArray(s.user_ids)?s.user_ids:[];t=i.filter(c=>a.includes(c.user_id))}else if(s.mode==="roles"){let a=Array.isArray(s.roles)?s.roles:[];t=i.filter(c=>!!c.user&&a.includes(c.user.role))}else t=i.filter(a=>a.user_id===e.id)}else t=yield this.timbratureService.getTimbratureUtente(e.id);this.timbrature=t||[],this.applicaFiltri()}catch(t){console.error("Errore nel caricamento delle timbrature:",t)}finally{this.isLoading=!1}}})}applicaFiltri(){let t=this.timbrature;if(this.filtroDataInizio){let e=new Date(this.filtroDataInizio);t=t.filter(i=>new Date(i.start_ts)>=e)}if(this.filtroDataFine){let e=new Date(this.filtroDataFine);e.setHours(23,59,59,999),t=t.filter(i=>new Date(i.start_ts)<=e)}if(this.filtroStato&&(this.filtroStato==="attiva"?t=t.filter(e=>!e.end_ts):this.filtroStato==="completata"&&(t=t.filter(e=>!!e.end_ts))),this.filtroOggi){let e=new Date;e.setHours(0,0,0,0);let i=new Date(e);i.setDate(i.getDate()+1),t=t.filter(r=>{let o=new Date(r.start_ts);return o>=e&&o<i})}this.timbratureFiltrate=t}filtraOggi(){this.filtroOggi=!this.filtroOggi,this.filtroOggi&&(this.filtroDataInizio="",this.filtroDataFine=""),this.applicaFiltri()}nuovaTimbraturaWithCheck(){return b(this,null,function*(){try{if(!this.currentUser){this.router.navigate(["/crea-timbratura"]);return}let t=yield this.timbratureService.getTimbratureUtente(this.currentUser.id),e=new Date;e.setHours(0,0,0,0);let i=new Date(e);i.setDate(i.getDate()+1);let r=t.find(o=>{let s=new Date(o.start_ts);return s>=e&&s<i});if(r){let o=new Date(r.start_ts).toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"});window.confirm(`\xC8 gi\xE0 presente una timbratura in data di oggi con ingresso alle ${o}.
Vuoi modificarla?`)&&this.router.navigate(["/crea-timbratura"],{queryParams:{edit:r.id,mode:"edit"}})}else this.router.navigate(["/crea-timbratura"])}catch(t){console.error("[ListaTimbrature] nuovaTimbraturaWithCheck error",t),this.router.navigate(["/crea-timbratura"])}})}visualizzaTimbratura(t){this.router.navigate(["/crea-timbratura"],{queryParams:{edit:t.id,mode:"edit"}})}eliminaTimbratura(t){confirm("Sei sicuro di voler eliminare questa timbratura?")&&console.log("Eliminazione timbratura:",t.id)}troncaTesto(t,e){return t?t.length<=e?t:t.substring(0,e)+"...":""}hasRole(t){return this.currentUser?.role===t}getInitials(t,e){if(!t&&!e)return"?";let i=t?.charAt(0)?.toUpperCase()||"",r=e?.charAt(0)?.toUpperCase()||"";return i+r}static \u0275fac=function(e){return new(e||n)(C(xt),C(he),C(St),C(Se))};static \u0275cmp=ge({type:n,selectors:[["app-lista-timbrature"]],decls:63,vars:9,consts:[[1,"page-container"],[1,"section-header"],[1,"header-icon"],[1,"material-icons"],[1,"section-titles"],[1,"section-title"],[1,"text-muted"],[1,"filters-section"],[1,"filters-container"],[1,"filter-group"],[1,"form-label"],["type","date",1,"form-control",3,"ngModelChange","change","ngModel"],[1,"form-control",3,"ngModelChange","change","ngModel"],["value",""],["value","attiva"],["value","completata"],[1,"actions-container"],[1,"promethea-button","ghost",3,"click"],[1,"promethea-button",3,"click"],[1,"table-section"],[1,"table-container"],[1,"crm-table"],[4,"ngIf"],[4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],["class","pagination-container",4,"ngIf"],["class","notes-preview",3,"title",4,"ngIf"],[1,"action-buttons"],["title","Visualizza",1,"icon-button",3,"click"],["title","Elimina",1,"icon-button",3,"click"],[1,"user-info-compact"],[1,"user-avatar-small"],[1,"user-details-compact"],[1,"notes-preview",3,"title"],[1,"empty-state"],[1,"pagination-container"],[1,"pagination-info"]],template:function(e,i){e&1&&(u(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),d(4,"view_list"),l()(),u(5,"div",4)(6,"h1",5),d(7,"Lista Timbrature"),l(),u(8,"p",6),d(9,"Visualizza e gestisci tutte le tue timbrature"),l()()(),u(10,"div",7)(11,"div",8)(12,"div",9)(13,"label",10),d(14,"Data Inizio"),l(),u(15,"input",11),G("ngModelChange",function(o){return q(i.filtroDataInizio,o)||(i.filtroDataInizio=o),o}),S("change",function(){return i.applicaFiltri()}),l()(),u(16,"div",9)(17,"label",10),d(18,"Data Fine"),l(),u(19,"input",11),G("ngModelChange",function(o){return q(i.filtroDataFine,o)||(i.filtroDataFine=o),o}),S("change",function(){return i.applicaFiltri()}),l()(),u(20,"div",9)(21,"label",10),d(22,"Stato"),l(),u(23,"select",12),G("ngModelChange",function(o){return q(i.filtroStato,o)||(i.filtroStato=o),o}),S("change",function(){return i.applicaFiltri()}),u(24,"option",13),d(25,"Tutti"),l(),u(26,"option",14),d(27,"Attive"),l(),u(28,"option",15),d(29,"Completate"),l()()()(),u(30,"div",16)(31,"button",17),S("click",function(){return i.filtraOggi()}),u(32,"span",3),d(33,"today"),l(),d(34," Oggi "),l(),u(35,"button",18),S("click",function(){return i.nuovaTimbraturaWithCheck()}),u(36,"span",3),d(37,"add"),l(),d(38," Nuova Timbratura "),l()()(),u(39,"div",19)(40,"div",20)(41,"table",21)(42,"thead")(43,"tr"),E(44,b2,2,0,"th",22),u(45,"th"),d(46,"Data"),l(),u(47,"th"),d(48,"Ora Inizio"),l(),u(49,"th"),d(50,"Ora Fine"),l(),u(51,"th"),d(52,"Ore Totali"),l(),u(53,"th"),d(54,"Pause"),l(),u(55,"th"),d(56,"Note"),l(),u(57,"th"),d(58,"Azioni"),l()()(),u(59,"tbody"),E(60,D2,28,21,"tr",23),l()()(),E(61,I2,7,0,"div",24),l(),E(62,T2,3,2,"div",25),l()),e&2&&(p(15),W("ngModel",i.filtroDataInizio),p(4),W("ngModel",i.filtroDataFine),p(4),W("ngModel",i.filtroStato),p(8),we("active",i.filtroOggi),p(13),_("ngIf",i.hasRole("admin")),p(16),_("ngForOf",i.timbratureFiltrate),p(),_("ngIf",i.timbratureFiltrate.length===0),p(),_("ngIf",i.timbratureFiltrate.length>0))},dependencies:[_e,qe,Ee,At,Et,Vt,zt,Ne,wt,Pe,ct,Yt,Xe],encapsulation:2})};function M2(n,t){n&1&&(hn(0),u(1,"span",4),d(2,"content_copy"),l(),mn())}function A2(n,t){n&1&&(hn(0),N(1,"span",32),mn())}function R2(n,t){if(n&1){let e=j();u(0,"button",31),S("click",function(){D(e);let r=v(2);return I(r.copiaGiornoPrecedente())}),E(1,M2,3,0,"ng-container",25)(2,A2,2,0,"ng-container",25),d(3," Copia Precedente "),l()}if(n&2){let e=v(2);_("disabled",e.caricandoTimbraturaPrecedente),p(),_("ngIf",!e.caricandoTimbraturaPrecedente),p(),_("ngIf",e.caricandoTimbraturaPrecedente)}}function O2(n,t){if(n&1&&(u(0,"div",29),E(1,R2,4,3,"button",30),l()),n&2){let e=v();p(),_("ngIf",e.timbraturaPrecedenteDisponibile)}}function N2(n,t){n&1&&(u(0,"div",33)(1,"div",34)(2,"span",4),d(3,"info"),l(),u(4,"div")(5,"div")(6,"strong"),d(7,"Modalit\xE0 Richiesta Modifica"),l()(),u(8,"div",35),d(9," Stai modificando una timbratura esistente. Le modifiche verranno inviate come richiesta all'amministratore che potr\xE0 approvarle o respingerle. "),l()()()())}function P2(n,t){n&1&&(u(0,"div",36)(1,"div",34)(2,"span",4),d(3,"admin_panel_settings"),l(),u(4,"div")(5,"div")(6,"strong"),d(7,"Modalit\xE0 Amministratore"),l()(),u(8,"div",35),d(9," Le modifiche verranno applicate immediatamente alla timbratura. "),l()()()())}function k2(n,t){if(n&1&&(u(0,"div",37)(1,"div",34)(2,"span",4),d(3,"warning"),l(),u(4,"div")(5,"div")(6,"strong"),d(7,"Hai gi\xE0 una timbratura per questa data"),l()(),u(8,"div",35),d(9),K(10,"date"),l()()()()),n&2){let e=v();p(9),O(" ",e.existingTimbraturaForDate?"Ingresso alle "+te(10,1,e.existingTimbraturaForDate.start_ts,"HH:mm"):"",". Non \xE8 consentito creare pi\xF9 di una timbratura nello stesso giorno. ")}}function F2(n,t){n&1&&(u(0,"span"),d(1,"Data obbligatoria"),l())}function L2(n,t){if(n&1&&(u(0,"span"),d(1),l()),n&2){let e,i=v(2);p(),R((e=i.timbraturaForm.get("data"))==null||e.errors==null||e.errors.futureDate==null?null:e.errors.futureDate.message)}}function j2(n,t){if(n&1&&(u(0,"div",18),E(1,F2,2,0,"span",25)(2,L2,2,1,"span",25),l()),n&2){let e,i,r=v();p(),_("ngIf",(e=r.timbraturaForm.get("data"))==null?null:e.hasError("required")),p(),_("ngIf",(i=r.timbraturaForm.get("data"))==null?null:i.hasError("futureDate"))}}function V2(n,t){n&1&&(u(0,"span"),d(1,"Ora ingresso obbligatoria"),l())}function z2(n,t){if(n&1&&(u(0,"span"),d(1),l()),n&2){let e,i=v(2);p(),R((e=i.timbraturaForm.get("ora_inizio"))==null||e.errors==null||e.errors.futureTime==null?null:e.errors.futureTime.message)}}function U2(n,t){if(n&1&&(u(0,"div",18),E(1,V2,2,0,"span",25)(2,z2,2,1,"span",25),l()),n&2){let e,i,r=v();p(),_("ngIf",(e=r.timbraturaForm.get("ora_inizio"))==null?null:e.hasError("required")),p(),_("ngIf",(i=r.timbraturaForm.get("ora_inizio"))==null?null:i.hasError("futureTime"))}}function B2(n,t){if(n&1&&(u(0,"div",18),d(1),l()),n&2){let e=v();p(),O(" ",e.timeRangeErrorMessage," ")}}function $2(n,t){if(n&1&&(u(0,"div",18),d(1),l()),n&2){let e,i=v();p(),O(" ",(e=i.timbraturaForm.get("ora_fine"))==null||e.errors==null||e.errors.futureTime==null?null:e.errors.futureTime.message," ")}}function H2(n,t){if(n&1){let e=j();u(0,"button",46),S("click",function(){D(e);let r=v().$index,o=v();return I(o.rimuoviPausa(r))}),u(1,"span",4),d(2,"delete"),l()()}}function W2(n,t){if(n&1&&(u(0,"div",44),d(1),l()),n&2){let e,i=v().$index,r=v();p(),O(" ",(e=r.getPausaControl(i,"inizio").errors)==null||e.futureTime==null?null:e.futureTime.message," ")}}function G2(n,t){if(n&1&&(u(0,"div",44),d(1),l()),n&2){let e,i=v().$index,r=v();p(),O(" ",(e=r.getPausaControl(i,"fine").errors)==null||e.futureTime==null?null:e.futureTime.message," ")}}function q2(n,t){if(n&1&&(u(0,"div",45),d(1),l()),n&2){let e=v().$index,i=v();p(),O(" ",i.getPauseTimeErrorMessage(e)," ")}}function K2(n,t){if(n&1&&(u(0,"div",22)(1,"div",38)(2,"div",39)(3,"span",4),d(4,"schedule"),l(),u(5,"strong"),d(6),l()(),E(7,H2,3,0,"button",40),l(),u(8,"div",41)(9,"div",42)(10,"label",15),d(11,"Inizio"),l(),N(12,"input",43),Z(13,W2,2,1,"div",44),l(),u(14,"div",42)(15,"label",15),d(16,"Fine"),l(),N(17,"input",43),Z(18,G2,2,1,"div",44),l()(),Z(19,q2,2,1,"div",45),l()),n&2){let e=t.$index,i=v();p(6),O("Pausa ",e+1),p(),_("ngIf",i.canRemovePause(e)),p(5),_("formControl",i.getPausaControl(e,"inizio")),p(),J(i.getPausaControl(e,"inizio").hasError("futureTime")?13:-1),p(4),_("formControl",i.getPausaControl(e,"fine")),p(),J(i.getPausaControl(e,"fine").hasError("futureTime")?18:-1),p(),J(i.hasPauseTimeError(e)?19:-1)}}function Y2(n,t){n&1&&(hn(0),u(1,"span",4),d(2,"my_location"),l(),mn())}function Z2(n,t){n&1&&(hn(0),N(1,"span",32),mn())}function J2(n,t){n&1&&(u(0,"div",56),d(1,"Ottenendo posizione\u2026"),l())}function Q2(n,t){if(n&1&&(u(0,"small"),d(1),K(2,"number"),l()),n&2){let e=v(3);p(),O("(",te(2,1,e.posizioneAttuale.accuracy,"1.0-0")," m)")}}function X2(n,t){if(n&1&&(u(0,"div",57)(1,"span",58),d(2,"check_circle"),l(),d(3," Posizione ottenuta "),E(4,Q2,3,4,"small",25),l()),n&2){let e=v(2);p(4),_("ngIf",e.posizioneAttuale.accuracy)}}function eF(n,t){n&1&&(u(0,"div",59),d(1,"Nessuna posizione"),l())}function tF(n,t){n&1&&(u(0,"span",75),d(1,"Disponibile"),l())}function nF(n,t){n&1&&(u(0,"span",76)(1,"span",77),d(2,"check_circle"),l(),d(3," Selezionato "),l())}function iF(n,t){if(n&1){let e=j();u(0,"button",78),S("click",function(){D(e);let r=v().$implicit,o=v(3);return I(o.selezionaPunto(r))}),u(1,"span",4),d(2,"location_on"),l(),d(3," Seleziona "),l()}}function rF(n,t){if(n&1){let e=j();u(0,"button",79),S("click",function(){D(e);let r=v(4);return I(r.deselezionaPunto())}),u(1,"span",4),d(2,"close"),l(),d(3," Deseleziona "),l()}}function oF(n,t){if(n&1&&(u(0,"div",65)(1,"div",66)(2,"div",67)(3,"strong"),d(4),l(),u(5,"div",68),d(6),l(),u(7,"div",69),d(8),l()(),u(9,"div",70),E(10,tF,2,0,"span",71)(11,nF,4,0,"span",72)(12,iF,4,0,"button",73)(13,rF,4,0,"button",74),l()()()),n&2){let e=t.$implicit,i=v(3);p(4),R((e==null?null:e.name)||"Punto di timbratura"),p(2),R(i.pointLabel(e)),p(2),O("Distanza: ",i.distanceToPoint(e)," m"),p(2),_("ngIf",!i.isPuntoSelezionato(e)),p(),_("ngIf",i.isPuntoSelezionato(e)),p(),_("ngIf",!i.isPuntoSelezionato(e)),p(),_("ngIf",i.isPuntoSelezionato(e))}}function sF(n,t){n&1&&(u(0,"div",80)(1,"div",34)(2,"span",4),d(3,"info"),l(),u(4,"div")(5,"div")(6,"strong"),d(7,"Seleziona un punto"),l()(),u(8,"div",81),d(9," Seleziona il punto di timbratura corretto per procedere. "),l()()()())}function aF(n,t){if(n&1&&(u(0,"div",82)(1,"div",34)(2,"span",4),d(3,"check_circle"),l(),u(4,"div")(5,"div")(6,"strong"),d(7,"Punto selezionato"),l()(),u(8,"div",81),d(9),l()()()()),n&2){let e=v(3);p(9),O(" ",(e.puntoSelezionato==null?null:e.puntoSelezionato.name)||"Punto di timbratura"," - Puoi procedere con la timbratura. ")}}function lF(n,t){if(n&1&&(u(0,"div",60)(1,"div",61),d(2),l(),E(3,oF,14,7,"div",62)(4,sF,10,0,"div",63)(5,aF,10,1,"div",64),l()),n&2){let e=v(2);p(2),O(" Punti di timbratura disponibili (",e.getPuntiNelRaggio().length,"): "),p(),_("ngForOf",e.getPuntiNelRaggio()),p(),_("ngIf",!e.puntoSelezionato),p(),_("ngIf",e.puntoSelezionato)}}function cF(n,t){if(n&1&&(u(0,"div",85)(1,"div",68),d(2,"Punto pi\xF9 vicino:"),l(),u(3,"div",86)(4,"strong"),d(5),l(),N(6,"br"),u(7,"span",87),d(8),l(),N(9,"br"),u(10,"span",87),d(11),l()()()),n&2){let e=v(3);p(5),R((e.nearestPoint==null?null:e.nearestPoint.name)||"Punto di timbratura"),p(3),R(e.pointLabel(e.nearestPoint)),p(3),O("Distanza: ",e.distanceToNearest," m")}}function uF(n,t){if(n&1&&(u(0,"div",83)(1,"div",34)(2,"span",4),d(3,"warning"),l(),u(4,"div")(5,"div")(6,"strong"),d(7,"Nessun punto disponibile"),l()(),u(8,"div",35),d(9,"Non ti trovi nel raggio di nessun punto di timbratura configurato."),l(),E(10,cF,12,3,"div",84),l()()()),n&2){let e=v(2);p(10),_("ngIf",e.nearestPoint)}}function dF(n,t){n&1&&(u(0,"div",88)(1,"div",34)(2,"span",4),d(3,"info"),l(),u(4,"div")(5,"div")(6,"strong"),d(7,"Posizione non verificata"),l()(),u(8,"div",35),d(9,' La tua posizione non \xE8 stata ancora verificata. Usa "Ottieni Posizione" per vedere i punti di timbratura disponibili. '),l()()()())}function fF(n,t){n&1&&(u(0,"div",89)(1,"div",34)(2,"span",4),d(3,"error"),l(),u(4,"div")(5,"div")(6,"strong"),d(7,"Non puoi timbrare"),l()(),u(8,"div",35),d(9,"Non sono configurati punti di timbratura per la tua azienda."),l()()()())}function pF(n,t){if(n&1&&(u(0,"div",89),d(1),l()),n&2){let e=v(2);p(),R(e.errorMessage)}}function hF(n,t){if(n&1&&(u(0,"div",88),d(1),l()),n&2){let e=v(2);p(),R(e.successMessage)}}function mF(n,t){if(n&1){let e=j();u(0,"div")(1,"div",14)(2,"label",15)(3,"span",4),d(4,"location_on"),l(),d(5," Posizione "),l(),u(6,"div",47)(7,"button",48),S("click",function(){D(e);let r=v();return I(r.ottieniPosizione())}),E(8,Y2,3,0,"ng-container",25)(9,Z2,2,0,"ng-container",25),d(10),l(),E(11,J2,2,0,"div",49)(12,X2,5,1,"div",50)(13,eF,2,0,"div",51),l(),E(14,lF,6,4,"div",52)(15,uF,11,1,"div",53)(16,dF,10,0,"div",54)(17,fF,10,0,"div",55)(18,pF,2,1,"div",55)(19,hF,2,1,"div",54),l()()}if(n&2){let e=v();p(7),_("disabled",e.ottenendoPosizione),p(),_("ngIf",!e.ottenendoPosizione),p(),_("ngIf",e.ottenendoPosizione),p(),O(" ",e.ottenendoPosizione?"Ottenendo...":"Ottieni Posizione"," "),p(),_("ngIf",e.ottenendoPosizione),p(),_("ngIf",!e.ottenendoPosizione&&e.posizioneAttuale),p(),_("ngIf",!e.ottenendoPosizione&&!e.posizioneAttuale),p(),_("ngIf",e.posizioneAttuale&&e.getPuntiNelRaggio().length>0),p(),_("ngIf",e.posizioneAttuale&&e.getPuntiNelRaggio().length===0),p(),_("ngIf",!e.posizioneAttuale&&!e.ottenendoPosizione),p(),_("ngIf",((e.currentCompany==null||e.currentCompany.punch_points==null?null:e.currentCompany.punch_points.length)??0)===0),p(),_("ngIf",e.errorMessage),p(),_("ngIf",e.successMessage)}}function gF(n,t){if(n&1&&(u(0,"div",91)(1,"h3",92),d(2,"Pause"),l(),u(3,"div",93),d(4),l()()),n&2){let e=v(2);p(4),R(e.formattaOreMinuti(e.calcolaPauseTotali()))}}function vF(n,t){if(n&1&&(u(0,"div",12)(1,"h2",6)(2,"span",4),d(3,"summarize"),l(),d(4," Riepilogo "),l(),u(5,"div",90)(6,"div",91)(7,"h3",92),d(8,"Ore Totali"),l(),u(9,"div",93),d(10),l()(),Z(11,gF,5,1,"div",91),u(12,"div",91)(13,"h3",92),d(14,"Ore Lavorative"),l(),u(15,"div",93),d(16),l()()()()),n&2){let e=v();p(10),R(e.formattaOreMinuti(e.calcolaOreTotali())),p(),J(e.calcolaPauseTotali()>0?11:-1),p(5),R(e.formattaOreMinuti(e.calcolaLavoroEffettivo()))}}function _F(n,t){if(n&1&&(hn(0),u(1,"span",4),d(2),l(),mn()),n&2){let e=v();p(2),R(e.isEditMode?(e.currentUser==null?null:e.currentUser.role)==="admin"?"save":"send":"save")}}function yF(n,t){n&1&&(hn(0),N(1,"span",32),mn())}var ap=class n{constructor(t,e,i,r,o,s){this.fb=t;this.timbratureService=e;this.authService=i;this.router=r;this.route=o;this.companyService=s;this.timbraturaForm=this.createForm()}POSITION_ACCURACY_THRESHOLD=150;timbraturaForm;isLoading=!1;errorMessage="";successMessage="";ottenendoPosizione=!1;posizioneAttuale=null;posizioneValida=!1;nearestPoint=null;distanceToNearest=null;currentUser=null;currentCompany=null;existingTimbraturaForDate=null;hasTimbraturaForSelectedDate=!1;requiresGeolocation=!1;timbraturaPrecedenteDisponibile=!1;caricandoTimbraturaPrecedente=!1;timbraturaPrecedente=null;isEditMode=!1;timbraturaOriginale=null;timbraturaId=null;puntoSelezionato=null;ngOnInit(){return b(this,null,function*(){let t=new Date().toISOString().split("T")[0];this.timbraturaForm.patchValue({data:t}),this.timbraturaForm.get("data")?.valueChanges.subscribe(()=>{this.timbraturaForm.get("ora_inizio")?.updateValueAndValidity(),this.timbraturaForm.get("ora_fine")?.updateValueAndValidity(),this.revalidateAllPauses(),this.checkExistingTimbraturaForDate(this.timbraturaForm.value.data).catch(e=>console.error(e))}),this.route.queryParams.subscribe(e=>{e.edit&&e.mode==="edit"&&(this.isEditMode=!0,this.timbraturaId=e.edit,this.timbraturaId&&this.caricaTimbraturaPerModifica(this.timbraturaId))}),this.authService.currentUser$.subscribe(e=>b(this,null,function*(){this.currentUser=e,e&&this.companyService.getAziendaForUser(e.id,e.company_id).subscribe({next:i=>b(this,null,function*(){this.currentCompany=i,this.requiresGeolocation=i?.timbratura_type==="punti",console.debug("[CreaTimbratura] company caricata",{id:i?.id,name:i?.name,punch_points_length:Array.isArray(i?.punch_points)?i.punch_points.length:0,punch_points:i?.punch_points}),this.isEditMode||(yield this.verificaTimbraturaPrecedente(),this.checkExistingTimbraturaForDate(this.timbraturaForm.value.data).catch(r=>console.error(r)))}),error:i=>console.error("[CreaTimbratura] errore carica azienda",i)})}))})}checkExistingTimbraturaForDate(t){return b(this,null,function*(){try{if(this.existingTimbraturaForDate=null,this.hasTimbraturaForSelectedDate=!1,!this.currentUser||!t)return;let e=yield this.timbratureService.getTimbratureUtente(this.currentUser.id),i=new Date(t);i.setHours(0,0,0,0);let r=e.find(o=>{if(!o.start_ts)return!1;let s=new Date(o.start_ts);return s.setHours(0,0,0,0),s.getTime()===i.getTime()})||null;r&&(this.existingTimbraturaForDate=r,this.hasTimbraturaForSelectedDate=!0)}catch(e){throw console.error("[CreaTimbratura] checkExistingTimbraturaForDate error",e),this.hasTimbraturaForSelectedDate=!1,this.existingTimbraturaForDate=null,e}})}caricaTimbraturaPerModifica(t){return b(this,null,function*(){try{if(this.isLoading=!0,this.timbraturaOriginale=yield this.timbratureService.getTimbraturaBId(t),!this.timbraturaOriginale){this.errorMessage="Timbratura non trovata",this.router.navigate(["/lista-timbrature"]);return}if(this.currentUser?.role!=="admin"&&this.timbraturaOriginale.user_id!==this.currentUser?.id){this.errorMessage="Non hai i permessi per modificare questa timbratura",this.router.navigate(["/lista-timbrature"]);return}this.popolaFormConDatiEsistenti(this.timbraturaOriginale)}catch(e){console.error("Errore nel caricamento della timbratura:",e),this.errorMessage="Errore nel caricamento della timbratura",this.router.navigate(["/lista-timbrature"])}finally{this.isLoading=!1}})}verificaTimbraturaPrecedente(){return b(this,null,function*(){if(this.currentUser)try{let t=this.calcolaGiornoLavorativoPrecedente();if(!t)return;let e=yield this.timbratureService.getTimbratureUtente(this.currentUser.id);this.timbraturaPrecedente=e.find(i=>{let r=new Date(i.start_ts).toISOString().split("T")[0],o=t.toISOString().split("T")[0];return r===o})||null,this.timbraturaPrecedenteDisponibile=!!this.timbraturaPrecedente}catch(t){console.error("Errore nella verifica timbratura precedente:",t)}})}calcolaGiornoLavorativoPrecedente(){let t=new Date;t.setHours(0,0,0,0);let i=(this.currentCompany?.closed_days||[]).map(a=>{if(typeof a=="number")return a;if(typeof a=="string"){let c=parseInt(a,10);return isNaN(c)?-1:c}return-1}).filter(a=>a>=0&&a<=6),r=i.length>0?i:[0,6],o=new Date(t);o.setDate(o.getDate()-1);let s=0;for(;s<7&&r.includes(o.getDay());)o.setDate(o.getDate()-1),s++;return s<7?o:null}copiaGiornoPrecedente(){return b(this,null,function*(){if(this.timbraturaPrecedente){this.caricandoTimbraturaPrecedente=!0;try{let t=this.timbraturaPrecedente,e=new Date(t.start_ts),i=t.end_ts?new Date(t.end_ts):null;if(this.timbraturaForm.patchValue({ora_inizio:e.toTimeString().substring(0,5),ora_fine:i?i.toTimeString().substring(0,5):"",notes:t.notes||""}),t.breaks&&Array.isArray(t.breaks)){for(;this.pause.length>0;)this.pause.removeAt(0);t.breaks.length>0?t.breaks.forEach(r=>{let o=new Date(r.start),s=new Date(r.end),a=this.fb.group({inizio:[o.toTimeString().substring(0,5),this.noFutureTimeValidator.bind(this)],fine:[s.toTimeString().substring(0,5),this.noFutureTimeValidator.bind(this)]},{validators:this.pauseTimeRangeValidator});this.pause.push(a)}):this.pause.push(this.creaPausaGroup())}if(t.locations&&Array.isArray(t.locations)&&t.locations.length>0){let r=t.locations[0];if(this.posizioneAttuale={lat:r.lat,lng:r.lng,indirizzo:r.address,timestamp:new Date,accuracy:0},this.posizioneValida=!0,this.currentCompany?.timbratura_type==="punti"){let o=this.checkInsidePoints(this.posizioneAttuale);this.posizioneValida=o.inside,this.nearestPoint=o.nearest,this.distanceToNearest=o.distance}}this.successMessage="Dati copiati dal giorno lavorativo precedente!",setTimeout(()=>this.successMessage="",3e3)}catch(t){console.error("Errore nella copia:",t),this.errorMessage="Errore durante la copia dei dati precedenti",setTimeout(()=>this.errorMessage="",3e3)}finally{this.caricandoTimbraturaPrecedente=!1}}})}formattaOreMinuti(t){let e=Math.floor(t),i=Math.round((t-e)*60);return e===0&&i===0?"0h":e===0?`${i}m`:i===0?`${e}h`:`${e}h ${i}m`}popolaFormConDatiEsistenti(t){let e=new Date(t.start_ts),i=t.end_ts?new Date(t.end_ts):null;if(this.timbraturaForm.patchValue({data:e.toISOString().split("T")[0],ora_inizio:e.toTimeString().substring(0,5),ora_fine:i?i.toTimeString().substring(0,5):"",notes:t.notes||""}),t.breaks&&Array.isArray(t.breaks)){for(;this.pause.length>0;)this.pause.removeAt(0);t.breaks.forEach(r=>{let o=new Date(r.start),s=new Date(r.end),a=this.fb.group({inizio:[o.toTimeString().substring(0,5),this.noFutureTimeValidator.bind(this)],fine:[s.toTimeString().substring(0,5),this.noFutureTimeValidator.bind(this)]},{validators:this.pauseTimeRangeValidator});this.pause.push(a)})}if(this.pause.length===0&&this.pause.push(this.creaPausaGroup()),t.locations&&Array.isArray(t.locations)&&t.locations.length>0){let r=t.locations[0];this.posizioneAttuale={lat:r.lat,lng:r.lng,indirizzo:r.address,timestamp:new Date(r.timestamp),accuracy:0},this.posizioneValida=!0}}createForm(){return this.fb.group({data:["",[Q.required,this.noFutureDateValidator]],ora_inizio:["",[Q.required,this.noFutureTimeValidator.bind(this)]],ora_fine:["",this.noFutureTimeValidator.bind(this)],notes:[""],pause:this.fb.array([this.creaPausaGroup()])},{validators:this.timeRangeValidator})}noFutureTimeValidator(t){if(!t.value)return null;let e=this.timbraturaForm?.get("data");if(!e?.value)return null;let i=e.value,r=new Date().toISOString().split("T")[0];if(i!==r)return null;let o=new Date,s=`${o.getHours().toString().padStart(2,"0")}:${o.getMinutes().toString().padStart(2,"0")}`;return t.value>s?{futureTime:{message:"Non \xE8 possibile inserire orari futuri per la data odierna"}}:null}get maxTimeForToday(){let t=this.timbraturaForm?.get("data");if(!t?.value)return null;let e=t.value,i=new Date().toISOString().split("T")[0];if(e===i){let r=new Date;return`${r.getHours().toString().padStart(2,"0")}:${r.getMinutes().toString().padStart(2,"0")}`}return null}get isSelectedDateToday(){let t=this.timbraturaForm?.get("data");if(!t?.value)return!1;let e=t.value,i=new Date().toISOString().split("T")[0];return e===i}timeRangeValidator(t){let e=t.get("ora_inizio")?.value,i=t.get("ora_fine")?.value;return!e||!i?null:i<=e?{invalidTimeRange:{message:"L'ora di uscita deve essere successiva all'ora di ingresso"}}:null}get hasTimeRangeError(){return this.timbraturaForm.hasError("invalidTimeRange")}get timeRangeErrorMessage(){return this.timbraturaForm.getError("invalidTimeRange")?.message||""}noFutureDateValidator(t){if(!t.value)return null;let e=new Date(t.value),i=new Date;return i.setHours(23,59,59,999),e>i?{futureDate:{message:"Non \xE8 possibile inserire timbrature future"}}:null}get maxDate(){return new Date().toISOString().split("T")[0]}creaPausaGroup(){return this.fb.group({inizio:["",this.noFutureTimeValidator.bind(this)],fine:["",this.noFutureTimeValidator.bind(this)]},{validators:this.pauseTimeRangeValidator})}revalidateAllPauses(){this.pause.controls.forEach(t=>{t.get("inizio")?.updateValueAndValidity(),t.get("fine")?.updateValueAndValidity()})}pauseTimeRangeValidator(t){let e=t.get("inizio")?.value,i=t.get("fine")?.value;return!e||!i?null:i<=e?{invalidPauseTimeRange:{message:"La fine pausa deve essere successiva all'inizio pausa"}}:null}hasPauseTimeError(t){return this.pause.at(t).hasError("invalidPauseTimeRange")}getPauseTimeErrorMessage(t){return this.pause.at(t).getError("invalidPauseTimeRange")?.message||""}get pause(){return this.timbraturaForm.get("pause")}getPausaControl(t,e){return this.pause.at(t).get(e)}aggiungiPausa(){this.pause.push(this.creaPausaGroup())}rimuoviPausa(t){this.pause.length>1&&t>=0&&t<this.pause.length&&this.pause.removeAt(t)}isPauseUsed(t){let e=this.pause.at(t),i=e.get("inizio")?.value,r=e.get("fine")?.value;return!!(i||r)}canRemovePause(t){return this.pause.length>1&&this.isPauseUsed(t)}ottieniPosizione(){if(this.puntoSelezionato=null,this.posizioneValida=!1,this.ottenendoPosizione=!0,this.errorMessage="",this.nearestPoint=null,this.distanceToNearest=null,!navigator.geolocation){this.errorMessage="Geolocalizzazione non supportata dal browser",this.ottenendoPosizione=!1;return}let t=[],e=6,i=8e3,r=Date.now(),o=h=>{console.debug("[CreaTimbratura] sample coords",h.coords.latitude,h.coords.longitude,h.coords.accuracy),t.push(h),(typeof h.coords.accuracy=="number"&&h.coords.accuracy<=this.POSITION_ACCURACY_THRESHOLD||t.length>=e||Date.now()-r>i)&&c()},s=h=>{console.error("[CreaTimbratura] geolocation error",h),f(),this.errorMessage=h.message||"Errore nella richiesta di posizione",this.ottenendoPosizione=!1},a=navigator.geolocation.watchPosition(o,s,{enableHighAccuracy:!0,maximumAge:0,timeout:5e3}),c=()=>{let h=null;for(let m of t){if(!h){h=m;continue}let y=typeof m.coords.accuracy=="number"?m.coords.accuracy:1/0,g=typeof h.coords.accuracy=="number"?h.coords.accuracy:1/0;y<g&&(h=m)}if(h)if(console.debug("[CreaTimbratura] best sample",h.coords.latitude,h.coords.longitude,h.coords.accuracy),this.posizioneAttuale={lat:h.coords.latitude,lng:h.coords.longitude,timestamp:new Date,accuracy:h.coords.accuracy},this.currentCompany?.timbratura_type==="punti"){let m=this.checkInsidePoints(this.posizioneAttuale);this.nearestPoint=m.nearest,this.distanceToNearest=m.distance}else this.posizioneValida=!0;else this.errorMessage="Impossibile ottenere campioni di posizione";f(),this.ottenendoPosizione=!1},f=()=>{typeof a=="number"&&navigator.geolocation.clearWatch&&(navigator.geolocation.clearWatch(a),a=-1)};setTimeout(()=>{this.ottenendoPosizione&&c()},i+200)}getPuntiNelRaggio(){return!this.posizioneAttuale||this.currentCompany?.timbratura_type!=="punti"?[]:(this.currentCompany.punch_points||[]).filter(e=>this.isInsidePoint(e))}checkInsidePoints(t){let e={inside:!1,nearest:null,distance:null};if(!t||!this.currentCompany)return e;let i=this.currentCompany.punch_points||[];if(!i.length)return e;let r=null,o=Number.POSITIVE_INFINITY;console.debug("[checkInsidePoints] posizione utente",t,"punti disponibili",i.length);for(let s of i){let a=this.toNumber(s.lat),c=this.toNumber(s.lng),f=this.toNumber(s.radius_m)||50;if(!isFinite(a)||!isFinite(c)){console.warn("[checkInsidePoints] punto senza coordinate numeriche",s);continue}let h=this.distanzaMetri(t.lat,t.lng,a,c);console.debug("[checkInsidePoints] punto",{id:s.id,name:s.name,plat:a,plng:c,pradius:f,distance_m:Math.round(h)}),h<o&&(o=h,r=Y(P({},s),{lat:a,lng:c,radius_m:f}))}return r?(e.nearest=r,e.distance=Math.round(o),e.inside=o<=(r.radius_m||50),console.debug("[checkInsidePoints] nearest",e.nearest,"distance",e.distance,"inside",e.inside)):console.debug("[checkInsidePoints] nessun punto valido trovato"),e}toNumber(t){if(t==null)return NaN;if(typeof t=="number")return t;if(typeof t=="string"){let e=t.trim().replace(",",".");return Number(e)}return Number(t)}calcolaOreTotali(){let t=this.timbraturaForm.value;if(!t.ora_inizio||!t.ora_fine)return 0;let e=new Date(`2000-01-01T${t.ora_inizio}`),r=new Date(`2000-01-01T${t.ora_fine}`).getTime()-e.getTime();return Math.max(0,r/(1e3*60*60))}calcolaPauseTotali(){let t=0;return this.timbraturaForm.value.pause.forEach(i=>{if(i.inizio&&i.fine){let r=new Date(`2000-01-01T${i.inizio}`),s=new Date(`2000-01-01T${i.fine}`).getTime()-r.getTime();t+=Math.max(0,s/(1e3*60*60))}}),t}calcolaLavoroEffettivo(){let t=this.calcolaOreTotali(),e=this.calcolaPauseTotali();return Math.max(0,t-e)}preparaDatiTimbratura(){let t=this.timbraturaForm.value,e=new Date(`${t.data}T${t.ora_inizio}`),i=t.ora_fine?new Date(`${t.data}T${t.ora_fine}`):null,r=t.pause.filter(a=>a.inizio&&a.fine).map(a=>({start:new Date(`${t.data}T${a.inizio}`).toISOString(),end:new Date(`${t.data}T${a.fine}`).toISOString()})),o=this.posizioneAttuale?[{lat:this.posizioneAttuale.lat,lng:this.posizioneAttuale.lng,address:this.posizioneAttuale.indirizzo,timestamp:this.posizioneAttuale.timestamp.toISOString()}]:[],s=Math.round(this.calcolaLavoroEffettivo()*60);return{id:this.timbraturaId||void 0,start_ts:e.toISOString(),end_ts:i?.toISOString()||null,breaks:r.length>0?r:null,locations:o.length>0?o:null,notes:t.notes||null,total_minutes:s,company_id:this.currentUser?.company_id||"",user_id:this.currentUser?.id||""}}onSubmit(){return b(this,null,function*(){if(this.timbraturaForm.invalid){this.timbraturaForm.markAllAsTouched();return}if(!this.currentUser||!this.currentUser.id){this.errorMessage="Utente non autenticato";return}this.isLoading=!0,this.errorMessage="",this.successMessage="";try{let t=this.isEditMode?this.timbraturaOriginale?.id:void 0;if(this.currentUser.role!=="admin"&&(yield this.hasTimbraturaPerGiorno(this.currentUser.id,this.timbraturaForm.value.data,t))){this.isLoading=!1,this.errorMessage="Hai gi\xE0 una timbratura per questa data. Non \xE8 consentito creare pi\xF9 di una timbratura al giorno.";return}}catch(t){console.error("[CreaTimbratura] errore controllo timbratura esistente",t)}try{if(this.currentCompany?.timbratura_type==="punti"){let t=this.currentCompany.punch_points||[];if(!t.length){this.isLoading=!1,this.errorMessage="Nessun punto di timbratura configurato per l'azienda.";return}if(this.puntoSelezionato)this.posizioneAttuale=this.posizioneAttuale??{lat:Number(this.puntoSelezionato.lat),lng:Number(this.puntoSelezionato.lng),timestamp:new Date,accuracy:0},this.posizioneValida=!0;else{if(!this.posizioneAttuale)try{let r=yield this.askForPositionOnce(12e3);this.posizioneAttuale={lat:r.coords.latitude,lng:r.coords.longitude,timestamp:new Date,accuracy:r.coords.accuracy},console.debug("[CreaTimbratura] posizione ottenuta onSubmit",this.posizioneAttuale)}catch(r){this.isLoading=!1,this.errorMessage=r?.message||"Impossibile ottenere la posizione";return}if((this.posizioneAttuale?.accuracy??1/0)>this.POSITION_ACCURACY_THRESHOLD){this.isLoading=!1,this.errorMessage=`Precisione posizione insufficiente (${Math.round(this.posizioneAttuale?.accuracy??0)} m). Usa un dispositivo con GPS o seleziona manualmente il punto.`;return}}let e=null,i=Number.POSITIVE_INFINITY;for(let r of t){let o=Number(r.lat),s=Number(r.lng);if(!isFinite(o)||!isFinite(s))continue;let a=this.distanzaMetri(this.posizioneAttuale.lat,this.posizioneAttuale.lng,o,s);a<i&&(i=a,e=Y(P({},r),{lat:o,lng:s,radius_m:Number(r.radius_m)||50}))}if(this.nearestPoint=e??null,this.distanceToNearest=i===Number.POSITIVE_INFINITY?null:Math.round(i),!e){this.isLoading=!1,this.errorMessage="Nessun punto di timbratura valido configurato (coordinate mancanti).";return}if(this.posizioneValida=i<=(e.radius_m||50),console.debug("[CreaTimbratura] verifica geofence",{nearest:e,nearestDist:i,posizioneValida:this.posizioneValida}),!this.posizioneValida){this.isLoading=!1,this.errorMessage=`Sei fuori dai punti di timbratura consentiti. Distanza: ${Math.round(i)} m (raggio: ${e.radius_m} m).`;return}}this.isEditMode?yield this.handleModificaTimbratura():yield this.saveTimbratura()}catch(t){console.error("[CreaTimbratura] errore onSubmit",t),this.isLoading=!1,this.errorMessage=t?.message||"Errore durante il salvataggio della timbratura"}})}handleModificaTimbratura(){return b(this,null,function*(){if(!this.timbraturaOriginale||!this.currentUser){this.errorMessage="Dati mancanti per la modifica";return}try{let t=this.timbraturaForm.value,e=new Date(this.timbraturaOriginale.start_ts).toISOString().split("T")[0],i=new Date(`${e}T${t.ora_inizio}`).toISOString(),r=t.ora_fine?new Date(`${e}T${t.ora_fine}`).toISOString():null,o=(t.pause||[]).filter(f=>f.inizio&&f.fine).map(f=>({start:new Date(`${e}T${f.inizio}`).toISOString(),end:new Date(`${e}T${f.fine}`).toISOString()})),s=this.posizioneAttuale?[{lat:this.posizioneAttuale.lat,lng:this.posizioneAttuale.lng,address:this.posizioneAttuale.indirizzo,timestamp:this.posizioneAttuale.timestamp.toISOString()}]:this.timbraturaOriginale.locations??null,a=Math.round(this.calcolaLavoroEffettivo()*60),c={id:this.timbraturaOriginale.id,user_id:this.timbraturaOriginale.user_id,company_id:this.timbraturaOriginale.company_id,start_ts:i,end_ts:r??null,breaks:o.length>0?o:null,locations:s&&s.length>0?s:null,notes:t.notes||this.timbraturaOriginale.notes||null,total_minutes:a};if(this.currentUser.role==="admin")yield this.timbratureService.aggiornaTimbratura(this.timbraturaOriginale.id,c),this.isLoading=!1,this.successMessage="Timbratura aggiornata con successo!",setTimeout(()=>this.router.navigate(["/lista-timbrature"]),1200);else{let f={timbratura_id:this.timbraturaOriginale.id,user_id:this.currentUser.id,company_id:this.currentUser.company_id,status:"pending",requested_changes:c,original_data:this.timbraturaOriginale,reason:"Richiesta di modifica tramite interfaccia utente"};yield this.timbratureService.creaRichiestaModifica(f),this.isLoading=!1,this.successMessage="Richiesta di modifica inviata! L'amministratore la valuter\xE0.",setTimeout(()=>this.router.navigate(["/lista-timbrature"]),2e3)}}catch(t){console.error("[CreaTimbratura] errore aggiornamento",t),this.isLoading=!1,this.errorMessage=t?.message||"Errore durante l'aggiornamento della timbratura"}})}distanzaMetri(t,e,i,r){let s=T=>T*Math.PI/180,a=s(t),c=s(i),f=s(i-t),h=s(r-e),m=Math.sin(f/2),y=Math.sin(h/2),g=m*m+Math.cos(a)*Math.cos(c)*y*y;return 6371e3*(2*Math.atan2(Math.sqrt(g),Math.sqrt(1-g)))}saveTimbratura(){return b(this,null,function*(){try{let t=this.preparaDatiTimbratura();if(t.company_id=this.currentCompany?.id||this.currentUser?.company_id||t.company_id,!t.user_id||!t.company_id){this.isLoading=!1,this.errorMessage="Impossibile determinare utente o azienda";return}let e=yield this.timbratureService.creaTimbraturaSupabase(t);console.debug("[CreaTimbratura] timbratura creata",e),this.isLoading=!1,this.successMessage="Timbratura registrata con successo!",setTimeout(()=>this.router.navigate(["/lista-timbrature"]),1200)}catch(t){console.error("[CreaTimbratura] errore saveTimbratura",t),this.isLoading=!1,this.errorMessage=t?.message||"Errore durante il salvataggio della timbratura"}})}submitAfterManualConfirm(t){t&&(this.posizioneAttuale={lat:Number(t.lat),lng:Number(t.lng),timestamp:new Date,accuracy:0},this.posizioneValida=!0,this.nearestPoint=t,this.distanceToNearest=0,this.isLoading=!0,this.errorMessage="",this.isEditMode?this.handleModificaTimbratura():this.saveTimbratura())}askForPositionOnce(t=1e4){return new Promise((e,i)=>{if(!navigator.geolocation)return i(new Error("Geolocalizzazione non supportata"));navigator.geolocation.getCurrentPosition(e,r=>{i(r)},{enableHighAccuracy:!0,timeout:t,maximumAge:0})})}pointRadius(t){let e=Number(t?.radius_m??t?.raggio??50);return isFinite(e)&&e>0?e:50}distanceToPoint(t){if(!this.posizioneAttuale)return null;let e=Number(t?.lat),i=Number(t?.lng);if(!isFinite(e)||!isFinite(i))return null;let r=this.distanzaMetri(this.posizioneAttuale.lat,this.posizioneAttuale.lng,e,i);return Math.round(r)}isInsidePoint(t){let e=this.distanceToPoint(t);if(e===null)return!1;let i=this.pointRadius(t);return e<=i}pointLabel(t){if(!t)return"Punto";let e=(t?.address||"").toString().trim();if(!e)return t?.name||"Punto";let i=e.split(",").map(g=>g.trim()).filter(Boolean),r=["italia","italy"];for(;i.length&&r.includes(i[i.length-1].toLowerCase());)i.pop();for(;i.length&&/^\d{4,}$/.test(i[i.length-1]);)i.pop();let o="",s="",a="",c="",f=/\b(Via|Viale|Corso|Piazza|Piazzale|Strada|Largo|P.za|Piazzetta|Vicolo|Borgo|Contrada)\b/i;if(i.length>=2&&/^\d+/.test(i[0]))s=i[0],o=i[1];else if(i.length>=2&&/^\d+/.test(i[1]))o=i[0],s=i[1];else{let g=i.findIndex(w=>f.test(w));if(g>=0){o=i[g];let w=o.match(/^(.*\D)\s+(\d+\S*)$/);w&&(o=w[1].trim(),s=w[2].trim())}else{o=i[0]||"";let w=o.match(/^(.*\D)\s+(\d+\S*)$/);w&&(o=w[1].trim(),s=w[2].trim())}}for(let g=i.length-1;g>=0;g--){let w=i[g];if(!(!w||w===o||w===s)&&!(/^\d+$/.test(w)||w.length>40)){if(!a)a=w;else if(!c&&w.length<=30){c=w;break}}}let h=o?s?`${o} ${s}`:o:t?.name||"Punto",m=this.pointRadius(t),y=h;return c&&(y+=`, ${c}`),a&&(y+=`, ${a}`),y+=`, raggio: ${m} m`,y}hasPauseErrors(){for(let t=0;t<this.pause.length;t++){let e=this.pause.at(t);if(e.invalid)return!0;let i=e.get("inizio"),r=e.get("fine");if(i?.hasError("futureTime")||r?.hasError("futureTime"))return!0}return!1}getSubmitButtonText(){return this.isLoading?this.isEditMode?this.currentUser?.role==="admin"?"Salvando...":"Inviando richiesta...":"Salvando...":this.isEditMode?this.currentUser?.role==="admin"?"Salva Modifiche":"Invia Richiesta Modifica":"Salva Timbratura"}selezionaPunto(t){this.puntoSelezionato=t,this.posizioneValida=!0,this.posizioneAttuale={lat:Number(t?.lat),lng:Number(t?.lng),indirizzo:t?.address||t?.indirizzo||null,timestamp:new Date,accuracy:0},this.successMessage=`Punto selezionato: ${t?.name||"Punto di timbratura"}`,setTimeout(()=>this.successMessage="",3e3),console.debug("[CreaTimbratura] Punto selezionato:",{nome:t?.name,indirizzo:this.pointLabel(t),distanza:this.distanceToPoint(t)})}deselezionaPunto(){this.puntoSelezionato=null,this.posizioneValida=!1}isPuntoSelezionato(t){return this.puntoSelezionato&&this.puntoSelezionato.id===t.id}hasTimbraturaPerGiorno(t,e,i){return b(this,null,function*(){try{let r=yield this.timbratureService.getTimbratureUtente(t),o=new Date(e);return o.setHours(0,0,0,0),r.some(s=>{if(i&&s.id===i||!s.start_ts)return!1;let a=new Date(s.start_ts);return a.setHours(0,0,0,0),a.getTime()===o.getTime()})}catch(r){throw console.error("[CreaTimbratura] hasTimbraturaPerGiorno error",r),r}})}static \u0275fac=function(e){return new(e||n)(C(bi),C(xt),C(he),C(Se),C(Lt),C(St))};static \u0275cmp=ge({type:n,selectors:[["app-crea-timbratura"]],decls:79,vars:20,consts:[[1,"gradient-container"],[1,"form-card"],[1,"section-header"],[1,"header-icon"],[1,"material-icons"],[1,"section-titles"],[1,"section-title"],[1,"text-muted"],["class","header-actions",4,"ngIf"],["class","status-message info","style","margin-bottom: var(--gutter-lg);",4,"ngIf"],["class","status-message warning","style","margin-bottom: var(--gutter-lg);",4,"ngIf"],[1,"generic-form",3,"ngSubmit","formGroup"],[1,"form-section"],[1,"grid-form"],[1,"filter-group"],[1,"form-label"],["type","date","formControlName","data",3,"max"],["class","status-message warning","style","margin-top:8px",4,"ngIf"],[1,"error"],["type","time","formControlName","ora_inizio"],["type","time","formControlName","ora_fine"],[1,"pause-container"],[1,"card","small",2,"margin-bottom","var(--gutter-md)"],["type","button",1,"promethea-button","outline",3,"click","disabled"],["formControlName","notes","rows","4","placeholder","Note opzionali sulla timbratura...",1,"mobile-textarea"],[4,"ngIf"],[1,"form-actions"],["type","button","routerLink","/lista-timbrature",1,"promethea-button","ghost"],["type","submit",1,"promethea-button",3,"disabled"],[1,"header-actions"],["type","button","class","promethea-button ghost","title","Copia orari e luogo dal giorno lavorativo precedente",3,"disabled","click",4,"ngIf"],["type","button","title","Copia orari e luogo dal giorno lavorativo precedente",1,"promethea-button","ghost",3,"click","disabled"],[1,"loading-spinner"],[1,"status-message","info",2,"margin-bottom","var(--gutter-lg)"],[2,"display","flex","align-items","flex-start","gap","8px"],[1,"muted",2,"margin-top","6px"],[1,"status-message","warning",2,"margin-bottom","var(--gutter-lg)"],[1,"status-message","warning",2,"margin-top","8px"],[1,"card-header",2,"justify-content","space-between"],[2,"display","flex","align-items","center","gap","var(--gutter-sm)","flex","1"],["type","button","class","promethea-button small secondary",3,"click",4,"ngIf"],[1,"pause-inputs",2,"margin-top","var(--gutter-sm)"],[1,"form-group"],["type","time",1,"form-control",3,"formControl"],[1,"error",2,"margin-top","4px"],[1,"error",2,"margin-top","8px"],["type","button",1,"promethea-button","small","secondary",3,"click"],[1,"location-actions",2,"display","flex","align-items","center","gap","8px"],["type","button",1,"promethea-button","secondary",3,"click","disabled"],["class","chip","style","background:#fff7e6;color:#8a6d00",4,"ngIf"],["class","chip","style","background:#e6fff1;color:#0a7a3a",4,"ngIf"],["class","chip","style","background:#f0f0f0;color:#333",4,"ngIf"],["style","margin-top:12px",4,"ngIf"],["class","status-message warning","style","margin-top:12px",4,"ngIf"],["class","status-message info","style","margin-top:12px",4,"ngIf"],["class","status-message error","style","margin-top:12px",4,"ngIf"],[1,"chip",2,"background","#fff7e6","color","#8a6d00"],[1,"chip",2,"background","#e6fff1","color","#0a7a3a"],[1,"material-icons",2,"vertical-align","middle"],[1,"chip",2,"background","#f0f0f0","color","#333"],[2,"margin-top","12px"],[1,"muted",2,"margin-bottom","8px"],["class","card small","style","margin-bottom:8px",4,"ngFor","ngForOf"],["class","status-message info","style","margin-top:8px",4,"ngIf"],["class","status-message success","style","margin-top:8px",4,"ngIf"],[1,"card","small",2,"margin-bottom","8px"],[2,"display","flex","justify-content","space-between","align-items","center"],[2,"flex","1"],[1,"muted",2,"font-size","0.9rem"],[1,"muted",2,"font-size","0.85rem"],[2,"display","flex","align-items","center","gap","8px"],["class","chip active",4,"ngIf"],["class","chip","style","background:#e6fff1;color:#0a7a3a;border:1px solid #22c55e",4,"ngIf"],["type","button","class","promethea-button small","title","Seleziona questo punto per timbrare",3,"click",4,"ngIf"],["type","button","class","promethea-button small secondary","title","Deseleziona questo punto",3,"click",4,"ngIf"],[1,"chip","active"],[1,"chip",2,"background","#e6fff1","color","#0a7a3a","border","1px solid #22c55e"],[1,"material-icons",2,"font-size","14px","vertical-align","middle"],["type","button","title","Seleziona questo punto per timbrare",1,"promethea-button","small",3,"click"],["type","button","title","Deseleziona questo punto",1,"promethea-button","small","secondary",3,"click"],[1,"status-message","info",2,"margin-top","8px"],[1,"muted",2,"margin-top","4px"],[1,"status-message","success",2,"margin-top","8px"],[1,"status-message","warning",2,"margin-top","12px"],["style","margin-top:8px",4,"ngIf"],[2,"margin-top","8px"],[2,"background","#f8f9fa","padding","8px","border-radius","6px","margin-top","4px"],[1,"muted"],[1,"status-message","info",2,"margin-top","12px"],[1,"status-message","error",2,"margin-top","12px"],[1,"grid-cards"],[1,"card"],[1,"card-title"],[1,"card-number"]],template:function(e,i){if(e&1&&(u(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"span",4),d(5),l()(),u(6,"div",5)(7,"h1",6),d(8),l(),u(9,"p",7),d(10),l()(),E(11,O2,2,1,"div",8),l(),E(12,N2,10,0,"div",9)(13,P2,10,0,"div",10),u(14,"form",11),S("ngSubmit",function(){return i.onSubmit()}),u(15,"div",12)(16,"h2",6)(17,"span",4),d(18,"schedule"),l(),d(19," Orario Timbratura "),l(),u(20,"div",13)(21,"div",14)(22,"label",15)(23,"span",4),d(24,"event"),l(),d(25," Data * "),l(),N(26,"input",16),E(27,k2,11,4,"div",17),Z(28,j2,3,2,"div",18),l(),u(29,"div",14)(30,"label",15)(31,"span",4),d(32,"play_arrow"),l(),d(33," Ora Ingresso * "),l(),N(34,"input",19),Z(35,U2,3,2,"div",18),l(),u(36,"div",14)(37,"label",15)(38,"span",4),d(39,"stop"),l(),d(40," Ora Uscita "),l(),N(41,"input",20),Z(42,B2,2,1,"div",18),Z(43,$2,2,1,"div",18),l()()(),u(44,"div",12)(45,"h2",6)(46,"span",4),d(47,"free_breakfast"),l(),d(48," Gestione Pause "),l(),u(49,"div",21),vt(50,K2,20,7,"div",22,wg),u(52,"button",23),S("click",function(){return i.aggiungiPausa()}),u(53,"span",4),d(54,"add"),l(),d(55," Aggiungi Pausa "),l()()(),u(56,"div",12)(57,"h2",6)(58,"span",4),d(59,"notes"),l(),d(60," Dettagli Aggiuntivi "),l(),u(61,"div",13)(62,"div",14)(63,"label",15)(64,"span",4),d(65,"sticky_note_2"),l(),d(66," Note "),l(),N(67,"textarea",24),l()(),E(68,mF,20,13,"div",25),l(),Z(69,vF,17,3,"div",12),u(70,"div",26)(71,"button",27)(72,"span",4),d(73,"arrow_back"),l(),d(74," Torna alle Timbrature "),l(),u(75,"button",28),E(76,_F,3,1,"ng-container",25)(77,yF,2,0,"ng-container",25),d(78),l()()()()()),e&2){let r,o,s;p(5),R(i.isEditMode?"edit":"assignment_add"),p(3),R(i.isEditMode?"Modifica Timbratura":"Nuova Timbratura"),p(2),R(i.isEditMode?"Richiedi modifiche alla tua timbratura":"Registra la tua timbratura giornaliera"),p(),_("ngIf",!i.isEditMode),p(),_("ngIf",i.isEditMode&&(i.currentUser==null?null:i.currentUser.role)!=="admin"),p(),_("ngIf",i.isEditMode&&(i.currentUser==null?null:i.currentUser.role)==="admin"),p(),_("formGroup",i.timbraturaForm),p(12),_("max",i.maxDate),p(),_("ngIf",i.hasTimbraturaForSelectedDate&&!i.isEditMode&&(i.currentUser==null?null:i.currentUser.role)!=="admin"),p(),J((r=i.timbraturaForm.get("data"))!=null&&r.invalid&&((r=i.timbraturaForm.get("data"))!=null&&r.touched)?28:-1),p(7),J((o=i.timbraturaForm.get("ora_inizio"))!=null&&o.invalid&&((o=i.timbraturaForm.get("ora_inizio"))!=null&&o.touched)?35:-1),p(7),J(i.hasTimeRangeError?42:-1),p(),J((s=i.timbraturaForm.get("ora_fine"))!=null&&s.hasError("futureTime")?43:-1),p(7),_t(i.pause.controls),p(2),_("disabled",i.hasPauseErrors()),p(16),_("ngIf",(i.currentCompany==null?null:i.currentCompany.timbratura_type)==="punti"),p(),J(i.calcolaOreTotali()>0?69:-1),p(6),_("disabled",i.timbraturaForm.invalid||i.isLoading||(i.currentCompany==null?null:i.currentCompany.timbratura_type)==="punti"&&!i.posizioneValida),p(),_("ngIf",!i.isLoading),p(),_("ngIf",i.isLoading),p(),O(" ",i.getSubmitButtonText()," ")}},dependencies:[_e,qe,Ee,wi,Rn,Ne,Pe,An,ov,On,Xn,At,jt,Yt,Xe],styles:[".pause-inputs[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-md)}.pause-inputs[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{flex:1}@media (max-width: 768px){.pause-inputs[_ngcontent-%COMP%]{flex-direction:column;gap:var(--gutter-sm)}}.header-actions[_ngcontent-%COMP%]{margin-left:auto;display:flex;gap:var(--gutter-sm)}.header-actions[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:var(--fs-md)}.mobile-textarea[_ngcontent-%COMP%]{min-height:10rem}.chip.active[_ngcontent-%COMP%]{background:color-mix(in srgb,var(--success) 15%,transparent);color:var(--success);border:1px solid color-mix(in srgb,var(--success) 30%,transparent)}@media (max-width: 768px){.pause-inputs[_ngcontent-%COMP%]{flex-direction:column;gap:var(--gutter-sm)}.header-actions[_ngcontent-%COMP%]{margin-left:0;margin-top:var(--gutter-sm)}.section-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}}.chip.active[_ngcontent-%COMP%]{background:color-mix(in srgb,var(--primary) 15%,transparent);color:var(--primary);border:1px solid color-mix(in srgb,var(--primary) 30%,transparent)}.status-message.success[_ngcontent-%COMP%]{background:color-mix(in srgb,var(--success) 10%,transparent);border:1px solid color-mix(in srgb,var(--success) 20%,transparent);color:var(--success)}.status-message.success[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:var(--success)}@media (max-width: 768px){.promethea-button.small[_ngcontent-%COMP%]{padding:4px 8px;font-size:.8rem}.promethea-button.small[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:16px}}"]})};var lp=class n{constructor(t,e){this.supabaseService=t;this.authService=e}getAnnunciAzienda(t){let i=this.supabaseService.getClient().from("companies").select("announcements").eq("id",t).single().then(r=>{if(r.error)throw r.error;return r.data?.announcements||[]});return B(i)}creaAnnuncio(t,e){let i=this.supabaseService.getClient(),r=b(this,null,function*(){let o=yield new Promise(g=>{this.authService.currentUser$.subscribe(w=>g(w)).unsubscribe()});if(!o||o.role!=="admin")throw new Error("Solo gli admin possono creare annunci");let{data:s,error:a}=yield i.from("companies").select("announcements").eq("id",t).single();if(a)throw a;let c=s?.announcements||[],f=Y(P({},e),{id:this.generateId(),created_at:new Date().toISOString(),is_active:!0}),h=[f,...c],{data:m,error:y}=yield i.from("companies").update({announcements:h,updated_at:new Date().toISOString()}).eq("id",t).select();if(y)throw y;return f});return B(r)}generateId(){return"ann_"+Math.random().toString(36).substr(2,9)}static \u0275fac=function(e){return new(e||n)(L(Ct),L(he))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};var $t=class n{constructor(t){this.supabaseService=t}refreshSubject=new Ke(void 0);refresh$=this.refreshSubject.asObservable();getDipendenti(t){if(!t||t==="null"||t==="undefined")return console.warn("[Dipendenti] getDipendenti chiamato con companyId non valido:",t),H([]);let i=this.supabaseService.getClient().from("users").select("*").eq("company_id",t).then(r=>{if(r.error)throw r.error;return Array.isArray(r.data)?r.data:[]});return B(i)}getDipendenteById(t){if(!t)return H(null);let i=this.supabaseService.getClient().from("users").select("*").eq("id",t).single().then(r=>{if(r.error)throw r.error;return r.data});return B(i)}checkEmployeeDepartmentConflict(t,e){let r=this.supabaseService.getClient().from("users").select("department_id, department:departments(id, company_id, name, description)").eq("id",t).maybeSingle().then(o=>{if(o.error)throw o.error;let s=o.data;if(!s?.department_id)return{hasConflict:!1};if(s.department_id===e)return{hasConflict:!1};let a=s.department;return Array.isArray(a)&&(a=a[0]??null),{hasConflict:!0,currentDepartment:a||void 0}});return B(r)}canDeleteDepartment(t){let i=this.supabaseService.getClient().from("users").select("id",{count:"exact"}).eq("department_id",t).then(r=>{if(r.error)throw r.error;let o=r.count||0;return{canDelete:o===0,employeeCount:o}});return B(i)}updateUser(t,e){if(!t)return H(null);let r=this.supabaseService.getClient().from("users").update(Y(P({},e),{updated_at:new Date().toISOString()})).eq("id",t).select("*, department:departments(id,name)").maybeSingle().then(o=>{if(o.error)throw console.error("[Dipendenti.updateUser] error",o.error),o.error;let s=o.data;s&&s.department&&Array.isArray(s.department)&&(s.department=s.department.length?s.department[0]:null),console.debug("[Dipendenti.updateUser] normalized success",s);try{this.refreshSubject.next()}catch{}return s});return B(r)}static \u0275fac=function(e){return new(e||n)(L(Ct))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};function wF(n,t){if(n&1&&(u(0,"div",11)(1,"div",19)(2,"span",4),d(3,"corporate_fare"),l(),u(4,"h3",12),d(5,"Informazioni Azienda"),l()(),u(6,"div",20)(7,"div",21)(8,"span",22),d(9,"Nome Azienda"),l(),u(10,"span",23),d(11),l()(),u(12,"div",21)(13,"span",22),d(14,"Partita IVA"),l(),u(15,"span",23),d(16),l()(),u(17,"div",21)(18,"span",22),d(19,"Forma Giuridica"),l(),u(20,"span",23),d(21),l()(),u(22,"div",21)(23,"span",22),d(24,"Settore"),l(),u(25,"span",23),d(26),l()()()()),n&2){let e=v();p(11),R(e.azienda.name),p(5),R(e.azienda.vat),p(5),R(e.azienda.legal_form||"Non specificata"),p(5),R(e.azienda.category||"Non specificato")}}function EF(n,t){if(n&1&&(u(0,"span",27),d(1),l()),n&2){let e=v(3);p(),be(" ",e.azienda.city,", ",e.azienda.province," ")}}function CF(n,t){if(n&1&&(u(0,"div",21)(1,"span",4),d(2,"location_on"),l(),u(3,"div",25)(4,"span",22),d(5,"Indirizzo"),l(),u(6,"span",23),d(7),l(),E(8,EF,2,2,"span",26),l()()),n&2){let e=v(2);p(7),O(" ",e.azienda.address," "),p(),_("ngIf",e.azienda.city||e.azienda.province)}}function SF(n,t){if(n&1&&(u(0,"div",21)(1,"span",4),d(2,"phone"),l(),u(3,"div",25)(4,"span",22),d(5,"Telefono"),l(),u(6,"span",23),d(7),l()()()),n&2){let e=v(2);p(7),R(e.azienda.numero_telefono)}}function xF(n,t){if(n&1&&(u(0,"div",21)(1,"span",4),d(2,"email"),l(),u(3,"div",25)(4,"span",22),d(5,"Email"),l(),u(6,"span",23)(7,"a",28),d(8),l()()()()),n&2){let e=v(2);p(7),_("href","mailto:"+e.azienda.email,La),p(),R(e.azienda.email)}}function DF(n,t){if(n&1&&(u(0,"div",21)(1,"span",4),d(2,"web"),l(),u(3,"div",25)(4,"span",22),d(5,"Sito Web"),l(),u(6,"a",29),d(7),l()()()),n&2){let e=v(2);p(6),_("href",e.azienda.website,La),p(),R(e.azienda.website)}}function IF(n,t){if(n&1&&(u(0,"div",21)(1,"span",4),d(2,"person"),l(),u(3,"div",25)(4,"span",22),d(5,"Amministratore"),l(),u(6,"span",23),d(7),l(),u(8,"span",27),d(9),l()()()),n&2){let e=v(2);p(7),be("",e.adminAzienda.first_name," ",e.adminAzienda.last_name),p(2),R(e.adminAzienda.email)}}function TF(n,t){if(n&1&&(u(0,"div",11)(1,"div",19)(2,"span",4),d(3,"contact_page"),l(),u(4,"h3",12),d(5,"Contatti"),l()(),u(6,"div",20),E(7,CF,9,2,"div",24)(8,SF,8,1,"div",24)(9,xF,9,2,"div",24)(10,DF,8,2,"div",24)(11,IF,10,3,"div",24),l()()),n&2){let e=v();p(7),_("ngIf",e.azienda.address||e.azienda.civic_number||e.azienda.city||e.azienda.province),p(),_("ngIf",e.azienda.numero_telefono),p(),_("ngIf",e.azienda.email),p(),_("ngIf",e.azienda.website),p(),_("ngIf",e.adminAzienda)}}function MF(n,t){if(n&1&&(u(0,"div",21)(1,"span",22),d(2,"Orario Ufficio"),l(),u(3,"span",23),d(4),l()()),n&2){let e=v(2);p(4),be("",e.azienda.opening_time," - ",e.azienda.closing_time)}}function AF(n,t){if(n&1&&(u(0,"div",34)(1,"span",35),d(2),l(),u(3,"span",36),d(4),l()()),n&2){let e=t.$implicit,i=v(2);p(2),R(e.label),p(),we("closed",i.isGiornoChiuso(e.key)),p(),O(" ",i.getOrarioGiorno(e.key)," ")}}function RF(n,t){if(n&1&&(u(0,"div",11)(1,"div",19)(2,"span",4),d(3,"schedule"),l(),u(4,"h3",12),d(5,"Orari di Lavoro"),l()(),u(6,"div",20),E(7,MF,5,2,"div",24),u(8,"div",30)(9,"h4",31),d(10,"Orari Settimanali"),l(),u(11,"div",32),E(12,AF,5,4,"div",33),l()()()()),n&2){let e=v();p(7),_("ngIf",e.azienda.opening_time&&e.azienda.closing_time),p(5),_("ngForOf",e.giorniSettimana)}}function OF(n,t){if(n&1&&(u(0,"div",39)(1,"div",40),d(2),l(),u(3,"div",41)(4,"div",42),d(5),l(),u(6,"div",43),d(7),l()(),u(8,"div",44),d(9),l()()),n&2){let e=t.$implicit,i=v(2);p(2),be(" ",((e==null?null:e.first_name)||"")==null?null:((e==null?null:e.first_name)||"").charAt(0),"",((e==null?null:e.last_name)||"")==null?null:((e==null?null:e.last_name)||"").charAt(0)," "),p(3),be("",e==null?null:e.first_name," ",e==null?null:e.last_name),p(),hr("role-"+(e==null?null:e.role)),p(),O(" ",i.getRuoloLabel(e==null?null:e.role)," "),p(),we("active",e==null?null:e.is_active),p(),O(" ",e!=null&&e.is_active?"Attivo":"Inattivo"," ")}}function NF(n,t){if(n&1&&(u(0,"div",10)(1,"h2",6)(2,"span",4),d(3,"groups"),l(),d(4," Team Aziendale "),l(),u(5,"div",37),E(6,OF,10,10,"div",38),l()()),n&2){let e=v();p(6),_("ngForOf",e.dipendenti)}}function PF(n,t){if(n&1){let e=j();u(0,"button",45),S("click",function(){D(e);let r=v();return I(r.mostraFormAnnuncio=!r.mostraFormAnnuncio)}),u(1,"span",4),d(2,"add"),l(),d(3," Nuovo Annuncio "),l()}}function kF(n,t){if(n&1){let e=j();u(0,"div",46)(1,"h3",31)(2,"span",4),d(3,"create"),l(),d(4," Crea Nuovo Annuncio "),l(),u(5,"div",47)(6,"label",48),d(7,"Titolo Annuncio"),l(),u(8,"input",49),G("ngModelChange",function(r){D(e);let o=v();return q(o.nuovoAnnuncio.title,r)||(o.nuovoAnnuncio.title=r),I(r)}),l()(),u(9,"div",47)(10,"label",48),d(11,"Contenuto"),l(),u(12,"textarea",50),G("ngModelChange",function(r){D(e);let o=v();return q(o.nuovoAnnuncio.content,r)||(o.nuovoAnnuncio.content=r),I(r)}),l()(),u(13,"div",51)(14,"button",52),S("click",function(){D(e);let r=v();return I(r.annullaCreazioneAnnuncio())}),d(15," Annulla "),l(),u(16,"button",53),S("click",function(){D(e);let r=v();return I(r.creaAnnuncio())}),u(17,"span",4),d(18,"publish"),l(),d(19," Pubblica Annuncio "),l()()()}if(n&2){let e=v();p(8),W("ngModel",e.nuovoAnnuncio.title),p(4),W("ngModel",e.nuovoAnnuncio.content),p(4),_("disabled",!e.nuovoAnnuncio.title||!e.nuovoAnnuncio.content)}}function FF(n,t){n&1&&(u(0,"span",63),d(1,"Tu"),l())}function LF(n,t){if(n&1&&(u(0,"div",56)(1,"div",57)(2,"h4",58),d(3),l(),u(4,"span",59),d(5),K(6,"date"),l()(),u(7,"p",60),d(8),l(),u(9,"div",61),d(10),E(11,FF,2,0,"span",62),l()()),n&2){let e=t.$implicit,i=v(2);p(3),R(e.title),p(2),R(te(6,5,e.created_at,"dd/MM/yyyy HH:mm")),p(3),R(e.content),p(2),O(" Pubblicato da ",e.author_name||e.author," "),p(),_("ngIf",e.author_id===(i.currentUser==null?null:i.currentUser.id))}}function jF(n,t){if(n&1&&(u(0,"div",54),E(1,LF,12,8,"div",55),l()),n&2){let e=v();p(),_("ngForOf",e.annunci)}}function VF(n,t){n&1&&(u(0,"p",7),d(1,' Clicca su "Nuovo Annuncio" per pubblicare il primo annuncio. '),l())}function zF(n,t){if(n&1&&(u(0,"div",64)(1,"span",4),d(2,"campaign"),l(),u(3,"h3"),d(4,"Nessun annuncio"),l(),u(5,"p"),d(6,"Non ci sono annunci aziendali al momento."),l(),E(7,VF,2,0,"p",65),l()),n&2){let e=v();p(7),_("ngIf",e.hasRole("admin"))}}function UF(n,t){n&1&&(u(0,"div",66),N(1,"div",67),u(2,"p"),d(3,"Caricamento annunci..."),l()())}function BF(n,t){n&1&&(u(0,"div",66),N(1,"div",67),u(2,"p"),d(3,"Caricamento informazioni aziendali..."),l()())}var cp=class n{constructor(t,e,i,r,o){this.authService=t;this.companyService=e;this.announcementsService=i;this.timbratureService=r;this.dipendentiService=o}azienda=null;adminAzienda=null;dipendenti=[];statistiche=null;annunci=[];currentUser=null;isLoading=!0;giorniSettimana=[{key:"monday",label:"Luned\xEC"},{key:"tuesday",label:"Marted\xEC"},{key:"wednesday",label:"Mercoled\xEC"},{key:"thursday",label:"Gioved\xEC"},{key:"friday",label:"Venerd\xEC"},{key:"saturday",label:"Sabato"},{key:"sunday",label:"Domenica"}];mostraFormAnnuncio=!1;nuovoAnnuncio={title:"",content:""};isLoadingAnnunci=!1;ngOnInit(){this.authService.currentUser$.subscribe(t=>{this.currentUser=t,t&&this.caricaDatiAzienda(t.company_id)})}caricaDatiAzienda(t){this.isLoading=!0,this.companyService.getAzienda(t).subscribe(e=>{if(!e){console.warn("Nessuna azienda trovata per id",t),this.isLoading=!1;return}this.azienda=e,this.caricaDipendenti(t),this.caricaAnnunci()},e=>{console.error("Errore nel caricamento dati azienda:",e),this.isLoading=!1})}caricaDipendenti(t){console.debug("[ProfiloAziendale] caricaDipendenti start (using Dipendenti service)",{companyId:t}),this.dipendentiService.getDipendenti(t).subscribe({next:e=>{let i=Array.isArray(e)?e:[];console.debug("[ProfiloAziendale] dipendenti (from Dipendenti):",i.length,i.slice(0,5)),this.dipendenti=i,this.statistiche={dipendentiTotali:i.length,dipendentiAttivi:i.filter(r=>!!r?.is_active).length,timbratureOggi:0,presenzeOggi:0},this.caricaAdminAzienda(this.dipendenti),this.loadTimbratureAndPresenze(),this.isLoading=!1},error:e=>{console.error("[ProfiloAziendale] errore getDipendenti (Dipendenti):",e),this.dipendenti=[],this.statistiche={dipendentiTotali:0,dipendentiAttivi:0,timbratureOggi:this.statistiche?.timbratureOggi??0,presenzeOggi:this.statistiche?.presenzeOggi??0},this.isLoading=!1}})}caricaAdminAzienda(t){let e=t.find(i=>i.role==="admin");e&&(this.adminAzienda=e)}caricaStatistiche(t){let e=t.filter(i=>i.is_active).length;console.debug("[ProfiloAziendale] caricaStatistiche dipendenti.length=",t.length,"attivi=",e),this.statistiche={dipendentiTotali:t.length,dipendentiAttivi:e,timbratureOggi:0,presenzeOggi:0},this.loadTimbratureAndPresenze()}loadTimbratureAndPresenze(){if(!this.azienda?.id){console.debug("[ProfiloAziendale] no azienda id, skip timbrature");return}let t=this.azienda.id;this.timbratureService.getTimbratureAzienda(t).then(e=>{let i=Array.isArray(e)?e:[];console.debug("[ProfiloAziendale] timbrature azienda count:",i.length);let r=new Date,o=c=>{if(!c)return!1;let f=new Date(c);return f.getFullYear()===r.getFullYear()&&f.getMonth()===r.getMonth()&&f.getDate()===r.getDate()},s=i.filter(c=>o(c.start_ts??c.created_at??c.ts)),a=new Set(s.map(c=>c.user_id??c.uid)).size;this.statistiche||(this.statistiche={dipendentiTotali:this.dipendenti.length,dipendentiAttivi:this.dipendenti.filter(c=>c.is_active).length,timbratureOggi:0,presenzeOggi:0}),this.statistiche.timbratureOggi=s.length,this.statistiche.presenzeOggi=a}).catch(e=>{console.error("[ProfiloAziendale] errore getTimbratureAzienda:",e),this.statistiche||(this.statistiche={dipendentiTotali:this.dipendenti.length,dipendentiAttivi:this.dipendenti.filter(i=>i.is_active).length,timbratureOggi:0,presenzeOggi:0}),this.statistiche.timbratureOggi=0,this.statistiche.presenzeOggi=0})}caricaAnnunci(){this.azienda?.id&&(this.isLoadingAnnunci=!0,this.announcementsService.getAnnunciAzienda(this.azienda.id).subscribe({next:t=>{this.annunci=t.filter(e=>e.is_active!==!1).sort((e,i)=>new Date(i.created_at).getTime()-new Date(e.created_at).getTime()),this.isLoadingAnnunci=!1},error:t=>{console.error("Errore nel caricamento annunci:",t),this.isLoadingAnnunci=!1,this.annunci=this.getMockAnnunci()}}))}creaAnnuncio(){if(!this.azienda?.id||!this.currentUser)return;let t={title:this.nuovoAnnuncio.title,content:this.nuovoAnnuncio.content,author_id:this.currentUser.id,author_name:`${this.currentUser.first_name} ${this.currentUser.last_name}`};this.announcementsService.creaAnnuncio(this.azienda.id,t).subscribe({next:e=>{this.annunci=[e,...this.annunci],this.nuovoAnnuncio={title:"",content:""},this.mostraFormAnnuncio=!1},error:e=>{console.error("Errore nella creazione annuncio:",e),alert("Errore nella creazione dell'annuncio: "+e.message)}})}annullaCreazioneAnnuncio(){this.mostraFormAnnuncio=!1,this.nuovoAnnuncio={title:"",content:""}}getMockAnnunci(){return[{id:"mock1",title:"Nuovo Orario Estivo",content:"A partire dal 1 giugno, l'orario di lavoro sar\xE0 dalle 8:00 alle 16:00.",author_id:"admin",author_name:"Amministrazione",created_at:new Date("2024-05-15").toISOString(),is_active:!0,date:new Date("2024-05-15"),author:"Amministrazione"}]}hasRole(t){return this.authService.hasRole(t)}isGiornoChiuso(t){if(!t)return!1;let e=this.azienda?.closed_days;return!e||!Array.isArray(e)?!1:e.some(i=>{if(!i)return!1;if(typeof i=="string"||typeof i=="number"){let o=String(i).split("|")[0];if(o.includes("/")){let[s,a]=o.split("/");return t>=s&&t<=a}return o===t}if(typeof i=="object"){let r=i.type||(i.start&&i.end?"range":"single");if(r==="single")return i.start===t;if(r==="range")return!i.start||!i.end?!1:t>=i.start&&t<=i.end}return!1})}getOrarioGiorno(t){if(!t)return"Non specificato";if(this.isGiornoChiuso(t))return"Chiuso";let i=this.azienda?.opening_hours?.[t];return i?i?.closed||!i?.open||!i?.close?"Chiuso":`${i.open} - ${i.close}`:this.azienda?.opening_time&&this.azienda?.closing_time?`${this.azienda.opening_time} - ${this.azienda.closing_time}`:"Non specificato"}getRuoloLabel(t){if(!t)return"Dipendente";switch(t){case"admin":return"Amministratore";case"manager":return"Manager";case"employee":return"Dipendente";default:return t.charAt(0).toUpperCase()+t.slice(1)}}static \u0275fac=function(e){return new(e||n)(C(he),C(St),C(lp),C(xt),C($t))};static \u0275cmp=ge({type:n,selectors:[["app-profilo-aziendale"]],decls:62,vars:14,consts:[["noAnnunci",""],[1,"page-container"],[1,"section-header"],[1,"header-icon"],[1,"material-icons"],[1,"section-titles"],[1,"section-title"],[1,"text-muted"],[1,"grid-cards"],["class","card",4,"ngIf"],[1,"form-section"],[1,"card"],[1,"card-title"],[1,"card-number"],["class","form-section",4,"ngIf"],["class","promethea-button outline",3,"click",4,"ngIf"],["class","form-card",4,"ngIf"],["class","announcements-list",4,"ngIf","ngIfElse"],["class","loading-container",4,"ngIf"],[1,"card-header"],[1,"card-content"],[1,"info-item"],[1,"info-label"],[1,"info-value"],["class","info-item",4,"ngIf"],[1,"contact-info"],["class","info-detail",4,"ngIf"],[1,"info-detail"],[3,"href"],["target","_blank",1,"info-link",3,"href"],[1,"opening-hours"],[1,"subsection-title"],[1,"hours-grid"],["class","hour-item",4,"ngFor","ngForOf"],[1,"hour-item"],[1,"day-label"],[1,"hour-value"],[1,"team-grid"],["class","team-member",4,"ngFor","ngForOf"],[1,"team-member"],[1,"member-avatar"],[1,"member-info"],[1,"member-name"],[1,"member-role","chip"],[1,"member-status"],[1,"promethea-button","outline",3,"click"],[1,"form-card"],[1,"form-group"],[1,"form-label"],["type","text","placeholder","Inserisci il titolo dell'annuncio",1,"form-input",3,"ngModelChange","ngModel"],["placeholder","Inserisci il contenuto dell'annuncio","rows","4",1,"form-textarea",3,"ngModelChange","ngModel"],[1,"form-actions"],[1,"promethea-button","ghost",3,"click"],[1,"promethea-button",3,"click","disabled"],[1,"announcements-list"],["class","announcement-item",4,"ngFor","ngForOf"],[1,"announcement-item"],[1,"announcement-header"],[1,"announcement-title"],[1,"announcement-date"],[1,"announcement-content"],[1,"announcement-author"],["class","chip active",4,"ngIf"],[1,"chip","active"],[1,"empty-state"],["class","text-muted",4,"ngIf"],[1,"loading-container"],[1,"loading-spinner"]],template:function(e,i){if(e&1&&(u(0,"div",1)(1,"div",2)(2,"div",3)(3,"span",4),d(4,"business"),l()(),u(5,"div",5)(6,"h1",6),d(7,"Profilo Aziendale"),l(),u(8,"p",7),d(9,"Informazioni e contatti dell'azienda"),l()()(),u(10,"div",8),E(11,wF,27,4,"div",9)(12,TF,12,5,"div",9)(13,RF,13,2,"div",9),l(),u(14,"div",10)(15,"h2",6)(16,"span",4),d(17,"insights"),l(),d(18," Statistiche Aziendali "),l(),u(19,"div",8)(20,"div",11)(21,"h3",12),d(22,"Dipendenti Totali"),l(),u(23,"div",13),d(24),l(),u(25,"p",7),d(26,"Persone nell'azienda"),l()(),u(27,"div",11)(28,"h3",12),d(29,"Dipendenti Attivi"),l(),u(30,"div",13),d(31),l(),u(32,"p",7),d(33,"Attualmente attivi"),l()(),u(34,"div",11)(35,"h3",12),d(36,"Timbrature Oggi"),l(),u(37,"div",13),d(38),l(),u(39,"p",7),d(40,"Registrate oggi"),l()(),u(41,"div",11)(42,"h3",12),d(43,"Presenze Oggi"),l(),u(44,"div",13),d(45),l(),u(46,"p",7),d(47,"Dipendenti in ufficio"),l()()()(),E(48,NF,7,1,"div",14),u(49,"div",10)(50,"div",2)(51,"h2",6)(52,"span",4),d(53,"announcement"),l(),d(54," Annunci Aziendali "),l(),E(55,PF,4,0,"button",15),l(),E(56,kF,20,3,"div",16)(57,jF,2,1,"div",17)(58,zF,8,1,"ng-template",null,0,to)(60,UF,4,0,"div",18),l(),E(61,BF,4,0,"div",18),l()),e&2){let r=zi(59);p(11),_("ngIf",i.azienda),p(),_("ngIf",i.azienda),p(),_("ngIf",i.azienda),p(11),R((i.statistiche==null?null:i.statistiche.dipendentiTotali)||0),p(7),R((i.statistiche==null?null:i.statistiche.dipendentiAttivi)||0),p(7),R((i.statistiche==null?null:i.statistiche.timbratureOggi)||0),p(7),R((i.statistiche==null?null:i.statistiche.presenzeOggi)||0),p(3),_("ngIf",((i.dipendenti==null?null:i.dipendenti.length)??0)>0),p(7),_("ngIf",i.hasRole("admin")),p(),_("ngIf",i.mostraFormAnnuncio&&i.hasRole("admin")),p(),_("ngIf",i.annunci.length>0)("ngIfElse",r),p(3),_("ngIf",i.isLoadingAnnunci),p(),_("ngIf",i.isLoading)}},dependencies:[_e,qe,Ee,Et,Ne,Pe,ct,Xe],encapsulation:2})};var Js=class n{message="";fullScreen=!0;size="64px";get style(){return{"--spinner-size":this.size}}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=ge({type:n,selectors:[["app-loading-spinner"]],inputs:{message:"message",fullScreen:"fullScreen",size:"size"},decls:7,vars:4,consts:[["role","status","aria-live","polite","aria-busy","true",1,"spinner-overlay"],[1,"spinner-wrap",3,"ngStyle"],["aria-hidden","true",1,"loading-spinner"],[1,"spinner-message"],[1,"visually-hidden"]],template:function(e,i){e&1&&(u(0,"div",0)(1,"div",1),N(2,"div",2),u(3,"div",3),d(4),l(),u(5,"span",4),d(6,"Caricamento in corso"),l()()()),e&2&&(we("fullscreen",i.fullScreen),p(),_("ngStyle",i.style),p(3),R(i.message||"Caricamento in corso..."))},dependencies:[_e,Xg],styles:[".spinner-overlay[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:var(--gutter-lg);width:100%;box-sizing:border-box;pointer-events:none}.spinner-overlay.fullscreen[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:9999;background:var(--background);pointer-events:auto}.spinner-wrap[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:calc(var(--gutter-sm) / 2);padding:calc(var(--gutter-sm));border-radius:12px;background:transparent}.visually-hidden[_ngcontent-%COMP%]{position:absolute!important;height:1px;width:1px;overflow:hidden;clip:rect(1px,1px,1px,1px);white-space:nowrap;border:0;padding:0;margin:-1px}.loading-spinner[_ngcontent-%COMP%]{min-width:48px;min-height:48px;width:var(--fs-xl);height:var(--fs-xl);border-radius:50%;border:6px solid color-mix(in srgb,var(--muted) 25%,transparent);border-top-color:var(--primary-color, #1976d2);box-sizing:border-box;animation:_ngcontent-%COMP%_spinner-rotate .9s linear infinite}.spinner-message[_ngcontent-%COMP%]{margin-top:8px;color:var(--text-muted);opacity:.95;text-align:center;max-width:min(320px,80vw);white-space:normal;line-height:1.2;font-weight:700;font-style:italic}@keyframes _ngcontent-%COMP%_spinner-rotate{to{transform:rotate(360deg)}}"]})};function $F(n,t){if(n&1&&(u(0,"div",17),d(1),l()),n&2){let e=v();p(),R(e.error)}}function HF(n,t){n&1&&(u(0,"div",18),d(1,"Nessun invito presente"),l())}function WF(n,t){if(n&1){let e=j();u(0,"li",19)(1,"div",20)(2,"strong",21),d(3),l(),u(4,"small",18),d(5),K(6,"date"),l()(),u(7,"div",22)(8,"button",23),S("click",function(){let r=D(e).$implicit,o=v();return I(o.rimuovi(r))}),u(9,"span",5),d(10,"delete"),l()()()()}if(n&2){let e=t.$implicit,i=v();p(3),R(e.email),p(2),R(te(6,3,e.created_at,"dd/MM/yyyy")),p(3),_("disabled",i.loading)}}var Qs=class n{constructor(t,e){this.invitiService=t;this.auth=e}companyId;closeModal=new Re;inviti=[];newEmail="";loading=!1;error="";userSub;currentUserId=null;ngOnInit(){this.userSub=this.auth.currentUser$.subscribe(t=>{this.currentUserId=t?.id??null}),this.load()}ngOnDestroy(){this.userSub?.unsubscribe()}load(){this.companyId&&this.invitiService.listByCompany(this.companyId).subscribe({next:t=>this.inviti=t,error:t=>{console.error("Inviti load error",t),t?.message?.includes('relation "employee_invitations" does not exist')&&console.warn("La tabella employee_invitations non esiste ancora in Supabase. Esegui la migrazione SQL.")}})}aggiungi(){if(this.error="",!this.newEmail||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.newEmail)){this.error="Inserire una email valida";return}if(!this.companyId){this.error="Company non disponibile";return}this.loading=!0;let t=this.currentUserId;this.invitiService.addInvite(this.companyId,this.newEmail,t??void 0).subscribe({next:()=>{this.newEmail="",this.loading=!1,this.load()},error:e=>{this.loading=!1,this.error="Errore aggiunta",console.error("Errore addInvite:",e),e?.message?.includes('relation "employee_invitations" does not exist')&&(this.error="Tabella inviti non trovata nel DB. Esegui la migrazione SQL.")}})}rimuovi(t){confirm(`Rimuovere ${t.email}?`)&&(this.loading=!0,this.invitiService.removeInviteById(t.id).subscribe({next:()=>{this.loading=!1,this.load()},error:e=>{this.loading=!1,console.error(e)}}))}close(){this.closeModal.emit()}static \u0275fac=function(e){return new(e||n)(C(Ys),C(he))};static \u0275cmp=ge({type:n,selectors:[["app-inviti-dipendenti"]],inputs:{companyId:"companyId"},outputs:{closeModal:"closeModal"},decls:23,vars:5,consts:[["tabindex","-1","role","dialog","aria-modal","true",1,"modal-overlay",3,"click"],[1,"modal-card",3,"click"],[1,"modal-header"],[1,"h3"],["aria-label","Chiudi",1,"icon-button",3,"click"],[1,"material-icons"],[1,"modal-body"],[1,"form-group"],[1,"form-label"],["type","email","placeholder","nome@esempio.it",1,"form-control",3,"ngModelChange","ngModel"],["class","text-error",4,"ngIf"],[1,"form-actions"],[1,"promethea-button",3,"click","disabled"],[1,"divider"],["class","text-muted",4,"ngIf"],[1,"invites-list"],["class","list-row",4,"ngFor","ngForOf"],[1,"text-error"],[1,"text-muted"],[1,"list-row"],[1,"invite-left"],[1,"invite-email"],[1,"invite-actions"],["aria-label","Rimuovi",1,"icon-button",3,"click","disabled"]],template:function(e,i){e&1&&(u(0,"div",0),S("click",function(){return i.close()}),u(1,"div",1),S("click",function(o){return o.stopPropagation()}),u(2,"header",2)(3,"h3",3),d(4,"Inviti dipendenti"),l(),u(5,"button",4),S("click",function(){return i.close()}),u(6,"span",5),d(7,"close"),l()()(),u(8,"section",6)(9,"div",7)(10,"label",8),d(11,"Email da invitare"),l(),u(12,"input",9),G("ngModelChange",function(o){return q(i.newEmail,o)||(i.newEmail=o),o}),l(),E(13,$F,2,1,"div",10),l(),u(14,"div",11)(15,"button",12),S("click",function(){return i.aggiungi()}),u(16,"span",5),d(17,"person_add"),l(),d(18," Aggiungi "),l()(),N(19,"hr",13),E(20,HF,2,0,"div",14),u(21,"ul",15),E(22,WF,11,6,"li",16),l()()()()),e&2&&(p(12),W("ngModel",i.newEmail),p(),_("ngIf",i.error),p(2),_("disabled",i.loading),p(5),_("ngIf",(i.inviti==null?null:i.inviti.length)===0),p(2),_("ngForOf",i.inviti))},dependencies:[_e,qe,Ee,Et,Ne,Pe,ct,Xe],styles:[".modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;padding:var(--gutter-lg, 20px);background:#0000006b;z-index:1200}.modal-card[_ngcontent-%COMP%]{width:100%;max-width:720px;background:var(--background);color:var(--text-color, #111);border-radius:12px;box-shadow:0 8px 28px #00000052;overflow:hidden}.modal-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:16px 18px;border-bottom:1px solid color-mix(in srgb,var(--muted, #ddd) 18%,transparent)}.modal-body[_ngcontent-%COMP%]{padding:14px 18px 20px}.form-group[_ngcontent-%COMP%]{margin-bottom:12px}.form-label[_ngcontent-%COMP%]{display:block;margin-bottom:6px;font-weight:600}.form-control[type=email][_ngcontent-%COMP%]{width:100%;max-width:100%}.form-actions[_ngcontent-%COMP%]{display:flex;gap:10px;align-items:center;margin-bottom:12px}.invites-list[_ngcontent-%COMP%]{list-style:none;margin:0;padding:0}.invites-list[_ngcontent-%COMP%]   .list-row[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:10px 0;border-bottom:1px dashed color-mix(in srgb,var(--muted, #ddd) 12%,transparent)}.invite-left[_ngcontent-%COMP%]{min-width:0;flex:1 1 auto;overflow:hidden}.invite-email[_ngcontent-%COMP%]{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.invite-actions[_ngcontent-%COMP%]{flex:0 0 auto;margin-left:8px}@media (max-width:520px){.modal-card[_ngcontent-%COMP%]{max-width:calc(100% - 24px);margin:0 6px}.modal-header[_ngcontent-%COMP%], .modal-body[_ngcontent-%COMP%]{padding-left:12px;padding-right:12px}.form-actions[_ngcontent-%COMP%]{flex-wrap:wrap;gap:8px}}"]})};var GF=()=>[],qF=n=>["chip",n];function KF(n,t){n&1&&N(0,"app-loading-spinner")}function YF(n,t){if(n&1){let e=j();u(0,"button",29),S("click",function(){D(e);let r=v();return I(r.openInvitiModal())}),u(1,"span",4),d(2,"person_add"),l(),d(3," Nuovo Dipendente "),l()}}function ZF(n,t){if(n&1){let e=j();u(0,"button",38),S("click",function(){D(e);let r=v().$implicit,o=v();return I(o.eliminaDipendente(r))}),u(1,"span",4),d(2,"delete"),l()()}}function JF(n,t){if(n&1){let e=j();u(0,"tr")(1,"td")(2,"div",30)(3,"div",31),d(4),l(),u(5,"div",32)(6,"a",33),S("click",function(r){let o=D(e).$implicit,s=v();return I(s.apriDettaglio(o.id,r))}),u(7,"strong"),d(8),l()()()()(),u(9,"td"),d(10),l(),u(11,"td")(12,"span",34),d(13),l()(),u(14,"td")(15,"span",34),d(16),l()(),u(17,"td"),d(18),l(),u(19,"td"),d(20),K(21,"date"),l(),u(22,"td")(23,"div",35)(24,"button",36),S("click",function(){let r=D(e).$implicit,o=v();return I(o.cambiaStatoDipendente(r))}),u(25,"span",4),d(26),l()(),E(27,ZF,3,0,"button",37),l()()()}if(n&2){let e=t.$implicit,i=v();p(4),be(" ",(e.first_name||"")[0],"",(e.last_name||"")[0]," "),p(4),be("",e.first_name||"-"," ",e.last_name||"-"),p(2),R(e.email||"-"),p(2),_("ngClass",xg(17,qF,"role-"+(e.role||"unknown"))),p(),O(" ",e.role||"\u2014"," "),p(2),_("ngClass",e!=null&&e.is_active?"chip active":"chip inactive"),p(),O(" ",e!=null&&e.is_active?"Attivo":"Inattivo"," "),p(2),R(e.phone||"-"),p(2),O(" ",e!=null&&e.hire_date?te(21,14,e.hire_date,"dd/MM/yyyy"):"Non specificata"," "),p(4),_("title",e!=null&&e.is_active?"Disattiva":"Attiva"),p(2),R(e!=null&&e.is_active?"person_off":"person"),p(),_("ngIf",i.hasRole("admin"))}}function QF(n,t){if(n&1){let e=j();u(0,"button",29),S("click",function(){D(e);let r=v(2);return I(r.openInvitiModal())}),u(1,"span",4),d(2,"person_add"),l(),d(3," Aggiungi il primo dipendente "),l()}}function XF(n,t){if(n&1&&(u(0,"div",39)(1,"span",4),d(2,"group"),l(),u(3,"h3"),d(4,"Nessun dipendente trovato"),l(),u(5,"p",40),d(6,"Non sono stati trovati dipendenti con i filtri attuali."),l(),E(7,QF,4,0,"button",21),l()),n&2){let e=v();p(7),_("ngIf",e.hasRole("admin"))}}function eL(n,t){if(n&1&&(u(0,"div",41)(1,"div",42),d(2),l()()),n&2){let e=v();p(2),be(" Mostrando ",e.dipendentiFiltrati.length," di ",e.dipendenti.length," dipendenti ")}}function tL(n,t){if(n&1){let e=j();u(0,"app-inviti-dipendenti",43),S("closeModal",function(){D(e);let r=v();return I(r.showInvitiModal=!1)}),l()}if(n&2){let e=v();_("companyId",(e.aziendaCorrente==null?null:e.aziendaCorrente.id)??null)}}var up=class n{constructor(t,e,i,r){this.companyService=t;this.dipendentiService=e;this.authService=i;this.router=r}dipendenti=[];dipendentiFiltrati=[];currentUser=null;isLoading=!1;showInvitiModal=!1;aziendaCorrente=null;filtroTesto="";filtroRuolo="";filtroStato="";ngOnInit(){this.isLoading=!0,this.authService.currentUser$.pipe(Pt(1),je(t=>(this.currentUser=t??null,t?.id?this.companyService.getAziendaByAdmin(t.id):H(null)))).subscribe({next:t=>{this.aziendaCorrente=t,this.aziendaCorrente?.id&&this.caricaDipendenti(this.aziendaCorrente.id),this.isLoading=!1},error:t=>{console.error("Errore caricamento azienda corrente",t),this.isLoading=!1}})}caricaDipendenti(t){this.isLoading=!0,this.dipendentiService.getDipendenti(t).subscribe({next:e=>{let i=(e||[]).filter(r=>{let o=this.currentUser?.id&&r.id===this.currentUser.id,s=r.role==="admin";return!o&&!s});this.dipendenti=i,this.applicaFiltri(),this.isLoading=!1},error:e=>{console.error("Errore nel caricamento dei dipendenti (Dipendenti service):",e),this.isLoading=!1}})}applicaFiltri(){let t=this.dipendenti;if(this.filtroTesto){let e=this.filtroTesto.toLowerCase();t=t.filter(i=>i.first_name.toLowerCase().includes(e)||i.last_name.toLowerCase().includes(e)||i.email.toLowerCase().includes(e))}if(this.filtroRuolo&&(t=t.filter(e=>e.role===this.filtroRuolo)),this.filtroStato){let e=this.filtroStato==="attivo";t=t.filter(i=>i.is_active===e)}this.dipendentiFiltrati=t}hasRole(t){return this.authService.hasRole(t)}openInvitiModal(){if(!this.aziendaCorrente||!this.aziendaCorrente.id){alert("Nessuna azienda associata. Assicurati che l'utente sia amministratore di una azienda.");return}this.showInvitiModal=!0}closeInvitiModal(){this.showInvitiModal=!1}cambiaStatoDipendente(t){let e=!t.is_active;confirm(`Sei sicuro di voler ${e?"attivare":"disattivare"} il dipendente ${t.first_name} ${t.last_name}?`)&&console.log("Cambio stato dipendente:",t.id,e)}eliminaDipendente(t){confirm(`Sei sicuro di voler eliminare il dipendente ${t.first_name} ${t.last_name}? Questa azione non pu\xF2 essere annullata.`)&&console.log("Eliminazione dipendente:",t.id)}trackById(t,e){return e?.id??t}apriDettaglio(t,e){if(e&&(e.preventDefault(),e.stopPropagation()),!t){console.warn("apriDettaglio chiamato senza id");return}this.router.navigate(["dipendenti",t])}static \u0275fac=function(e){return new(e||n)(C(St),C($t),C(he),C(Se))};static \u0275cmp=ge({type:n,selectors:[["app-lista-dipendenti"]],decls:65,vars:11,consts:[[1,"page-container"],[4,"ngIf"],[1,"section-header"],[1,"header-icon"],[1,"material-icons"],[1,"section-titles"],[1,"section-title"],[1,"text-muted"],[1,"filters-section"],[1,"filters-container"],[1,"filter-group"],[1,"form-label"],["type","text","placeholder","Nome, cognome, email...",1,"form-control",3,"ngModelChange","input","ngModel"],[1,"form-control",3,"ngModelChange","change","ngModel"],["value",""],["value","admin"],["value","manager"],["value","employee"],["value","attivo"],["value","inattivo"],[1,"actions-container"],["class","promethea-button",3,"click",4,"ngIf"],[1,"table-section"],[1,"table-container"],[1,"crm-table"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","empty-state",4,"ngIf"],["class","pagination-container",4,"ngIf"],[3,"companyId","closeModal",4,"ngIf"],[1,"promethea-button",3,"click"],[1,"user-info-compact"],[1,"user-avatar-small"],[1,"user-details-compact"],["href","#","title","Apri dettaglio",1,"link",3,"click"],[3,"ngClass"],[1,"action-buttons"],[1,"icon-button",3,"click","title"],["class","icon-button","title","Elimina",3,"click",4,"ngIf"],["title","Elimina",1,"icon-button",3,"click"],[1,"empty-state"],[2,"margin-bottom","var(--gutter-lg)"],[1,"pagination-container"],[1,"pagination-info"],[3,"closeModal","companyId"]],template:function(e,i){e&1&&(u(0,"div",0),E(1,KF,1,0,"app-loading-spinner",1),u(2,"div",2)(3,"div",3)(4,"span",4),d(5,"people"),l()(),u(6,"div",5)(7,"h1",6),d(8,"Lista Dipendenti"),l(),u(9,"p",7),d(10,"Gestisci i dipendenti dell'azienda"),l()()(),u(11,"div",8)(12,"div",9)(13,"div",10)(14,"label",11),d(15,"Cerca"),l(),u(16,"input",12),G("ngModelChange",function(o){return q(i.filtroTesto,o)||(i.filtroTesto=o),o}),S("input",function(){return i.applicaFiltri()}),l()(),u(17,"div",10)(18,"label",11),d(19,"Ruolo"),l(),u(20,"select",13),G("ngModelChange",function(o){return q(i.filtroRuolo,o)||(i.filtroRuolo=o),o}),S("change",function(){return i.applicaFiltri()}),u(21,"option",14),d(22,"Tutti"),l(),u(23,"option",15),d(24,"Admin"),l(),u(25,"option",16),d(26,"Manager"),l(),u(27,"option",17),d(28,"Dipendente"),l()()(),u(29,"div",10)(30,"label",11),d(31,"Stato"),l(),u(32,"select",13),G("ngModelChange",function(o){return q(i.filtroStato,o)||(i.filtroStato=o),o}),S("change",function(){return i.applicaFiltri()}),u(33,"option",14),d(34,"Tutti"),l(),u(35,"option",18),d(36,"Attivo"),l(),u(37,"option",19),d(38,"Inattivo"),l()()()(),u(39,"div",20),E(40,YF,4,0,"button",21),l()(),u(41,"div",22)(42,"div",23)(43,"table",24)(44,"thead")(45,"tr")(46,"th"),d(47,"Nome"),l(),u(48,"th"),d(49,"Email"),l(),u(50,"th"),d(51,"Ruolo"),l(),u(52,"th"),d(53,"Stato"),l(),u(54,"th"),d(55,"Telefono"),l(),u(56,"th"),d(57,"Data Assunzione"),l(),u(58,"th"),d(59,"Azioni"),l()()(),u(60,"tbody"),E(61,JF,28,19,"tr",25),l()()(),E(62,XF,8,1,"div",26),l(),E(63,eL,3,2,"div",27),l(),E(64,tL,1,1,"app-inviti-dipendenti",28)),e&2&&(p(),_("ngIf",i.isLoading),p(15),W("ngModel",i.filtroTesto),p(4),W("ngModel",i.filtroRuolo),p(12),W("ngModel",i.filtroStato),p(8),_("ngIf",i.hasRole("admin")),p(21),_("ngForOf",i.dipendentiFiltrati||yt(10,GF))("ngForTrackBy",i.trackById),p(),_("ngIf",i.dipendentiFiltrati.length===0),p(),_("ngIf",i.dipendentiFiltrati.length>0),p(),_("ngIf",i.showInvitiModal))},dependencies:[_e,Qg,qe,Ee,At,Et,Vt,zt,Ne,wt,Pe,ct,Js,Qs,Xe],styles:[".user-info-compact[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm)}.user-avatar-small[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;background:var(--gradiente);display:flex;align-items:center;justify-content:center;color:#fff;font-weight:600;font-size:.8rem;flex-shrink:0}.user-details-compact[_ngcontent-%COMP%]{min-width:0}.user-details-compact[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.chip.role-admin[_ngcontent-%COMP%]{background:color-mix(in srgb,var(--primary) 20%,transparent);color:var(--primary)}.chip.role-manager[_ngcontent-%COMP%]{background:color-mix(in srgb,#f59e0b 20%,transparent);color:#f59e0b}.chip.role-employee[_ngcontent-%COMP%], .chip.active[_ngcontent-%COMP%]{background:color-mix(in srgb,#10b981 20%,transparent);color:#10b981}.chip.inactive[_ngcontent-%COMP%]{background:color-mix(in srgb,#ef4444 20%,transparent);color:#ef4444}@media (max-width: 768px){.user-info-compact[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:0}.user-avatar-small[_ngcontent-%COMP%]{margin-bottom:4px}}"]})};var Xs=class n{constructor(t){this.supabaseService=t}getDepartments(t){let i=this.supabaseService.getClient().from("departments").select("*, employee_count:users(count)").eq("company_id",t).order("name").then(r=>{if(r.error)throw r.error;return(r.data||[]).map(o=>Y(P({},o),{employee_count:o.employee_count?.[0]?.count||0}))});return B(i)}createDepartment(t){let e=this.supabaseService.getClient();return B(e.from("departments").insert([t]).select("*").maybeSingle().then(i=>{if(i.error)throw i.error;return i.data}))}updateDepartment(t,e){let r=this.supabaseService.getClient().from("departments").update(Y(P({},e),{updated_at:new Date().toISOString()})).eq("id",t).select().single().then(o=>{if(o.error)throw o.error;return o.data});return B(r)}deleteDepartment(t){let i=this.supabaseService.getClient().from("departments").delete().eq("id",t).then(r=>{if(r.error)throw r.error});return B(i)}updateEmployeeDepartment(t,e){let r=this.supabaseService.getClient().from("users").update({department_id:e,updated_at:new Date().toISOString()}).eq("id",t).select("*, department:departments(id, name)").single().then(o=>{if(o.error)throw o.error;return o.data});return B(r)}getDipendentiConReparto(t){let i=this.supabaseService.getClient().from("users").select("*, department:departments(id, name)").eq("company_id",t).order("first_name").then(r=>{if(r.error)throw r.error;return r.data||[]});return B(i)}canDeleteDepartment(t){let i=this.supabaseService.getClient().from("users").select("id",{count:"exact"}).eq("department_id",t).then(r=>{if(r.error)throw r.error;let o=typeof r.count=="number"?r.count:0;return{canDelete:o===0,employeeCount:o}});return B(i)}static \u0275fac=function(e){return new(e||n)(L(Ct))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};var gx=(n,t)=>t.id,nL=(n,t)=>t.giorno;function iL(n,t){if(n&1){let e=j();u(0,"div",9)(1,"button",44),S("click",function(){D(e);let r=v();return I(r.generaReport())}),u(2,"span",4),d(3,"download"),l(),d(4," Report "),l()()}}function rL(n,t){if(n&1&&(u(0,"div",45)(1,"span",4),d(2,"check_circle"),l(),d(3),l()),n&2){let e=v();p(3),O(" ",e.messaggioSuccesso," ")}}function oL(n,t){if(n&1&&(u(0,"div",46)(1,"span",4),d(2,"error"),l(),d(3),l()),n&2){let e=v();p(3),O(" ",e.messaggioErrore," ")}}function sL(n,t){if(n&1&&(u(0,"span",20),d(1),l()),n&2){let e=v();p(),R((e.dipendente==null?null:e.dipendente.first_name)||"Non specificato")}}function aL(n,t){if(n&1){let e=j();u(0,"input",47),G("ngModelChange",function(r){D(e);let o=v();return q(o.editWorkModel.first_name,r)||(o.editWorkModel.first_name=r),I(r)}),l()}if(n&2){let e=v();W("ngModel",e.editWorkModel.first_name)}}function lL(n,t){if(n&1&&(u(0,"span",20),d(1),l()),n&2){let e=v();p(),R((e.dipendente==null?null:e.dipendente.last_name)||"Non specificato")}}function cL(n,t){if(n&1){let e=j();u(0,"input",48),G("ngModelChange",function(r){D(e);let o=v();return q(o.editWorkModel.last_name,r)||(o.editWorkModel.last_name=r),I(r)}),l()}if(n&2){let e=v();W("ngModel",e.editWorkModel.last_name)}}function uL(n,t){if(n&1&&(d(0),K(1,"date")),n&2){let e=v();O(" ",te(1,1,e.dipendente==null?null:e.dipendente.birth_date,"dd/MM/yyyy")," ")}}function dL(n,t){n&1&&d(0," Non specificata ")}function fL(n,t){if(n&1&&(u(0,"span",20),d(1),l()),n&2){let e=v();p(),R((e.dipendente==null?null:e.dipendente.birth_place)||"Non specificato")}}function pL(n,t){if(n&1){let e=j();u(0,"input",49),G("ngModelChange",function(r){D(e);let o=v();return q(o.editWorkModel.birth_place,r)||(o.editWorkModel.birth_place=r),I(r)}),l()}if(n&2){let e=v();W("ngModel",e.editWorkModel.birth_place)}}function hL(n,t){if(n&1){let e=j();u(0,"button",50),S("click",function(){D(e);let r=v();return I(r.beginEditWorkInfo())}),u(1,"span",4),d(2,"edit"),l()()}}function mL(n,t){if(n&1&&(u(0,"span",20),d(1),l()),n&2){let e=v();p(),R(e.getDepartmentName())}}function gL(n,t){if(n&1&&(u(0,"option",53),d(1),l()),n&2){let e=t.$implicit;_("value",e.id),p(),R(e.name)}}function vL(n,t){if(n&1){let e=j();u(0,"div",25)(1,"select",51),G("ngModelChange",function(r){D(e);let o=v();return q(o.editWorkModel.department_id,r)||(o.editWorkModel.department_id=r),I(r)}),u(2,"option",52),d(3,"Nessun reparto"),l(),vt(4,gL,2,2,"option",53,gx),l()()}if(n&2){let e=v();p(),W("ngModel",e.editWorkModel.department_id),p(3),_t(e.departments)}}function _L(n,t){if(n&1&&(u(0,"span",20),d(1),l()),n&2){let e=v();p(),R((e.dipendente==null?null:e.dipendente.job_title)||"Non specificata")}}function yL(n,t){if(n&1){let e=j();u(0,"input",54),G("ngModelChange",function(r){D(e);let o=v();return q(o.editWorkModel.job_title,r)||(o.editWorkModel.job_title=r),I(r)}),l()}if(n&2){let e=v();W("ngModel",e.editWorkModel.job_title)}}function bL(n,t){if(n&1&&(u(0,"span",55),d(1),l()),n&2){let e=v();hr("role-"+((e.dipendente==null?null:e.dipendente.role)||"employee")),p(),O(" ",e.getRuoloLabel(e.dipendente==null?null:e.dipendente.role)," ")}}function wL(n,t){if(n&1){let e=j();u(0,"select",56),G("ngModelChange",function(r){D(e);let o=v();return q(o.editWorkModel.role,r)||(o.editWorkModel.role=r),I(r)}),u(1,"option",57),d(2,"Dipendente"),l(),u(3,"option",58),d(4,"Manager"),l(),u(5,"option",59),d(6,"Amministratore"),l()()}if(n&2){let e=v();W("ngModel",e.editWorkModel.role)}}function EL(n,t){if(n&1&&(u(0,"span",55),d(1),l()),n&2){let e=v();we("active",e.dipendente==null?null:e.dipendente.is_active)("inactive",!(e.dipendente!=null&&e.dipendente.is_active)),p(),O(" ",e.dipendente!=null&&e.dipendente.is_active?"Attivo":"Inattivo"," ")}}function CL(n,t){if(n&1){let e=j();u(0,"label",31)(1,"input",60),G("ngModelChange",function(r){D(e);let o=v();return q(o.editWorkModel.is_active,r)||(o.editWorkModel.is_active=r),I(r)}),l(),d(2," Attivo "),l()}if(n&2){let e=v();p(),W("ngModel",e.editWorkModel.is_active)}}function SL(n,t){if(n&1&&(u(0,"span",20),d(1),l()),n&2){let e=v();p(),R(e.dipendente!=null&&e.dipendente.full_time?"Full-Time":"Part-Time")}}function xL(n,t){if(n&1){let e=j();u(0,"label",31)(1,"input",61),G("ngModelChange",function(r){D(e);let o=v();return q(o.editWorkModel.full_time,r)||(o.editWorkModel.full_time=r),I(r)}),l(),d(2," Full-Time "),l()}if(n&2){let e=v();p(),W("ngModel",e.editWorkModel.full_time)}}function DL(n,t){if(n&1&&(d(0),K(1,"date")),n&2){let e=v(2);O(" ",te(1,1,e.dipendente==null?null:e.dipendente.hire_date,"dd/MM/yyyy")," ")}}function IL(n,t){n&1&&d(0," Non specificata ")}function TL(n,t){if(n&1&&(u(0,"span",20),Z(1,DL,2,4)(2,IL,1,0),l()),n&2){let e=v();p(),J(e.dipendente!=null&&e.dipendente.hire_date?1:2)}}function ML(n,t){if(n&1){let e=j();u(0,"input",62),G("ngModelChange",function(r){D(e);let o=v();return q(o.editWorkModel.hire_date,r)||(o.editWorkModel.hire_date=r),I(r)}),l()}if(n&2){let e=v();W("ngModel",e.editWorkModel.hire_date)}}function AL(n,t){if(n&1&&(u(0,"span",20),d(1),l()),n&2){let e=v();p(),O("",(e.dipendente==null?null:e.dipendente.monthly_hours)||0," ore")}}function RL(n,t){if(n&1){let e=j();u(0,"input",63),G("ngModelChange",function(r){D(e);let o=v();return q(o.editWorkModel.monthly_hours,r)||(o.editWorkModel.monthly_hours=r),I(r)}),l()}if(n&2){let e=v();W("ngModel",e.editWorkModel.monthly_hours)}}function OL(n,t){if(n&1){let e=j();u(0,"div",34)(1,"button",44),S("click",function(){D(e);let r=v();return I(r.onSaveWorkInfo())}),d(2," Salva modifiche "),l(),u(3,"button",64),S("click",function(){D(e);let r=v();return I(r.cancelEditWorkInfo())}),d(4,"Annulla"),l()()}}function NL(n,t){n&1&&(u(0,"th"),d(1,"Azioni"),l())}function PL(n,t){if(n&1&&(d(0),K(1,"date")),n&2){let e=v().$implicit;O(" ",te(1,1,e.end_ts,"HH:mm")," ")}}function kL(n,t){n&1&&d(0," In corso ")}function FL(n,t){if(n&1){let e=j();u(0,"td")(1,"div",66)(2,"button",67),S("click",function(){D(e);let r=v().$implicit,o=v();return I(o.modificaTimbratura(r))}),u(3,"span",4),d(4,"edit"),l()(),u(5,"button",67),S("click",function(){D(e);let r=v().$implicit,o=v();return I(o.eliminaTimbratura(r))}),u(6,"span",4),d(7,"delete"),l()()()()}}function LL(n,t){if(n&1&&(u(0,"tr")(1,"td"),d(2),K(3,"date"),l(),u(4,"td"),d(5),K(6,"date"),l(),u(7,"td"),Z(8,PL,2,4)(9,kL,1,0),l(),u(10,"td"),d(11),K(12,"number"),l(),u(13,"td"),d(14),l(),u(15,"td",65),d(16),l(),Z(17,FL,8,0,"td"),l()),n&2){let e=t.$implicit,i=v();p(2),R(te(3,7,e.start_ts,"dd/MM/yyyy")),p(3),R(te(6,10,e.start_ts,"HH:mm")),p(3),J(e.end_ts?8:9),p(3),O("",te(12,13,e.total_minutes/60,"1.1-1")," ore"),p(3),R(e.breaks?"S\xEC":"No"),p(2),R(e.notes||"Nessuna"),p(),J(i.hasRole("admin")||i.hasRole("manager")?17:-1)}}function jL(n,t){n&1&&(u(0,"div",39)(1,"span",4),d(2,"schedule"),l(),u(3,"h3"),d(4,"Nessuna timbratura"),l(),u(5,"p"),d(6,"Non sono state trovate timbrature recenti per questo dipendente."),l()())}function VL(n,t){if(n&1&&(u(0,"div",42)(1,"div",68),N(2,"div",69),l(),u(3,"div",70),d(4),K(5,"number"),l(),u(6,"div",71),d(7),l()()),n&2){let e=t.$implicit,i=v();p(2),di("height",i.getAltezzaBarra(e.ore)+"%"),p(2),O("",te(5,4,e.ore,"1.1-1"),"h"),p(3),R(e.giorno)}}function zL(n,t){n&1&&(u(0,"div",43),N(1,"div",72),u(2,"p"),d(3,"Caricamento dettaglio dipendente..."),l()())}var dp=class n{constructor(t,e,i,r,o){this.route=t;this.router=e;this.dipendentiService=i;this.timbratureService=r;this.departmentsService=o}isLoading=!0;dipendente=null;timbratureRecenti=[];statistiche={oreLavorate:0,giorniPresenti:0,mediaOreGiornaliere:0,puntualita:0};andamentoSettimanale=[];editWorkModel={};departments=[];editingDepartment=!1;messaggioSuccesso="";messaggioErrore="";editingWorkInfo=!1;ngOnInit(){let t=this.route.snapshot.paramMap.get("id");if(!t){console.error("Dipendente non trovato: id mancante nella route"),this.router.navigate(["/dipendenti"]);return}this.isLoading=!0,this.dipendentiService.getDipendenteById(t).subscribe({next:e=>{e?(this.dipendente=e,this.caricaTimbratureRecenti(e.id),this.caricaStatistiche(e.id),this.caricaAndamentoSettimanale(e.id),this.caricaReparti()):(console.error("Dipendente non trovato",t),this.router.navigate(["/dipendenti"])),this.isLoading=!1},error:e=>{console.error("Errore caricamento dipendente",e),this.isLoading=!1,this.messaggioErrore="Errore nel caricamento del dipendente",this.nascondiMessaggioDopoTimeout()}})}caricaTimbratureRecenti(t){return b(this,null,function*(){try{let e=yield this.timbratureService.getTimbratureUtente(t);console.debug("[DipendenteDettaglio] timbrature raw",e);let i=(Array.isArray(e)?e:[]).map(r=>Y(P({},r),{start_ts:r?.start_ts?new Date(r.start_ts):null,end_ts:r?.end_ts?new Date(r.end_ts):null,total_minutes:Number(r?.total_minutes)||0})).filter(r=>r&&r.start_ts);i.sort((r,o)=>o.start_ts.getTime()-r.start_ts.getTime()),this.timbratureRecenti=i.slice(0,10),console.debug("[DipendenteDettaglio] timbratureRecenti",this.timbratureRecenti)}catch(e){console.error("Errore nel caricamento delle timbrature",e),this.timbratureRecenti=[]}})}caricaStatistiche(t){return b(this,null,function*(){try{let e=yield this.timbratureService.getTimbratureUtente(t);console.debug("[DipendenteDettaglio] timbrature raw",e),this.calcolaStatistiche(Array.isArray(e)?e:[])}catch(e){console.error("Errore nel caricamento delle statistiche",e),this.statistiche={oreLavorate:120.5,giorniPresenti:15,mediaOreGiornaliere:8,puntualita:.85}}})}calcolaStatistiche(t){let e=new Date,i=new Date(e.getFullYear(),e.getMonth(),1),r=new Date(e.getFullYear(),e.getMonth()+1,1),o=t.filter(c=>{if(!c?.start_ts)return!1;let f=new Date(c.start_ts);return f>=i&&f<r}),s=o.reduce((c,f)=>{let h=Number(f.total_minutes)||0;return c+h/60},0),a=new Set(o.map(c=>new Date(c.start_ts).toISOString().slice(0,10))).size;this.statistiche={oreLavorate:s,giorniPresenti:a,mediaOreGiornaliere:a>0?s/a:0,puntualita:this.statistiche.puntualita},console.debug("[DipendenteDettaglio] statistiche calcolate",this.statistiche,{timbratureMeseCount:o.length})}caricaAndamentoSettimanale(t){return b(this,null,function*(){try{this.andamentoSettimanale=[{giorno:"Lun",ore:7.5},{giorno:"Mar",ore:8.2},{giorno:"Mer",ore:6.8},{giorno:"Gio",ore:8.5},{giorno:"Ven",ore:7},{giorno:"Sab",ore:0},{giorno:"Dom",ore:0}]}catch(e){console.error("Errore nel caricamento dell'andamento settimanale",e)}})}caricaReparti(){this.dipendente?.company_id&&this.departmentsService.getDepartments(this.dipendente.company_id).subscribe({next:t=>{this.departments=t,this.editingWorkInfo&&(this.editWorkModel?.department_id===void 0||this.editWorkModel.department_id===null)&&(this.editWorkModel.department_id=this.dipendente?.department?.id??this.dipendente?.department_id??null)},error:t=>{console.error("Errore caricamento reparti",t)}})}saveWorkInfo(t){this.dipendente?.id&&(this.isLoading=!0,this.dipendentiService.updateUser(this.dipendente.id,t).subscribe({next:e=>{if(this.isLoading=!1,e){this.dipendente=e;let i=this.editWorkModel?.department_id??this.dipendente?.department?.id??null;if(i&&(!this.dipendente.department||!this.dipendente.department.id)){let r=Array.isArray(this.departments)?this.departments.find(o=>o&&o.id===i):void 0;r?this.dipendente.department={id:r.id,name:r.name}:this.dipendente?.company_id&&this.departmentsService.getDepartments(this.dipendente.company_id).subscribe({next:o=>{let s=Array.isArray(o)?o.find(a=>a&&a.id===i):void 0;s&&(this.dipendente.department={id:s.id,name:s.name})},error:o=>console.warn("[DipendenteDettaglio] errore fetch departments fallback",o)})}}this.messaggioSuccesso="Informazioni lavorative aggiornate",this.editingWorkInfo=!1,this.editingDepartment=!1,this.nascondiMessaggioDopoTimeout()},error:e=>{this.isLoading=!1,console.error("[DipendenteDettaglio] saveWorkInfo error",e),this.messaggioErrore="Errore durante il salvataggio",this.nascondiMessaggioDopoTimeout()}}))}cambiaReparto(t){this.saveWorkInfo({department_id:t||null})}nascondiMessaggioDopoTimeout(){setTimeout(()=>{this.messaggioSuccesso="",this.messaggioErrore=""},5e3)}getRuoloLabel(t){return t?{admin:"Amministratore",manager:"Manager",employee:"Dipendente"}[t]||t:"Dipendente"}getDifferenzaOre(){let t=this.dipendente?.monthly_hours||0;return(this.statistiche.oreLavorate||0)-t}getClasseDifferenzaOre(){return this.getDifferenzaOre()>=0?"positive":"negative"}getPercentualeCompletamento(){let t=this.dipendente?.monthly_hours||0,e=this.statistiche.oreLavorate||0;return t>0?e/t:0}getAltezzaBarra(t){let e=Math.max(...this.andamentoSettimanale.map(i=>i.ore));return e>0?t/e*100:0}modificaDipendente(){this.dipendente&&this.router.navigate(["/dipendenti",this.dipendente.id,"modifica"])}generaReport(){this.dipendente&&this.generaReportLocale()}generaReportLocale(){let t=`
      REPORT DIPENDENTE
      =================
      
      Nome: ${this.dipendente?.first_name} ${this.dipendente?.last_name}
      Email: ${this.dipendente?.email}
      Mansione: ${this.dipendente?.job_title}
      Reparto: ${this.dipendente?.department?.name||"Nessun reparto"}
      
      STATISTICHE MENSILI
      -------------------
      Ore lavorate: ${this.statistiche.oreLavorate}
      Giorni presenti: ${this.statistiche.giorniPresenti}
      Media ore/giorno: ${this.statistiche.mediaOreGiornaliere}
      Puntualit\xE0: ${(this.statistiche.puntualita*100).toFixed(1)}%
    `,e=new Blob([t],{type:"text/plain"}),i=window.URL.createObjectURL(e),r=document.createElement("a");r.href=i,r.download=`report_${this.dipendente?.first_name}_${this.dipendente?.last_name}.txt`,r.click(),window.URL.revokeObjectURL(i)}vediTutteTimbrature(){this.dipendente&&this.router.navigate(["/timbrature"],{queryParams:{dipendente:this.dipendente.id}})}modificaTimbratura(t){console.log("Modifica timbratura:",t),this.router.navigate(["/timbrature",t.id,"modifica"])}eliminaTimbratura(t){confirm("Sei sicuro di voler eliminare questa timbratura?")&&(console.log("Elimina timbratura:",t),this.timbratureRecenti=this.timbratureRecenti.filter(e=>e.id!==t.id))}hasRole(t){return t==="admin"}beginEditWorkInfo(){this.dipendente&&(this.editWorkModel={department_id:this.dipendente.department?.id??this.dipendente?.department_id??null,job_title:this.dipendente.job_title??null,role:this.dipendente.role??"employee",is_active:!!this.dipendente.is_active,full_time:!!this.dipendente.full_time,monthly_hours:typeof this.dipendente.monthly_hours=="number"?this.dipendente.monthly_hours:null,hire_date:this.dipendente?.hire_date??null,first_name:this.dipendente.first_name??null,last_name:this.dipendente.last_name??null,birth_place:this.dipendente.birth_place??null},this.editingWorkInfo=!0,this.editingDepartment=!0)}cancelEditWorkInfo(){this.editingWorkInfo=!1,this.editingDepartment=!1,this.editWorkModel={}}onSaveWorkInfo(){if(!this.dipendente?.id)return;let t=typeof this.editWorkModel.monthly_hours<"u"&&this.editWorkModel.monthly_hours!==null?Number(this.editWorkModel.monthly_hours):typeof this.dipendente.monthly_hours<"u"?this.dipendente.monthly_hours:null,e={department_id:typeof this.editWorkModel.department_id<"u"?this.editWorkModel.department_id:this.dipendente.department?.id??null,job_title:this.editWorkModel.job_title??this.dipendente.job_title??null,role:this.editWorkModel.role??this.dipendente.role??null,is_active:typeof this.editWorkModel.is_active<"u"?!!this.editWorkModel.is_active:!!this.dipendente.is_active,full_time:typeof this.editWorkModel.full_time<"u"?!!this.editWorkModel.full_time:!!this.dipendente.full_time,monthly_hours:t,hire_date:typeof this.editWorkModel.hire_date<"u"?this.editWorkModel.hire_date:this.dipendente?.hire_date??null,first_name:typeof this.editWorkModel.first_name<"u"?this.editWorkModel.first_name:this.dipendente.first_name??null,last_name:typeof this.editWorkModel.last_name<"u"?this.editWorkModel.last_name:this.dipendente.last_name??null,birth_place:typeof this.editWorkModel.birth_place<"u"?this.editWorkModel.birth_place:this.dipendente.birth_place??null};if(console.debug("[DipendenteDettaglio] onSaveWorkInfo payload",e),!confirm("Sei sicuro di voler salvare le modifiche al dipendente?")){console.debug("[DipendenteDettaglio] save cancelled by user");return}this.dipendentiService.updateUser(this.dipendente.id,e).subscribe({next:r=>{console.debug("[DipendenteDettaglio] updateUser response",r),r&&(this.dipendente=r),e.first_name&&(this.dipendente=this.dipendente??{},this.dipendente.first_name=e.first_name),e.last_name&&(this.dipendente=this.dipendente??{},this.dipendente.last_name=e.last_name),e.birth_place&&(this.dipendente=this.dipendente??{},this.dipendente.birth_place=e.birth_place),e.hire_date&&(this.dipendente=this.dipendente??{},this.dipendente.hire_date=e.hire_date),this.editingWorkInfo=!1,this.editingDepartment=!1,this.messaggioSuccesso="Informazioni salvate",this.nascondiMessaggioDopoTimeout()},error:r=>{console.error("[DipendenteDettaglio] updateUser error",r),this.messaggioErrore="Errore salvataggio: "+(r?.message||JSON.stringify(r))}})}getDepartmentName(){let t=this.dipendente?.department?.name;if(t)return t;let e=this.editWorkModel?.department_id??this.dipendente?.department_id??this.dipendente?.department?.id??null;if(!e)return"Nessun reparto assegnato";if(Array.isArray(this.departments)){let i=this.departments.find(r=>r&&r.id===e);if(i?.name)return i.name}return"Nessun reparto assegnato"}static \u0275fac=function(e){return new(e||n)(C(Lt),C(Se),C($t),C(xt),C(Xs))};static \u0275cmp=ge({type:n,selectors:[["app-dipendente-dettaglio"]],decls:248,vars:50,consts:[["workForm","ngForm"],[1,"page-container"],[1,"section-header"],[1,"header-icon"],[1,"material-icons"],[1,"section-titles"],[1,"section-title"],[1,"text-muted"],["routerLink","/dipendenti",1,"link"],[1,"actions-container"],["class","status-message info",4,"ngIf"],["class","status-message error",4,"ngIf"],[1,"grid-cards"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-content"],[1,"info-item"],[1,"contact-info"],[1,"info-label"],[1,"info-value"],["name","first_name","type","text",1,"form-control",3,"ngModel"],["name","last_name","type","text",1,"form-control",3,"ngModel"],["name","birth_place","type","text",1,"form-control",3,"ngModel"],["title","Modifica informazioni e reparto",1,"icon-button"],[2,"display","flex","gap","8px","align-items","center","width","100%"],["novalidate",""],["name","job_title","type","text",1,"form-control",3,"ngModel"],[1,"chip",3,"class"],["name","role",1,"form-control",3,"ngModel"],[1,"chip",3,"active","inactive"],[2,"display","inline-flex","align-items","center","gap","8px"],["name","hire_date","type","date",1,"form-control",3,"ngModel"],["name","monthly_hours","type","number",1,"form-control",2,"width","140px",3,"ngModel"],[1,"form-actions",2,"margin-top","12px"],[1,"form-section"],[1,"promethea-button","outline",3,"click"],[1,"table-container"],[1,"crm-table"],[1,"empty-state"],[1,"chart-container"],[1,"chart-bars"],[1,"chart-bar"],[1,"loading-container"],[1,"promethea-button",3,"click"],[1,"status-message","info"],[1,"status-message","error"],["name","first_name","type","text",1,"form-control",3,"ngModelChange","ngModel"],["name","last_name","type","text",1,"form-control",3,"ngModelChange","ngModel"],["name","birth_place","type","text",1,"form-control",3,"ngModelChange","ngModel"],["title","Modifica informazioni e reparto",1,"icon-button",3,"click"],["name","department_id",1,"form-control",2,"min-width","240px",3,"ngModelChange","ngModel"],["value",""],[3,"value"],["name","job_title","type","text",1,"form-control",3,"ngModelChange","ngModel"],[1,"chip"],["name","role",1,"form-control",3,"ngModelChange","ngModel"],["value","employee"],["value","manager"],["value","admin"],["name","is_active","type","checkbox",3,"ngModelChange","ngModel"],["name","full_time","type","checkbox",3,"ngModelChange","ngModel"],["name","hire_date","type","date",1,"form-control",3,"ngModelChange","ngModel"],["name","monthly_hours","type","number",1,"form-control",2,"width","140px",3,"ngModelChange","ngModel"],[1,"promethea-button","ghost",3,"click"],[1,"notes-preview"],[1,"action-buttons"],[1,"icon-button",3,"click"],[1,"bar-container"],[1,"bar-fill"],[1,"bar-value"],[1,"bar-label"],[1,"loading-spinner"]],template:function(e,i){if(e&1){let r=j();u(0,"div",1)(1,"div",2)(2,"div",3)(3,"span",4),d(4,"person"),l()(),u(5,"div",5)(6,"h1",6),d(7),l(),u(8,"p",7)(9,"a",8),d(10,"Dipendenti"),l(),d(11," / Dettaglio dipendente "),l()(),Z(12,iL,5,0,"div",9),l(),E(13,rL,4,1,"div",10)(14,oL,4,1,"div",11),u(15,"div",12)(16,"div",13)(17,"div",14)(18,"span",4),d(19,"badge"),l(),u(20,"h2",15),d(21,"Informazioni Personali"),l()(),u(22,"div",16)(23,"div",17)(24,"span",4),d(25,"badge"),l(),u(26,"div",18)(27,"span",19),d(28,"Nome"),l(),Z(29,sL,2,1,"span",20)(30,aL,1,1,"input",21),l()(),u(31,"div",17)(32,"span",4),d(33,"badge"),l(),u(34,"div",18)(35,"span",19),d(36,"Cognome"),l(),Z(37,lL,2,1,"span",20)(38,cL,1,1,"input",22),l()(),u(39,"div",17)(40,"span",4),d(41,"email"),l(),u(42,"div",18)(43,"span",19),d(44,"Email"),l(),u(45,"span",20),d(46),l()()(),u(47,"div",17)(48,"span",4),d(49,"phone"),l(),u(50,"div",18)(51,"span",19),d(52,"Telefono"),l(),u(53,"span",20),d(54),l()()(),u(55,"div",17)(56,"span",4),d(57,"cake"),l(),u(58,"div",18)(59,"span",19),d(60,"Data di Nascita"),l(),u(61,"span",20),Z(62,uL,2,4)(63,dL,1,0),l()()(),u(64,"div",17)(65,"span",4),d(66,"place"),l(),u(67,"div",18)(68,"span",19),d(69,"Luogo di Nascita"),l(),Z(70,fL,2,1,"span",20)(71,pL,1,1,"input",23),l()(),u(72,"div",17)(73,"span",4),d(74,"fingerprint"),l(),u(75,"div",18)(76,"span",19),d(77,"Codice Fiscale"),l(),u(78,"span",20),d(79),l()()()()(),u(80,"div",13)(81,"div",14)(82,"span",4),d(83,"work"),l(),u(84,"h2",15),d(85,"Informazioni Lavorative"),l(),Z(86,hL,3,0,"button",24),l(),u(87,"div",16)(88,"div",17)(89,"span",4),d(90,"groups"),l(),u(91,"div",18)(92,"span",19),d(93,"Reparto"),l(),Z(94,mL,2,1,"span",20)(95,vL,6,1,"div",25),l()(),u(96,"form",26,0)(98,"div",17)(99,"span",4),d(100,"business_center"),l(),u(101,"div",18)(102,"span",19),d(103,"Mansione"),l(),Z(104,_L,2,1,"span",20)(105,yL,1,1,"input",27),l()(),u(106,"div",17)(107,"span",4),d(108,"admin_panel_settings"),l(),u(109,"div",18)(110,"span",19),d(111,"Ruolo"),l(),Z(112,bL,2,3,"span",28)(113,wL,7,1,"select",29),l()(),u(114,"div",17)(115,"span",4),d(116,"toggle_on"),l(),u(117,"div",18)(118,"span",19),d(119,"Stato"),l(),Z(120,EL,2,5,"span",30)(121,CL,3,1,"label",31),l()(),u(122,"div",17)(123,"span",4),d(124,"schedule"),l(),u(125,"div",18)(126,"span",19),d(127,"Tipo di Contratto"),l(),Z(128,SL,2,1,"span",20)(129,xL,3,1,"label",31),l()(),u(130,"div",17)(131,"span",4),d(132,"work_outline"),l(),u(133,"div",18)(134,"span",19),d(135,"Data di Assunzione"),l(),Z(136,TL,3,1,"span",20)(137,ML,1,1,"input",32),l()(),u(138,"div",17)(139,"span",4),d(140,"av_timer"),l(),u(141,"div",18)(142,"span",19),d(143,"Ore Mensili Previste"),l(),Z(144,AL,2,1,"span",20)(145,RL,1,1,"input",33),l()(),Z(146,OL,5,0,"div",34),l()()(),u(147,"div",13)(148,"div",14)(149,"span",4),d(150,"insights"),l(),u(151,"h2",15),d(152,"Statistiche Mese Corrente"),l()(),u(153,"div",16)(154,"div",17)(155,"span",19),d(156,"Ore Lavorate"),l(),u(157,"span",20),d(158),K(159,"number"),l()(),u(160,"div",17)(161,"span",19),d(162,"Giorni Presenti"),l(),u(163,"span",20),d(164),l()(),u(165,"div",17)(166,"span",19),d(167,"Media Ore Giornaliere"),l(),u(168,"span",20),d(169),K(170,"number"),l()(),u(171,"div",17)(172,"span",19),d(173,"Puntualit\xE0"),l(),u(174,"span",20),d(175),K(176,"percent"),l()()()(),u(177,"div",13)(178,"div",14)(179,"span",4),d(180,"calendar_today"),l(),u(181,"h2",15),d(182,"Riepilogo Presenze"),l()(),u(183,"div",16)(184,"div",17)(185,"span",19),d(186,"Ore Previste"),l(),u(187,"span",20),d(188),l()(),u(189,"div",17)(190,"span",19),d(191,"Ore Raggiunte"),l(),u(192,"span",20),d(193),K(194,"number"),l()(),u(195,"div",17)(196,"span",19),d(197,"Differenza"),l(),u(198,"span",20),d(199),K(200,"number"),l()(),u(201,"div",17)(202,"span",19),d(203,"Progresso"),l(),u(204,"span",20),d(205),K(206,"percent"),l()()()()(),u(207,"div",35)(208,"div",2)(209,"h2",6)(210,"span",4),d(211,"schedule"),l(),d(212," Timbrature Recenti "),l(),u(213,"button",36),S("click",function(){return D(r),I(i.vediTutteTimbrature())}),u(214,"span",4),d(215,"list"),l(),d(216," Vedi Tutte "),l()(),u(217,"div",37)(218,"table",38)(219,"thead")(220,"tr")(221,"th"),d(222,"Data"),l(),u(223,"th"),d(224,"Ingresso"),l(),u(225,"th"),d(226,"Uscita"),l(),u(227,"th"),d(228,"Ore Totali"),l(),u(229,"th"),d(230,"Pause"),l(),u(231,"th"),d(232,"Note"),l(),Z(233,NL,2,0,"th"),l()(),u(234,"tbody"),vt(235,LL,18,16,"tr",null,gx),l()()(),Z(237,jL,7,0,"div",39),l(),u(238,"div",35)(239,"h2",6)(240,"span",4),d(241,"bar_chart"),l(),d(242," Andamento Settimanale "),l(),u(243,"div",40)(244,"div",41),vt(245,VL,8,7,"div",42,nL),l()()(),Z(247,zL,4,0,"div",43),l()}e&2&&(p(7),be("",i.dipendente==null?null:i.dipendente.first_name," ",i.dipendente==null?null:i.dipendente.last_name),p(5),J(i.hasRole("admin")||i.hasRole("manager")?12:-1),p(),_("ngIf",i.messaggioSuccesso),p(),_("ngIf",i.messaggioErrore),p(15),J(i.editingWorkInfo?30:29),p(8),J(i.editingWorkInfo?38:37),p(9),R(i.dipendente==null?null:i.dipendente.email),p(8),R((i.dipendente==null?null:i.dipendente.phone)||"Non specificato"),p(8),J(i.dipendente!=null&&i.dipendente.birth_date?62:63),p(8),J(i.editingWorkInfo?71:70),p(9),R((i.dipendente==null?null:i.dipendente.fiscal_code)||"Non specificato"),p(7),J(i.hasRole("admin")?86:-1),p(8),J(i.editingDepartment?95:94),p(10),J(i.editingWorkInfo?105:104),p(8),J(i.editingWorkInfo?113:112),p(8),J(i.editingWorkInfo?121:120),p(8),J(i.editingWorkInfo?129:128),p(8),J(i.editingWorkInfo?137:136),p(8),J(i.editingWorkInfo?145:144),p(2),J(i.editingWorkInfo?146:-1),p(12),O("",te(159,34,i.statistiche.oreLavorate,"1.1-1")," ore"),p(6),O("",i.statistiche.giorniPresenti," giorni"),p(5),O("",te(170,37,i.statistiche.mediaOreGiornaliere,"1.1-1")," ore"),p(6),R(Ui(176,40,i.statistiche.puntualita)),p(13),O("",(i.dipendente==null?null:i.dipendente.monthly_hours)||0," ore"),p(5),O("",te(194,42,i.statistiche.oreLavorate,"1.1-1")," ore"),p(5),hr(i.getClasseDifferenzaOre()),p(),O(" ",te(200,45,i.getDifferenzaOre(),"1.1-1")," ore "),p(6),R(Ui(206,48,i.getPercentualeCompletamento())),p(28),J(i.hasRole("admin")||i.hasRole("manager")?233:-1),p(2),_t(i.timbratureRecenti),p(2),J(i.timbratureRecenti.length===0?237:-1),p(8),_t(i.andamentoSettimanale),p(2),J(i.isLoading?247:-1))},dependencies:[_e,Ee,At,jt,Et,Rn,Vt,zt,Ne,kl,ho,wt,Pe,An,ct,nv,Yt,Xa,Xe],styles:["[_ngcontent-%COMP%]:root{--dip-card-min: 500px}.grid-cards[_ngcontent-%COMP%]{gap:var(--gutter-lg);grid-template-columns:repeat(auto-fit,minmax(var(--dip-card-min),1fr));max-width:calc((var(--dip-card-min) * 2) + var(--gutter-lg));width:100%;margin-left:auto;margin-right:auto;box-sizing:border-box}.grid-cards[_ngcontent-%COMP%] > .card[_ngcontent-%COMP%]{width:100%;max-width:none;box-sizing:border-box}"]})};var fp=class n{constructor(t,e){this.http=t;this.authService=e}baseUrl="/api/reports";generaReportTimbrature(t){let e=this.authService.getAuthHeaders();return this.http.post(`${this.baseUrl}/timbrature`,t,{headers:e})}esportaPDF(t){let e=this.authService.getAuthHeaders();return this.http.post(`${this.baseUrl}/export/pdf`,t,{headers:e,responseType:"blob"})}esportaExcel(t){let e=this.authService.getAuthHeaders();return this.http.post(`${this.baseUrl}/export/excel`,t,{headers:e,responseType:"blob"})}generaReportKPI(t){return this.http.post(`${this.baseUrl}/kpi`,t,{responseType:"blob"})}static \u0275fac=function(e){return new(e||n)(L(pi),L(he))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};function BL(n,t){if(n&1&&(u(0,"option",42),d(1),l()),n&2){let e=t.$implicit;_("value",e.id),p(),be("",e.first_name," ",e.last_name)}}function $L(n,t){if(n&1&&(u(0,"div",43)(1,"div",44),N(2,"div",45),l(),u(3,"div",46),d(4),K(5,"number"),l(),u(6,"div",47),d(7),l()()),n&2){let e=t.$implicit,i=v();p(2),di("height",i.getAltezzaBarra(e.ore)+"%"),p(2),O("",te(5,4,e.ore,"1.0-1"),"h"),p(3),R(e.nome)}}function HL(n,t){if(n&1&&(u(0,"div",48)(1,"span",49),d(2),l(),u(3,"span",50),d(4),K(5,"percent"),l()()),n&2){let e=t.$implicit;p(2),R(e.fascia),p(2),R(Ui(5,2,e.percentuale))}}function WL(n,t){if(n&1&&(u(0,"tr")(1,"td")(2,"div",51)(3,"div",52),d(4),l(),u(5,"div",53)(6,"strong"),d(7),l()()()(),u(8,"td"),d(9),K(10,"number"),l(),u(11,"td"),d(12),K(13,"number"),l(),u(14,"td"),d(15),l(),u(16,"td"),d(17),K(18,"percent"),l(),u(19,"td")(20,"span",54),d(21),l()()()),n&2){let e=t.$implicit;p(4),O(" ",e.nome.charAt(0)," "),p(3),R(e.nome),p(2),O("",te(10,12,e.oreTotali,"1.1-1"),"h"),p(3),O("",te(13,15,e.oreMedieGiorno,"1.1-1"),"h"),p(3),be("",e.giorniPresente,"/",e.giorniTotali),p(2),R(Ui(18,18,e.puntualita)),p(3),we("active",e.attivo)("inactive",!e.attivo),p(),O(" ",e.attivo?"Attivo":"Inattivo"," ")}}function GL(n,t){if(n&1&&(u(0,"div",48)(1,"span",49),d(2),l(),u(3,"span",50),d(4),K(5,"number"),l()()),n&2){let e=t.$implicit;p(2),R(e.giorno),p(2),O("",te(5,2,e.ore,"1.1-1"),"h")}}function qL(n,t){if(n&1&&(u(0,"div",55)(1,"span",3),d(2,"info"),l(),u(3,"div",56)(4,"span",57),d(5),l(),u(6,"span",58),d(7),l(),u(8,"span",59),d(9),K(10,"date"),l()()()),n&2){let e=t.$implicit;p(5),R(e.tipo),p(2),R(e.descrizione),p(2),be("",e.dipendente," - ",Ui(10,4,e.data))}}function KL(n,t){n&1&&(u(0,"div",60)(1,"span",3),d(2,"check_circle"),l(),u(3,"h3"),d(4,"Nessuna anomalia"),l(),u(5,"p"),d(6,"Non sono state rilevate anomalie nelle timbrature"),l()())}function YL(n,t){n&1&&(u(0,"div",61),N(1,"div",62),u(2,"p"),d(3,"Caricamento metriche KPI..."),l()())}var pp=class n{constructor(t,e,i){this.timbratureService=t;this.dipendentiService=e;this.reportsService=i}isLoading=!0;filtroPeriodo="mese";filtroDipendente="tutti";filtroReparto="tutti";kpi={oreTotali:0,presenzeMedie:0,oreMediePerDipendente:0,tassoPuntualita:0};orePerDipendente=[];performanceDipendenti=[];distribuzioneOrari=[];andamentoSettimanale=[];anomalie=[];dipendenti=[];ngOnInit(){return b(this,null,function*(){yield this.caricaDipendenti(),yield this.caricaKPI()})}caricaDipendenti(){return b(this,null,function*(){try{let t=yield $p(this.dipendentiService.getDipendenti());this.dipendenti=t??[]}catch(t){console.error("Errore nel caricamento dei dipendenti",t),this.dipendenti=[]}})}caricaKPI(){return b(this,null,function*(){this.isLoading=!0;try{yield this.simulaCaricamentoDati(),this.kpi={oreTotali:324.5,presenzeMedie:8.2,oreMediePerDipendente:7.8,tassoPuntualita:.87},this.orePerDipendente=[{nome:"Mario Rossi",ore:45.2},{nome:"Luca Bianchi",ore:42.8},{nome:"Anna Verdi",ore:38.5},{nome:"Giulia Neri",ore:41.3},{nome:"Paolo Gialli",ore:39.7}],this.performanceDipendenti=[{nome:"Mario Rossi",oreTotali:45.2,oreMedieGiorno:8.2,giorniPresente:22,giorniTotali:22,puntualita:.95,attivo:!0},{nome:"Luca Bianchi",oreTotali:42.8,oreMedieGiorno:7.8,giorniPresente:21,giorniTotali:22,puntualita:.88,attivo:!0},{nome:"Anna Verdi",oreTotali:38.5,oreMedieGiorno:7.1,giorniPresente:20,giorniTotali:22,puntualita:.92,attivo:!0}],this.distribuzioneOrari=[{fascia:"Prima delle 8:00",percentuale:.15},{fascia:"8:00 - 8:30",percentuale:.45},{fascia:"8:30 - 9:00",percentuale:.3},{fascia:"Dopo le 9:00",percentuale:.1}],this.andamentoSettimanale=[{giorno:"Luned\xEC",ore:65.2},{giorno:"Marted\xEC",ore:68.7},{giorno:"Mercoled\xEC",ore:62.4},{giorno:"Gioved\xEC",ore:70.1},{giorno:"Venerd\xEC",ore:58.9}],this.anomalie=[{tipo:"Timbratura Mancante",descrizione:"Uscita non registrata",dipendente:"Paolo Gialli",data:new Date("2024-01-15")}]}catch(t){console.error("Errore nel caricamento dei KPI",t)}finally{this.isLoading=!1}})}getAltezzaBarra(t){let e=Math.max(...this.orePerDipendente.map(i=>i.ore));return e>0?t/e*100:0}onFiltroChange(){this.caricaKPI()}aggiornaDati(){return b(this,null,function*(){yield this.caricaKPI()})}esportaReport(){return b(this,null,function*(){try{yield this.reportsService.generaReportKPI({periodo:this.filtroPeriodo,dipendente:this.filtroDipendente,reparto:this.filtroReparto}).toPromise(),alert("Report KPI esportato con successo!")}catch(t){console.error("Errore nell'esportazione del report",t),alert("Errore nell'esportazione del report")}})}simulaCaricamentoDati(){return new Promise(t=>{setTimeout(()=>t(),1500)})}static \u0275fac=function(e){return new(e||n)(C(xt),C($t),C(fp))};static \u0275cmp=ge({type:n,selectors:[["app-kpi"]],decls:160,vars:26,consts:[[1,"page-container"],[1,"section-header"],[1,"header-icon"],[1,"material-icons"],[1,"section-titles"],[1,"section-title"],[1,"text-muted"],[1,"filters-section"],[1,"filters-container"],[1,"filter-group"],[1,"form-label"],[3,"ngModelChange","change","ngModel"],["value","oggi"],["value","settimana"],["value","mese"],["value","trimestre"],["value","tutti"],[3,"value",4,"ngFor","ngForOf"],["value","amministrazione"],["value","produzione"],["value","vendite"],[1,"actions-container"],[1,"promethea-button","outline",3,"click"],[1,"promethea-button",3,"click"],[1,"grid-cards"],[1,"card"],[1,"card-header"],[1,"card-title"],[1,"card-number"],[1,"card-content"],[1,"chart-container"],[1,"chart-bars"],["class","chart-bar",4,"ngFor","ngForOf"],[1,"hours-grid"],["class","hour-item",4,"ngFor","ngForOf"],[1,"form-section"],[1,"table-container"],[1,"crm-table"],[4,"ngFor","ngForOf"],["class","info-item",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],["class","loading-container",4,"ngIf"],[3,"value"],[1,"chart-bar"],[1,"bar-container"],[1,"bar-fill"],[1,"bar-value"],[1,"bar-label"],[1,"hour-item"],[1,"day-label"],[1,"hour-value"],[1,"user-info-compact"],[1,"user-avatar-small"],[1,"user-details-compact"],[1,"chip"],[1,"info-item"],[1,"contact-info"],[1,"info-label"],[1,"info-value"],[1,"info-detail"],[1,"empty-state"],[1,"loading-container"],[1,"loading-spinner"]],template:function(e,i){e&1&&(u(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),d(4,"insights"),l()(),u(5,"div",4)(6,"h1",5),d(7,"Key Performance Indicators"),l(),u(8,"p",6),d(9,"Metriche e statistiche sulle timbrature"),l()()(),u(10,"div",7)(11,"div",8)(12,"div",9)(13,"label",10),d(14,"Periodo"),l(),u(15,"select",11),G("ngModelChange",function(o){return q(i.filtroPeriodo,o)||(i.filtroPeriodo=o),o}),S("change",function(){return i.onFiltroChange()}),u(16,"option",12),d(17,"Oggi"),l(),u(18,"option",13),d(19,"Questa Settimana"),l(),u(20,"option",14),d(21,"Questo Mese"),l(),u(22,"option",15),d(23,"Questo Trimestre"),l()()(),u(24,"div",9)(25,"label",10),d(26,"Dipendente"),l(),u(27,"select",11),G("ngModelChange",function(o){return q(i.filtroDipendente,o)||(i.filtroDipendente=o),o}),S("change",function(){return i.onFiltroChange()}),u(28,"option",16),d(29,"Tutti i dipendenti"),l(),E(30,BL,2,3,"option",17),l()(),u(31,"div",9)(32,"label",10),d(33,"Reparto"),l(),u(34,"select",11),G("ngModelChange",function(o){return q(i.filtroReparto,o)||(i.filtroReparto=o),o}),S("change",function(){return i.onFiltroChange()}),u(35,"option",16),d(36,"Tutti i reparti"),l(),u(37,"option",18),d(38,"Amministrazione"),l(),u(39,"option",19),d(40,"Produzione"),l(),u(41,"option",20),d(42,"Vendite"),l()()()(),u(43,"div",21)(44,"button",22),S("click",function(){return i.esportaReport()}),u(45,"span",3),d(46,"download"),l(),d(47," Esporta Report "),l(),u(48,"button",23),S("click",function(){return i.aggiornaDati()}),u(49,"span",3),d(50,"refresh"),l(),d(51," Aggiorna "),l()()(),u(52,"div",24)(53,"div",25)(54,"div",26)(55,"span",3),d(56,"schedule"),l(),u(57,"h3",27),d(58,"Ore Totali Lavorate"),l()(),u(59,"div",28),d(60),K(61,"number"),l(),u(62,"p",6),d(63,"Nel periodo selezionato"),l()(),u(64,"div",25)(65,"div",26)(66,"span",3),d(67,"groups"),l(),u(68,"h3",27),d(69,"Presenze Medie"),l()(),u(70,"div",28),d(71),K(72,"number"),l(),u(73,"p",6),d(74,"Dipendenti per giorno"),l()(),u(75,"div",25)(76,"div",26)(77,"span",3),d(78,"timelapse"),l(),u(79,"h3",27),d(80,"Ore Medie per Dip."),l()(),u(81,"div",28),d(82),K(83,"number"),l(),u(84,"p",6),d(85,"Per dipendente"),l()(),u(86,"div",25)(87,"div",26)(88,"span",3),d(89,"access_time"),l(),u(90,"h3",27),d(91,"Puntualit\xE0"),l()(),u(92,"div",28),d(93),K(94,"percent"),l(),u(95,"p",6),d(96,"Ingressi in orario"),l()()(),u(97,"div",24)(98,"div",25)(99,"div",26)(100,"span",3),d(101,"bar_chart"),l(),u(102,"h3",27),d(103,"Ore per Dipendente"),l()(),u(104,"div",29)(105,"div",30)(106,"div",31),E(107,$L,8,7,"div",32),l()()()(),u(108,"div",25)(109,"div",26)(110,"span",3),d(111,"pie_chart"),l(),u(112,"h3",27),d(113,"Distribuzione Orari"),l()(),u(114,"div",29)(115,"div",33),E(116,HL,6,4,"div",34),l()()()(),u(117,"div",35)(118,"h2",5)(119,"span",3),d(120,"leaderboard"),l(),d(121," Performance Dipendenti "),l(),u(122,"div",36)(123,"table",37)(124,"thead")(125,"tr")(126,"th"),d(127,"Dipendente"),l(),u(128,"th"),d(129,"Ore Totali"),l(),u(130,"th"),d(131,"Ore Medie/Giorno"),l(),u(132,"th"),d(133,"Giorni Presente"),l(),u(134,"th"),d(135,"Puntualit\xE0"),l(),u(136,"th"),d(137,"Status"),l()()(),u(138,"tbody"),E(139,WL,22,20,"tr",38),l()()()(),u(140,"div",24)(141,"div",25)(142,"div",26)(143,"span",3),d(144,"trending_up"),l(),u(145,"h3",27),d(146,"Andamento Settimanale"),l()(),u(147,"div",29)(148,"div",33),E(149,GL,6,5,"div",34),l()()(),u(150,"div",25)(151,"div",26)(152,"span",3),d(153,"warning"),l(),u(154,"h3",27),d(155,"Anomalie Rilevate"),l()(),u(156,"div",29),E(157,qL,11,6,"div",39)(158,KL,7,0,"div",40),l()()(),E(159,YL,4,0,"div",41),l()),e&2&&(p(15),W("ngModel",i.filtroPeriodo),p(12),W("ngModel",i.filtroDipendente),p(3),_("ngForOf",i.dipendenti),p(4),W("ngModel",i.filtroReparto),p(26),O("",te(61,15,i.kpi.oreTotali,"1.0-1"),"h"),p(11),R(te(72,18,i.kpi.presenzeMedie,"1.0-1")),p(11),O("",te(83,21,i.kpi.oreMediePerDipendente,"1.0-1"),"h"),p(11),R(Ui(94,24,i.kpi.tassoPuntualita)),p(14),_("ngForOf",i.orePerDipendente),p(9),_("ngForOf",i.distribuzioneOrari),p(23),_("ngForOf",i.performanceDipendenti),p(10),_("ngForOf",i.andamentoSettimanale),p(8),_("ngForOf",i.anomalie),p(),_("ngIf",i.anomalie.length===0),p(),_("ngIf",i.isLoading))},dependencies:[Et,Vt,zt,wt,Pe,ct,_e,qe,Ee,Yt,Xa,Xe],encapsulation:2})};var Ln=()=>({standalone:!0});function ZL(n,t){n&1&&(u(0,"div",50),d(1," Nome obbligatorio "),l())}function JL(n,t){n&1&&(u(0,"div",50),d(1," Cognome obbligatorio "),l())}function QL(n,t){n&1&&(u(0,"div",50),d(1," Email obbligatoria e valida "),l())}function XL(n,t){n&1&&(u(0,"span",3),d(1,"save"),l())}function e3(n,t){n&1&&N(0,"span",51)}function t3(n,t){if(n&1){let e=j();u(0,"div")(1,"form",13),S("ngSubmit",function(){D(e);let r=v();return I(r.salvaProfilo())}),u(2,"div",14)(3,"div",15)(4,"label",16)(5,"span",3),d(6,"badge"),l(),d(7," Nome * "),l(),N(8,"input",33),E(9,ZL,2,0,"div",34),l(),u(10,"div",15)(11,"label",16)(12,"span",3),d(13,"badge"),l(),d(14," Cognome * "),l(),N(15,"input",35),E(16,JL,2,0,"div",34),l(),u(17,"div",15)(18,"label",16)(19,"span",3),d(20,"email"),l(),d(21," Email * "),l(),N(22,"input",36),E(23,QL,2,0,"div",34),l(),u(24,"div",15)(25,"label",16)(26,"span",3),d(27,"phone"),l(),d(28," Telefono "),l(),N(29,"input",37),l(),u(30,"div",15)(31,"label",16)(32,"span",3),d(33,"event_available"),l(),d(34," Data di Assunzione "),l(),N(35,"input",38),u(36,"div",39),d(37,"Modificabile solo dall'amministratore"),l()(),u(38,"div",15)(39,"label",16)(40,"span",3),d(41,"cake"),l(),d(42," Data di Nascita "),l(),N(43,"input",40),l(),u(44,"div",15)(45,"label",16)(46,"span",3),d(47,"place"),l(),d(48," Luogo di Nascita "),l(),N(49,"input",41),l(),u(50,"div",15)(51,"label",16)(52,"span",3),d(53,"badge"),l(),d(54," Codice Fiscale "),l(),N(55,"input",42),l(),u(56,"div",15)(57,"label",16)(58,"span",3),d(59,"work_outline"),l(),d(60," Job Title "),l(),N(61,"input",43),l(),u(62,"div",15)(63,"label",16)(64,"span",3),d(65,"schedule"),l(),d(66," Ore Mensili "),l(),N(67,"input",44),l(),u(68,"div",45)(69,"label",46),N(70,"input",47)(71,"span",27),d(72," Full time "),l()(),u(73,"div",15)(74,"label",16)(75,"span",3),d(76,"public"),l(),d(77," Timezone "),l(),N(78,"input",48),l(),u(79,"div",15)(80,"label",16)(81,"span",3),d(82,"work"),l(),d(83," Ruolo "),l(),N(84,"input",49),l(),u(85,"div",15)(86,"label",16)(87,"span",3),d(88,"business"),l(),d(89," Azienda "),l(),N(90,"input",49),l()(),u(91,"div",20)(92,"button",21),E(93,XL,2,0,"span",22)(94,e3,1,0,"span",23),d(95),l()()()()}if(n&2){let e,i,r,o=v();p(),_("formGroup",o.profiloForm),p(8),_("ngIf",((e=o.profiloForm.get("first_name"))==null?null:e.invalid)&&((e=o.profiloForm.get("first_name"))==null?null:e.touched)),p(7),_("ngIf",((i=o.profiloForm.get("last_name"))==null?null:i.invalid)&&((i=o.profiloForm.get("last_name"))==null?null:i.touched)),p(7),_("ngIf",((r=o.profiloForm.get("email"))==null?null:r.invalid)&&((r=o.profiloForm.get("email"))==null?null:r.touched)),p(12),_("disabled",!o.hasRole("admin")),p(49),_("value",o.currentUser==null?null:o.currentUser.role),p(6),_("value",(o.aziendaCorrente==null?null:o.aziendaCorrente.name)||"N/A"),p(2),_("disabled",o.profiloForm.invalid||o.salvataggioProfilo),p(),_("ngIf",!o.salvataggioProfilo),p(),_("ngIf",o.salvataggioProfilo),p(),O(" ",o.salvataggioProfilo?"Salvando...":"Salva Profilo"," ")}}function n3(n,t){n&1&&(u(0,"div",50),d(1," Nome azienda obbligatorio "),l())}function i3(n,t){n&1&&(u(0,"div",50),d(1," Partita IVA obbligatoria "),l())}function r3(n,t){if(n&1&&(u(0,"span"),d(1),K(2,"number"),K(3,"number"),l()),n&2){let e=v().$implicit;p(),be("coord: ",te(2,2,e.lat,"1.5-5"),", ",te(3,5,e.lng,"1.5-5"))}}function o3(n,t){n&1&&(u(0,"span"),d(1,"coord: \u2014"),l())}function s3(n,t){if(n&1){let e=j();u(0,"div",74)(1,"div",75),d(2),l(),u(3,"div",76)(4,"div",77),d(5),l(),u(6,"div",78)(7,"span",79),d(8,"place"),l(),u(9,"div",80)(10,"div",81)(11,"strong",82),d(12),u(13,"small",83),d(14),l()(),u(15,"div",84),E(16,r3,4,8,"span",11)(17,o3,2,0,"span",11),l()(),u(18,"div",85)(19,"div",86),d(20),l(),u(21,"div",87)(22,"span",88),d(23),l()()()()()(),u(24,"div")(25,"button",89),S("click",function(){let r=D(e).index,o=v(4);return I(o.removePunchPoint(r))}),u(26,"span",3),d(27,"delete"),l()()()()}if(n&2){let e=t.$implicit,i=t.index,r=v(4);p(2),O(" ",((e.name||e.address||"Punto "+(i+1))==null?null:(e.name||e.address||"Punto "+(i+1)).charAt(0))||i+1," "),p(3),R(e.name||e.address||"Punto "+(i+1)),p(7),O(" ",r.getStreet(e)," "),p(2),R(r.getCivic(e)),p(2),_("ngIf",(e==null?null:e.lat)&&(e==null?null:e.lng)),p(),_("ngIf",!(e!=null&&e.lat)||!(e!=null&&e.lng)),p(3),R(r.getCityProvince(e)||"\u2014"),p(3),O("raggio: ",e.radius_m||50," m")}}function a3(n,t){if(n&1){let e=j();u(0,"div",90)(1,"div",15)(2,"label",16),d(3,"Nome Punto"),l(),u(4,"input",91),G("ngModelChange",function(r){D(e);let o=v(4);return q(o.newPoint.name,r)||(o.newPoint.name=r),I(r)}),l()(),u(5,"div",92)(6,"div",93)(7,"label",16),d(8,"Via / Indirizzo"),l(),u(9,"input",94),G("ngModelChange",function(r){D(e);let o=v(4);return q(o.newPoint.address,r)||(o.newPoint.address=r),I(r)}),l()(),u(10,"div",95)(11,"label",16),d(12,"Civico"),l(),u(13,"input",96),G("ngModelChange",function(r){D(e);let o=v(4);return q(o.newPoint.civic_number,r)||(o.newPoint.civic_number=r),I(r)}),l()()(),u(14,"div",97)(15,"div",15)(16,"label",16),d(17,"Citt\xE0"),l(),u(18,"input",98),G("ngModelChange",function(r){D(e);let o=v(4);return q(o.newPoint.city,r)||(o.newPoint.city=r),I(r)}),l()(),u(19,"div",15)(20,"label",16),d(21,"Provincia"),l(),u(22,"input",99),G("ngModelChange",function(r){D(e);let o=v(4);return q(o.newPoint.province,r)||(o.newPoint.province=r),I(r)}),l()()(),u(23,"div",100)(24,"div",101)(25,"label",16),d(26,"Raggio (m)"),l(),u(27,"input",102),G("ngModelChange",function(r){D(e);let o=v(4);return q(o.newPoint.radius_m,r)||(o.newPoint.radius_m=r),I(r)}),l()()(),u(28,"div",20)(29,"button",30),S("click",function(){D(e);let r=v(4);return I(r.addPunchPoint())}),d(30," Salva Punto "),l()()()}if(n&2){let e=v(4);p(4),W("ngModel",e.newPoint.name),_("ngModelOptions",yt(13,Ln)),p(5),W("ngModel",e.newPoint.address),_("ngModelOptions",yt(14,Ln)),p(4),W("ngModel",e.newPoint.civic_number),_("ngModelOptions",yt(15,Ln)),p(5),W("ngModel",e.newPoint.city),_("ngModelOptions",yt(16,Ln)),p(4),W("ngModel",e.newPoint.province),_("ngModelOptions",yt(17,Ln)),p(5),W("ngModel",e.newPoint.radius_m),_("ngModelOptions",yt(18,Ln)),p(2),_("disabled",!(e.aziendaCorrente!=null&&e.aziendaCorrente.id)||e.salvataggioAzienda)}}function l3(n,t){if(n&1){let e=j();u(0,"div",66)(1,"h3",69)(2,"span",3),d(3,"place"),l(),d(4,"Punti di Timbratura"),l(),u(5,"div",70),E(6,s3,28,8,"div",71),l(),u(7,"div",72)(8,"button",30),S("click",function(){D(e);let r=v(3);return I(r.toggleAddPointForm())}),u(9,"span",3),d(10),l(),d(11),l()(),E(12,a3,31,19,"div",73),l()}if(n&2){let e=v(3);p(6),_("ngForOf",e.punchPoints),p(2),_("disabled",e.salvataggioAzienda),p(2),R(e.showAddPointForm?"close":"add"),p(),O(" ",e.showAddPointForm?"Annulla":"Aggiungi Punto"," "),p(),_("ngIf",e.showAddPointForm)}}function c3(n,t){if(n&1&&(u(0,"div",106)(1,"div",107),d(2),l(),u(3,"div",108)(4,"div",101)(5,"label",16),d(6,"Apertura"),l(),N(7,"input",109),l(),u(8,"div",101)(9,"label",16),d(10,"Chiusura"),l(),N(11,"input",110),l(),u(12,"div",111)(13,"label",46),N(14,"input",112)(15,"span",27),d(16," Chiuso "),l()()()()),n&2){let e=t.$implicit;_("formGroupName",e.key),p(2),R(e.label)}}function u3(n,t){if(n&1){let e=j();u(0,"div")(1,"div",103),E(2,c3,17,2,"div",104),l(),u(3,"div",20)(4,"button",105),S("click",function(){D(e);let r=v(3);return I(r.resetOrariDefault())}),u(5,"span",3),d(6,"restore"),l(),d(7," Ripristina Orari Predefiniti "),l()()()}if(n&2){let e=v(3);p(2),_("ngForOf",e.giorniSettimana)}}function d3(n,t){if(n&1){let e=j();u(0,"div",122)(1,"div")(2,"strong"),d(3),l(),u(4,"div",123),d(5),l()(),u(6,"div")(7,"button",89),S("click",function(){let r=D(e).index,o=v(4);return I(o.rimuoviGiornoChiusura(r))}),u(8,"span",3),d(9,"delete"),l()()()()}if(n&2){let e=t.$implicit,i=v(4);p(3),R(i.formatClosedDay(e)),p(2),R(e.label||(e.type==="range"?"Intervallo":"Giorno singolo"))}}function f3(n,t){if(n&1){let e=j();u(0,"div")(1,"div",113),E(2,d3,10,2,"div",114),l(),u(3,"div",115)(4,"div",116)(5,"input",117),G("ngModelChange",function(r){D(e);let o=v(3);return q(o.newDate,r)||(o.newDate=r),I(r)}),l(),u(6,"input",118),G("ngModelChange",function(r){D(e);let o=v(3);return q(o.newDateLabel,r)||(o.newDateLabel=r),I(r)}),l(),u(7,"button",119),S("click",function(){D(e);let r=v(3);return I(r.aggiungiGiornoSingolo())}),d(8,"Aggiungi Giorno"),l()(),u(9,"div",116)(10,"input",117),G("ngModelChange",function(r){D(e);let o=v(3);return q(o.rangeStart,r)||(o.rangeStart=r),I(r)}),l(),u(11,"input",117),G("ngModelChange",function(r){D(e);let o=v(3);return q(o.rangeEnd,r)||(o.rangeEnd=r),I(r)}),l(),u(12,"button",119),S("click",function(){D(e);let r=v(3);return I(r.aggiungiIntervallo())}),d(13,"Aggiungi Intervallo"),l()(),u(14,"div",120)(15,"button",121),S("click",function(){D(e);let r=v(3);return I(r.ripristinaFestivita())}),d(16,"Ripristina Festivit\xE0"),l()()()()}if(n&2){let e=v(3);p(2),_("ngForOf",e.giorniChiusura),p(3),W("ngModel",e.newDate),_("ngModelOptions",yt(9,Ln)),p(),W("ngModel",e.newDateLabel),_("ngModelOptions",yt(10,Ln)),p(4),W("ngModel",e.rangeStart),_("ngModelOptions",yt(11,Ln)),p(),W("ngModel",e.rangeEnd),_("ngModelOptions",yt(12,Ln))}}function p3(n,t){n&1&&(u(0,"span",3),d(1,"save"),l())}function h3(n,t){n&1&&N(0,"span",51)}function m3(n,t){if(n&1){let e=j();u(0,"div")(1,"form",13),S("ngSubmit",function(){D(e);let r=v(2);return I(r.salvaAzienda())}),u(2,"div",14)(3,"div",15)(4,"label",16)(5,"span",3),d(6,"corporate_fare"),l(),d(7," Nome Azienda * "),l(),N(8,"input",53),E(9,n3,2,0,"div",34),l(),u(10,"div",15)(11,"label",16)(12,"span",3),d(13,"receipt"),l(),d(14," Partita IVA * "),l(),N(15,"input",54),E(16,i3,2,0,"div",34),l(),u(17,"div",15)(18,"label",16)(19,"span",3),d(20,"location_on"),l(),d(21," Indirizzo "),l(),N(22,"input",55),l(),u(23,"div",15)(24,"label",16)(25,"span",3),d(26,"location_city"),l(),d(27," Citt\xE0 "),l(),N(28,"input",56),l(),u(29,"div",15)(30,"label",16)(31,"span",3),d(32,"map"),l(),d(33," Provincia "),l(),N(34,"input",57),l(),u(35,"div",15)(36,"label",16)(37,"span",3),d(38,"web"),l(),d(39," Sito Web "),l(),N(40,"input",58),l(),u(41,"div",15)(42,"label",16)(43,"span",3),d(44,"phone"),l(),d(45," Telefono Aziendale "),l(),N(46,"input",59),l(),u(47,"div",15)(48,"label",16)(49,"span",3),d(50,"email"),l(),d(51," Email Aziendale "),l(),N(52,"input",36),l(),u(53,"div",15)(54,"label",16)(55,"span",3),d(56,"room_preferences"),l(),d(57," Tipologia Timbratura "),l(),u(58,"div",60)(59,"label",61),N(60,"input",62)(61,"span",63),d(62," Libera "),l(),u(63,"label",61),N(64,"input",64)(65,"span",63),d(66," Punti Timbratura "),l()()(),E(67,l3,13,5,"div",65),u(68,"div",66)(69,"div",9),S("click",function(){D(e);let r=v(2);return I(r.toggleOpeningHours())}),u(70,"h3",5)(71,"span",3),d(72,"schedule"),l(),d(73," Orari di Lavoro "),l(),u(74,"button",67)(75,"span",3),d(76),l()()(),E(77,u3,8,1,"div",11),l(),u(78,"div",66)(79,"div",9),S("click",function(){D(e);let r=v(2);return I(r.toggleClosedDays())}),u(80,"h3",5)(81,"span",3),d(82,"event_busy"),l(),d(83," Giorni di Chiusura (festivit\xE0 / chiusure)"),l(),u(84,"button",68)(85,"span",3),d(86),l()()(),E(87,f3,17,13,"div",11),l()(),u(88,"div",20)(89,"button",21),E(90,p3,2,0,"span",22)(91,h3,1,0,"span",23),d(92),l()()()()}if(n&2){let e,i,r,o=v(2);p(),_("formGroup",o.aziendaForm),p(8),_("ngIf",((e=o.aziendaForm.get("name"))==null?null:e.invalid)&&((e=o.aziendaForm.get("name"))==null?null:e.touched)),p(7),_("ngIf",((i=o.aziendaForm.get("vat"))==null?null:i.invalid)&&((i=o.aziendaForm.get("vat"))==null?null:i.touched)),p(51),_("ngIf",((r=o.aziendaForm.get("timbratura_type"))==null?null:r.value)==="punti"),p(7),pn("aria-expanded",mr(o.showOpeningHours)),p(2),R(o.showOpeningHours?"expand_less":"expand_more"),p(),_("ngIf",o.showOpeningHours),p(7),pn("aria-expanded",mr(o.showClosedDays)),p(2),R(o.showClosedDays?"expand_less":"expand_more"),p(),_("ngIf",o.showClosedDays),p(2),_("disabled",o.aziendaForm.invalid||o.salvataggioAzienda),p(),_("ngIf",!o.salvataggioAzienda),p(),_("ngIf",o.salvataggioAzienda),p(),O(" ",o.salvataggioAzienda?"Salvando...":"Salva Azienda"," ")}}function g3(n,t){if(n&1){let e=j();u(0,"div",8)(1,"div",9),S("click",function(){D(e);let r=v();return I(r.toggleAzienda())}),u(2,"h2",5)(3,"span",3),d(4,"business"),l(),d(5," Dati Azienda"),l(),u(6,"button",52)(7,"span",3),d(8),l()()(),E(9,m3,93,16,"div",11),l()}if(n&2){let e=v();p(6),pn("aria-expanded",mr(e.showAzienda)),p(2),R(e.showAzienda?"expand_less":"expand_more"),p(),_("ngIf",e.showAzienda)}}function v3(n,t){n&1&&(u(0,"div",133)(1,"span",3),d(2,"inbox"),l(),u(3,"p"),d(4,"Nessun reparto creato"),l()())}function _3(n,t){if(n&1&&(u(0,"p",145),d(1),l()),n&2){let e=v(2).$implicit;p(),R(e.description)}}function y3(n,t){n&1&&(u(0,"p",6),d(1,"Nessuna descrizione"),l())}function b3(n,t){if(n&1&&(u(0,"div",140)(1,"div",141)(2,"h4"),d(3),l(),u(4,"span",142),d(5),l()(),E(6,_3,2,1,"p",143)(7,y3,2,0,"p",144),l()),n&2){let e=v().$implicit;p(3),R(e.name),p(2),O("",e.employee_count||0," dipendenti"),p(),_("ngIf",e.description),p(),_("ngIf",!e.description)}}function w3(n,t){if(n&1){let e=j();u(0,"div",146)(1,"input",147),S("ngModelChange",function(r){D(e);let o=v(4);return I(o.editingDepartment&&(o.editingDepartment.name=r))}),l(),u(2,"textarea",148),S("ngModelChange",function(r){D(e);let o=v(4);return I(o.editingDepartment&&(o.editingDepartment.description=r))}),l()()}if(n&2){let e=v(4);p(),_("ngModel",(e.editingDepartment==null?null:e.editingDepartment.name)||""),p(),_("ngModel",(e.editingDepartment==null?null:e.editingDepartment.description)||"")}}function E3(n,t){if(n&1){let e=j();u(0,"div",149)(1,"button",150),S("click",function(){D(e);let r=v().$implicit,o=v(3);return I(o.avviaModificaReparto(r))}),u(2,"span",3),d(3,"edit"),l()(),u(4,"button",151),S("click",function(){D(e);let r=v().$implicit,o=v(3);return I(o.eliminaReparto(r))}),u(5,"span",3),d(6,"delete"),l()()()}if(n&2){let e=v().$implicit;p(4),_("disabled",(e.employee_count||0)>0)}}function C3(n,t){if(n&1){let e=j();u(0,"div")(1,"button",152),S("click",function(){D(e);let r=v(4);return I(r.salvaModificaReparto())}),u(2,"span",3),d(3,"check"),l()(),u(4,"button",153),S("click",function(){D(e);let r=v(4);return I(r.annullaModificaReparto())}),u(5,"span",3),d(6,"close"),l()()()}}function S3(n,t){if(n&1&&(u(0,"div",134)(1,"div",135),E(2,b3,8,4,"div",136)(3,w3,3,2,"div",137),l(),u(4,"div",138),E(5,E3,7,1,"div",139)(6,C3,7,0,"div",11),l()()),n&2){let e=t.$implicit,i=v(3);p(2),_("ngIf",(i.editingDepartment==null?null:i.editingDepartment.id)!==e.id),p(),_("ngIf",(i.editingDepartment==null?null:i.editingDepartment.id)===e.id),p(2),_("ngIf",(i.editingDepartment==null?null:i.editingDepartment.id)!==e.id),p(),_("ngIf",(i.editingDepartment==null?null:i.editingDepartment.id)===e.id)}}function x3(n,t){if(n&1){let e=j();u(0,"div",126)(1,"div",127)(2,"h3",69),d(3,"Aggiungi Nuovo Reparto"),l(),u(4,"div",14)(5,"div",15)(6,"label",16),d(7,"Nome Reparto *"),l(),u(8,"input",128),G("ngModelChange",function(r){D(e);let o=v(2);return q(o.newDepartmentName,r)||(o.newDepartmentName=r),I(r)}),l()(),u(9,"div",15)(10,"label",16),d(11,"Descrizione"),l(),u(12,"textarea",129),G("ngModelChange",function(r){D(e);let o=v(2);return q(o.newDepartmentDescription,r)||(o.newDepartmentDescription=r),I(r)}),l()()(),u(13,"div",20)(14,"button",30),S("click",function(){D(e);let r=v(2);return I(r.aggiungiReparto())}),u(15,"span",3),d(16,"add"),l(),d(17," Aggiungi Reparto "),l()()(),u(18,"div",127)(19,"h3",69),d(20,"Reparti Esistenti"),l(),E(21,v3,5,0,"div",130),u(22,"div",131),E(23,S3,7,4,"div",132),l()()()}if(n&2){let e=v(2);p(8),W("ngModel",e.newDepartmentName),_("ngModelOptions",yt(7,Ln)),p(4),W("ngModel",e.newDepartmentDescription),_("ngModelOptions",yt(8,Ln)),p(2),_("disabled",!e.newDepartmentName||!e.newDepartmentName.trim()||e.salvataggioAzienda),p(7),_("ngIf",e.departments.length===0),p(2),_("ngForOf",e.departments)}}function D3(n,t){if(n&1){let e=j();u(0,"div",8)(1,"div",9),S("click",function(){D(e);let r=v();return I(r.toggleGestioneReparti())}),u(2,"h2",5)(3,"span",3),d(4,"groups"),l(),d(5," Gestione Reparti"),l(),u(6,"button",124)(7,"span",3),d(8),l()()(),E(9,x3,24,9,"div",125),l()}if(n&2){let e=v();p(6),pn("aria-expanded",mr(e.showGestioneReparti)),p(2),R(e.showGestioneReparti?"expand_less":"expand_more"),p(),_("ngIf",e.showGestioneReparti)}}function I3(n,t){if(n&1&&(u(0,"option",156),d(1),l()),n&2){let e=t.$implicit;_("ngValue",e.id),p(),sd("",e.first_name," ",e.last_name," (",e.email,")")}}function T3(n,t){if(n&1){let e=j();u(0,"label",46)(1,"input",170),S("change",function(r){let o=D(e).$implicit,s=v(5);return I(s.toggleManagerUser(o.id,r))}),l(),d(2),l()}if(n&2){let e=t.$implicit,i=v(5);p(),_("value",e.id)("checked",i.managerConfig.user_ids.includes(e.id)),p(),be(" ",e.first_name," ",e.last_name," ")}}function M3(n,t){if(n&1){let e=j();u(0,"div",39)(1,"button",105),S("click",function(){D(e);let r=v(5);return I(r.toggleShowEmployees())}),d(2),l()()}if(n&2){let e=v(5);p(2),O(" ",e.showAllEmployees?"Mostra meno":"Mostra tutti ("+e.companyEmployees.length+")"," ")}}function A3(n,t){if(n&1&&(u(0,"div",15)(1,"label",16),d(2,"Seleziona Utenti"),l(),u(3,"div",167),E(4,T3,3,4,"label",168),K(5,"slice"),l(),E(6,M3,3,1,"div",169),l()),n&2){let e=v(4);p(4),_("ngForOf",e.showAllEmployees?e.companyEmployees:Ig(5,2,e.companyEmployees,0,10)),p(2),_("ngIf",e.companyEmployees.length>10)}}function R3(n,t){if(n&1){let e=j();u(0,"label",46)(1,"input",170),S("change",function(r){let o=D(e).$implicit,s=v(5);return I(s.toggleManagerRole(o,r))}),l(),d(2),l()}if(n&2){let e=t.$implicit,i=v(5);p(),_("value",e)("checked",i.managerConfig.roles.includes(e)),p(),O(" ",e," ")}}function O3(n,t){if(n&1&&(u(0,"div",15)(1,"label",16),d(2,"Seleziona Ruoli"),l(),u(3,"div",171),E(4,R3,3,3,"label",168),l()()),n&2){let e=v(4);p(4),_("ngForOf",e.availableRoles)}}function N3(n,t){if(n&1){let e=j();u(0,"label",46)(1,"input",170),S("change",function(r){let o=D(e).$implicit,s=v(5);return I(s.toggleManagerDepartment(o.id,r))}),l(),d(2),l()}if(n&2){let e=t.$implicit,i=v(5);p(),_("value",e.id)("checked",i.managerConfig.department_ids==null?null:i.managerConfig.department_ids.includes(e.id)),p(),O(" ",e.name," ")}}function P3(n,t){if(n&1&&(u(0,"div",15)(1,"label",16),d(2,"Seleziona Reparti"),l(),u(3,"div",131),E(4,N3,3,3,"label",168),l()()),n&2){let e=v(4);p(4),_("ngForOf",e.departments)}}function k3(n,t){if(n&1){let e=j();u(0,"div",159)(1,"div",15)(2,"label",16),d(3,"Modalit\xE0 di visibilit\xE0"),l(),u(4,"div",160)(5,"label",61)(6,"input",161),G("ngModelChange",function(r){D(e);let o=v(3);return q(o.managerConfig.mode,r)||(o.managerConfig.mode=r),I(r)}),l(),d(7," Solo proprie timbrature"),l(),u(8,"label",61)(9,"input",162),G("ngModelChange",function(r){D(e);let o=v(3);return q(o.managerConfig.mode,r)||(o.managerConfig.mode=r),I(r)}),l(),d(10," Lista utenti selezionati"),l(),E(11,A3,7,6,"div",163),u(12,"label",61)(13,"input",164),G("ngModelChange",function(r){D(e);let o=v(3);return q(o.managerConfig.mode,r)||(o.managerConfig.mode=r),I(r)}),l(),d(14," Per ruolo"),l(),E(15,O3,5,1,"div",163),u(16,"label",61)(17,"input",165),G("ngModelChange",function(r){D(e);let o=v(3);return q(o.managerConfig.mode,r)||(o.managerConfig.mode=r),I(r)}),l(),d(18," Per reparto"),l(),E(19,P3,5,1,"div",163),l()(),u(20,"div",127)(21,"h4",69),d(22,"Permessi Responsabile"),l(),u(23,"div",166)(24,"label",46)(25,"input",26),G("ngModelChange",function(r){D(e);let o=v(3);return q(o.managerConfig.can_view_all_employees,r)||(o.managerConfig.can_view_all_employees=r),I(r)}),l(),N(26,"span",27),d(27," Pu\xF2 vedere tutti i dipendenti dell'azienda "),l(),u(28,"label",46)(29,"input",26),G("ngModelChange",function(r){D(e);let o=v(3);return q(o.managerConfig.can_manage_departments,r)||(o.managerConfig.can_manage_departments=r),I(r)}),l(),N(30,"span",27),d(31," Pu\xF2 gestire i reparti (creare, modificare, eliminare) "),l()()(),u(32,"div",20)(33,"button",30),S("click",function(){D(e);let r=v(3);return I(r.salvaManagerVisibility())}),d(34," Salva Visibilit\xE0 "),l()()()}if(n&2){let e=v(3);p(6),W("ngModel",e.managerConfig.mode),p(3),W("ngModel",e.managerConfig.mode),p(2),_("ngIf",e.managerConfig.mode==="selected_users"),p(2),W("ngModel",e.managerConfig.mode),p(2),_("ngIf",e.managerConfig.mode==="roles"),p(2),W("ngModel",e.managerConfig.mode),p(2),_("ngIf",e.managerConfig.mode==="department"),p(6),W("ngModel",e.managerConfig.can_view_all_employees),p(4),W("ngModel",e.managerConfig.can_manage_departments),p(4),_("disabled",e.salvataggioAzienda)}}function F3(n,t){if(n&1){let e=j();u(0,"div",126)(1,"div",15)(2,"label",16),d(3,"Seleziona Responsabile"),l(),u(4,"select",155),G("ngModelChange",function(r){D(e);let o=v(2);return q(o.selectedManagerId,r)||(o.selectedManagerId=r),I(r)}),S("change",function(){D(e);let r=v(2);return I(r.onManagerSelected())}),u(5,"option",156),d(6,"-- Seleziona --"),l(),E(7,I3,2,4,"option",157),l()(),E(8,k3,35,10,"div",158),l()}if(n&2){let e=v(2);p(4),W("ngModel",e.selectedManagerId),p(),_("ngValue",null),p(2),_("ngForOf",e.managerUsers),p(),_("ngIf",e.selectedManagerId)}}function L3(n,t){if(n&1){let e=j();u(0,"div",8)(1,"div",9),S("click",function(){D(e);let r=v();return I(r.toggleVisibilitaResponsabili())}),u(2,"h2",5)(3,"span",3),d(4,"visibility"),l(),d(5," Visibilit\xE0 Responsabili"),l(),u(6,"button",154)(7,"span",3),d(8),l()()(),E(9,F3,9,4,"div",125),l()}if(n&2){let e=v();p(6),pn("aria-expanded",mr(e.showVisibilitaResponsabili)),p(2),R(e.showVisibilitaResponsabili?"expand_less":"expand_more"),p(),_("ngIf",e.showVisibilitaResponsabili)}}function j3(n,t){n&1&&(u(0,"span",3),d(1,"lock"),l())}function V3(n,t){n&1&&N(0,"span",51)}function z3(n,t){if(n&1){let e=j();u(0,"label",25)(1,"input",26),G("ngModelChange",function(r){D(e);let o=v();return q(o.impostazioniNotifiche.notificheAmministratore,r)||(o.impostazioniNotifiche.notificheAmministratore=r),I(r)}),l(),N(2,"span",27),u(3,"div",28)(4,"strong"),d(5,"Notifiche Amministratore"),l(),u(6,"span"),d(7,"Ricevi notifiche per le attivit\xE0 aziendali"),l()()()}if(n&2){let e=v();p(),W("ngModel",e.impostazioniNotifiche.notificheAmministratore)}}function U3(n,t){n&1&&(u(0,"span",3),d(1,"save"),l())}function B3(n,t){n&1&&N(0,"span",51)}function $3(n,t){if(n&1&&(u(0,"div",172)(1,"span",3),d(2,"check_circle"),l(),d(3),l()),n&2){let e=v();p(3),O(" ",e.messaggioSuccesso," ")}}function H3(n,t){if(n&1&&(u(0,"div",173)(1,"span",3),d(2,"error"),l(),d(3),l()),n&2){let e=v();p(3),O(" ",e.messaggioErrore," ")}}var hp=class n{constructor(t,e,i,r,o){this.fb=t;this.authService=e;this.companyService=i;this.dipendentiService=r;this.departmentsService=o;this.profiloForm=this.creaProfiloForm(),this.aziendaForm=this.creaAziendaForm(),this.sicurezzaForm=this.creaSicurezzaForm()}profiloForm;aziendaForm;sicurezzaForm;giorniChiusura=[];newDate=null;newDateLabel=null;rangeStart=null;rangeEnd=null;currentYear=new Date().getFullYear();punchPoints=[];newPoint={name:"",address:"",civic_number:"",city:null,province:null,lat:null,lng:null,radius_m:50};showAllEmployees=!1;companyEmployees=[];availableRoles=[];selectedManagerId=null;managerConfig={mode:"self",user_ids:[],roles:[],department_ids:[],can_view_all_employees:!1,can_manage_departments:!1};managerVisibilityMap={};currentUser=null;aziendaCorrente=null;impostazioniNotifiche={emailNotifiche:!0,riepilogoGiornaliero:!1,notificheAmministratore:!0};closedDays=[];salvataggioProfilo=!1;salvataggioAzienda=!1;salvataggioPassword=!1;salvataggioNotifiche=!1;departments=[];newDepartmentName="";newDepartmentDescription="";editingDepartment=null;messaggioSuccesso="";messaggioErrore="";giorniSettimana=[{key:"monday",label:"Luned\xEC"},{key:"tuesday",label:"Marted\xEC"},{key:"wednesday",label:"Mercoled\xEC"},{key:"thursday",label:"Gioved\xEC"},{key:"friday",label:"Venerd\xEC"},{key:"saturday",label:"Sabato"},{key:"sunday",label:"Domenica"}];showAddPointForm=!1;showOpeningHours=!1;showProfilo=!1;showAzienda=!1;showReparti=!1;showClosedDays=!1;showGestioneReparti=!1;showVisibilitaResponsabili=!1;ngOnInit(){this.aziendaForm=this.creaAziendaForm(),this.authService.currentUser$.subscribe(t=>{this.currentUser=t??null,t&&(this.caricaDatiProfilo(),this.companyService.getAziendaForUser(t.id,t.company_id).subscribe({next:e=>{if(!e){console.warn("[Impostazioni] nessuna azienda trovata per utente",t.id);return}this.aziendaCorrente=e,this.managerVisibilityMap=e.manager_visibility??{},this.loadManagerVisibilityData(),this.hasRole("admin")&&this.caricaReparti(),this.patchAziendaForm(e);let i=this.openingHoursGroup;i&&i.valueChanges.pipe(Wp(800),Gp((r,o)=>JSON.stringify(r)===JSON.stringify(o))).subscribe(()=>{this.aziendaCorrente?.id&&this.autoSaveOpeningHours()})},error:e=>{console.error("[Impostazioni] errore getAziendaForUser",e)}}))})}safeGet(t,e=""){return t??e}creaProfiloForm(){return this.fb.group({first_name:["",Q.required],last_name:["",Q.required],email:["",[Q.required,Q.email]],phone:[""],hire_date:[""],birth_date:[""],birth_place:[""],fiscal_code:[""],job_title:[""],monthly_hours:[null],full_time:[!1],timezone:["Europe/Rome"]})}creaAziendaForm(){let t=this.fb.group({});return this.giorniSettimana.forEach(e=>{t.addControl(e.key,this.fb.group({open:[""],close:[""],closed:[!1]}))}),this.fb.group({name:["",Q.required],vat:["",Q.required],address:[""],city:[""],province:[""],numero_telefono:[""],email:["",Q.email],website:[""],opening_hours:t,timbratura_type:["libera"]})}get openingHoursGroup(){return this.aziendaForm.get("opening_hours")}patchAziendaForm(t){let e=P({},t);t.opening_hours&&(e.opening_hours=t.opening_hours),e.timbratura_type=t.timbratura_type??"libera",this.aziendaForm.patchValue(e),this.punchPoints=t.punch_points?[...t.punch_points]:[],t.city&&(this.newPoint.city=t.city),t.province&&(this.newPoint.province=t.province);let i=this.openingHoursGroup,r=t?.opening_hours;console.log("[Impostazioni] Dati opening_hours dal DB:",r),r&&typeof r=="object"?this.giorniSettimana.forEach(s=>{let a=r[s.key],c=i.get(s.key);c&&a?(console.log(`[Impostazioni] Patch giorno ${s.key}:`,a),c.patchValue({open:a.open||"",close:a.close||"",closed:a.closed||!1})):console.warn(`[Impostazioni] FormGroup non trovato per giorno: ${s.key}`)}):console.warn("[Impostazioni] opening_hours non trovato o non valido:",r);let o=t.closed_days;o&&Array.isArray(o)&&o.length>0?this.giorniChiusura=o.map(s=>{if(!s)return null;if(typeof s=="string")if(s.includes("/")){let[a,c]=s.split("/");return{type:"range",start:a,end:c,label:`Chiusura ${this.formatDateDisplay(a)}`}}else{let a=this.festivitaMap()[s];return{type:"single",start:s,label:a??"Festa"}}return{type:s.type==="range"?"range":"single",start:s.start,end:s.end??void 0,label:s.label??(s.type==="range"?`Chiusura ${this.formatDateDisplay(s.start)}`:"Festa")}}).filter(Boolean):this.giorniChiusura.length===0&&(this.giorniChiusura=this.getFestivitaItalianeDetailed(this.currentYear))}debugOrari(){console.log("=== DEBUG ORARI ==="),console.log("giorniSettimana:",this.giorniSettimana),console.log("openingHoursGroup:",this.openingHoursGroup),console.log("openingHoursGroup valid:",this.openingHoursGroup?.valid),console.log("openingHoursGroup value:",JSON.stringify(this.openingHoursGroup?.value,null,2)),console.log("showOpeningHours:",this.showOpeningHours),this.giorniSettimana.forEach(t=>{let e=this.openingHoursGroup?.get(t.key);console.log(`${t.label} (${t.key}):`,{open:e?.get("open")?.value,close:e?.get("close")?.value,closed:e?.get("closed")?.value,valid:e?.valid})})}aggiungiGiornoSingolo(){if(!this.newDate)return;let t=(this.newDateLabel||"").trim()||"Festa personalizzata";this.giorniChiusura.some(i=>i.type==="single"&&i.start===this.newDate)||(this.giorniChiusura.push({type:"single",start:this.newDate,label:t}),this.newDate=null,this.newDateLabel=null,this.persistClosedDays())}aggiungiIntervallo(){if(!this.rangeStart||!this.rangeEnd)return;if(this.rangeEnd<this.rangeStart){let e=this.rangeStart;this.rangeStart=this.rangeEnd,this.rangeEnd=e}this.giorniChiusura.some(e=>e.type==="range"&&e.start===this.rangeStart&&e.end===this.rangeEnd)||(this.giorniChiusura.push({type:"range",start:this.rangeStart,end:this.rangeEnd,label:"Intervallo personalizzato"}),this.rangeStart=null,this.rangeEnd=null,this.persistClosedDays())}rimuoviGiornoChiusura(t){this.giorniChiusura.splice(t,1),this.persistClosedDays()}ripristinaFestivita(){this.giorniChiusura=this.getFestivitaItalianeDetailed(this.currentYear)}persistClosedDays(){if(!this.aziendaCorrente?.id){console.warn("[Impostazioni] persistClosedDays: aziendaCorrente mancante, skip save");return}let t={closed_days:this.closedDaysToPayload()};this.salvataggioAzienda=!0,this.messaggioErrore="",this.companyService.aggiornaAzienda(this.aziendaCorrente.id,t).subscribe({next:e=>{this.salvataggioAzienda=!1,e&&(this.aziendaCorrente=e,this.patchAziendaForm(e)),this.messaggioSuccesso="Festivit\xE0 salvata",this.nascondiMessaggioDopoTimeout()},error:e=>{this.salvataggioAzienda=!1,console.error("[Impostazioni] errore persistClosedDays",e),this.messaggioErrore="Errore durante il salvataggio delle festivit\xE0",this.nascondiMessaggioDopoTimeout()}})}closedDaysToPayload(){return this.giorniChiusura.map(t=>t?t.type==="range"?{type:"range",start:t.start,end:t.end,label:t.label??`Chiusura ${this.formatDateDisplay(t.start)}`}:{type:"single",start:t.start,label:t.label??"Festa"}:null).filter(Boolean)}creaSicurezzaForm(){return this.fb.group({currentPassword:[""],newPassword:[""],confirmPassword:[""]})}caricaDatiProfilo(){this.currentUser&&(this.profiloForm.patchValue({first_name:this.currentUser.first_name,last_name:this.currentUser.last_name,email:this.currentUser.email,phone:this.currentUser.phone||"",hire_date:this.currentUser.hire_date??"",birth_date:this.currentUser.birth_date??"",birth_place:this.currentUser.birth_place??"",fiscal_code:this.currentUser.fiscal_code??"",job_title:this.currentUser.job_title??"",monthly_hours:this.currentUser.monthly_hours??null,full_time:this.currentUser.full_time??!1,timezone:this.currentUser.timezone??"Europe/Rome"}),this.currentUser.notifications_preferences&&(this.impostazioniNotifiche=P(P({},this.impostazioniNotifiche),this.currentUser.notifications_preferences)),this.hasRole("admin")?this.profiloForm.get("hire_date")?.enable():this.profiloForm.get("hire_date")?.disable())}caricaDatiAzienda(t){t&&this.companyService.getAzienda(t).subscribe({next:e=>{if(!e){console.warn("Nessuna azienda trovata per id",t);return}this.aziendaCorrente=e;let i=P({},e);e.opening_hours&&(i.opening_hours=e.opening_hours),this.aziendaForm.patchValue(i);let r=e.closed_days;r&&Array.isArray(r)&&r.length>0?this.giorniChiusura=r.map(s=>{if(typeof s!="string")return null;if(s.includes("/")){let[a,c]=s.split("/");return{type:"range",start:a,end:c,label:`Chiusura ${this.formatDateDisplay(a)}`}}else{let a=this.festivitaMap()[s];return{type:"single",start:s,label:a??"Festa"}}}).filter(Boolean):this.giorniChiusura=this.getFestivitaItalianeDetailed(this.currentYear);let o=this.openingHoursGroup;e.opening_hours&&Object.keys(e.opening_hours).forEach(s=>{let a=o.get(s);a&&(a.get("open")?.setValue(e.opening_hours?.[s]?.open??""),a.get("close")?.setValue(e.opening_hours?.[s]?.close??""),a.get("closed")?.setValue(!!e.opening_hours?.[s]?.closed))})},error:e=>{console.error("Errore nel caricamento dati azienda:",e)}})}hasRole(t){return this.authService.hasRole(t)}salvaProfilo(){return b(this,null,function*(){if(this.profiloForm.invalid||!this.currentUser){this.profiloForm.markAllAsTouched();return}this.salvataggioProfilo=!0,this.messaggioErrore="";try{let t=this.profiloForm.getRawValue(),e={first_name:t.first_name,last_name:t.last_name,email:t.email,phone:t.phone||null,birth_date:t.birth_date?t.birth_date:null,birth_place:t.birth_place||null,fiscal_code:t.fiscal_code||null,job_title:t.job_title||null,monthly_hours:t.monthly_hours!==""&&t.monthly_hours!=null?Number(t.monthly_hours):null,full_time:!!t.full_time,timezone:t.timezone||null};this.hasRole("admin")&&(e.hire_date=t.hire_date?t.hire_date:null),e.notifications_preferences=this.impostazioniNotifiche;let i=yield this.authService.updateUserProfile(this.currentUser.id,e);this.currentUser=i??this.currentUser,this.messaggioSuccesso="Profilo aggiornato con successo!",this.nascondiMessaggioDopoTimeout(),this.showSystemNotification("Aggiornato il profilo con successo")}catch(t){console.error("[Impostazioni] errore salvaProfilo",t),this.messaggioErrore="Errore durante il salvataggio del profilo"}finally{this.salvataggioProfilo=!1}})}salvaAzienda(){if(this.aziendaForm.invalid){this.aziendaForm.markAllAsTouched();return}this.salvataggioAzienda=!0,this.messaggioErrore="";let t=this.aziendaForm.value,e={},i=this.aziendaForm.get("opening_hours");this.giorniSettimana.forEach(o=>{let s=i.get(o.key);e[o.key]={open:s.get("open")?.value||null,close:s.get("close")?.value||null,closed:!!s.get("closed")?.value}});let r=Y(P({},t),{opening_hours:e,closed_days:this.closedDaysToPayload(),timbratura_type:t.timbratura_type??"libera",punch_points:this.punchPoints});console.debug("[Impostazioni] salvaAzienda payload:",r,"companyId:",this.aziendaCorrente?.id),this.companyService.aggiornaAzienda(this.aziendaCorrente.id,r).subscribe({next:o=>{this.salvataggioAzienda=!1,o&&(this.aziendaCorrente=o,this.patchAziendaForm(o)),this.messaggioSuccesso="Dati azienda aggiornati con successo!",this.nascondiMessaggioDopoTimeout()},error:o=>{this.salvataggioAzienda=!1,this.messaggioErrore="Errore durante il salvataggio dei dati azienda",console.error("Errore aggiornamento azienda:",o)}})}showSystemNotification(t,e=!1){return b(this,null,function*(){if(!("Notification"in window)){console.debug("[Impostazioni] Notification API non disponibile");return}if(!(location.protocol==="https:"||location.hostname==="localhost"||location.hostname==="127.0.0.1")){console.debug("[Impostazioni] Notification API richiede HTTPS o localhost");return}try{if(Notification.permission==="granted"){new Notification(t,{silent:!1});return}if(Notification.permission!=="denied"){let r=yield Notification.requestPermission();r==="granted"?new Notification(t,{silent:!1}):console.debug("[Impostazioni] Notification permission non concessa:",r)}else console.debug("[Impostazioni] Notification permission \xE8 denied")}catch(r){console.warn("[Impostazioni] errore Notification API",r)}})}cambiaPassword(){if(this.sicurezzaForm.invalid){this.sicurezzaForm.markAllAsTouched();return}this.salvataggioPassword=!0,this.messaggioErrore="",setTimeout(()=>{this.salvataggioPassword=!1,this.sicurezzaForm.reset(),this.messaggioSuccesso="Password cambiata con successo!",this.nascondiMessaggioDopoTimeout()},1e3)}salvaNotifiche(){return b(this,null,function*(){if(!this.currentUser){console.debug("[Impostazioni] salvaNotifiche: utente non autenticato");return}this.salvataggioNotifiche=!0,this.messaggioErrore="";let t=null;try{"Notification"in window?location.protocol==="https:"||location.hostname==="localhost"||location.hostname==="127.0.0.1"?(t=yield Notification.requestPermission(),console.debug("[Impostazioni] Notification.requestPermission =>",t)):console.debug("[Impostazioni] Notification API richiede HTTPS o localhost"):console.debug("[Impostazioni] Notification API non disponibile")}catch(i){console.warn("[Impostazioni] errore requestPermission",i)}let e={notifications_preferences:this.impostazioniNotifiche};console.debug("[Impostazioni] salvaNotifiche payload:",e);try{let i=yield this.authService.updateUserProfile(this.currentUser.id,e);if(console.debug("[Impostazioni] updateUserProfile response:",i),this.currentUser=i??this.currentUser,this.salvataggioNotifiche=!1,this.messaggioSuccesso="Preferenze notifiche salvate!",this.nascondiMessaggioDopoTimeout(),t==="granted")try{new Notification("Aggiornato il profilo con successo")}catch(r){console.warn("[Impostazioni] errore creazione Notification",r)}else console.debug("[Impostazioni] permesso notifiche non concesso, nessuna notifica di sistema mostrata")}catch(i){let r=i&&(i.message||i.error||JSON.stringify(i))||"Errore sconosciuto";if(console.error("[Impostazioni] errore salvaNotifiche",i),this.salvataggioNotifiche=!1,this.messaggioErrore="Errore durante il salvataggio delle preferenze: "+r,t==="granted")try{new Notification("Salvataggio preferenze fallito")}catch{}}})}toggleGiornoChiusura(t){let e=t.target,i=e.value;if(i){e.checked?this.giorniChiusura.some(o=>o.type==="single"&&o.start===i)||this.giorniChiusura.push({type:"single",start:i,label:"Festa personalizzata"}):this.giorniChiusura=this.giorniChiusura.filter(r=>!(r.type==="single"&&r.start===i));try{this.persistClosedDays()}catch(r){console.warn("[Impostazioni] persistClosedDays failed from toggleGiornoChiusura",r)}}}formatDateDisplay(t){if(!t)return"";let e=t.split("-");if(e.length!==3)return t;let[i,r,o]=e;return`${o}/${r}/${i}`}formatClosedDay(t){return t?t.type==="range"?`${this.formatDateDisplay(t.start)} \u2192 ${this.formatDateDisplay(t.end??"")}`:this.formatDateDisplay(t.start):""}nascondiMessaggioDopoTimeout(){setTimeout(()=>{this.messaggioSuccesso="",this.messaggioErrore=""},5e3)}getFestivitaItalianeDetailed(t){let e=h=>h.toString().padStart(2,"0"),i=h=>`${h.getFullYear()}-${e(h.getMonth()+1)}-${e(h.getDate())}`,r={[i(new Date(t,0,1))]:"Capodanno",[i(new Date(t,0,6))]:"Epifania",[i(new Date(t,3,25))]:"Festa della Liberazione",[i(new Date(t,4,1))]:"Festa del Lavoro",[i(new Date(t,5,2))]:"Festa della Repubblica",[i(new Date(t,7,15))]:"Ferragosto",[i(new Date(t,10,1))]:"Ognissanti",[i(new Date(t,11,8))]:"Immacolata Concezione",[i(new Date(t,11,25))]:"Natale",[i(new Date(t,11,26))]:"Santo Stefano"},o=this.calculateEasterDate(t),s=i(o),a=new Date(o);a.setDate(a.getDate()+1);let c=i(a),f=[];return Object.keys(r).forEach(h=>f.push({type:"single",start:h,label:r[h]})),f.push({type:"single",start:s,label:"Pasqua"}),f.push({type:"single",start:c,label:"Pasquetta"}),f.sort((h,m)=>h.start>m.start?1:h.start<m.start?-1:0),f}festivitaMap(){let t=this.getFestivitaItalianeDetailed(this.currentYear),e={};return t.forEach(i=>{e[i.start]=i.label??"Festa"}),e}calculateEasterDate(t){let e=t%19,i=Math.floor(t/100),r=t%100,o=Math.floor(i/4),s=i%4,a=Math.floor((i+8)/25),c=Math.floor((i-a+1)/3),f=(19*e+i-o-c+15)%30,h=Math.floor(r/4),m=r%4,y=(32+2*s+2*h-f-m)%7,g=Math.floor((e+11*f+22*y)/451),w=Math.floor((f+y-7*g+114)/31),T=(f+y-7*g+114)%31+1;return new Date(t,w-1,T)}loadManagerVisibilityData(){if(!this.aziendaCorrente?.id){console.debug("[Impostazioni] loadManagerVisibilityData called without aziendaCorrente.id");return}let t=this.aziendaCorrente.id;console.debug("[Impostazioni] loadManagerVisibilityData companyId=",t),this.dipendentiService.getDipendenti(t).subscribe({next:e=>{let i=e??[];console.debug("[Impostazioni] loadManagerVisibilityData response count=",i.length),this.companyEmployees=i;let r=new Set;i.forEach(o=>{o&&typeof o.role=="string"&&o.role.trim()&&r.add(o.role)}),this.availableRoles=Array.from(r),i.length===0&&console.warn("[Impostazioni] loadManagerVisibilityData: no employees returned for company",t)},error:e=>{console.error("[Impostazioni] errore loadManagerVisibilityData",e)}})}onManagerSelected(){if(!this.selectedManagerId){this.managerConfig={mode:"self",user_ids:[],roles:[]};return}let t=this.managerVisibilityMap[this.selectedManagerId]??{mode:"self",user_ids:[],roles:[]};this.managerConfig={mode:t.mode??"self",user_ids:Array.isArray(t.user_ids)?t.user_ids:[],roles:Array.isArray(t.roles)?t.roles:[]}}toggleManagerUser(t,e){let i=e.target.checked,r=this.managerConfig.user_ids.indexOf(t);i&&r===-1?this.managerConfig.user_ids.push(t):!i&&r!==-1&&this.managerConfig.user_ids.splice(r,1)}toggleManagerRole(t,e){e.target.checked?this.managerConfig.roles.includes(t)||this.managerConfig.roles.push(t):this.managerConfig.roles=this.managerConfig.roles.filter(r=>r!==t)}salvaManagerVisibility(){if(!this.aziendaCorrente||!this.aziendaCorrente.id||!this.selectedManagerId)return;this.managerVisibilityMap[this.selectedManagerId]=P({},this.managerConfig);let t={manager_visibility:this.managerVisibilityMap};this.salvataggioAzienda=!0,console.debug("[Impostazioni] salvaManagerVisibility payload =>",{companyId:this.aziendaCorrente.id,payload:t}),this.companyService.aggiornaAzienda(this.aziendaCorrente.id,t).subscribe({next:e=>{this.salvataggioAzienda=!1,console.debug("[Impostazioni] salvaManagerVisibility response =>",e),this.messaggioSuccesso="Visibilit\xE0 responsabile salvata",this.nascondiMessaggioDopoTimeout()},error:e=>{this.salvataggioAzienda=!1,this.messaggioErrore="Errore salvataggio visibilit\xE0 responsabile: "+(e?.message||JSON.stringify(e)),console.error("[Impostazioni] salvaManagerVisibility error",e)}})}addPunchPoint(){return b(this,null,function*(){if(this.messaggioErrore="",!this.aziendaCorrente?.id){if(!this.currentUser){this.messaggioErrore="Azienda non selezionata e utente non autenticato",console.debug("[Impostazioni] addPunchPoint abort: aziendaCorrente missing and no currentUser",{currentUser:this.currentUser});return}try{let c=yield er(this.companyService.getAziendaForUser(this.currentUser.id,this.currentUser.company_id));c&&(this.aziendaCorrente=c,this.punchPoints=[...c.punch_points||[]],this.patchAziendaForm(c))}catch(c){console.warn("[Impostazioni] fallback getAziendaForUser failed",c)}}if(!this.aziendaCorrente?.id){this.messaggioErrore="Azienda non selezionata",console.debug("[Impostazioni] addPunchPoint abort: aziendaCorrente missing after reload attempt",{currentUser:this.currentUser});return}let t=P({},this.newPoint);t.radius_m=Number(t.radius_m)||50;let e=t.address||"",i=t.civic_number||"",r=t.city||this.aziendaCorrente?.city||"",o=t.province||this.aziendaCorrente?.province||"",s=yield this.geocodeAddress(e,i,r,o);if(!s){this.messaggioErrore="Impossibile trovare coordinate per l'indirizzo inserito. Controlla indirizzo/civico/citt\xE0.";return}t.lat=s.lat,t.lng=s.lng,t.address=s.displayName,t.id=Math.random().toString(36).slice(2,9),delete t.civic_number;let a=[...this.punchPoints||[],t];this.salvataggioAzienda=!0,this.companyService.aggiornaAzienda(this.aziendaCorrente.id,{punch_points:a}).subscribe({next:c=>b(this,null,function*(){this.salvataggioAzienda=!1,console.debug("[Impostazioni] aggiornaAzienda response",c);try{if(!this.currentUser)console.warn("[Impostazioni] currentUser non definito, salto refresh azienda");else{let f=yield er(this.companyService.getAziendaForUser(this.currentUser.id,this.currentUser.company_id));f&&(this.aziendaCorrente=f,this.punchPoints=[...f.punch_points||[]],this.patchAziendaForm(f))}}catch(f){console.warn("[Impostazioni] impossibile ricaricare azienda dopo update",f),c&&(this.aziendaCorrente=c,this.punchPoints=c.punch_points||a,this.patchAziendaForm(c))}this.messaggioSuccesso="Punto di timbratura salvato",this.nascondiMessaggioDopoTimeout()}),error:c=>{this.salvataggioAzienda=!1,console.error("[Impostazioni] errore salva punch_point",c),this.messaggioErrore="Errore durante il salvataggio del punto (verifica permessi / console network)"}})})}removePunchPoint(t){this.punchPoints.splice(t,1)}toggleShowEmployees(){this.showAllEmployees=!this.showAllEmployees}geocodeAddress(t,e,i,r){return b(this,null,function*(){let o=[];t&&o.push(t),e&&o.push(e),i&&o.push(i),r&&o.push(r);let s=o.join(", ");if(!s)return null;let a="https://nominatim.openstreetmap.org/search?format=json&limit=1&q="+encodeURIComponent(s);try{let c=yield fetch(a,{method:"GET",headers:{Accept:"application/json"}});if(!c.ok)return null;let f=yield c.json();if(!Array.isArray(f)||f.length===0)return null;let h=f[0];return{lat:Number(h.lat),lng:Number(h.lon),displayName:h.display_name}}catch(c){return console.error("[Impostazioni] geocodeAddress error",c),null}})}getStreet(t){let e=(t?.address||t?.name||"").toString().trim();if(!e)return"";let i=e.split(",").map(s=>s.trim()).filter(Boolean),r=i[0]||"",o=r.match(/^(.*\D)\s+(\d+\S*)$/);return o?o[1].trim():i.length>=2&&/^\d+\S*$/.test(i[0])?i[1]:r}getCivic(t){let e=(t?.address||"").toString().trim();if(!e)return"";let i=e.split(",").map(s=>s.trim()).filter(Boolean),o=(i[0]||"").match(/^(.*\D)\s+(\d+\S*)$/);return o?o[2].trim():i.length>=2&&/^\d+\S*$/.test(i[0])?i[0]:i.length>=2&&/^\d+\S*$/.test(i[1])?i[1]:""}getCityProvince(t){let e=(t?.city||"").toString().trim(),i=(t?.province||"").toString().trim();if(e||i)return`${e}${i&&e!==i?" "+i:""}`.trim();let r=(t?.address||"").toString().trim();if(!r)return"";let o=r.split(",").map(f=>f.trim()).filter(Boolean),s=["italia","italy"];for(;o.length&&s.includes(o[o.length-1].toLowerCase());)o.pop();for(;o.length&&/^\d{4,}$/.test(o[o.length-1]);)o.pop();let a=this.getStreet(t),c=this.getCivic(t);for(let f=o.length-1;f>=0;f--){let h=o[f];if(h&&!(h===a||h===c)&&!(/^\d+$/.test(h)||h.length>40))return h}return""}caricaReparti(){if(!this.aziendaCorrente?.id){console.debug("[Impostazioni] caricaReparti called without aziendaCorrente.id");return}console.debug("[Impostazioni] caricaReparti companyId=",this.aziendaCorrente.id),this.departmentsService.getDepartments(this.aziendaCorrente.id).subscribe({next:t=>{console.debug("[Impostazioni] caricaReparti response count=",(t||[]).length),this.departments=t},error:t=>{console.error("[Impostazioni] errore caricamento reparti",t)}})}aggiungiReparto(){if(!this.newDepartmentName.trim()||!this.aziendaCorrente?.id)return;let t={company_id:this.aziendaCorrente.id,name:this.newDepartmentName.trim(),description:this.newDepartmentDescription.trim()||void 0};this.departmentsService.createDepartment(t).subscribe({next:e=>{this.departments.push(e),this.newDepartmentName="",this.newDepartmentDescription="",this.messaggioSuccesso="Reparto aggiunto con successo",this.nascondiMessaggioDopoTimeout()},error:e=>{console.error("[Impostazioni] errore aggiunta reparto",e),this.messaggioErrore="Errore durante l'aggiunta del reparto",this.nascondiMessaggioDopoTimeout()}})}avviaModificaReparto(t){this.editingDepartment=P({},t)}salvaModificaReparto(){this.editingDepartment&&this.departmentsService.updateDepartment(this.editingDepartment.id,{name:this.editingDepartment.name,description:this.editingDepartment.description}).subscribe({next:t=>{let e=this.departments.findIndex(i=>i.id===t.id);e!==-1&&(this.departments[e]=t),this.editingDepartment=null,this.messaggioSuccesso="Reparto aggiornato con successo",this.nascondiMessaggioDopoTimeout()},error:t=>{console.error("[Impostazioni] errore modifica reparto",t),this.messaggioErrore="Errore durante la modifica del reparto",this.nascondiMessaggioDopoTimeout()}})}annullaModificaReparto(){this.editingDepartment=null}toggleManagerDepartment(t,e){let i=e.target.checked;this.managerConfig.department_ids||(this.managerConfig.department_ids=[]);let r=this.managerConfig.department_ids.indexOf(t);i&&r===-1?this.managerConfig.department_ids.push(t):!i&&r!==-1&&this.managerConfig.department_ids.splice(r,1)}eliminaReparto(t){this.departmentsService.canDeleteDepartment(t.id).subscribe({next:e=>{if(!e.canDelete){this.messaggioErrore=`Impossibile eliminare il reparto "${t.name}". Ci sono ${e.employeeCount} dipendenti assegnati.`,this.nascondiMessaggioDopoTimeout();return}confirm(`Sei sicuro di voler eliminare il reparto "${t.name}"?`)&&this.departmentsService.deleteDepartment(t.id).subscribe({next:()=>{this.departments=this.departments.filter(i=>i.id!==t.id),this.messaggioSuccesso="Reparto eliminato con successo",this.nascondiMessaggioDopoTimeout()},error:i=>{console.error("[Impostazioni] errore eliminazione reparto",i),this.messaggioErrore="Errore durante l'eliminazione del reparto",this.nascondiMessaggioDopoTimeout()}})},error:e=>{console.error("[Impostazioni] errore controllo eliminazione reparto",e),this.messaggioErrore="Errore durante il controllo del reparto",this.nascondiMessaggioDopoTimeout()}})}toggleAddPointForm(){this.showAddPointForm=!this.showAddPointForm,this.showAddPointForm?this.aziendaCorrente&&(this.newPoint.city=this.aziendaCorrente.city??this.newPoint.city,this.newPoint.province=this.aziendaCorrente.province??this.newPoint.province):this.newPoint={name:"",address:"",civic_number:"",city:this.aziendaCorrente?.city||null,province:this.aziendaCorrente?.province||null,lat:null,lng:null,radius_m:50}}toggleOpeningHours(){this.showOpeningHours=!this.showOpeningHours}toggleProfilo(){this.showProfilo=!this.showProfilo}toggleAzienda(){this.showAzienda=!this.showAzienda}toggleReparti(){this.showReparti=!this.showReparti}toggleGestioneReparti(){this.showGestioneReparti=!this.showGestioneReparti}toggleVisibilitaResponsabili(){this.showVisibilitaResponsabili=!this.showVisibilitaResponsabili}toggleClosedDays(){this.showClosedDays=!this.showClosedDays}autoSaveOpeningHours(){if(this.aziendaCorrente?.id)try{let t=this.aziendaForm.get("opening_hours"),e={};this.giorniSettimana.forEach(i=>{let r=t.get(i.key);e[i.key]={open:r.get("open")?.value||null,close:r.get("close")?.value||null,closed:!!r.get("closed")?.value}}),this.salvataggioAzienda=!0,this.companyService.aggiornaAzienda(this.aziendaCorrente.id,{opening_hours:e}).subscribe({next:i=>{this.salvataggioAzienda=!1,i&&(this.aziendaCorrente=i,console.debug("[Impostazioni] opening_hours autosaved",e))},error:i=>{this.salvataggioAzienda=!1,console.error("[Impostazioni] autosave opening_hours failed",i)}})}catch(t){console.error("[Impostazioni] autoSaveOpeningHours unexpected",t)}}resetOrariDefault(){let t=this.openingHoursGroup,e={monday:{open:"09:00",close:"18:00",closed:!1},tuesday:{open:"09:00",close:"18:00",closed:!1},wednesday:{open:"09:00",close:"18:00",closed:!1},thursday:{open:"09:00",close:"18:00",closed:!1},friday:{open:"09:00",close:"18:00",closed:!1},saturday:{open:"09:00",close:"13:00",closed:!1},sunday:{open:"",close:"",closed:!0}};this.giorniSettimana.forEach(i=>{let r=t.get(i.key);r&&r.patchValue(e[i.key])}),this.messaggioSuccesso="Orari reimpostati ai valori predefiniti",this.nascondiMessaggioDopoTimeout()}get managerUsers(){return(this.companyEmployees||[]).filter(t=>(t?.role??"").toString().trim().toLowerCase()==="manager")}static \u0275fac=function(e){return new(e||n)(C(bi),C(he),C(St),C($t),C(Xs))};static \u0275cmp=ge({type:n,selectors:[["app-impostazioni"]],decls:84,vars:21,consts:[[1,"page-container"],[1,"section-header"],[1,"header-icon"],[1,"material-icons"],[1,"section-titles"],[1,"section-title"],[1,"text-muted"],[1,"settings-grid"],[1,"form-section"],[1,"subsection-header",2,"display","flex","align-items","center","justify-content","space-between","cursor","pointer",3,"click"],["type","button","title","Mostra/Nascondi Profilo",1,"icon-button",2,"background","none","border","0","padding","6px","cursor","pointer",3,"aria-expanded"],[4,"ngIf"],["class","form-section",4,"ngIf"],[1,"generic-form",3,"ngSubmit","formGroup"],[1,"grid-form"],[1,"form-group"],[1,"form-label"],["type","password","formControlName","currentPassword",1,"form-control"],["type","password","formControlName","newPassword",1,"form-control"],["type","password","formControlName","confirmPassword",1,"form-control"],[1,"form-actions"],["type","submit",1,"promethea-button",3,"disabled"],["class","material-icons",4,"ngIf"],["class","loading-spinner",4,"ngIf"],[1,"notifications-grid"],[1,"checkbox-label","large"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"checkmark"],[1,"notification-info"],["class","checkbox-label large",4,"ngIf"],["type","button",1,"promethea-button",3,"click","disabled"],["class","status-message info",4,"ngIf"],["class","status-message error",4,"ngIf"],["type","text","formControlName","first_name",1,"form-control"],["class","error",4,"ngIf"],["type","text","formControlName","last_name",1,"form-control"],["type","email","formControlName","email",1,"form-control"],["type","tel","formControlName","phone",1,"form-control"],["type","date","formControlName","hire_date",1,"form-control",3,"disabled"],[1,"info","small"],["type","date","formControlName","birth_date",1,"form-control"],["type","text","formControlName","birth_place",1,"form-control"],["type","text","formControlName","fiscal_code",1,"form-control"],["type","text","formControlName","job_title",1,"form-control"],["type","number","min","0","formControlName","monthly_hours",1,"form-control"],[1,"form-group","checkbox-inline"],[1,"checkbox-label"],["type","checkbox","formControlName","full_time"],["type","text","formControlName","timezone","placeholder","Europe/Rome",1,"form-control"],["type","text","disabled","",1,"form-control",3,"value"],[1,"error"],[1,"loading-spinner"],["type","button","title","Mostra/Nascondi Dati Azienda",1,"icon-button",2,"background","none","border","0","padding","6px","cursor","pointer",3,"aria-expanded"],["type","text","formControlName","name",1,"form-control"],["type","text","formControlName","vat",1,"form-control"],["type","text","formControlName","address",1,"form-control"],["type","text","formControlName","city",1,"form-control"],["type","text","formControlName","province",1,"form-control"],["type","url","formControlName","website",1,"form-control"],["type","tel","formControlName","numero_telefono",1,"form-control"],[1,"radio-group"],[1,"radio-label"],["type","radio","formControlName","timbratura_type","value","libera"],[1,"radio-checkmark"],["type","radio","formControlName","timbratura_type","value","punti"],["class","form-subsection full-width",4,"ngIf"],[1,"form-subsection","full-width"],["type","button","title","Mostra/Nascondi orari",1,"icon-button",2,"background","none","border","0","padding","6px","cursor","pointer",3,"aria-expanded"],["type","button","title","Mostra/Nascondi Giorni Chiusura",1,"icon-button",2,"background","none","border","0","padding","6px","cursor","pointer",3,"aria-expanded"],[1,"subsection-title"],[1,"punch-points-list"],["class","team-member",4,"ngFor","ngForOf"],[1,"form-actions",2,"margin","12px 0"],["class","point-form",4,"ngIf"],[1,"team-member"],["aria-hidden","true",1,"user-avatar-small"],[1,"member-info"],[1,"member-name"],[1,"info-detail","location-chip",2,"display","flex","align-items","center","gap","8px"],["aria-hidden","true",1,"material-icons"],[2,"display","flex","flex","1","align-items","center","gap","12px","flex-wrap","wrap","min-width","0"],[2,"min-width","0","overflow","hidden","text-overflow","ellipsis","white-space","nowrap"],[2,"display","inline-block","overflow","hidden","text-overflow","ellipsis"],[2,"font-size","0.85em","color","var(--text-color)","opacity","0.8","margin-left","6px"],[1,"muted","small",2,"margin-top","4px"],[2,"margin-left","auto","text-align","right","white-space","nowrap"],[1,"muted","small"],[2,"margin-top","6px"],[1,"chip"],["type","button","title","Rimuovi",1,"icon-button",3,"click"],[1,"point-form"],["type","text","placeholder","Es. Sede Principale",1,"form-control",3,"ngModelChange","ngModel","ngModelOptions"],[1,"grid-alternative",2,"display","flex","gap","var(--gutter-sm)"],[1,"form-group","wider"],["type","text","placeholder","Es. Via Roma",1,"form-control",3,"ngModelChange","ngModel","ngModelOptions"],[1,"form-group","narrower"],["type","text","placeholder","Es. 12/A",1,"form-control",3,"ngModelChange","ngModel","ngModelOptions"],[1,"grid-alternative"],["type","text","placeholder","Citt\xE0",1,"form-control",3,"ngModelChange","ngModel","ngModelOptions"],["type","text","placeholder","Provincia (es. RM)",1,"form-control",3,"ngModelChange","ngModel","ngModelOptions"],[1,"inline-fields"],[1,"form-group","small"],["type","number","placeholder","50",1,"form-control","small",3,"ngModelChange","ngModel","ngModelOptions"],["formGroupName","opening_hours",1,"opening-hours-grid"],["class","day-row",3,"formGroupName",4,"ngFor","ngForOf"],["type","button",1,"promethea-button","ghost","small",3,"click"],[1,"day-row",3,"formGroupName"],[1,"day-label"],[1,"day-controls"],["type","time","formControlName","open","step","60",1,"form-control"],["type","time","formControlName","close","step","60",1,"form-control"],[1,"form-group","small","checkbox-inline"],["type","checkbox","formControlName","closed"],[1,"closed-days-grid"],["class","day-row feste",4,"ngFor","ngForOf"],[1,"closed-days-actions"],[1,"action-group"],["type","date",1,"form-control",3,"ngModelChange","ngModel","ngModelOptions"],["type","text","placeholder","Nome festivit\xE0 (es. Chiusura estiva)",1,"form-control",2,"max-width","300px","margin-left","8px",3,"ngModelChange","ngModel","ngModelOptions"],["type","button",1,"promethea-button",3,"click"],[1,"actions-right"],["type","button",1,"promethea-button","ghost",3,"click"],[1,"day-row","feste"],[1,"info-detail"],["type","button","title","Mostra/Nascondi Gestione Reparti",1,"icon-button",2,"background","none","border","0","padding","6px","cursor","pointer",3,"aria-expanded"],["class","generic-form",4,"ngIf"],[1,"generic-form"],[1,"form-subsection"],["type","text","placeholder","Es. Commerciale, Amministrazione",1,"form-control",3,"ngModelChange","ngModel","ngModelOptions"],["placeholder","Descrizione opzionale del reparto","rows","2",1,"form-control",3,"ngModelChange","ngModel","ngModelOptions"],["class","empty-state",4,"ngIf"],[1,"departments-list"],["class","department-item",4,"ngFor","ngForOf"],[1,"empty-state"],[1,"department-item"],[1,"department-info"],["class","department-details",4,"ngIf"],["class","edit-form",4,"ngIf"],[1,"actions-container"],["style","display: flex; flex-direction: row; gap: var(--gutter-sm);",4,"ngIf"],[1,"department-details"],[1,"department-header"],[1,"employee-count"],["class","department-description",4,"ngIf"],["class","text-muted",4,"ngIf"],[1,"department-description"],[1,"edit-form"],["type","text","placeholder","Nome reparto",1,"form-control","small",3,"ngModelChange","ngModel"],["rows","2","placeholder","Descrizione",1,"form-control","small",3,"ngModelChange","ngModel"],[2,"display","flex","flex-direction","row","gap","var(--gutter-sm)"],["type","button","title","Modifica",1,"icon-button",3,"click"],["type","button","title","Elimina",1,"icon-button",3,"click","disabled"],["type","button","title","Salva",1,"icon-button","success",3,"click"],["type","button","title","Annulla",1,"icon-button",3,"click"],["type","button","title","Mostra/Nascondi Visibilit\xE0",1,"icon-button",2,"background","none","border","0","padding","6px","cursor","pointer",3,"aria-expanded"],["name","selectedManager",1,"form-control",3,"ngModelChange","change","ngModel"],[3,"ngValue"],[3,"ngValue",4,"ngFor","ngForOf"],["class","manager-config",4,"ngIf"],[1,"manager-config"],[1,"announcements-list"],["type","radio","name","mode","value","self",3,"ngModelChange","ngModel"],["type","radio","name","mode","value","selected_users",3,"ngModelChange","ngModel"],["class","form-group",4,"ngIf"],["type","radio","name","mode","value","roles",3,"ngModelChange","ngModel"],["type","radio","name","mode","value","department",3,"ngModelChange","ngModel"],[1,"permissions-grid"],[1,"users-list"],["class","checkbox-label",4,"ngFor","ngForOf"],["class","info small",4,"ngIf"],["type","checkbox",3,"change","value","checked"],[1,"roles-list"],[1,"status-message","info"],[1,"status-message","error"]],template:function(e,i){e&1&&(u(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),d(4,"settings"),l()(),u(5,"div",4)(6,"h1",5),d(7,"Impostazioni"),l(),u(8,"p",6),d(9,"Gestisci il tuo profilo e le impostazioni aziendali"),l()()(),u(10,"div",7)(11,"div",8)(12,"div",9),S("click",function(){return i.toggleProfilo()}),u(13,"h2",5)(14,"span",3),d(15,"person"),l(),d(16," Profilo Utente"),l(),u(17,"button",10)(18,"span",3),d(19),l()()(),E(20,t3,96,11,"div",11),l(),E(21,g3,10,4,"div",12)(22,D3,10,4,"div",12)(23,L3,10,4,"div",12),u(24,"div",8)(25,"h2",5)(26,"span",3),d(27,"security"),l(),d(28," Sicurezza "),l(),u(29,"form",13),S("ngSubmit",function(){return i.cambiaPassword()}),u(30,"div",14)(31,"div",15)(32,"label",16)(33,"span",3),d(34,"lock"),l(),d(35," Password Attuale "),l(),N(36,"input",17),l(),u(37,"div",15)(38,"label",16)(39,"span",3),d(40,"lock_reset"),l(),d(41," Nuova Password "),l(),N(42,"input",18),l(),u(43,"div",15)(44,"label",16)(45,"span",3),d(46,"lock_reset"),l(),d(47," Conferma Password "),l(),N(48,"input",19),l()(),u(49,"div",20)(50,"button",21),E(51,j3,2,0,"span",22)(52,V3,1,0,"span",23),d(53),l()()()(),u(54,"div",8)(55,"h2",5)(56,"span",3),d(57,"notifications"),l(),d(58," Notifiche "),l(),u(59,"div",24)(60,"label",25)(61,"input",26),G("ngModelChange",function(o){return q(i.impostazioniNotifiche.emailNotifiche,o)||(i.impostazioniNotifiche.emailNotifiche=o),o}),l(),N(62,"span",27),u(63,"div",28)(64,"strong"),d(65,"Notifiche Email"),l(),u(66,"span"),d(67,"Ricevi notifiche via email per le tue timbrature"),l()()(),u(68,"label",25)(69,"input",26),G("ngModelChange",function(o){return q(i.impostazioniNotifiche.riepilogoGiornaliero,o)||(i.impostazioniNotifiche.riepilogoGiornaliero=o),o}),l(),N(70,"span",27),u(71,"div",28)(72,"strong"),d(73,"Riepilogo Giornaliero"),l(),u(74,"span"),d(75,"Ricevi un riepilogo giornaliero delle tue ore"),l()()(),E(76,z3,8,1,"label",29),l(),u(77,"div",20)(78,"button",30),S("click",function(){return i.salvaNotifiche()}),E(79,U3,2,0,"span",22)(80,B3,1,0,"span",23),d(81),l()()()(),E(82,$3,4,1,"div",31)(83,H3,4,1,"div",32),l()),e&2&&(p(17),pn("aria-expanded",mr(i.showProfilo)),p(2),R(i.showProfilo?"expand_less":"expand_more"),p(),_("ngIf",i.showProfilo),p(),_("ngIf",i.hasRole("admin")),p(),_("ngIf",i.hasRole("admin")),p(),_("ngIf",i.hasRole("admin")),p(6),_("formGroup",i.sicurezzaForm),p(21),_("disabled",i.sicurezzaForm.invalid||i.salvataggioPassword),p(),_("ngIf",!i.salvataggioPassword),p(),_("ngIf",i.salvataggioPassword),p(),O(" ",i.salvataggioPassword?"Salvando...":"Cambia Password"," "),p(8),W("ngModel",i.impostazioniNotifiche.emailNotifiche),p(8),W("ngModel",i.impostazioniNotifiche.riepilogoGiornaliero),p(7),_("ngIf",i.hasRole("admin")),p(2),_("disabled",i.salvataggioNotifiche),p(),_("ngIf",!i.salvataggioNotifiche),p(),_("ngIf",i.salvataggioNotifiche),p(),O(" ",i.salvataggioNotifiche?"Salvando...":"Salva Notifiche"," "),p(),_("ngIf",i.messaggioSuccesso),p(),_("ngIf",i.messaggioErrore))},dependencies:[_e,qe,Ee,wi,Rn,Vt,zt,Ne,kl,ho,wt,iv,Pe,An,sv,On,Xn,Fs,Et,ct,e0,Yt],styles:[".closed-days-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:var(--gutter-sm)}.closed-days-grid[_ngcontent-%COMP%]   .day-row.feste[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:var(--gutter-sm);justify-content:flex-start}.closed-days-grid[_ngcontent-%COMP%]   .day-row.feste[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{flex:1 1 auto;min-width:0;overflow:hidden}.closed-days-grid[_ngcontent-%COMP%]   .day-row.feste[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{display:block;overflow:hidden;text-overflow:ellipsis}.closed-days-grid[_ngcontent-%COMP%]   .day-row.feste[_ngcontent-%COMP%]   .info-detail[_ngcontent-%COMP%]{font-size:.85rem;color:color-mix(in srgb,var(--text-color) 60%,transparent);margin-top:4px;overflow:hidden}.closed-days-grid[_ngcontent-%COMP%]   .day-row.feste[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:last-child, .closed-days-grid[_ngcontent-%COMP%]   .day-row.feste[_ngcontent-%COMP%]   .icon-button[_ngcontent-%COMP%]{flex:0 0 auto;margin-left:8px}.closed-days-actions[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-sm, 12px);margin-top:var(--space-sm, 12px);align-items:center}.closed-days-actions[_ngcontent-%COMP%]   .action-group[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center}.closed-days-actions[_ngcontent-%COMP%]   .actions-right[_ngcontent-%COMP%]{margin-left:auto}.closed-days-actions[_ngcontent-%COMP%]   .form-control[type=date][_ngcontent-%COMP%]{max-width:220px}@media (max-width: 600px){.closed-days-actions[_ngcontent-%COMP%]{flex-wrap:wrap;gap:10px}.closed-days-actions[_ngcontent-%COMP%]   .action-group[_ngcontent-%COMP%], .closed-days-actions[_ngcontent-%COMP%]   .actions-right[_ngcontent-%COMP%]{flex:1 1 100%;display:flex;justify-content:flex-start}.closed-days-actions[_ngcontent-%COMP%]   .actions-right[_ngcontent-%COMP%]{justify-content:flex-end}}.point-form[_ngcontent-%COMP%], .inline-fields[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--gutter-sm)}.form-subsection.full-width[_ngcontent-%COMP%]{grid-column:1 / -1;width:100%}.form-group.wider[_ngcontent-%COMP%]{flex:2}.form-group.narrower[_ngcontent-%COMP%]{flex:1}.departments-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:var(--gutter-sm)}.department-item[_ngcontent-%COMP%]{display:flex;justify-content:between;align-items:flex-start;padding:var(--gutter-sm);border:1px solid var(--border-color);border-radius:var(--border-radius);background:var(--surface-color)}.department-info[_ngcontent-%COMP%]{flex:1}.department-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);margin-bottom:4px}.department-header[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0;font-size:1.1em;color:var(--text-color)}.employee-count[_ngcontent-%COMP%]{font-size:.85em;color:var(--text-muted);background:var(--primary-light);padding:2px 8px;border-radius:12px}.department-description[_ngcontent-%COMP%]{margin:4px 0 0;font-size:.9em;color:var(--text-muted)}.department-actions[_ngcontent-%COMP%]{display:flex;gap:4px}.edit-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;width:100%}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:var(--gutter-xl);color:var(--text-muted)}.empty-state[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:3em;margin-bottom:var(--gutter-sm);opacity:.5}.form-control[type=time][_ngcontent-%COMP%]{width:140px;min-width:120px;box-sizing:border-box;padding:6px 8px}.form-group.small[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;min-width:120px;max-width:260px}.checkbox-inline[_ngcontent-%COMP%]{display:flex;align-items:center;min-width:120px}.day-controls[_ngcontent-%COMP%]   .form-group.small[_ngcontent-%COMP%]   .form-label[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.day-row[_ngcontent-%COMP%]:focus-within{border-color:#0000000f;background:color-mix(in srgb,var(--primary-light) 6%,transparent)}"]})};function W3(n,t){if(n&1&&(u(0,"option",32),d(1),l()),n&2){let e=t.$implicit;_("value",e.id),p(),be(" ",e.first_name," ",e.last_name," ")}}function G3(n,t){if(n&1){let e=j();u(0,"select",29),G("ngModelChange",function(r){D(e);let o=v();return q(o.dipendenteSelezionato,r)||(o.dipendenteSelezionato=r),I(r)}),u(1,"option",30),d(2,"Tutti i dipendenti"),l(),E(3,W3,2,3,"option",31),l()}if(n&2){let e=v();W("ngModel",e.dipendenteSelezionato),p(3),_("ngForOf",e.dipendenti)}}function q3(n,t){if(n&1&&N(0,"input",33),n&2){let e=v();_("value",(e.currentUser==null?null:e.currentUser.first_name)+" "+(e.currentUser==null?null:e.currentUser.last_name))}}function K3(n,t){n&1&&(u(0,"span",3),d(1,"refresh"),l())}function Y3(n,t){n&1&&N(0,"span",34)}function Z3(n,t){if(n&1&&(u(0,"div",35)(1,"h2",5)(2,"span",3),d(3,"insights"),l(),d(4," Statistiche "),l(),u(5,"div",36)(6,"div",37)(7,"h3",38),d(8,"Ore Totali"),l(),u(9,"div",39),d(10),K(11,"number"),l(),u(12,"p",6),d(13,"Periodo selezionato"),l()(),u(14,"div",37)(15,"h3",38),d(16,"Media Giornaliera"),l(),u(17,"div",39),d(18),K(19,"number"),l(),u(20,"p",6),d(21,"Per giorno lavorativo"),l()(),u(22,"div",37)(23,"h3",38),d(24,"Giorni Lavorati"),l(),u(25,"div",39),d(26),l(),u(27,"p",6),d(28),l()(),u(29,"div",37)(30,"h3",38),d(31,"Ore di Pause"),l(),u(32,"div",39),d(33),K(34,"number"),l(),u(35,"p",6),d(36,"Totale pause"),l()()()()),n&2){let e=v();p(10),O("",te(11,5,e.datiReport.oreTotali,"1.1-1"),"h"),p(8),O("",te(19,8,e.datiReport.mediaGiornaliera,"1.1-1"),"h"),p(8),R(e.datiReport.giorniLavorati),p(2),O("Su ",e.datiReport.giorniTotali," giorni"),p(5),O("",te(34,11,e.datiReport.orePause,"1.1-1"),"h")}}function J3(n,t){if(n&1&&(u(0,"span",46),d(1),l()),n&2){let e=v().$implicit,i=v(2);_("title",e.note),p(),O(" ",i.troncaTesto(e.note,20)," ")}}function Q3(n,t){n&1&&(u(0,"span"),d(1,"-"),l())}function X3(n,t){if(n&1&&(u(0,"tr")(1,"td"),d(2),K(3,"date"),l(),u(4,"td"),d(5),l(),u(6,"td"),d(7),l(),u(8,"td"),d(9),l(),u(10,"td"),d(11),K(12,"number"),l(),u(13,"td"),d(14),K(15,"number"),l(),u(16,"td"),d(17),K(18,"number"),l(),u(19,"td"),E(20,J3,2,2,"span",44)(21,Q3,2,0,"span",45),l()()),n&2){let e=t.$implicit;p(2),R(te(3,9,e.data,"dd/MM/yyyy")),p(3),R(e.dipendente),p(2),R(e.oraInizio),p(2),R(e.oraFine),p(2),O("",te(12,12,e.oreLavorate,"1.1-1"),"h"),p(3),O("",te(15,15,e.pause,"1.1-1"),"h"),p(3),O("",te(18,18,e.oreEffettive,"1.1-1"),"h"),p(3),_("ngIf",e.note),p(),_("ngIf",!e.note)}}function ej(n,t){if(n&1&&(u(0,"div",40)(1,"h2",5)(2,"span",3),d(3,"view_list"),l(),d(4," Dettaglio Timbrature "),l(),u(5,"div",41)(6,"table",42)(7,"thead")(8,"tr")(9,"th"),d(10,"Data"),l(),u(11,"th"),d(12,"Dipendente"),l(),u(13,"th"),d(14,"Ora Inizio"),l(),u(15,"th"),d(16,"Ora Fine"),l(),u(17,"th"),d(18,"Ore Lavorate"),l(),u(19,"th"),d(20,"Pause"),l(),u(21,"th"),d(22,"Ore Effettive"),l(),u(23,"th"),d(24,"Note"),l()()(),u(25,"tbody"),E(26,X3,22,21,"tr",43),l()()()()),n&2){let e=v();p(26),_("ngForOf",e.datiReport.dettaglio)}}function tj(n,t){if(n&1&&(u(0,"div",51)(1,"div",52),d(2),l(),u(3,"div",53),N(4,"div",54),l(),u(5,"div",55),d(6),K(7,"number"),l()()),n&2){let e=t.$implicit,i=v(2);p(2),R(e.giorno),p(2),di("height",e.ore/i.datiReport.maxOreGiornaliere*100+"%"),p(2),O("",te(7,4,e.ore,"1.1-1"),"h")}}function nj(n,t){if(n&1&&(u(0,"div",7)(1,"h2",5)(2,"span",3),d(3,"bar_chart"),l(),d(4," Andamento Ore Lavorative "),l(),u(5,"div",47)(6,"div",48)(7,"p",6),d(8,"Grafico delle ore lavorative per giorno"),l(),u(9,"div",49),E(10,tj,8,7,"div",50),l()()()()),n&2){let e=v();p(10),_("ngForOf",e.datiReport.graficoOre)}}function ij(n,t){n&1&&(u(0,"div",56)(1,"span",3),d(2,"analytics"),l(),u(3,"h3"),d(4,"Nessun report generato"),l(),u(5,"p"),d(6,"Seleziona i filtri e genera un report per visualizzare i dati."),l()())}var mp=class n{constructor(t,e,i){this.authService=t;this.companyService=e;this.timbratureService=i}tipoReport="settimanale";dataInizio="";dataFine="";dipendenteSelezionato="tutti";currentUser=null;dipendenti=[];datiReport=null;isLoading=!1;ngOnInit(){this.authService.currentUser$.subscribe(t=>{this.currentUser=t,t&&(this.impostaDatePredefinite(),(this.hasRole("admin")||this.hasRole("manager"))&&this.caricaDipendenti(t.company_id))})}impostaDatePredefinite(){let t=new Date;switch(this.tipoReport){case"settimanale":let e=new Date(t);e.setDate(t.getDate()-t.getDay()+1),this.dataInizio=e.toISOString().split("T")[0],this.dataFine=t.toISOString().split("T")[0];break;case"mensile":let i=new Date(t.getFullYear(),t.getMonth(),1);this.dataInizio=i.toISOString().split("T")[0],this.dataFine=t.toISOString().split("T")[0];break;case"annuale":let r=new Date(t.getFullYear(),0,1);this.dataInizio=r.toISOString().split("T")[0],this.dataFine=t.toISOString().split("T")[0];break;case"personalizzato":break}}onTipoReportChange(){this.impostaDatePredefinite()}caricaDipendenti(t){this.companyService.getDipendenti(t).subscribe({next:e=>{this.dipendenti=e},error:e=>{console.error("Errore nel caricamento dipendenti:",e)}})}hasRole(t){return this.authService.hasRole(t)}generaReport(){if(!this.dataInizio||!this.dataFine){alert("Seleziona le date di inizio e fine");return}this.isLoading=!0,this.datiReport=null,setTimeout(()=>{this.datiReport=this.generaReportMock(),this.isLoading=!1},1500)}generaReportMock(){let t=[{data:new Date("2024-01-15"),dipendente:"Mario Rossi",oraInizio:"08:00",oraFine:"17:00",oreLavorate:9,pause:1,oreEffettive:8,note:"Giornata standard"},{data:new Date("2024-01-16"),dipendente:"Mario Rossi",oraInizio:"09:00",oraFine:"18:00",oreLavorate:9,pause:1,oreEffettive:8,note:"Riunione mattutina"},{data:new Date("2024-01-17"),dipendente:"Mario Rossi",oraInizio:"08:30",oraFine:"17:30",oreLavorate:9,pause:.5,oreEffettive:8.5}],e=[{giorno:"Lun",ore:8},{giorno:"Mar",ore:8},{giorno:"Mer",ore:8.5},{giorno:"Gio",ore:7.5},{giorno:"Ven",ore:8},{giorno:"Sab",ore:4},{giorno:"Dom",ore:0}],i=t.reduce((s,a)=>s+a.oreEffettive,0),r=t.reduce((s,a)=>s+a.pause,0),o=Math.max(...e.map(s=>s.ore));return{oreTotali:i,mediaGiornaliera:i/t.length,giorniLavorati:t.length,giorniTotali:7,orePause:r,maxOreGiornaliere:o,dettaglio:t,graficoOre:e}}esportaPDF(){console.log("Esportazione PDF con dati:",this.datiReport),alert("Esportazione PDF simulata! Nella versione reale verrebbe generato un PDF.")}esportaExcel(){console.log("Esportazione Excel con dati:",this.datiReport),alert("Esportazione Excel simulata! Nella versione reale verrebbe generato un file Excel.")}troncaTesto(t,e){return t?t.length<=e?t:t.substring(0,e)+"...":""}static \u0275fac=function(e){return new(e||n)(C(he),C(St),C(xt))};static \u0275cmp=ge({type:n,selectors:[["app-report"]],decls:58,vars:15,consts:[[1,"page-container"],[1,"section-header"],[1,"header-icon"],[1,"material-icons"],[1,"section-titles"],[1,"section-title"],[1,"text-muted"],[1,"form-section"],[1,"grid-form"],[1,"form-group"],[1,"form-label"],[1,"form-control",3,"ngModelChange","change","ngModel"],["value","settimanale"],["value","mensile"],["value","annuale"],["value","personalizzato"],["type","date",1,"form-control",3,"ngModelChange","ngModel"],["class","form-control",3,"ngModel","ngModelChange",4,"ngIf"],["type","text","class","form-control","disabled","",3,"value",4,"ngIf"],[1,"form-actions"],[1,"promethea-button",3,"click","disabled"],["class","material-icons",4,"ngIf"],["class","loading-spinner",4,"ngIf"],[1,"promethea-button","outline",3,"click","disabled"],[1,"promethea-button","secondary",3,"click","disabled"],["class","kpi-section",4,"ngIf"],["class","table-section",4,"ngIf"],["class","form-section",4,"ngIf"],["class","empty-state",4,"ngIf"],[1,"form-control",3,"ngModelChange","ngModel"],["value","tutti"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["type","text","disabled","",1,"form-control",3,"value"],[1,"loading-spinner"],[1,"kpi-section"],[1,"grid-cards"],[1,"card"],[1,"card-title"],[1,"card-number"],[1,"table-section"],[1,"table-container"],[1,"crm-table"],[4,"ngFor","ngForOf"],["class","notes-preview",3,"title",4,"ngIf"],[4,"ngIf"],[1,"notes-preview",3,"title"],[1,"chart-placeholder"],[1,"chart-container"],[1,"chart-bars"],["class","chart-bar",4,"ngFor","ngForOf"],[1,"chart-bar"],[1,"bar-label"],[1,"bar-container"],[1,"bar-fill"],[1,"bar-value"],[1,"empty-state"]],template:function(e,i){e&1&&(u(0,"div",0)(1,"div",1)(2,"div",2)(3,"span",3),d(4,"assessment"),l()(),u(5,"div",4)(6,"h1",5),d(7,"Report Timbrature"),l(),u(8,"p",6),d(9,"Analizza e esporta i dati delle timbrature"),l()()(),u(10,"div",7)(11,"h2",5)(12,"span",3),d(13,"filter_alt"),l(),d(14," Filtri Report "),l(),u(15,"div",8)(16,"div",9)(17,"label",10),d(18,"Tipo Report"),l(),u(19,"select",11),G("ngModelChange",function(o){return q(i.tipoReport,o)||(i.tipoReport=o),o}),S("change",function(){return i.onTipoReportChange()}),u(20,"option",12),d(21,"Settimanale"),l(),u(22,"option",13),d(23,"Mensile"),l(),u(24,"option",14),d(25,"Annuale"),l(),u(26,"option",15),d(27,"Personalizzato"),l()()(),u(28,"div",9)(29,"label",10),d(30,"Data Inizio"),l(),u(31,"input",16),G("ngModelChange",function(o){return q(i.dataInizio,o)||(i.dataInizio=o),o}),l()(),u(32,"div",9)(33,"label",10),d(34,"Data Fine"),l(),u(35,"input",16),G("ngModelChange",function(o){return q(i.dataFine,o)||(i.dataFine=o),o}),l()(),u(36,"div",9)(37,"label",10),d(38,"Dipendente"),l(),E(39,G3,4,2,"select",17)(40,q3,1,1,"input",18),l()(),u(41,"div",19)(42,"button",20),S("click",function(){return i.generaReport()}),E(43,K3,2,0,"span",21)(44,Y3,1,0,"span",22),d(45),l(),u(46,"button",23),S("click",function(){return i.esportaPDF()}),u(47,"span",3),d(48,"picture_as_pdf"),l(),d(49," Esporta PDF "),l(),u(50,"button",24),S("click",function(){return i.esportaExcel()}),u(51,"span",3),d(52,"table_chart"),l(),d(53," Esporta Excel "),l()()(),E(54,Z3,37,14,"div",25)(55,ej,27,1,"div",26)(56,nj,11,1,"div",27)(57,ij,7,0,"div",28),l()),e&2&&(p(19),W("ngModel",i.tipoReport),p(12),W("ngModel",i.dataInizio),p(4),W("ngModel",i.dataFine),p(4),_("ngIf",i.hasRole("admin")||i.hasRole("manager")),p(),_("ngIf",!i.hasRole("admin")&&!i.hasRole("manager")),p(2),_("disabled",i.isLoading),p(),_("ngIf",!i.isLoading),p(),_("ngIf",i.isLoading),p(),O(" ",i.isLoading?"Generando...":"Genera Report"," "),p(),_("disabled",!i.datiReport),p(4),_("disabled",!i.datiReport),p(4),_("ngIf",i.datiReport),p(),_("ngIf",i.datiReport),p(),_("ngIf",i.datiReport),p(),_("ngIf",!i.datiReport&&!i.isLoading))},dependencies:[_e,qe,Ee,Et,Vt,zt,Ne,wt,Pe,ct,Yt,Xe],styles:[".kpi-section[_ngcontent-%COMP%]{margin-bottom:var(--gutter-lg)}.chart-placeholder[_ngcontent-%COMP%]{background:var(--background);border:1px solid var(--smoke-color-1);border-radius:16px;padding:var(--gutter-lg);margin-top:var(--gutter-md)}.chart-container[_ngcontent-%COMP%]{text-align:center}.chart-bars[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end;gap:var(--gutter-sm);height:200px;margin-top:var(--gutter-lg);padding:0 var(--gutter-md)}.chart-bar[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;flex:1;gap:var(--gutter-sm)}.bar-label[_ngcontent-%COMP%]{font-size:.8rem;color:var(--text-color);opacity:.7}.bar-container[_ngcontent-%COMP%]{height:120px;width:30px;background:color-mix(in srgb,var(--smoke-color-1) 50%,transparent);border-radius:4px 4px 0 0;position:relative;display:flex;align-items:flex-end}.bar-fill[_ngcontent-%COMP%]{width:100%;background:var(--gradiente);border-radius:4px 4px 0 0;transition:height .3s ease;min-height:4px}.bar-value[_ngcontent-%COMP%]{font-size:.8rem;font-weight:600;color:var(--text-color)}@media (max-width: 768px){.chart-bars[_ngcontent-%COMP%]{gap:4px;padding:0 var(--gutter-sm)}.bar-container[_ngcontent-%COMP%]{width:20px}.bar-label[_ngcontent-%COMP%], .bar-value[_ngcontent-%COMP%]{font-size:.7rem}}@media (max-width: 480px){.chart-bars[_ngcontent-%COMP%]{flex-wrap:wrap;height:auto;gap:var(--gutter-md)}.chart-bar[_ngcontent-%COMP%]{flex:0 0 calc(33.333% - var(--gutter-md))}}"]})};var gp=class n{constructor(t){this.supabaseService=t}BUCKET_NAME="buste-paga";getBustePagaAzienda(t){let i=this.supabaseService.getClient().from("payroll_files").select(`
        *,
        users:user_id (first_name, last_name, email)
      `).eq("company_id",t).order("period",{ascending:!1}).then(r=>{if(r.error)throw r.error;return r.data});return B(i)}getBustePagaDipendente(t){let i=this.supabaseService.getClient().from("payroll_files").select("*").eq("user_id",t).eq("visible_to_user",!0).order("period",{ascending:!1}).then(r=>{if(r.error)throw r.error;return r.data});return B(i)}uploadBustaPaga(t,e,i,r,o){return b(this,null,function*(){let s=this.supabaseService.getClient(),a=t.name.split(".").pop(),c=`${e}_${r}_${Date.now()}.${a}`,f=`${i}/${c}`,{error:h}=yield s.storage.from(this.BUCKET_NAME).upload(f,t);if(h)throw h;let{error:m}=yield s.from("payroll_files").insert({user_id:e,company_id:i,filename:c,original_name:t.name,file_size_bytes:t.size,mime_type:t.type,storage_path:f,period:r,uploaded_by:o,visible_to_user:!0});if(m)throw m;return{success:!0,fileName:c}})}downloadBustaPaga(t,e){let r=this.supabaseService.getClient().storage.from(this.BUCKET_NAME).download(t).then(o=>{if(o.error)throw o.error;let s=URL.createObjectURL(o.data),a=document.createElement("a");return a.href=s,a.download=e,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s),{success:!0}});return B(r)}eliminaBustaPaga(t,e){let i=this.supabaseService.getClient(),r=Promise.all([i.from("payroll_files").delete().eq("id",t),i.storage.from(this.BUCKET_NAME).remove([e])]).then(([o,s])=>{if(o.error)throw o.error;if(s.error)throw s.error;return{success:!0}});return B(r)}static \u0275fac=function(e){return new(e||n)(L(Ct))};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};var Gv=(n,t)=>t.id;function oj(n,t){if(n&1){let e=j();u(0,"div",8)(1,"button",16),S("click",function(){D(e);let r=v();return I(r.mostraUpload=!r.mostraUpload)}),u(2,"span",4),d(3,"upload"),l(),d(4," Carica Buste Paga "),l()()}}function sj(n,t){if(n&1&&(u(0,"option",21),d(1),l()),n&2){let e=t.$implicit;_("value",e.id),p(),be("",e.first_name," ",e.last_name)}}function aj(n,t){if(n&1){let e=j();u(0,"div",32)(1,"span",4),d(2,"cloud_upload"),l(),u(3,"h3"),d(4,"Trascina i file PDF qui"),l(),u(5,"p",33),d(6,"oppure"),l(),u(7,"button",34),S("click",function(){D(e);let r=zi(12);return I(r.click())}),u(8,"span",4),d(9,"attach_file"),l(),d(10," Seleziona File "),l(),u(11,"input",35,0),S("change",function(r){D(e);let o=v(2);return I(o.onFileSelected(r))}),l()()}}function lj(n,t){if(n&1){let e=j();u(0,"div",38)(1,"span",4),d(2,"picture_as_pdf"),l(),u(3,"div",39)(4,"span",40),d(5),l(),u(6,"span",41),d(7),l()(),u(8,"button",42),S("click",function(){let r=D(e).index,o=v(3);return I(o.rimuoviFile(r))}),u(9,"span",4),d(10,"close"),l()()()}if(n&2){let e=t.$implicit;p(5),R(e.name),p(2),O("",(e.size/1024/1024).toFixed(2)," MB")}}function cj(n,t){if(n&1&&(u(0,"div",36)(1,"h4"),d(2),l(),E(3,lj,11,2,"div",37),l()),n&2){let e=v(2);p(2),O("File selezionati (",e.selectedFiles.length,")"),p(),_("ngForOf",e.selectedFiles)}}function uj(n,t){if(n&1&&(u(0,"div",26)(1,"span",4),d(2,"error"),l(),d(3),l()),n&2){let e=v(2);p(3),O(" ",e.errorMessage," ")}}function dj(n,t){if(n&1&&(u(0,"div",27)(1,"span",4),d(2,"check_circle"),l(),d(3),l()),n&2){let e=v(2);p(3),O(" ",e.successMessage," ")}}function fj(n,t){n&1&&(u(0,"span",4),d(1,"upload"),l())}function pj(n,t){n&1&&N(0,"span",31)}function hj(n,t){if(n&1){let e=j();u(0,"div",9)(1,"h2",6)(2,"span",4),d(3,"cloud_upload"),l(),d(4," Carica Nuove Buste Paga "),l(),u(5,"div",17)(6,"div",12)(7,"label",18)(8,"span",4),d(9,"person"),l(),d(10," Dipendente * "),l(),u(11,"select",19),G("ngModelChange",function(r){D(e);let o=v();return q(o.selectedUserId,r)||(o.selectedUserId=r),I(r)}),u(12,"option",20),d(13,"Seleziona dipendente"),l(),vt(14,sj,2,3,"option",21,Gv),l()(),u(16,"div",12)(17,"label",18)(18,"span",4),d(19,"event"),l(),d(20," Periodo * "),l(),u(21,"input",22),G("ngModelChange",function(r){D(e);let o=v();return q(o.selectedPeriod,r)||(o.selectedPeriod=r),I(r)}),l()()(),u(22,"div",23),S("drop",function(r){D(e);let o=v();return I(o.onDrop(r))})("dragover",function(r){D(e);let o=v();return I(o.onDragOver(r))})("dragleave",function(r){D(e);let o=v();return I(o.onDragLeave(r))}),E(23,aj,13,0,"div",24)(24,cj,4,2,"div",25),l(),Z(25,uj,4,1,"div",26),Z(26,dj,4,1,"div",27),u(27,"div",28)(28,"button",29),S("click",function(){D(e);let r=v();return I(r.resetUpload())}),d(29," Annulla "),l(),u(30,"button",30),S("click",function(){D(e);let r=v();return I(r.onUpload())}),Z(31,fj,2,0,"span",4),Z(32,pj,1,0,"span",31),d(33),l()()()}if(n&2){let e=v();p(11),W("ngModel",e.selectedUserId),_("disabled",e.isLoading),p(3),_t(e.dipendenti),p(7),W("ngModel",e.selectedPeriod),_("disabled",e.isLoading),p(),we("drag-over",e.isDragOver)("has-files",e.selectedFiles.length>0),p(),_("ngIf",e.selectedFiles.length===0),p(),_("ngIf",e.selectedFiles.length>0),p(),J(e.errorMessage?25:-1),p(),J(e.successMessage?26:-1),p(2),_("disabled",e.isLoading),p(2),_("disabled",!e.canUpload()||e.isLoading),p(),J(e.isLoading?-1:31),p(),J(e.isLoading?32:-1),p(),O(" ",e.isLoading?"Caricamento...":"Carica Buste Paga"," ")}}function mj(n,t){if(n&1&&(u(0,"div",10)(1,"div",43)(2,"h3",44),d(3,"Buste Paga Totali"),l(),u(4,"div",45),d(5),l()(),u(6,"div",43)(7,"h3",44),d(8,"Ultima Busta Paga"),l(),u(9,"div",45),d(10),l()()()),n&2){let e=v();p(5),R(e.bustePaga.length),p(5),O(" ",(e.ultimaBustaPaga==null?null:e.ultimaBustaPaga.period)||"N/A"," ")}}function gj(n,t){if(n&1&&(u(0,"option",21),d(1),l()),n&2){let e=t.$implicit;_("value",e),p(),R(e)}}function vj(n,t){if(n&1&&(u(0,"option",21),d(1),l()),n&2){let e=t.$implicit;_("value",e.id),p(),be("",e.first_name," ",e.last_name)}}function _j(n,t){if(n&1){let e=j();u(0,"div",12)(1,"label",18),d(2,"Filtra per periodo"),l(),u(3,"select",46),G("ngModelChange",function(r){D(e);let o=v();return q(o.filtroPeriodo,r)||(o.filtroPeriodo=r),I(r)}),S("change",function(){D(e);let r=v();return I(r.applicaFiltri())}),u(4,"option",20),d(5,"Tutti i periodi"),l(),vt(6,gj,2,2,"option",21,pr),l()(),u(8,"div",12)(9,"label",18),d(10,"Filtra per dipendente"),l(),u(11,"select",46),G("ngModelChange",function(r){D(e);let o=v();return q(o.filtroDipendente,r)||(o.filtroDipendente=r),I(r)}),S("change",function(){D(e);let r=v();return I(r.applicaFiltri())}),u(12,"option",20),d(13,"Tutti i dipendenti"),l(),vt(14,vj,2,3,"option",21,Gv),l()()}if(n&2){let e=v();p(3),W("ngModel",e.filtroPeriodo),p(3),_t(e.periodiUnici),p(5),W("ngModel",e.filtroDipendente),p(3),_t(e.dipendenti)}}function yj(n,t){if(n&1&&(u(0,"option",21),d(1),l()),n&2){let e=t.$implicit;_("value",e),p(),R(e)}}function bj(n,t){if(n&1){let e=j();u(0,"div",12)(1,"label",18),d(2,"Anno"),l(),u(3,"select",46),G("ngModelChange",function(r){D(e);let o=v();return q(o.filtroAnno,r)||(o.filtroAnno=r),I(r)}),S("change",function(){D(e);let r=v();return I(r.applicaFiltri())}),u(4,"option",20),d(5,"Tutti gli anni"),l(),vt(6,yj,2,2,"option",21,pr),l()()}if(n&2){let e=v();p(3),W("ngModel",e.filtroAnno),p(3),_t(e.anniDisponibili)}}function wj(n,t){n&1&&(u(0,"th"),d(1,"Dipendente"),l())}function Ej(n,t){if(n&1&&(u(0,"td")(1,"div",50)(2,"div",51),d(3),l(),u(4,"div",52)(5,"strong"),d(6),l(),u(7,"span",7),d(8),l()()()()),n&2){let e=v().$implicit;p(3),be(" ",e.user==null||e.user.first_name==null?null:e.user.first_name.charAt(0),"",e.user==null||e.user.last_name==null?null:e.user.last_name.charAt(0)," "),p(3),be("",e.user==null?null:e.user.first_name," ",e.user==null?null:e.user.last_name),p(2),R(e.user==null?null:e.user.email)}}function Cj(n,t){if(n&1){let e=j();u(0,"button",48),S("click",function(){D(e);let r=v().$implicit,o=v();return I(o.eliminaBustaPaga(r))}),u(1,"span",4),d(2,"delete"),l()()}}function Sj(n,t){if(n&1){let e=j();u(0,"tr"),Z(1,Ej,9,5,"td"),u(2,"td"),d(3),l(),u(4,"td")(5,"div",39)(6,"span",4),d(7,"picture_as_pdf"),l(),d(8),l()(),u(9,"td"),d(10),K(11,"date"),l(),u(12,"td"),d(13),l(),u(14,"td")(15,"div",47)(16,"button",48),S("click",function(){let r=D(e).$implicit,o=v();return I(o.downloadBustaPaga(r))}),u(17,"span",4),d(18,"download"),l()(),Z(19,Cj,3,0,"button",49),l()()()}if(n&2){let e=t.$implicit,i=v();p(),J(i.isAdmin?1:-1),p(2),R(e.period),p(5),O(" ",e.original_name," "),p(2),R(te(11,6,e.uploaded_at,"dd/MM/yyyy")),p(3),O("",(e.file_size_bytes/1024/1024).toFixed(2)," MB"),p(6),J(i.isAdmin?19:-1)}}function xj(n,t){if(n&1&&(u(0,"div",15)(1,"span",4),d(2,"description"),l(),u(3,"h3"),d(4,"Nessuna busta paga"),l(),u(5,"p"),d(6),l()()),n&2){let e=v();p(6),O(" ",e.isAdmin?"Non sono state caricate buste paga per i filtri selezionati.":"Non sono presenti buste paga per i filtri selezionati."," ")}}var vp=class n{constructor(t,e,i){this.bustePagaService=t;this.dipendentiService=e;this.authService=i}destroy$=new Le;isAdmin=!1;isLoading=!1;bustePaga=[];bustePagaFiltrate=[];mostraUpload=!1;selectedFiles=[];isDragOver=!1;selectedUserId="";selectedPeriod="";filtroPeriodo="";filtroDipendente="";filtroAnno="";dipendenti=[];periodiUnici=[];anniDisponibili=[];errorMessage="";successMessage="";ngOnInit(){return b(this,null,function*(){this.verificaRuolo(),yield this.caricaDati()})}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}verificaRuolo(){return b(this,null,function*(){try{let t=yield er(this.authService.currentUser$);this.isAdmin=t?.role==="admin"||t?.role==="manager",console.log("Ruolo utente:",this.isAdmin?"Admin":"Dipendente")}catch(t){console.error("Errore nel verificare il ruolo:",t),this.isAdmin=!1}})}caricaDati(){return b(this,null,function*(){this.isLoading=!0;try{let t=localStorage.getItem("companyId");if(!t)throw new Error("Company ID non trovato");if(this.isAdmin)yield Promise.all([this.caricaBustePagaAzienda(t),this.caricaDipendenti(t)]);else{let e=yield this.getCurrentUserId();yield this.caricaBustePagaDipendente(e)}this.inizializzaFiltri()}catch(t){console.error("Errore nel caricamento dei dati:",t),this.errorMessage="Errore nel caricamento dei dati"}finally{this.isLoading=!1}})}caricaBustePagaAzienda(t){return new Promise((e,i)=>{this.bustePagaService.getBustePagaAzienda(t).pipe(Vn(this.destroy$)).subscribe({next:r=>{this.bustePaga=r,this.bustePagaFiltrate=r,e()},error:r=>{console.error("Errore nel caricamento buste paga azienda:",r),i(r)}})})}caricaBustePagaDipendente(t){return new Promise((e,i)=>{this.bustePagaService.getBustePagaDipendente(t).pipe(Vn(this.destroy$)).subscribe({next:r=>{this.bustePaga=r,this.bustePagaFiltrate=r,e()},error:r=>{console.error("Errore nel caricamento buste paga dipendente:",r),i(r)}})})}caricaDipendenti(t){return new Promise((e,i)=>{this.dipendentiService.getDipendenti(t).pipe(Vn(this.destroy$)).subscribe({next:r=>{this.dipendenti=r,e()},error:r=>{console.error("Errore nel caricamento dipendenti:",r),i(r)}})})}inizializzaFiltri(){this.isAdmin?this.periodiUnici=[...new Set(this.bustePaga.map(t=>t.period))].sort().reverse():this.anniDisponibili=[...new Set(this.bustePaga.map(t=>t.period.split("-")[0]))].sort().reverse()}getCurrentUserId(){return b(this,null,function*(){return(yield er(this.authService.currentUser$))?.id||""})}applicaFiltri(){let t=this.bustePaga;this.isAdmin?(this.filtroPeriodo&&(t=t.filter(e=>e.period===this.filtroPeriodo)),this.filtroDipendente&&(t=t.filter(e=>e.user_id===this.filtroDipendente))):this.filtroAnno&&(t=t.filter(e=>e.period.startsWith(this.filtroAnno))),this.bustePagaFiltrate=t}onDragOver(t){t.preventDefault(),this.isDragOver=!0}onDragLeave(t){t.preventDefault(),this.isDragOver=!1}onDrop(t){t.preventDefault(),this.isDragOver=!1;let e=t.dataTransfer?.files;e&&this.processFiles(e)}onFileSelected(t){let e=t.target;e.files&&this.processFiles(e.files)}processFiles(t){let e=Array.from(t).filter(i=>i.type==="application/pdf");if(e.length===0){this.errorMessage="Seleziona solo file PDF";return}this.selectedFiles=[...this.selectedFiles,...e],this.errorMessage=""}rimuoviFile(t){this.selectedFiles.splice(t,1)}canUpload(){return!!this.selectedUserId&&!!this.selectedPeriod&&this.selectedFiles.length>0}onUpload(){return b(this,null,function*(){if(this.canUpload()){this.isLoading=!0,this.errorMessage="",this.successMessage="";try{let t=localStorage.getItem("companyId");if(!t)throw new Error("Company ID non trovato");let e=yield er(this.authService.currentUser$);if(!e?.id)throw new Error("Utente non autenticato");let i=e.id;for(let r of this.selectedFiles)yield this.bustePagaService.uploadBustaPaga(r,this.selectedUserId,t,this.selectedPeriod,i);this.successMessage=`Caricamento completato! ${this.selectedFiles.length} file caricati.`,this.resetUpload(),yield this.caricaDati()}catch(t){console.error("Errore durante l'upload:",t),this.errorMessage=t.message||"Errore durante l'upload"}finally{this.isLoading=!1}}})}resetUpload(){this.selectedFiles=[],this.selectedUserId="",this.selectedPeriod="",this.mostraUpload=!1}downloadBustaPaga(t){this.bustePagaService.downloadBustaPaga(t.storage_path,t.original_name).pipe(Vn(this.destroy$)).subscribe({error:e=>{console.error("Errore nel download:",e),this.errorMessage="Errore durante il download"}})}eliminaBustaPaga(t){confirm("Sei sicuro di voler eliminare questa busta paga?")&&this.bustePagaService.eliminaBustaPaga(t.id,t.storage_path).pipe(Vn(this.destroy$)).subscribe({next:()=>{this.successMessage="Busta paga eliminata con successo",this.caricaDati()},error:e=>{console.error("Errore nell'eliminazione:",e),this.errorMessage="Errore durante l'eliminazione"}})}get ultimaBustaPaga(){return this.bustePaga.length>0?this.bustePaga[0]:null}static \u0275fac=function(e){return new(e||n)(C(gp),C($t),C(he))};static \u0275cmp=ge({type:n,selectors:[["app-buste-paga"]],decls:41,vars:9,consts:[["fileInput",""],[1,"page-container"],[1,"section-header"],[1,"header-icon"],[1,"material-icons"],[1,"section-titles"],[1,"section-title"],[1,"text-muted"],[1,"actions-container"],[1,"form-section"],[1,"grid-cards"],[1,"filters-container"],[1,"filter-group"],[1,"table-container"],[1,"crm-table"],[1,"empty-state"],[1,"promethea-button",3,"click"],[1,"grid-form",2,"margin-bottom","var(--gutter-lg)"],[1,"form-label"],[3,"ngModelChange","ngModel","disabled"],["value",""],[3,"value"],["type","month",1,"form-control",3,"ngModelChange","ngModel","disabled"],[1,"drop-zone",3,"drop","dragover","dragleave"],["class","drop-content",4,"ngIf"],["class","files-list",4,"ngIf"],[1,"status-message","error"],[1,"status-message","info"],[1,"form-actions"],["type","button",1,"promethea-button","ghost",3,"click","disabled"],["type","button",1,"promethea-button",3,"click","disabled"],[1,"loading-spinner"],[1,"drop-content"],[1,"text-muted",2,"margin-bottom","var(--gutter-lg)"],["type","button",1,"promethea-button","outline",3,"click"],["type","file","accept",".pdf","multiple","","hidden","",3,"change"],[1,"files-list"],["class","file-item",4,"ngFor","ngForOf"],[1,"file-item"],[1,"file-info"],[1,"file-name"],[1,"file-size"],["type","button",1,"icon-button",3,"click"],[1,"card"],[1,"card-title"],[1,"card-number"],[3,"ngModelChange","change","ngModel"],[1,"action-buttons"],[1,"icon-button",3,"click"],[1,"icon-button"],[1,"user-info-compact"],[1,"user-avatar-small"],[1,"user-details-compact"]],template:function(e,i){e&1&&(u(0,"div",1)(1,"div",2)(2,"div",3)(3,"span",4),d(4,"payments"),l()(),u(5,"div",5)(6,"h1",6),d(7),l(),u(8,"p",7),d(9),l()(),Z(10,oj,5,0,"div",8),l(),Z(11,hj,34,17,"div",9),Z(12,mj,11,2,"div",10),u(13,"div",9)(14,"div",2)(15,"h2",6)(16,"span",4),d(17,"list_alt"),l(),d(18),l(),u(19,"div",11),Z(20,_j,16,2)(21,bj,8,1,"div",12),l()(),u(22,"div",13)(23,"table",14)(24,"thead")(25,"tr"),Z(26,wj,2,0,"th"),u(27,"th"),d(28,"Periodo"),l(),u(29,"th"),d(30,"File"),l(),u(31,"th"),d(32,"Data Caricamento"),l(),u(33,"th"),d(34,"Dimensione"),l(),u(35,"th"),d(36,"Azioni"),l()()(),u(37,"tbody"),vt(38,Sj,20,9,"tr",null,Gv),l()()(),Z(40,xj,7,1,"div",15),l()()),e&2&&(p(7),O(" ",i.isAdmin?"Gestione Buste Paga":"Le mie Buste Paga"," "),p(2),O(" ",i.isAdmin?"Carica e gestisci le buste paga dei dipendenti":"Consulta e scarica le tue buste paga"," "),p(),J(i.isAdmin?10:-1),p(),J(i.isAdmin&&i.mostraUpload?11:-1),p(),J(i.isAdmin?-1:12),p(6),O(" ",i.isAdmin?"Buste Paga Caricate":"Storico Buste Paga"," "),p(2),J(i.isAdmin?20:21),p(6),J(i.isAdmin?26:-1),p(12),_t(i.bustePagaFiltrate),p(2),J(i.bustePagaFiltrate.length===0?40:-1))},dependencies:[_e,qe,Ee,Et,Vt,zt,Ne,wt,Pe,ct,At,Xe],styles:[".drop-zone[_ngcontent-%COMP%]{border:2px dashed var(--smoke-color-1);border-radius:16px;padding:var(--gutter-xl);text-align:center;transition:all .3s ease;background:color-mix(in srgb,var(--background) 95%,transparent)}.drop-zone.drag-over[_ngcontent-%COMP%]{border-color:var(--primary);background:color-mix(in srgb,var(--primary) 5%,transparent)}.drop-zone.has-files[_ngcontent-%COMP%]{border-style:solid;border-color:var(--primary);background:color-mix(in srgb,var(--primary) 2%,transparent)}.drop-content[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:var(--smoke-color-1)}.drop-zone.drag-over[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:var(--primary)}.files-list[_ngcontent-%COMP%]{text-align:left}.file-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);padding:var(--gutter-sm);border:1px solid var(--smoke-color-1);border-radius:8px;margin-bottom:var(--gutter-sm);background:var(--background)}.file-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.file-info[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:2px}.file-name[_ngcontent-%COMP%]{font-weight:600;color:var(--text-color)}.file-size[_ngcontent-%COMP%]{font-size:.8rem;color:color-mix(in srgb,var(--text-color) 60%,transparent)}@media (max-width: 768px){.drop-zone[_ngcontent-%COMP%]{padding:var(--gutter-lg)}.file-item[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:var(--gutter-sm)}.action-buttons[_ngcontent-%COMP%]{align-self:flex-end}}"]})};var Dj=()=>({month:"long",year:"numeric"}),Ij=(n,t)=>t.id;function Tj(n,t){n&1&&(u(0,"div",10),N(1,"div",18),u(2,"p"),d(3,"Caricamento calendario..."),l()())}function Mj(n,t){if(n&1&&(u(0,"div",13),d(1),l()),n&2){let e=t.$implicit;p(),R(e)}}function Aj(n,t){if(n&1&&(u(0,"div",25)(1,"span",26),d(2),l()()),n&2){let e=t.$implicit;di("background-color",e.color),p(2),R(e.title)}}function Rj(n,t){if(n&1&&(u(0,"div",22),vt(1,Aj,3,3,"div",24,Ij),l()),n&2){let e=v().$implicit,i=v(2);p(),_t(i.getEventsForDay(e))}}function Oj(n,t){if(n&1&&(u(0,"div",23),d(1),l()),n&2){let e=v(2).$implicit,i=v(2);p(),O(" ",i.getTimbratureCounterForDay(e)," ")}}function Nj(n,t){if(n&1&&E(0,Oj,2,1,"div",27),n&2){let e=v().$implicit,i=v(2);_("ngIf",i.getTimbratureCounterForDay(e))}}function Pj(n,t){if(n&1){let e=j();u(0,"div",20),S("click",function(){let r=D(e).$implicit,o=v(2);return I(o.onDayClick(r))}),u(1,"div",21),d(2),l(),Z(3,Rj,3,0,"div",22),Z(4,Nj,1,1,"div",23),l()}if(n&2){let e=t.$implicit,i=v(2);we("current-month",i.isCurrentMonth(e))("other-month",!i.isCurrentMonth(e))("today",i.isToday(e)),p(2),O(" ",e.getDate()," "),p(),J(i.getRuoloCorrente()==="employee"?3:-1),p(),J(i.getRuoloCorrente()==="admin"||i.getRuoloCorrente()==="manager"?4:-1)}}function kj(n,t){if(n&1&&(u(0,"div",15),vt(1,Pj,5,9,"div",19,pr),l()),n&2){let e=t.$implicit;p(),_t(e)}}function Fj(n,t){n&1&&(u(0,"div",17),N(1,"div",28),u(2,"span"),d(3,"Timbratura completata"),l()(),u(4,"div",17),N(5,"div",29),u(6,"span"),d(7,"Timbratura in corso"),l()())}function Lj(n,t){n&1&&(u(0,"div",17)(1,"span"),d(2,"Counter: Timbrature effettuate / Dipendenti totali"),l()())}var _p=class n{currentDate=Be(new Date);weeks=Be([]);events=Be([]);timbrature=Be([]);dipendenti=Be([]);isLoading=Be(!0);daysOfWeek=["Lun","Mar","Mer","Gio","Ven","Sab","Dom"];authService=A(he);timbratureService=A(xt);dipendentiService=A($t);ngOnInit(){return b(this,null,function*(){yield this.caricaDipendenti(),yield this.caricaTimbrature(),this.generateCalendar()})}caricaDipendenti(){return b(this,null,function*(){let t=this.authService.currentUserSubject.value;if((t?.role==="admin"||t?.role==="manager")&&t.company_id)try{this.dipendentiService.getDipendenti(t.company_id).subscribe({next:e=>{let i=e.filter(r=>r.is_active);this.dipendenti.set(i)},error:e=>{console.error("Errore caricamento dipendenti:",e)}})}catch(e){console.error("Errore caricamento dipendenti:",e)}})}caricaTimbrature(){return b(this,null,function*(){this.isLoading.set(!0);try{let t=this.authService.currentUserSubject.value;if(!t)return;let e=[];t.role==="admin"?e=yield this.timbratureService.getTimbratureAzienda(t.company_id):t.role==="manager"?e=yield this.timbratureService.getTimbraturePerCalendario():e=yield this.timbratureService.getTimbratureUtente(t.id),this.timbrature.set(e),this.creaEventiDaTimbrature(e)}catch(t){console.error("Errore nel caricamento timbrature:",t)}finally{this.isLoading.set(!1)}})}creaEventiDaTimbrature(t){if(this.authService.currentUserSubject.value?.role==="employee"){let i=t.map(r=>({id:r.id||"",title:`${this.formattaOrario(r.start_ts)} - ${r.end_ts?this.formattaOrario(r.end_ts):"In corso"}`,date:new Date(r.start_ts),color:r.end_ts?"#22c55e":"#f59e0b",type:"timbratura",data:r}));this.events.set(i)}else this.events.set([])}getTimbratureCounterForDay(t){if(this.authService.currentUserSubject.value?.role==="employee")return"";let i=this.dipendenti().length;if(i===0)return"";let r=this.timbrature().filter(s=>{let a=new Date(s.start_ts);return this.isSameDay(a,t)});return`${new Set(r.map(s=>s.user_id)).size}/${i}`}isSameDay(t,e){return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()}formattaOrario(t){return new Date(t).toLocaleTimeString("it-IT",{hour:"2-digit",minute:"2-digit"})}generateCalendar(){let t=this.currentDate().getFullYear(),e=this.currentDate().getMonth(),i=new Date(t,e,1),r=new Date(t,e+1,0),o=new Date(i),s=(i.getDay()+6)%7;o.setDate(i.getDate()-s);let a=[],c=[];for(let f=0;f<42;f++){let h=new Date(o);h.setDate(o.getDate()+f),c.push(h),c.length===7&&(a.push(c),c=[])}this.weeks.set(a)}getEventsForDay(t){return this.authService.currentUserSubject.value?.role!=="employee"?[]:this.events().filter(i=>this.isSameDay(i.date,t))}isCurrentMonth(t){return t.getMonth()===this.currentDate().getMonth()}isToday(t){let e=new Date;return this.isSameDay(t,e)}previousMonth(){return b(this,null,function*(){let t=new Date(this.currentDate());t.setMonth(t.getMonth()-1),this.currentDate.set(t),this.generateCalendar(),yield this.caricaTimbrature()})}nextMonth(){return b(this,null,function*(){let t=new Date(this.currentDate());t.setMonth(t.getMonth()+1),this.currentDate.set(t),this.generateCalendar(),yield this.caricaTimbrature()})}goToToday(){return b(this,null,function*(){this.currentDate.set(new Date),this.generateCalendar(),yield this.caricaTimbrature()})}onDayClick(t){console.log("Giorno cliccato:",t)}getRuoloCorrente(){return this.authService.currentUserSubject.value?.role||""}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=ge({type:n,selectors:[["app-calendario"]],decls:31,vars:4,consts:[[1,"page-container"],[1,"card-header"],[1,"material-icons"],[1,"card-title"],[1,"calendar-controls"],["title","Mese precedente",1,"icon-button",3,"click"],[1,"promethea-button","ghost",3,"click"],[1,"calendar-month-title"],["title","Mese successivo",1,"icon-button",3,"click"],[1,"card-content"],[1,"loading-container"],[1,"calendar-container"],[1,"calendar-header"],[1,"calendar-day-header"],[1,"calendar-grid"],[1,"calendar-week"],[1,"calendar-legend"],[1,"legend-item"],[1,"loading-spinner"],[1,"calendar-day",3,"current-month","other-month","today"],[1,"calendar-day",3,"click"],[1,"day-number"],[1,"day-events"],[1,"timbrature-counter"],[1,"calendar-event","timbratura-event",3,"background-color"],[1,"calendar-event","timbratura-event"],[1,"event-time"],["class","timbrature-counter",4,"ngIf"],[1,"legend-color",2,"background-color","#22c55e"],[1,"legend-color",2,"background-color","#f59e0b"]],template:function(e,i){e&1&&(u(0,"div",0)(1,"div",1)(2,"span",2),d(3,"calendar_today"),l(),u(4,"h2",3),d(5,"Calendario Timbrature"),l(),u(6,"div",4)(7,"button",5),S("click",function(){return i.previousMonth()}),u(8,"span",2),d(9,"chevron_left"),l()(),u(10,"button",6),S("click",function(){return i.goToToday()}),u(11,"span",2),d(12,"today"),l(),d(13," Oggi "),l(),u(14,"h3",7),d(15),l(),u(16,"button",8),S("click",function(){return i.nextMonth()}),u(17,"span",2),d(18,"chevron_right"),l()()()(),u(19,"div",9),Z(20,Tj,4,0,"div",10),u(21,"div",11)(22,"div",12),vt(23,Mj,2,1,"div",13,pr),l(),u(25,"div",14),vt(26,kj,3,0,"div",15,pr),l()(),u(28,"div",16),Z(29,Fj,8,0)(30,Lj,3,0,"div",17),l()()()),e&2&&(p(15),O(" ",i.currentDate().toLocaleDateString("it-IT",yt(3,Dj))," "),p(5),J(i.isLoading()?20:-1),p(3),_t(i.daysOfWeek),p(3),_t(i.weeks()),p(3),J(i.getRuoloCorrente()==="employee"?29:30))},dependencies:[_e,Ee],styles:[".day-events[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.calendar-event[_ngcontent-%COMP%]{padding:2px 6px;border-radius:4px;font-size:.7rem;color:#fff;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;cursor:pointer;transition:all .2s ease}.calendar-event[_ngcontent-%COMP%]:hover{transform:scale(1.02);box-shadow:0 2px 4px var(--shadow)}@media (max-width: 768px){.calendar-controls[_ngcontent-%COMP%]{flex-wrap:wrap;justify-content:center}.calendar-month-title[_ngcontent-%COMP%]{min-width:150px;order:-1;width:100%;text-align:center}.calendar-week[_ngcontent-%COMP%]{min-height:80px}.calendar-day[_ngcontent-%COMP%]{padding:4px}.day-number[_ngcontent-%COMP%]{font-size:.8rem;margin-bottom:2px}.calendar-event[_ngcontent-%COMP%]{font-size:.6rem;padding:1px 3px}}@media (max-width: 480px){.calendar-day-header[_ngcontent-%COMP%]{padding:var(--gutter-sm);font-size:.7rem}.days-of-week[_ngcontent-%COMP%]{font-size:.7rem}}.timbratura-event[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px;padding:4px 6px;border-radius:6px;font-size:.7rem;color:#fff;cursor:pointer;transition:all .2s ease;border-left:3px solid color-mix(in srgb,currentColor 30%,transparent)}.timbratura-event[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 2px 8px var(--shadow)}.event-time[_ngcontent-%COMP%]{font-weight:600;font-size:.65rem}.event-user[_ngcontent-%COMP%]{font-size:.6rem;opacity:.9;font-style:italic}.calendar-legend[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-lg);margin-top:var(--gutter-lg);padding-top:var(--gutter-md);border-top:1px solid var(--smoke-color-1);flex-wrap:wrap}.legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);font-size:.8rem;color:var(--text-color)}.legend-color[_ngcontent-%COMP%]{width:16px;height:16px;border-radius:4px;border:1px solid var(--smoke-color-1)}@media (max-width: 768px){.timbratura-event[_ngcontent-%COMP%]{padding:2px 4px;font-size:.6rem}.event-time[_ngcontent-%COMP%]{font-size:.55rem}.event-user[_ngcontent-%COMP%]{font-size:.5rem}.calendar-legend[_ngcontent-%COMP%]{flex-direction:column;gap:var(--gutter-sm)}}.calendar-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-md);margin-left:auto}.calendar-month-title[_ngcontent-%COMP%]{margin:0;font-size:var(--fs-md);font-weight:600;color:var(--text-color);min-width:200px;text-align:center}.calendar-container[_ngcontent-%COMP%]{background:var(--background);border-radius:16px;overflow:hidden}.calendar-header[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(7,1fr);background:var(--smoke-color-2);border-bottom:1px solid var(--smoke-color-1)}.calendar-day-header[_ngcontent-%COMP%]{padding:var(--gutter-md);text-align:center;font-weight:600;color:var(--text-color);font-size:var(--fs-sm);border-right:1px solid var(--smoke-color-1)}.calendar-day-header[_ngcontent-%COMP%]:last-child{border-right:none}.calendar-grid[_ngcontent-%COMP%]{display:flex;flex-direction:column}.calendar-week[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(7,1fr);min-height:120px}.calendar-day[_ngcontent-%COMP%]{padding:var(--gutter-sm);border-right:1px solid var(--smoke-color-1);border-bottom:1px solid var(--smoke-color-1);cursor:pointer;transition:all .2s ease;background:var(--background);position:relative}.calendar-day[_ngcontent-%COMP%]:hover{background:color-mix(in srgb,var(--primary) 5%,transparent);transform:translateY(-1px)}.calendar-day.other-month[_ngcontent-%COMP%]{background:color-mix(in srgb,var(--background) 60%,transparent);color:color-mix(in srgb,var(--text-color) 40%,transparent)}.calendar-day.other-month[_ngcontent-%COMP%]:hover{background:color-mix(in srgb,var(--primary) 3%,transparent)}.calendar-day.today[_ngcontent-%COMP%]{background:var(--gradiente-light);border:2px solid var(--primary)}.calendar-day.today[_ngcontent-%COMP%]   .day-number[_ngcontent-%COMP%]{font-weight:800;color:var(--primary)}.day-number[_ngcontent-%COMP%]{font-size:var(--fs-sm);font-weight:600;margin-bottom:var(--gutter-sm);text-align:center;color:var(--text-color)}.other-month[_ngcontent-%COMP%]   .day-number[_ngcontent-%COMP%]{color:color-mix(in srgb,var(--text-color) 40%,transparent);font-weight:400}.day-events[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px;max-height:80px;overflow-y:auto}.day-events[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}.day-events[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--smoke-color-1);border-radius:2px}@media (max-width: 768px){.calendar-controls[_ngcontent-%COMP%]{flex-wrap:wrap;justify-content:center}.calendar-month-title[_ngcontent-%COMP%]{min-width:150px;order:-1;width:100%;text-align:center}.calendar-week[_ngcontent-%COMP%]{min-height:100px}.calendar-day[_ngcontent-%COMP%]{padding:4px}.day-number[_ngcontent-%COMP%]{font-size:.8rem;margin-bottom:2px}}@media (max-width: 480px){.calendar-day-header[_ngcontent-%COMP%]{padding:var(--gutter-sm);font-size:.7rem}}.timbrature-counter[_ngcontent-%COMP%]{font-size:.75rem;color:var(--primary);font-weight:600;text-align:center;margin-top:4px;padding:2px 6px;background:color-mix(in srgb,var(--primary) 10%,transparent);border-radius:4px;border:1px solid color-mix(in srgb,var(--primary) 20%,transparent);min-height:20px;display:flex;align-items:center;justify-content:center}.calendar-day.other-month[_ngcontent-%COMP%]   .timbrature-counter[_ngcontent-%COMP%]{opacity:.5}@media (max-width: 768px){.timbrature-counter[_ngcontent-%COMP%]{font-size:.65rem;padding:1px 4px;min-height:16px}}"]})};var vx=[{path:"",redirectTo:"/login",pathMatch:"full"},{path:"login",component:np},{path:"register",component:ip},{path:"forgot-password",component:rp},{path:"home",component:op},{path:"timbrature",component:sp},{path:"crea-timbratura",component:ap},{path:"profilo-aziendale",component:cp},{path:"calendario",component:_p},{path:"dipendenti",component:up},{path:"dipendenti/:id",component:dp},{path:"inviti-dipendenti",component:Qs},{path:"report",component:mp},{path:"buste-paga",component:vp},{path:"kpi",component:pp},{path:"impostazioni",component:hp},{path:"loading-spinner",component:Js},{path:"**",redirectTo:"/home"}];var qv={providers:[Hh(),p0(),Rg({eventCoalescing:!0}),B0(vx)]};var yp=class n{THEME_KEY="app-theme";darkThemeClass="dark-theme";currentTheme=Be("light");constructor(){this.loadTheme()}loadTheme(){let t=localStorage.getItem(this.THEME_KEY),e=window.matchMedia("(prefers-color-scheme: dark)").matches,i=t||(e?"dark":"light");this.setTheme(i)}toggleTheme(){let t=this.currentTheme()==="light"?"dark":"light";this.setTheme(t)}setTheme(t){this.currentTheme.set(t),localStorage.setItem(this.THEME_KEY,t),t==="dark"?(document.documentElement.setAttribute("data-theme","dark"),document.documentElement.classList.add(this.darkThemeClass)):(document.documentElement.removeAttribute("data-theme"),document.documentElement.classList.remove(this.darkThemeClass))}static \u0275fac=function(e){return new(e||n)};static \u0275prov=k({token:n,factory:n.\u0275fac,providedIn:"root"})};var jj=["sidebar"];function Vj(n,t){if(n&1){let e=j();u(0,"button",39),S("click",function(){D(e);let r=v(2);return I(r.toggleSidebar())}),u(1,"span",10),d(2,"chevron_left"),l()()}}function zj(n,t){n&1&&(u(0,"div",40),d(1,"Dashboard"),l())}function Uj(n,t){n&1&&(u(0,"div",40),d(1,"Gestione"),l())}function Bj(n,t){if(n&1){let e=j();u(0,"a",41),S("click",function(){D(e);let r=v(2);return I(r.onNavItemClicked())}),u(1,"span",10),d(2,"people"),l(),u(3,"span",16),d(4,"Dipendenti"),l()()}}function $j(n,t){n&1&&(u(0,"div",40),d(1,"Timbrature"),l())}function Hj(n,t){n&1&&(u(0,"div",40),d(1,"Report"),l())}function Wj(n,t){if(n&1){let e=j();u(0,"div",13),E(1,Hj,2,0,"div",14),u(2,"a",42),S("click",function(){D(e);let r=v(2);return I(r.onNavItemClicked())}),u(3,"span",10),d(4,"assessment"),l(),u(5,"span",16),d(6,"Report"),l()()()}if(n&2){let e=v(2);p(),_("ngIf",!e.isSidebarCollapsed)}}function Gj(n,t){n&1&&(u(0,"div",40),d(1,"Analisi"),l())}function qj(n,t){if(n&1&&(u(0,"div",43)(1,"div",44)(2,"div",45),d(3),l(),u(4,"div",46),d(5),l()()()),n&2){let e=v(2);p(3),be("",e.currentUser==null?null:e.currentUser.first_name," ",e.currentUser==null?null:e.currentUser.last_name),p(2),R(e.currentUser==null?null:e.currentUser.role)}}function Kj(n,t){if(n&1){let e=j();hn(0),u(1,"div",3)(2,"aside",4,1)(4,"div",5)(5,"div",6),N(6,"img",7),l(),u(7,"div",8)(8,"button",9),S("click",function(){D(e);let r=v();return I(r.toggleTheme())}),u(9,"span",10),d(10),l()(),E(11,Vj,3,0,"button",11),l()(),u(12,"nav",12)(13,"div",13),E(14,zj,2,0,"div",14),u(15,"a",15),S("click",function(){D(e);let r=v();return I(r.onNavItemClicked())}),u(16,"span",10),d(17,"dashboard"),l(),u(18,"span",16),d(19,"Dashboard"),l()()(),u(20,"div",13),E(21,Uj,2,0,"div",14)(22,Bj,5,0,"a",17),u(23,"a",18),S("click",function(){D(e);let r=v();return I(r.onNavItemClicked())}),u(24,"span",10),d(25,"business"),l(),u(26,"span",16),d(27,"Azienda"),l()()(),u(28,"div",13),E(29,$j,2,0,"div",14),u(30,"a",19),S("click",function(){D(e);let r=v();return I(r.onNavItemClicked())}),u(31,"span",10),d(32,"schedule"),l(),u(33,"span",16),d(34,"Timbrature"),l()(),u(35,"a",20),S("click",function(){D(e);let r=v();return I(r.onNavItemClicked())}),u(36,"span",10),d(37,"add_circle"),l(),u(38,"span",16),d(39,"Nuova Timbratura"),l()(),u(40,"a",21),S("click",function(){D(e);let r=v();return I(r.onNavItemClicked())}),u(41,"span",10),d(42,"calendar_today"),l(),u(43,"span",16),d(44,"Calendario"),l()()(),E(45,Wj,7,1,"div",22),u(46,"div",13),E(47,Gj,2,0,"div",14),u(48,"a",23),S("click",function(){D(e);let r=v();return I(r.onNavItemClicked())}),u(49,"span",10),d(50,"insights"),l(),u(51,"span",16),d(52,"KPI"),l()()()(),u(53,"div",24)(54,"div",25)(55,"div",26),d(56),l(),E(57,qj,6,3,"div",27),u(58,"div",28)(59,"a",29),S("click",function(){D(e);let r=v();return I(r.onNavItemClicked())}),u(60,"span",10),d(61,"settings"),l()(),u(62,"button",30),S("click",function(){D(e);let r=v();return I(r.logout())}),u(63,"span",10),d(64,"logout"),l()()()()()(),u(65,"main",31)(66,"header",32)(67,"button",33),S("click",function(){D(e);let r=v();return I(r.toggleSidebar())}),u(68,"span",10),d(69,"menu"),l()(),u(70,"div",34)(71,"div",35),d(72),K(73,"date"),l(),u(74,"div",36),d(75),K(76,"date"),l()()(),u(77,"div",37),N(78,"router-outlet"),l()(),u(79,"div",38),S("click",function(){D(e);let r=v();return I(r.closeSidebar())}),l()(),mn()}if(n&2){let e=v();p(),we("sidebar-collapsed",e.isSidebarCollapsed),p(),we("hidden",e.isSidebarCollapsed)("collapsed",e.isSidebarCollapsed&&!e.isMobileSidebarOpen),p(6),_("title",e.currentTheme()==="light"?"Attiva tema scuro":"Attiva tema chiaro"),p(2),O(" ",e.currentTheme()==="light"?"dark_mode":"light_mode"," "),p(),_("ngIf",!e.isSidebarCollapsed),p(3),_("ngIf",!e.isSidebarCollapsed),p(7),_("ngIf",!e.isSidebarCollapsed),p(),_("ngIf",e.hasRole("admin")||e.hasRole("manager")),p(7),_("ngIf",!e.isSidebarCollapsed),p(16),_("ngIf",e.hasRole("admin")||e.hasRole("manager")),p(2),_("ngIf",!e.isSidebarCollapsed),p(9),be(" ",e.currentUser==null||e.currentUser.first_name==null?null:e.currentUser.first_name.charAt(0),"",e.currentUser==null||e.currentUser.last_name==null?null:e.currentUser.last_name.charAt(0)," "),p(),_("ngIf",!e.isSidebarCollapsed),p(2),_("title","Impostazioni"),p(3),_("title","Logout"),p(10),R(te(73,24,e.currentTime,"HH:mm")),p(3),R(te(76,27,e.currentTime,"EEEE, d MMMM yyyy")),p(4),we("active",e.isMobileSidebarOpen)}}function Yj(n,t){n&1&&(u(0,"div",47),N(1,"router-outlet"),l())}var bp=class n{constructor(t,e){this.authService=t;this.router=e}sidebarRef;isSidebarCollapsed=!1;isMobileSidebarOpen=!1;currentTime=new Date;currentUser=null;isAuthRoute=!1;themeService=A(yp);currentTheme=this.themeService.currentTheme;timeInterval;userSub;routeSub;authRoutes=["/login","/register","/forgot-password"];ngOnInit(){this.timeInterval=setInterval(()=>{this.currentTime=new Date},1e3),this.userSub=this.authService.currentUser$.subscribe(e=>{this.currentUser=e});let t=this.router.url.split("?")[0];this.isAuthRoute=this.authRoutes.includes(t),this.routeSub=this.router.events.pipe(rt(e=>e instanceof Jt)).subscribe(e=>{let i=e.urlAfterRedirects.split("?")[0];this.isAuthRoute=this.authRoutes.includes(i),this.isAuthRoute&&(this.isSidebarCollapsed=!0,this.isMobileSidebarOpen=!1)}),this.checkScreenSize()}onResize(){this.checkScreenSize()}checkScreenSize(){window.innerWidth<768?(this.isSidebarCollapsed=!0,this.isMobileSidebarOpen=!1):this.isMobileSidebarOpen=!1}toggleTheme(){this.themeService.toggleTheme()}toggleSidebar(){window.innerWidth<768?(this.isMobileSidebarOpen=!this.isMobileSidebarOpen,this.isSidebarCollapsed=!this.isMobileSidebarOpen):this.isSidebarCollapsed=!this.isSidebarCollapsed}closeSidebar(){window.innerWidth<768?(this.isMobileSidebarOpen=!1,this.isSidebarCollapsed=!0):this.isSidebarCollapsed=!0}onNavItemClicked(){setTimeout(()=>this.closeSidebar(),50)}handleDocumentClick(t){let e=t.target;e&&(e.closest(".sidebar")||e.closest(".sidebar-toggle")||e.closest(".sidebar-hamburger")||(this.isMobileSidebarOpen||!this.isSidebarCollapsed&&window.innerWidth>=768)&&this.closeSidebar())}hasRole(t){return this.authService.hasRole(t)}logout(){this.authService.logout(),this.router.navigate(["/login"])}ngOnDestroy(){this.timeInterval&&clearInterval(this.timeInterval),this.userSub?.unsubscribe(),this.routeSub?.unsubscribe()}static \u0275fac=function(e){return new(e||n)(C(he),C(Se))};static \u0275cmp=ge({type:n,selectors:[["app-root"]],viewQuery:function(e,i){if(e&1&&Cg(jj,7),e&2){let r;Ba(r=$a())&&(i.sidebarRef=r.first)}},hostBindings:function(e,i){e&1&&S("resize",function(){return i.onResize()},qm)("click",function(o){return i.handleDocumentClick(o)},Km)},decls:3,vars:2,consts:[["authLayout",""],["sidebar",""],[4,"ngIf","ngIfElse"],[1,"app-container"],[1,"sidebar"],[1,"sidebar-header"],[1,"logo-container"],["src","/assets/logo.png","alt","Logo",1,"logo"],[1,"header-actions"],[1,"theme-toggle","icon-button",3,"click","title"],[1,"material-icons"],["class","sidebar-toggle icon-button",3,"click",4,"ngIf"],[1,"sidebar-nav"],[1,"nav-section"],["class","nav-label",4,"ngIf"],["routerLink","/home","routerLinkActive","active",1,"nav-item",3,"click"],[1,"nav-text"],["class","nav-item","routerLink","/dipendenti","routerLinkActive","active",3,"click",4,"ngIf"],["routerLink","/profilo-aziendale","routerLinkActive","active",1,"nav-item",3,"click"],["routerLink","/timbrature","routerLinkActive","active",1,"nav-item",3,"click"],["routerLink","/crea-timbratura","routerLinkActive","active",1,"nav-item",3,"click"],["routerLink","/calendario","routerLinkActive","active",1,"nav-item",3,"click"],["class","nav-section",4,"ngIf"],["routerLink","/kpi","routerLinkActive","active",1,"nav-item",3,"click"],[1,"sidebar-footer"],[1,"user-section"],[1,"user-avatar"],["class","user-info",4,"ngIf"],[1,"user-actions"],["routerLink","/impostazioni","routerLinkActive","active",1,"nav-item","compact",3,"click","title"],[1,"nav-item","compact","logout-btn",3,"click","title"],[1,"main-content"],[1,"top-header"],[1,"sidebar-hamburger",3,"click"],[1,"header-actions",2,"background","var(--background)"],[1,"current-time"],[1,"current-date"],[1,"page-content"],[1,"mobile-overlay",3,"click"],[1,"sidebar-toggle","icon-button",3,"click"],[1,"nav-label"],["routerLink","/dipendenti","routerLinkActive","active",1,"nav-item",3,"click"],["routerLink","/report","routerLinkActive","active",1,"nav-item",3,"click"],[1,"user-info"],[1,"user-details"],[1,"user-name"],[1,"user-role","chip"],[1,"auth-layout"]],template:function(e,i){if(e&1&&E(0,Kj,80,30,"ng-container",2)(1,Yj,2,0,"ng-template",null,0,to),e&2){let r=zi(2);_("ngIf",!i.isAuthRoute)("ngIfElse",r)}},dependencies:[_e,Ee,wl,At,jt,U0,Xe],styles:[".app-container[_ngcontent-%COMP%]{display:block;min-height:100vh;background:var(--background)}.app-container.sidebar-collapsed[_ngcontent-%COMP%]{grid-template-columns:0px 1fr}.sidebar[_ngcontent-%COMP%]{position:fixed;inset:0 auto 0 0;width:var(--grandezzasidebar);max-width:min(90vw,320px);height:100dvh;display:flex;flex-direction:column;gap:var(--gutter-sm);padding:0;background:var(--sidebar-background);-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);border-right:1px solid var(--smoke-color-1);z-index:9999;transition:transform .32s cubic-bezier(.2,.9,.2,1);overflow-y:auto;-webkit-overflow-scrolling:touch}.sidebar.hidden[_ngcontent-%COMP%]{width:0;border-right:none;box-shadow:none;transition:all .4s cubic-bezier(.25,.8,.25,1);padding:0}.sidebar.collapsed[_ngcontent-%COMP%]:not(.hidden){width:0;padding:0}.sidebar-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:0;border-bottom:1px solid var(--smoke-color-1);min-height:5rem;flex-shrink:0;position:relative;overflow:hidden}.sidebar-header[_ngcontent-%COMP%]   .theme-toggle[_ngcontent-%COMP%]{background:var(--smoke-color-1);border:1px solid var(--smoke-color-2);color:var(--text-color);cursor:pointer;padding:var(--gutter-sm);border-radius:50%;transition:all .3s cubic-bezier(.25,.8,.25,1);display:flex;align-items:center;justify-content:center;width:40px;height:40px;position:relative;overflow:hidden;box-shadow:0 2px 4px var(--shadow)}.logo[_ngcontent-%COMP%]{height:50px;width:auto;object-fit:contain;flex-shrink:0;transition:all .3s cubic-bezier(.25,.8,.25,1);filter:brightness(1);border-radius:50%;box-shadow:0 2px 4px var(--shadow);background:color-mix(in srgb,var(--text-color) 20%,transparent)}.logo-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);flex:1;min-width:0;padding:var(--gutter-sm);transition:all .3s cubic-bezier(.25,.8,.25,1)}.app-name[_ngcontent-%COMP%]{font-weight:700;font-size:var(--fs-md);color:var(--primary);white-space:nowrap;opacity:1;padding:var(--gutter-sm);transition:opacity .3s ease}.sidebar.collapsed[_ngcontent-%COMP%]   .app-name[_ngcontent-%COMP%]{opacity:0;width:0}.sidebar-toggle[_ngcontent-%COMP%]{background:var(--smoke-color-1);border:1px solid var(--smoke-color-2);color:var(--text-color);cursor:pointer;padding:var(--gutter-sm);border-radius:50%;transition:all .3s cubic-bezier(.25,.8,.25,1);display:flex;align-items:center;justify-content:center;width:40px;height:40px;box-shadow:0 2px 4px var(--shadow)}.sidebar-toggle[_ngcontent-%COMP%]:hover{background:var(--text-color);color:var(--background);border-color:var(--accent);transform:translateY(-1px);box-shadow:0 4px 12px color-mix(in srgb,var(--accent) 30%,transparent)}.sidebar-nav[_ngcontent-%COMP%]{flex:1;padding:var(--gutter-lg) 0;overflow-y:auto}.nav-section[_ngcontent-%COMP%]{margin-bottom:var(--gutter-lg)}.nav-label[_ngcontent-%COMP%]{font-size:var(--fs-sm);font-weight:600;color:var(--text-color);opacity:.6;padding:0 var(--gutter-lg) var(--gutter-sm) var(--gutter-lg);text-transform:uppercase;letter-spacing:.5px;transition:opacity .3s ease}.sidebar.collapsed[_ngcontent-%COMP%]   .nav-label[_ngcontent-%COMP%]{opacity:0;height:0;padding:0;margin:0}.nav-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);padding:var(--gutter-sm) var(--gutter-lg);color:var(--text-color);text-decoration:none;transition:all .2s ease;border-left:3px solid transparent;margin:2px var(--gutter-sm);border-radius:8px;white-space:nowrap;overflow:hidden}.nav-item[_ngcontent-%COMP%]:hover{background:var(--smoke-color-1);border-left-color:var(--primary)}.nav-item.active[_ngcontent-%COMP%]{background:var(--smoke-color-3);border-left-color:var(--tertiary);color:var(--tertiary);font-weight:600}.nav-item.compact[_ngcontent-%COMP%]{padding:var(--gutter-sm);justify-content:center;margin:0}.nav-text[_ngcontent-%COMP%]{transition:opacity .3s ease;opacity:1}.sidebar.collapsed[_ngcontent-%COMP%]   .nav-text[_ngcontent-%COMP%]{opacity:0;width:0}.nav-text[_ngcontent-%COMP%], .app-name[_ngcontent-%COMP%], .user-info[_ngcontent-%COMP%], .nav-label[_ngcontent-%COMP%]{transition:all .3s cubic-bezier(.25,.8,.25,1)}.nav-item[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:20px;min-width:24px;text-align:center}.sidebar-footer[_ngcontent-%COMP%]{border-top:1px solid var(--smoke-color-1);padding:var(--gutter-sm);flex-shrink:0}.user-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);transition:all .3s ease}.user-avatar[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;background:var(--gradiente);display:flex;align-items:center;justify-content:center;color:var(--background);font-weight:600;font-size:var(--fs-sm);flex-shrink:0}.user-info[_ngcontent-%COMP%]{flex:1;overflow:hidden;transition:opacity .3s ease;opacity:1}.sidebar.collapsed[_ngcontent-%COMP%]   .user-info[_ngcontent-%COMP%]{opacity:0;width:0;margin:0}.user-details[_ngcontent-%COMP%]{min-width:0}.user-name[_ngcontent-%COMP%]{font-weight:600;font-size:var(--fs-sm);margin-bottom:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.user-role.chip[_ngcontent-%COMP%]{font-size:.7rem;padding:2px 8px}.user-actions[_ngcontent-%COMP%]{display:flex;gap:var(--gutter-sm);margin-left:auto}.logout-btn[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;text-align:left;font-family:inherit}.main-content[_ngcontent-%COMP%]{background:var(--background);display:flex;flex-direction:column;width:calc(100% - var(--grandezzasidebar));min-height:100vh;margin-left:var(--grandezzasidebar);transition:margin-left .4s cubic-bezier(.25,.8,.25,1),width .4s cubic-bezier(.25,.8,.25,1);box-sizing:border-box;max-width:100%;transform:translateZ(0);will-change:margin-left,width}.top-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:var(--gutter-sm);background:transparent;border-bottom:1px solid var(--smoke-color-1);position:sticky;top:0;z-index:100;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);min-height:5rem}.sidebar-hamburger[_ngcontent-%COMP%]{background:none;border:none;color:var(--text-color);cursor:pointer;padding:var(--gutter-sm);border-radius:8px;transition:all .2s ease;display:flex;align-items:center;justify-content:center}.sidebar-hamburger[_ngcontent-%COMP%]:hover{background:var(--smoke-color-1)}.sidebar-hamburger[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:var(--fs-md)}.header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:var(--gutter-sm);flex-shrink:0;padding:var(--gutter-sm);border-radius:8px;transition:all .3s cubic-bezier(.25,.8,.25,1)}.current-time[_ngcontent-%COMP%]{font-size:var(--fs-md);font-weight:700;color:var(--primary)}.current-date[_ngcontent-%COMP%]{font-size:var(--fs-sm);color:var(--text-color);opacity:.7}.theme-toggle[_ngcontent-%COMP%]{background:none;border:none;color:var(--text-color);cursor:pointer;padding:var(--gutter-sm);border-radius:8px;transition:all .2s ease;display:flex;align-items:center;justify-content:center}.theme-toggle[_ngcontent-%COMP%]:hover{background:var(--smoke-color-1);color:var(--primary)}.page-content[_ngcontent-%COMP%]{flex:1;padding:0;overflow-y:auto}.mobile-overlay[_ngcontent-%COMP%]{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;z-index:999;opacity:0;visibility:hidden;transition:all .3s cubic-bezier(.25,.8,.25,1);-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.mobile-overlay.active[_ngcontent-%COMP%]{opacity:1;visibility:visible}@media (max-width: 768px){.app-container[_ngcontent-%COMP%]{grid-template-columns:1fr}.sidebar[_ngcontent-%COMP%]{width:100vw!important;max-width:100vw!important;border-right:none;border-bottom:1px solid var(--smoke-color-1)}.sidebar[_ngcontent-%COMP%]:not(.hidden){transform:translate(0)}.mobile-overlay[_ngcontent-%COMP%]{display:block;background:#0006;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.header-actions[_ngcontent-%COMP%]{gap:var(--gutter-sm);align-items:flex-end}.current-time[_ngcontent-%COMP%]{font-size:var(--fs-sm)}.current-date[_ngcontent-%COMP%]{font-size:.8rem}}@media (max-width: 480px){.page-content[_ngcontent-%COMP%]{padding:var(--gutter-md)}.sidebar-footer[_ngcontent-%COMP%]{padding:var(--gutter-sm)}.user-section[_ngcontent-%COMP%], .user-actions[_ngcontent-%COMP%]{gap:var(--gutter-sm)}}.sidebar-nav[_ngcontent-%COMP%]::-webkit-scrollbar{width:4px}.sidebar-nav[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.sidebar-nav[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:var(--scrollbar-thumb);border-radius:var(--scrollbar-radius)}.sidebar-nav[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:var(--scrollbar-thumb-hover)}@keyframes _ngcontent-%COMP%_slideIn{0%{transform:translate(-100%)}to{transform:translate(0)}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.app-container.sidebar-collapsed[_ngcontent-%COMP%]   .main-content[_ngcontent-%COMP%]{width:100%;margin-left:0;max-width:100%;box-sizing:border-box}"]})};u0(bp,Y(P({},qv),{providers:[...qv.providers??[],{provide:gn,useClass:Qa}]})).catch(n=>console.error(n));
